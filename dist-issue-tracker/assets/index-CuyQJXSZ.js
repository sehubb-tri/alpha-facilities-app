(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function r(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(c){if(c.ep)return;c.ep=!0;const d=r(c);fetch(c.href,d)}})();var Ad={exports:{}},to={};var Xg;function Tb(){if(Xg)return to;Xg=1;var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function r(a,c,d){var h=null;if(d!==void 0&&(h=""+d),c.key!==void 0&&(h=""+c.key),"key"in c){d={};for(var p in c)p!=="key"&&(d[p]=c[p])}else d=c;return c=d.ref,{$$typeof:n,type:a,key:h,ref:c!==void 0?c:null,props:d}}return to.Fragment=i,to.jsx=r,to.jsxs=r,to}var em;function Ab(){return em||(em=1,Ad.exports=Tb()),Ad.exports}var s=Ab(),zd={exports:{}},_e={};var tm;function zb(){if(tm)return _e;tm=1;var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),S=Symbol.iterator;function _(I){return I===null||typeof I!="object"?null:(I=S&&I[S]||I["@@iterator"],typeof I=="function"?I:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,A={};function z(I,U,Q){this.props=I,this.context=U,this.refs=A,this.updater=Q||w}z.prototype.isReactComponent={},z.prototype.setState=function(I,U){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,U,"setState")},z.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function D(){}D.prototype=z.prototype;function y(I,U,Q){this.props=I,this.context=U,this.refs=A,this.updater=Q||w}var C=y.prototype=new D;C.constructor=y,j(C,z.prototype),C.isPureReactComponent=!0;var T=Array.isArray;function E(){}var W={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function K(I,U,Q){var ie=Q.ref;return{$$typeof:n,type:I,key:U,ref:ie!==void 0?ie:null,props:Q}}function ee(I,U){return K(I.type,U,I.props)}function F(I){return typeof I=="object"&&I!==null&&I.$$typeof===n}function ne(I){var U={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(Q){return U[Q]})}var se=/\/+/g;function B(I,U){return typeof I=="object"&&I!==null&&I.key!=null?ne(""+I.key):U.toString(36)}function $(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(E,E):(I.status="pending",I.then(function(U){I.status==="pending"&&(I.status="fulfilled",I.value=U)},function(U){I.status==="pending"&&(I.status="rejected",I.reason=U)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function O(I,U,Q,ie,fe){var ce=typeof I;(ce==="undefined"||ce==="boolean")&&(I=null);var ge=!1;if(I===null)ge=!0;else switch(ce){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(I.$$typeof){case n:case i:ge=!0;break;case x:return ge=I._init,O(ge(I._payload),U,Q,ie,fe)}}if(ge)return fe=fe(I),ge=ie===""?"."+B(I,0):ie,T(fe)?(Q="",ge!=null&&(Q=ge.replace(se,"$&/")+"/"),O(fe,U,Q,"",function(dt){return dt})):fe!=null&&(F(fe)&&(fe=ee(fe,Q+(fe.key==null||I&&I.key===fe.key?"":(""+fe.key).replace(se,"$&/")+"/")+ge)),U.push(fe)),1;ge=0;var Pe=ie===""?".":ie+":";if(T(I))for(var Ne=0;Ne<I.length;Ne++)ie=I[Ne],ce=Pe+B(ie,Ne),ge+=O(ie,U,Q,ce,fe);else if(Ne=_(I),typeof Ne=="function")for(I=Ne.call(I),Ne=0;!(ie=I.next()).done;)ie=ie.value,ce=Pe+B(ie,Ne++),ge+=O(ie,U,Q,ce,fe);else if(ce==="object"){if(typeof I.then=="function")return O($(I),U,Q,ie,fe);throw U=String(I),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return ge}function q(I,U,Q){if(I==null)return I;var ie=[],fe=0;return O(I,ie,"","",function(ce){return U.call(Q,ce,fe++)}),ie}function Z(I){if(I._status===-1){var U=I._result;U=U(),U.then(function(Q){(I._status===0||I._status===-1)&&(I._status=1,I._result=Q)},function(Q){(I._status===0||I._status===-1)&&(I._status=2,I._result=Q)}),I._status===-1&&(I._status=0,I._result=U)}if(I._status===1)return I._result.default;throw I._result}var re=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},ae={map:q,forEach:function(I,U,Q){q(I,function(){U.apply(this,arguments)},Q)},count:function(I){var U=0;return q(I,function(){U++}),U},toArray:function(I){return q(I,function(U){return U})||[]},only:function(I){if(!F(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return _e.Activity=k,_e.Children=ae,_e.Component=z,_e.Fragment=r,_e.Profiler=c,_e.PureComponent=y,_e.StrictMode=a,_e.Suspense=g,_e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=W,_e.__COMPILER_RUNTIME={__proto__:null,c:function(I){return W.H.useMemoCache(I)}},_e.cache=function(I){return function(){return I.apply(null,arguments)}},_e.cacheSignal=function(){return null},_e.cloneElement=function(I,U,Q){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var ie=j({},I.props),fe=I.key;if(U!=null)for(ce in U.key!==void 0&&(fe=""+U.key),U)!M.call(U,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&U.ref===void 0||(ie[ce]=U[ce]);var ce=arguments.length-2;if(ce===1)ie.children=Q;else if(1<ce){for(var ge=Array(ce),Pe=0;Pe<ce;Pe++)ge[Pe]=arguments[Pe+2];ie.children=ge}return K(I.type,fe,ie)},_e.createContext=function(I){return I={$$typeof:h,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:d,_context:I},I},_e.createElement=function(I,U,Q){var ie,fe={},ce=null;if(U!=null)for(ie in U.key!==void 0&&(ce=""+U.key),U)M.call(U,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(fe[ie]=U[ie]);var ge=arguments.length-2;if(ge===1)fe.children=Q;else if(1<ge){for(var Pe=Array(ge),Ne=0;Ne<ge;Ne++)Pe[Ne]=arguments[Ne+2];fe.children=Pe}if(I&&I.defaultProps)for(ie in ge=I.defaultProps,ge)fe[ie]===void 0&&(fe[ie]=ge[ie]);return K(I,ce,fe)},_e.createRef=function(){return{current:null}},_e.forwardRef=function(I){return{$$typeof:p,render:I}},_e.isValidElement=F,_e.lazy=function(I){return{$$typeof:x,_payload:{_status:-1,_result:I},_init:Z}},_e.memo=function(I,U){return{$$typeof:m,type:I,compare:U===void 0?null:U}},_e.startTransition=function(I){var U=W.T,Q={};W.T=Q;try{var ie=I(),fe=W.S;fe!==null&&fe(Q,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(E,re)}catch(ce){re(ce)}finally{U!==null&&Q.types!==null&&(U.types=Q.types),W.T=U}},_e.unstable_useCacheRefresh=function(){return W.H.useCacheRefresh()},_e.use=function(I){return W.H.use(I)},_e.useActionState=function(I,U,Q){return W.H.useActionState(I,U,Q)},_e.useCallback=function(I,U){return W.H.useCallback(I,U)},_e.useContext=function(I){return W.H.useContext(I)},_e.useDebugValue=function(){},_e.useDeferredValue=function(I,U){return W.H.useDeferredValue(I,U)},_e.useEffect=function(I,U){return W.H.useEffect(I,U)},_e.useEffectEvent=function(I){return W.H.useEffectEvent(I)},_e.useId=function(){return W.H.useId()},_e.useImperativeHandle=function(I,U,Q){return W.H.useImperativeHandle(I,U,Q)},_e.useInsertionEffect=function(I,U){return W.H.useInsertionEffect(I,U)},_e.useLayoutEffect=function(I,U){return W.H.useLayoutEffect(I,U)},_e.useMemo=function(I,U){return W.H.useMemo(I,U)},_e.useOptimistic=function(I,U){return W.H.useOptimistic(I,U)},_e.useReducer=function(I,U,Q){return W.H.useReducer(I,U,Q)},_e.useRef=function(I){return W.H.useRef(I)},_e.useState=function(I){return W.H.useState(I)},_e.useSyncExternalStore=function(I,U,Q){return W.H.useSyncExternalStore(I,U,Q)},_e.useTransition=function(){return W.H.useTransition()},_e.version="19.2.3",_e}var nm;function Du(){return nm||(nm=1,zd.exports=zb()),zd.exports}var v=Du(),Dd={exports:{}},no={},Od={exports:{}},Id={};var im;function Db(){return im||(im=1,(function(n){function i(O,q){var Z=O.length;O.push(q);e:for(;0<Z;){var re=Z-1>>>1,ae=O[re];if(0<c(ae,q))O[re]=q,O[Z]=ae,Z=re;else break e}}function r(O){return O.length===0?null:O[0]}function a(O){if(O.length===0)return null;var q=O[0],Z=O.pop();if(Z!==q){O[0]=Z;e:for(var re=0,ae=O.length,I=ae>>>1;re<I;){var U=2*(re+1)-1,Q=O[U],ie=U+1,fe=O[ie];if(0>c(Q,Z))ie<ae&&0>c(fe,Q)?(O[re]=fe,O[ie]=Z,re=ie):(O[re]=Q,O[U]=Z,re=U);else if(ie<ae&&0>c(fe,Z))O[re]=fe,O[ie]=Z,re=ie;else break e}}return q}function c(O,q){var Z=O.sortIndex-q.sortIndex;return Z!==0?Z:O.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;n.unstable_now=function(){return d.now()}}else{var h=Date,p=h.now();n.unstable_now=function(){return h.now()-p}}var g=[],m=[],x=1,k=null,S=3,_=!1,w=!1,j=!1,A=!1,z=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function C(O){for(var q=r(m);q!==null;){if(q.callback===null)a(m);else if(q.startTime<=O)a(m),q.sortIndex=q.expirationTime,i(g,q);else break;q=r(m)}}function T(O){if(j=!1,C(O),!w)if(r(g)!==null)w=!0,E||(E=!0,ne());else{var q=r(m);q!==null&&$(T,q.startTime-O)}}var E=!1,W=-1,M=5,K=-1;function ee(){return A?!0:!(n.unstable_now()-K<M)}function F(){if(A=!1,E){var O=n.unstable_now();K=O;var q=!0;try{e:{w=!1,j&&(j=!1,D(W),W=-1),_=!0;var Z=S;try{t:{for(C(O),k=r(g);k!==null&&!(k.expirationTime>O&&ee());){var re=k.callback;if(typeof re=="function"){k.callback=null,S=k.priorityLevel;var ae=re(k.expirationTime<=O);if(O=n.unstable_now(),typeof ae=="function"){k.callback=ae,C(O),q=!0;break t}k===r(g)&&a(g),C(O)}else a(g);k=r(g)}if(k!==null)q=!0;else{var I=r(m);I!==null&&$(T,I.startTime-O),q=!1}}break e}finally{k=null,S=Z,_=!1}q=void 0}}finally{q?ne():E=!1}}}var ne;if(typeof y=="function")ne=function(){y(F)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,B=se.port2;se.port1.onmessage=F,ne=function(){B.postMessage(null)}}else ne=function(){z(F,0)};function $(O,q){W=z(function(){O(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(O){switch(S){case 1:case 2:case 3:var q=3;break;default:q=S}var Z=S;S=q;try{return O()}finally{S=Z}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(O,q){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var Z=S;S=O;try{return q()}finally{S=Z}},n.unstable_scheduleCallback=function(O,q,Z){var re=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?re+Z:re):Z=re,O){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=Z+ae,O={id:x++,callback:q,priorityLevel:O,startTime:Z,expirationTime:ae,sortIndex:-1},Z>re?(O.sortIndex=Z,i(m,O),r(g)===null&&O===r(m)&&(j?(D(W),W=-1):j=!0,$(T,Z-re))):(O.sortIndex=ae,i(g,O),w||_||(w=!0,E||(E=!0,ne()))),O},n.unstable_shouldYield=ee,n.unstable_wrapCallback=function(O){var q=S;return function(){var Z=S;S=q;try{return O.apply(this,arguments)}finally{S=Z}}}})(Id)),Id}var sm;function Ob(){return sm||(sm=1,Od.exports=Db()),Od.exports}var Bd={exports:{}},kt={};var rm;function Ib(){if(rm)return kt;rm=1;var n=Du();function i(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)m+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(i(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},c=Symbol.for("react.portal");function d(g,m,x){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:k==null?null:""+k,children:g,containerInfo:m,implementation:x}}var h=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return kt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,kt.createPortal=function(g,m){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(i(299));return d(g,m,null,x)},kt.flushSync=function(g){var m=h.T,x=a.p;try{if(h.T=null,a.p=2,g)return g()}finally{h.T=m,a.p=x,a.d.f()}},kt.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(g,m))},kt.prefetchDNS=function(g){typeof g=="string"&&a.d.D(g)},kt.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var x=m.as,k=p(x,m.crossOrigin),S=typeof m.integrity=="string"?m.integrity:void 0,_=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;x==="style"?a.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:k,integrity:S,fetchPriority:_}):x==="script"&&a.d.X(g,{crossOrigin:k,integrity:S,fetchPriority:_,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},kt.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var x=p(m.as,m.crossOrigin);a.d.M(g,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(g)},kt.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var x=m.as,k=p(x,m.crossOrigin);a.d.L(g,x,{crossOrigin:k,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},kt.preloadModule=function(g,m){if(typeof g=="string")if(m){var x=p(m.as,m.crossOrigin);a.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(g)},kt.requestFormReset=function(g){a.d.r(g)},kt.unstable_batchedUpdates=function(g,m){return g(m)},kt.useFormState=function(g,m,x){return h.H.useFormState(g,m,x)},kt.useFormStatus=function(){return h.H.useHostTransitionStatus()},kt.version="19.2.3",kt}var om;function Bb(){if(om)return Bd.exports;om=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(i){console.error(i)}}return n(),Bd.exports=Ib(),Bd.exports}var am;function Nb(){if(am)return no;am=1;var n=Ob(),i=Du(),r=Bb();function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)t+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,o=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(o=t.return),e=t.return;while(e)}return t.tag===3?o:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(d(e)!==e)throw Error(a(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(a(188));return t!==e?null:e}for(var o=e,l=t;;){var u=o.return;if(u===null)break;var f=u.alternate;if(f===null){if(l=u.return,l!==null){o=l;continue}break}if(u.child===f.child){for(f=u.child;f;){if(f===o)return g(u),e;if(f===l)return g(u),t;f=f.sibling}throw Error(a(188))}if(o.return!==l.return)o=u,l=f;else{for(var b=!1,R=u.child;R;){if(R===o){b=!0,o=u,l=f;break}if(R===l){b=!0,l=u,o=f;break}R=R.sibling}if(!b){for(R=f.child;R;){if(R===o){b=!0,o=f,l=u;break}if(R===l){b=!0,l=f,o=u;break}R=R.sibling}if(!b)throw Error(a(189))}}if(o.alternate!==l)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?e:t}function x(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=x(e),t!==null)return t;e=e.sibling}return null}var k=Object.assign,S=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),y=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function ne(e){return e===null||typeof e!="object"?null:(e=F&&e[F]||e["@@iterator"],typeof e=="function"?e:null)}var se=Symbol.for("react.client.reference");function B(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===se?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case j:return"Fragment";case z:return"Profiler";case A:return"StrictMode";case T:return"Suspense";case E:return"SuspenseList";case K:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case y:return e.displayName||"Context";case D:return(e._context.displayName||"Context")+".Consumer";case C:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case W:return t=e.displayName||null,t!==null?t:B(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return B(e(t))}catch{}}return null}var $=Array.isArray,O=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},re=[],ae=-1;function I(e){return{current:e}}function U(e){0>ae||(e.current=re[ae],re[ae]=null,ae--)}function Q(e,t){ae++,re[ae]=e.current,e.current=t}var ie=I(null),fe=I(null),ce=I(null),ge=I(null);function Pe(e,t){switch(Q(ce,t),Q(fe,e),Q(ie,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?kg(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=kg(t),e=wg(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(ie),Q(ie,e)}function Ne(){U(ie),U(fe),U(ce)}function dt(e){e.memoizedState!==null&&Q(ge,e);var t=ie.current,o=wg(t,e.type);t!==o&&(Q(fe,e),Q(ie,o))}function Bt(e){fe.current===e&&(U(ie),U(fe)),ge.current===e&&(U(ge),Qr._currentValue=Z)}var ue,ye;function we(e){if(ue===void 0)try{throw Error()}catch(o){var t=o.stack.trim().match(/\n( *(at )?)/);ue=t&&t[1]||"",ye=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ue+e+ye}var oe=!1;function le(e,t){if(!e||oe)return"";oe=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var te=function(){throw Error()};if(Object.defineProperty(te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(te,[])}catch(Y){var V=Y}Reflect.construct(e,[],te)}else{try{te.call()}catch(Y){V=Y}e.call(te.prototype)}}else{try{throw Error()}catch(Y){V=Y}(te=e())&&typeof te.catch=="function"&&te.catch(function(){})}}catch(Y){if(Y&&V&&typeof Y.stack=="string")return[Y.stack,V.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var u=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");u&&u.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=l.DetermineComponentFrameRoot(),b=f[0],R=f[1];if(b&&R){var N=b.split(`
`),G=R.split(`
`);for(u=l=0;l<N.length&&!N[l].includes("DetermineComponentFrameRoot");)l++;for(;u<G.length&&!G[u].includes("DetermineComponentFrameRoot");)u++;if(l===N.length||u===G.length)for(l=N.length-1,u=G.length-1;1<=l&&0<=u&&N[l]!==G[u];)u--;for(;1<=l&&0<=u;l--,u--)if(N[l]!==G[u]){if(l!==1||u!==1)do if(l--,u--,0>u||N[l]!==G[u]){var J=`
`+N[l].replace(" at new "," at ");return e.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",e.displayName)),J}while(1<=l&&0<=u);break}}}finally{oe=!1,Error.prepareStackTrace=o}return(o=e?e.displayName||e.name:"")?we(o):""}function Oe(e,t){switch(e.tag){case 26:case 27:case 5:return we(e.type);case 16:return we("Lazy");case 13:return e.child!==t&&t!==null?we("Suspense Fallback"):we("Suspense");case 19:return we("SuspenseList");case 0:case 15:return le(e.type,!1);case 11:return le(e.type.render,!1);case 1:return le(e.type,!0);case 31:return we("Activity");default:return""}}function it(e){try{var t="",o=null;do t+=Oe(e,o),o=e,e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var Rt=Object.prototype.hasOwnProperty,cn=n.unstable_scheduleCallback,Di=n.unstable_cancelCallback,ay=n.unstable_shouldYield,ly=n.unstable_requestPaint,Nt=n.unstable_now,cy=n.unstable_getCurrentPriorityLevel,Xu=n.unstable_ImmediatePriority,eh=n.unstable_UserBlockingPriority,Ao=n.unstable_NormalPriority,dy=n.unstable_LowPriority,th=n.unstable_IdlePriority,uy=n.log,hy=n.unstable_setDisableYieldValue,cr=null,Mt=null;function ei(e){if(typeof uy=="function"&&hy(e),Mt&&typeof Mt.setStrictMode=="function")try{Mt.setStrictMode(cr,e)}catch{}}var qt=Math.clz32?Math.clz32:gy,fy=Math.log,py=Math.LN2;function gy(e){return e>>>=0,e===0?32:31-(fy(e)/py|0)|0}var zo=256,Do=262144,Oo=4194304;function Oi(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Io(e,t,o){var l=e.pendingLanes;if(l===0)return 0;var u=0,f=e.suspendedLanes,b=e.pingedLanes;e=e.warmLanes;var R=l&134217727;return R!==0?(l=R&~f,l!==0?u=Oi(l):(b&=R,b!==0?u=Oi(b):o||(o=R&~e,o!==0&&(u=Oi(o))))):(R=l&~f,R!==0?u=Oi(R):b!==0?u=Oi(b):o||(o=l&~e,o!==0&&(u=Oi(o)))),u===0?0:t!==0&&t!==u&&(t&f)===0&&(f=u&-u,o=t&-t,f>=o||f===32&&(o&4194048)!==0)?t:u}function dr(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function my(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nh(){var e=Oo;return Oo<<=1,(Oo&62914560)===0&&(Oo=4194304),e}function yl(e){for(var t=[],o=0;31>o;o++)t.push(e);return t}function ur(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function xy(e,t,o,l,u,f){var b=e.pendingLanes;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=o,e.entangledLanes&=o,e.errorRecoveryDisabledLanes&=o,e.shellSuspendCounter=0;var R=e.entanglements,N=e.expirationTimes,G=e.hiddenUpdates;for(o=b&~o;0<o;){var J=31-qt(o),te=1<<J;R[J]=0,N[J]=-1;var V=G[J];if(V!==null)for(G[J]=null,J=0;J<V.length;J++){var Y=V[J];Y!==null&&(Y.lane&=-536870913)}o&=~te}l!==0&&ih(e,l,0),f!==0&&u===0&&e.tag!==0&&(e.suspendedLanes|=f&~(b&~t))}function ih(e,t,o){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-qt(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|o&261930}function sh(e,t){var o=e.entangledLanes|=t;for(e=e.entanglements;o;){var l=31-qt(o),u=1<<l;u&t|e[l]&t&&(e[l]|=t),o&=~u}}function rh(e,t){var o=t&-t;return o=(o&42)!==0?1:bl(o),(o&(e.suspendedLanes|t))!==0?0:o}function bl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function vl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function oh(){var e=q.p;return e!==0?e:(e=window.event,e===void 0?32:Vg(e.type))}function ah(e,t){var o=q.p;try{return q.p=e,t()}finally{q.p=o}}var ti=Math.random().toString(36).slice(2),gt="__reactFiber$"+ti,Et="__reactProps$"+ti,us="__reactContainer$"+ti,Sl="__reactEvents$"+ti,yy="__reactListeners$"+ti,by="__reactHandles$"+ti,lh="__reactResources$"+ti,hr="__reactMarker$"+ti;function kl(e){delete e[gt],delete e[Et],delete e[Sl],delete e[yy],delete e[by]}function hs(e){var t=e[gt];if(t)return t;for(var o=e.parentNode;o;){if(t=o[us]||o[gt]){if(o=t.alternate,t.child!==null||o!==null&&o.child!==null)for(e=Ag(e);e!==null;){if(o=e[gt])return o;e=Ag(e)}return t}e=o,o=e.parentNode}return null}function fs(e){if(e=e[gt]||e[us]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function fr(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(a(33))}function ps(e){var t=e[lh];return t||(t=e[lh]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function ft(e){e[hr]=!0}var ch=new Set,dh={};function Ii(e,t){gs(e,t),gs(e+"Capture",t)}function gs(e,t){for(dh[e]=t,e=0;e<t.length;e++)ch.add(t[e])}var vy=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),uh={},hh={};function Sy(e){return Rt.call(hh,e)?!0:Rt.call(uh,e)?!1:vy.test(e)?hh[e]=!0:(uh[e]=!0,!1)}function Bo(e,t,o){if(Sy(t))if(o===null)e.removeAttribute(t);else{switch(typeof o){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+o)}}function No(e,t,o){if(o===null)e.removeAttribute(t);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+o)}}function Tn(e,t,o,l){if(l===null)e.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(o);return}e.setAttributeNS(t,o,""+l)}}function Kt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ky(e,t,o){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var u=l.get,f=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return u.call(this)},set:function(b){o=""+b,f.call(this,b)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wl(e){if(!e._valueTracker){var t=fh(e)?"checked":"value";e._valueTracker=ky(e,t,""+e[t])}}function ph(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var o=t.getValue(),l="";return e&&(l=fh(e)?e.checked?"true":"false":e.value),e=l,e!==o?(t.setValue(e),!0):!1}function Mo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var wy=/[\n"\\]/g;function Qt(e){return e.replace(wy,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function _l(e,t,o,l,u,f,b,R){e.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?e.type=b:e.removeAttribute("type"),t!=null?b==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Kt(t)):e.value!==""+Kt(t)&&(e.value=""+Kt(t)):b!=="submit"&&b!=="reset"||e.removeAttribute("value"),t!=null?jl(e,b,Kt(t)):o!=null?jl(e,b,Kt(o)):l!=null&&e.removeAttribute("value"),u==null&&f!=null&&(e.defaultChecked=!!f),u!=null&&(e.checked=u&&typeof u!="function"&&typeof u!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?e.name=""+Kt(R):e.removeAttribute("name")}function gh(e,t,o,l,u,f,b,R){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){wl(e);return}o=o!=null?""+Kt(o):"",t=t!=null?""+Kt(t):o,R||t===e.value||(e.value=t),e.defaultValue=t}l=l??u,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=R?e.checked:!!l,e.defaultChecked=!!l,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(e.name=b),wl(e)}function jl(e,t,o){t==="number"&&Mo(e.ownerDocument)===e||e.defaultValue===""+o||(e.defaultValue=""+o)}function ms(e,t,o,l){if(e=e.options,t){t={};for(var u=0;u<o.length;u++)t["$"+o[u]]=!0;for(o=0;o<e.length;o++)u=t.hasOwnProperty("$"+e[o].value),e[o].selected!==u&&(e[o].selected=u),u&&l&&(e[o].defaultSelected=!0)}else{for(o=""+Kt(o),t=null,u=0;u<e.length;u++){if(e[u].value===o){e[u].selected=!0,l&&(e[u].defaultSelected=!0);return}t!==null||e[u].disabled||(t=e[u])}t!==null&&(t.selected=!0)}}function mh(e,t,o){if(t!=null&&(t=""+Kt(t),t!==e.value&&(e.value=t),o==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=o!=null?""+Kt(o):""}function xh(e,t,o,l){if(t==null){if(l!=null){if(o!=null)throw Error(a(92));if($(l)){if(1<l.length)throw Error(a(93));l=l[0]}o=l}o==null&&(o=""),t=o}o=Kt(t),e.defaultValue=o,l=e.textContent,l===o&&l!==""&&l!==null&&(e.value=l),wl(e)}function xs(e,t){if(t){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=t;return}}e.textContent=t}var _y=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function yh(e,t,o){var l=t.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,o):typeof o!="number"||o===0||_y.has(t)?t==="float"?e.cssFloat=o:e[t]=(""+o).trim():e[t]=o+"px"}function bh(e,t,o){if(t!=null&&typeof t!="object")throw Error(a(62));if(e=e.style,o!=null){for(var l in o)!o.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var u in t)l=t[u],t.hasOwnProperty(u)&&o[u]!==l&&yh(e,u,l)}else for(var f in t)t.hasOwnProperty(f)&&yh(e,f,t[f])}function Cl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Cy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function qo(e){return Cy.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function An(){}var Rl=null;function El(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ys=null,bs=null;function vh(e){var t=fs(e);if(t&&(e=t.stateNode)){var o=e[Et]||null;e:switch(e=t.stateNode,t.type){case"input":if(_l(e,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),t=o.name,o.type==="radio"&&t!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Qt(""+t)+'"][type="radio"]'),t=0;t<o.length;t++){var l=o[t];if(l!==e&&l.form===e.form){var u=l[Et]||null;if(!u)throw Error(a(90));_l(l,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name)}}for(t=0;t<o.length;t++)l=o[t],l.form===e.form&&ph(l)}break e;case"textarea":mh(e,o.value,o.defaultValue);break e;case"select":t=o.value,t!=null&&ms(e,!!o.multiple,t,!1)}}}var Tl=!1;function Sh(e,t,o){if(Tl)return e(t,o);Tl=!0;try{var l=e(t);return l}finally{if(Tl=!1,(ys!==null||bs!==null)&&(ja(),ys&&(t=ys,e=bs,bs=ys=null,vh(t),e)))for(t=0;t<e.length;t++)vh(e[t])}}function pr(e,t){var o=e.stateNode;if(o===null)return null;var l=o[Et]||null;if(l===null)return null;o=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(a(231,t,typeof o));return o}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Al=!1;if(zn)try{var gr={};Object.defineProperty(gr,"passive",{get:function(){Al=!0}}),window.addEventListener("test",gr,gr),window.removeEventListener("test",gr,gr)}catch{Al=!1}var ni=null,zl=null,Wo=null;function kh(){if(Wo)return Wo;var e,t=zl,o=t.length,l,u="value"in ni?ni.value:ni.textContent,f=u.length;for(e=0;e<o&&t[e]===u[e];e++);var b=o-e;for(l=1;l<=b&&t[o-l]===u[f-l];l++);return Wo=u.slice(e,1<l?1-l:void 0)}function Uo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Lo(){return!0}function wh(){return!1}function Tt(e){function t(o,l,u,f,b){this._reactName=o,this._targetInst=u,this.type=l,this.nativeEvent=f,this.target=b,this.currentTarget=null;for(var R in e)e.hasOwnProperty(R)&&(o=e[R],this[R]=o?o(f):f[R]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Lo:wh,this.isPropagationStopped=wh,this}return k(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Lo)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Lo)},persist:function(){},isPersistent:Lo}),t}var Bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$o=Tt(Bi),mr=k({},Bi,{view:0,detail:0}),Ry=Tt(mr),Dl,Ol,xr,Ho=k({},mr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==xr&&(xr&&e.type==="mousemove"?(Dl=e.screenX-xr.screenX,Ol=e.screenY-xr.screenY):Ol=Dl=0,xr=e),Dl)},movementY:function(e){return"movementY"in e?e.movementY:Ol}}),_h=Tt(Ho),Ey=k({},Ho,{dataTransfer:0}),Ty=Tt(Ey),Ay=k({},mr,{relatedTarget:0}),Il=Tt(Ay),zy=k({},Bi,{animationName:0,elapsedTime:0,pseudoElement:0}),Dy=Tt(zy),Oy=k({},Bi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Iy=Tt(Oy),By=k({},Bi,{data:0}),jh=Tt(By),Ny={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},My={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=qy[e])?!!t[e]:!1}function Bl(){return Wy}var Uy=k({},mr,{key:function(e){if(e.key){var t=Ny[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Uo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?My[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bl,charCode:function(e){return e.type==="keypress"?Uo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Uo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ly=Tt(Uy),$y=k({},Ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ch=Tt($y),Hy=k({},mr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bl}),Py=Tt(Hy),Gy=k({},Bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vy=Tt(Gy),Zy=k({},Ho,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fy=Tt(Zy),Yy=k({},Bi,{newState:0,oldState:0}),Ky=Tt(Yy),Qy=[9,13,27,32],Nl=zn&&"CompositionEvent"in window,yr=null;zn&&"documentMode"in document&&(yr=document.documentMode);var Jy=zn&&"TextEvent"in window&&!yr,Rh=zn&&(!Nl||yr&&8<yr&&11>=yr),Eh=" ",Th=!1;function Ah(e,t){switch(e){case"keyup":return Qy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vs=!1;function Xy(e,t){switch(e){case"compositionend":return zh(t);case"keypress":return t.which!==32?null:(Th=!0,Eh);case"textInput":return e=t.data,e===Eh&&Th?null:e;default:return null}}function e0(e,t){if(vs)return e==="compositionend"||!Nl&&Ah(e,t)?(e=kh(),Wo=zl=ni=null,vs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rh&&t.locale!=="ko"?null:t.data;default:return null}}var t0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!t0[e.type]:t==="textarea"}function Oh(e,t,o,l){ys?bs?bs.push(l):bs=[l]:ys=l,t=Da(t,"onChange"),0<t.length&&(o=new $o("onChange","change",null,o,l),e.push({event:o,listeners:t}))}var br=null,vr=null;function n0(e){mg(e,0)}function Po(e){var t=fr(e);if(ph(t))return e}function Ih(e,t){if(e==="change")return t}var Bh=!1;if(zn){var Ml;if(zn){var ql="oninput"in document;if(!ql){var Nh=document.createElement("div");Nh.setAttribute("oninput","return;"),ql=typeof Nh.oninput=="function"}Ml=ql}else Ml=!1;Bh=Ml&&(!document.documentMode||9<document.documentMode)}function Mh(){br&&(br.detachEvent("onpropertychange",qh),vr=br=null)}function qh(e){if(e.propertyName==="value"&&Po(vr)){var t=[];Oh(t,vr,e,El(e)),Sh(n0,t)}}function i0(e,t,o){e==="focusin"?(Mh(),br=t,vr=o,br.attachEvent("onpropertychange",qh)):e==="focusout"&&Mh()}function s0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Po(vr)}function r0(e,t){if(e==="click")return Po(t)}function o0(e,t){if(e==="input"||e==="change")return Po(t)}function a0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Wt=typeof Object.is=="function"?Object.is:a0;function Sr(e,t){if(Wt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var o=Object.keys(e),l=Object.keys(t);if(o.length!==l.length)return!1;for(l=0;l<o.length;l++){var u=o[l];if(!Rt.call(t,u)||!Wt(e[u],t[u]))return!1}return!0}function Wh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Uh(e,t){var o=Wh(e);e=0;for(var l;o;){if(o.nodeType===3){if(l=e+o.textContent.length,e<=t&&l>=t)return{node:o,offset:t-e};e=l}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Wh(o)}}function Lh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Lh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $h(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Mo(e.document);t instanceof e.HTMLIFrameElement;){try{var o=typeof t.contentWindow.location.href=="string"}catch{o=!1}if(o)e=t.contentWindow;else break;t=Mo(e.document)}return t}function Wl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var l0=zn&&"documentMode"in document&&11>=document.documentMode,Ss=null,Ul=null,kr=null,Ll=!1;function Hh(e,t,o){var l=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ll||Ss==null||Ss!==Mo(l)||(l=Ss,"selectionStart"in l&&Wl(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),kr&&Sr(kr,l)||(kr=l,l=Da(Ul,"onSelect"),0<l.length&&(t=new $o("onSelect","select",null,t,o),e.push({event:t,listeners:l}),t.target=Ss)))}function Ni(e,t){var o={};return o[e.toLowerCase()]=t.toLowerCase(),o["Webkit"+e]="webkit"+t,o["Moz"+e]="moz"+t,o}var ks={animationend:Ni("Animation","AnimationEnd"),animationiteration:Ni("Animation","AnimationIteration"),animationstart:Ni("Animation","AnimationStart"),transitionrun:Ni("Transition","TransitionRun"),transitionstart:Ni("Transition","TransitionStart"),transitioncancel:Ni("Transition","TransitionCancel"),transitionend:Ni("Transition","TransitionEnd")},$l={},Ph={};zn&&(Ph=document.createElement("div").style,"AnimationEvent"in window||(delete ks.animationend.animation,delete ks.animationiteration.animation,delete ks.animationstart.animation),"TransitionEvent"in window||delete ks.transitionend.transition);function Mi(e){if($l[e])return $l[e];if(!ks[e])return e;var t=ks[e],o;for(o in t)if(t.hasOwnProperty(o)&&o in Ph)return $l[e]=t[o];return e}var Gh=Mi("animationend"),Vh=Mi("animationiteration"),Zh=Mi("animationstart"),c0=Mi("transitionrun"),d0=Mi("transitionstart"),u0=Mi("transitioncancel"),Fh=Mi("transitionend"),Yh=new Map,Hl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Hl.push("scrollEnd");function dn(e,t){Yh.set(e,t),Ii(t,[e])}var Go=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Jt=[],ws=0,Pl=0;function Vo(){for(var e=ws,t=Pl=ws=0;t<e;){var o=Jt[t];Jt[t++]=null;var l=Jt[t];Jt[t++]=null;var u=Jt[t];Jt[t++]=null;var f=Jt[t];if(Jt[t++]=null,l!==null&&u!==null){var b=l.pending;b===null?u.next=u:(u.next=b.next,b.next=u),l.pending=u}f!==0&&Kh(o,u,f)}}function Zo(e,t,o,l){Jt[ws++]=e,Jt[ws++]=t,Jt[ws++]=o,Jt[ws++]=l,Pl|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function Gl(e,t,o,l){return Zo(e,t,o,l),Fo(e)}function qi(e,t){return Zo(e,null,null,t),Fo(e)}function Kh(e,t,o){e.lanes|=o;var l=e.alternate;l!==null&&(l.lanes|=o);for(var u=!1,f=e.return;f!==null;)f.childLanes|=o,l=f.alternate,l!==null&&(l.childLanes|=o),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(u=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,u&&t!==null&&(u=31-qt(o),e=f.hiddenUpdates,l=e[u],l===null?e[u]=[t]:l.push(t),t.lane=o|536870912),f):null}function Fo(e){if(50<Pr)throw Pr=0,ed=null,Error(a(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var _s={};function h0(e,t,o,l){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ut(e,t,o,l){return new h0(e,t,o,l)}function Vl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Dn(e,t){var o=e.alternate;return o===null?(o=Ut(e.tag,t,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=t,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&65011712,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,t=e.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o.refCleanup=e.refCleanup,o}function Qh(e,t){e.flags&=65011714;var o=e.alternate;return o===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=o.childLanes,e.lanes=o.lanes,e.child=o.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=o.memoizedProps,e.memoizedState=o.memoizedState,e.updateQueue=o.updateQueue,e.type=o.type,t=o.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Yo(e,t,o,l,u,f){var b=0;if(l=e,typeof e=="function")Vl(e)&&(b=1);else if(typeof e=="string")b=xb(e,o,ie.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case K:return e=Ut(31,o,t,u),e.elementType=K,e.lanes=f,e;case j:return Wi(o.children,u,f,t);case A:b=8,u|=24;break;case z:return e=Ut(12,o,t,u|2),e.elementType=z,e.lanes=f,e;case T:return e=Ut(13,o,t,u),e.elementType=T,e.lanes=f,e;case E:return e=Ut(19,o,t,u),e.elementType=E,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case y:b=10;break e;case D:b=9;break e;case C:b=11;break e;case W:b=14;break e;case M:b=16,l=null;break e}b=29,o=Error(a(130,e===null?"null":typeof e,"")),l=null}return t=Ut(b,o,t,u),t.elementType=e,t.type=l,t.lanes=f,t}function Wi(e,t,o,l){return e=Ut(7,e,l,t),e.lanes=o,e}function Zl(e,t,o){return e=Ut(6,e,null,t),e.lanes=o,e}function Jh(e){var t=Ut(18,null,null,0);return t.stateNode=e,t}function Fl(e,t,o){return t=Ut(4,e.children!==null?e.children:[],e.key,t),t.lanes=o,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Xh=new WeakMap;function Xt(e,t){if(typeof e=="object"&&e!==null){var o=Xh.get(e);return o!==void 0?o:(t={value:e,source:t,stack:it(t)},Xh.set(e,t),t)}return{value:e,source:t,stack:it(t)}}var js=[],Cs=0,Ko=null,wr=0,en=[],tn=0,ii=null,Sn=1,kn="";function On(e,t){js[Cs++]=wr,js[Cs++]=Ko,Ko=e,wr=t}function ef(e,t,o){en[tn++]=Sn,en[tn++]=kn,en[tn++]=ii,ii=e;var l=Sn;e=kn;var u=32-qt(l)-1;l&=~(1<<u),o+=1;var f=32-qt(t)+u;if(30<f){var b=u-u%5;f=(l&(1<<b)-1).toString(32),l>>=b,u-=b,Sn=1<<32-qt(t)+u|o<<u|l,kn=f+e}else Sn=1<<f|o<<u|l,kn=e}function Yl(e){e.return!==null&&(On(e,1),ef(e,1,0))}function Kl(e){for(;e===Ko;)Ko=js[--Cs],js[Cs]=null,wr=js[--Cs],js[Cs]=null;for(;e===ii;)ii=en[--tn],en[tn]=null,kn=en[--tn],en[tn]=null,Sn=en[--tn],en[tn]=null}function tf(e,t){en[tn++]=Sn,en[tn++]=kn,en[tn++]=ii,Sn=t.id,kn=t.overflow,ii=e}var mt=null,Ze=null,ze=!1,si=null,nn=!1,Ql=Error(a(519));function ri(e){var t=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw _r(Xt(t,e)),Ql}function nf(e){var t=e.stateNode,o=e.type,l=e.memoizedProps;switch(t[gt]=e,t[Et]=l,o){case"dialog":Ee("cancel",t),Ee("close",t);break;case"iframe":case"object":case"embed":Ee("load",t);break;case"video":case"audio":for(o=0;o<Vr.length;o++)Ee(Vr[o],t);break;case"source":Ee("error",t);break;case"img":case"image":case"link":Ee("error",t),Ee("load",t);break;case"details":Ee("toggle",t);break;case"input":Ee("invalid",t),gh(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Ee("invalid",t);break;case"textarea":Ee("invalid",t),xh(t,l.value,l.defaultValue,l.children)}o=l.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||t.textContent===""+o||l.suppressHydrationWarning===!0||vg(t.textContent,o)?(l.popover!=null&&(Ee("beforetoggle",t),Ee("toggle",t)),l.onScroll!=null&&Ee("scroll",t),l.onScrollEnd!=null&&Ee("scrollend",t),l.onClick!=null&&(t.onclick=An),t=!0):t=!1,t||ri(e,!0)}function sf(e){for(mt=e.return;mt;)switch(mt.tag){case 5:case 31:case 13:nn=!1;return;case 27:case 3:nn=!0;return;default:mt=mt.return}}function Rs(e){if(e!==mt)return!1;if(!ze)return sf(e),ze=!0,!1;var t=e.tag,o;if((o=t!==3&&t!==27)&&((o=t===5)&&(o=e.type,o=!(o!=="form"&&o!=="button")||gd(e.type,e.memoizedProps)),o=!o),o&&Ze&&ri(e),sf(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));Ze=Tg(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));Ze=Tg(e)}else t===27?(t=Ze,bi(e.type)?(e=vd,vd=null,Ze=e):Ze=t):Ze=mt?rn(e.stateNode.nextSibling):null;return!0}function Ui(){Ze=mt=null,ze=!1}function Jl(){var e=si;return e!==null&&(Ot===null?Ot=e:Ot.push.apply(Ot,e),si=null),e}function _r(e){si===null?si=[e]:si.push(e)}var Xl=I(null),Li=null,In=null;function oi(e,t,o){Q(Xl,t._currentValue),t._currentValue=o}function Bn(e){e._currentValue=Xl.current,U(Xl)}function ec(e,t,o){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===o)break;e=e.return}}function tc(e,t,o,l){var u=e.child;for(u!==null&&(u.return=e);u!==null;){var f=u.dependencies;if(f!==null){var b=u.child;f=f.firstContext;e:for(;f!==null;){var R=f;f=u;for(var N=0;N<t.length;N++)if(R.context===t[N]){f.lanes|=o,R=f.alternate,R!==null&&(R.lanes|=o),ec(f.return,o,e),l||(b=null);break e}f=R.next}}else if(u.tag===18){if(b=u.return,b===null)throw Error(a(341));b.lanes|=o,f=b.alternate,f!==null&&(f.lanes|=o),ec(b,o,e),b=null}else b=u.child;if(b!==null)b.return=u;else for(b=u;b!==null;){if(b===e){b=null;break}if(u=b.sibling,u!==null){u.return=b.return,b=u;break}b=b.return}u=b}}function Es(e,t,o,l){e=null;for(var u=t,f=!1;u!==null;){if(!f){if((u.flags&524288)!==0)f=!0;else if((u.flags&262144)!==0)break}if(u.tag===10){var b=u.alternate;if(b===null)throw Error(a(387));if(b=b.memoizedProps,b!==null){var R=u.type;Wt(u.pendingProps.value,b.value)||(e!==null?e.push(R):e=[R])}}else if(u===ge.current){if(b=u.alternate,b===null)throw Error(a(387));b.memoizedState.memoizedState!==u.memoizedState.memoizedState&&(e!==null?e.push(Qr):e=[Qr])}u=u.return}e!==null&&tc(t,e,o,l),t.flags|=262144}function Qo(e){for(e=e.firstContext;e!==null;){if(!Wt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function $i(e){Li=e,In=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function xt(e){return rf(Li,e)}function Jo(e,t){return Li===null&&$i(e),rf(e,t)}function rf(e,t){var o=t._currentValue;if(t={context:t,memoizedValue:o,next:null},In===null){if(e===null)throw Error(a(308));In=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else In=In.next=t;return o}var f0=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(o,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(o){return o()})}},p0=n.unstable_scheduleCallback,g0=n.unstable_NormalPriority,st={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nc(){return{controller:new f0,data:new Map,refCount:0}}function jr(e){e.refCount--,e.refCount===0&&p0(g0,function(){e.controller.abort()})}var Cr=null,ic=0,Ts=0,As=null;function m0(e,t){if(Cr===null){var o=Cr=[];ic=0,Ts=od(),As={status:"pending",value:void 0,then:function(l){o.push(l)}}}return ic++,t.then(of,of),t}function of(){if(--ic===0&&Cr!==null){As!==null&&(As.status="fulfilled");var e=Cr;Cr=null,Ts=0,As=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function x0(e,t){var o=[],l={status:"pending",value:null,reason:null,then:function(u){o.push(u)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var u=0;u<o.length;u++)(0,o[u])(t)},function(u){for(l.status="rejected",l.reason=u,u=0;u<o.length;u++)(0,o[u])(void 0)}),l}var af=O.S;O.S=function(e,t){Pp=Nt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&m0(e,t),af!==null&&af(e,t)};var Hi=I(null);function sc(){var e=Hi.current;return e!==null?e:Ge.pooledCache}function Xo(e,t){t===null?Q(Hi,Hi.current):Q(Hi,t.pool)}function lf(){var e=sc();return e===null?null:{parent:st._currentValue,pool:e}}var zs=Error(a(460)),rc=Error(a(474)),ea=Error(a(542)),ta={then:function(){}};function cf(e){return e=e.status,e==="fulfilled"||e==="rejected"}function df(e,t,o){switch(o=e[o],o===void 0?e.push(t):o!==t&&(t.then(An,An),t=o),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,hf(e),e;default:if(typeof t.status=="string")t.then(An,An);else{if(e=Ge,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var u=t;u.status="fulfilled",u.value=l}},function(l){if(t.status==="pending"){var u=t;u.status="rejected",u.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,hf(e),e}throw Gi=t,zs}}function Pi(e){try{var t=e._init;return t(e._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Gi=o,zs):o}}var Gi=null;function uf(){if(Gi===null)throw Error(a(459));var e=Gi;return Gi=null,e}function hf(e){if(e===zs||e===ea)throw Error(a(483))}var Ds=null,Rr=0;function na(e){var t=Rr;return Rr+=1,Ds===null&&(Ds=[]),df(Ds,e,t)}function Er(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function ia(e,t){throw t.$$typeof===S?Error(a(525)):(e=Object.prototype.toString.call(t),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function ff(e){function t(H,L){if(e){var P=H.deletions;P===null?(H.deletions=[L],H.flags|=16):P.push(L)}}function o(H,L){if(!e)return null;for(;L!==null;)t(H,L),L=L.sibling;return null}function l(H){for(var L=new Map;H!==null;)H.key!==null?L.set(H.key,H):L.set(H.index,H),H=H.sibling;return L}function u(H,L){return H=Dn(H,L),H.index=0,H.sibling=null,H}function f(H,L,P){return H.index=P,e?(P=H.alternate,P!==null?(P=P.index,P<L?(H.flags|=67108866,L):P):(H.flags|=67108866,L)):(H.flags|=1048576,L)}function b(H){return e&&H.alternate===null&&(H.flags|=67108866),H}function R(H,L,P,X){return L===null||L.tag!==6?(L=Zl(P,H.mode,X),L.return=H,L):(L=u(L,P),L.return=H,L)}function N(H,L,P,X){var me=P.type;return me===j?J(H,L,P.props.children,X,P.key):L!==null&&(L.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===M&&Pi(me)===L.type)?(L=u(L,P.props),Er(L,P),L.return=H,L):(L=Yo(P.type,P.key,P.props,null,H.mode,X),Er(L,P),L.return=H,L)}function G(H,L,P,X){return L===null||L.tag!==4||L.stateNode.containerInfo!==P.containerInfo||L.stateNode.implementation!==P.implementation?(L=Fl(P,H.mode,X),L.return=H,L):(L=u(L,P.children||[]),L.return=H,L)}function J(H,L,P,X,me){return L===null||L.tag!==7?(L=Wi(P,H.mode,X,me),L.return=H,L):(L=u(L,P),L.return=H,L)}function te(H,L,P){if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return L=Zl(""+L,H.mode,P),L.return=H,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case _:return P=Yo(L.type,L.key,L.props,null,H.mode,P),Er(P,L),P.return=H,P;case w:return L=Fl(L,H.mode,P),L.return=H,L;case M:return L=Pi(L),te(H,L,P)}if($(L)||ne(L))return L=Wi(L,H.mode,P,null),L.return=H,L;if(typeof L.then=="function")return te(H,na(L),P);if(L.$$typeof===y)return te(H,Jo(H,L),P);ia(H,L)}return null}function V(H,L,P,X){var me=L!==null?L.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return me!==null?null:R(H,L,""+P,X);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case _:return P.key===me?N(H,L,P,X):null;case w:return P.key===me?G(H,L,P,X):null;case M:return P=Pi(P),V(H,L,P,X)}if($(P)||ne(P))return me!==null?null:J(H,L,P,X,null);if(typeof P.then=="function")return V(H,L,na(P),X);if(P.$$typeof===y)return V(H,L,Jo(H,P),X);ia(H,P)}return null}function Y(H,L,P,X,me){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return H=H.get(P)||null,R(L,H,""+X,me);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case _:return H=H.get(X.key===null?P:X.key)||null,N(L,H,X,me);case w:return H=H.get(X.key===null?P:X.key)||null,G(L,H,X,me);case M:return X=Pi(X),Y(H,L,P,X,me)}if($(X)||ne(X))return H=H.get(P)||null,J(L,H,X,me,null);if(typeof X.then=="function")return Y(H,L,P,na(X),me);if(X.$$typeof===y)return Y(H,L,P,Jo(L,X),me);ia(L,X)}return null}function de(H,L,P,X){for(var me=null,Ie=null,he=L,Ce=L=0,Ae=null;he!==null&&Ce<P.length;Ce++){he.index>Ce?(Ae=he,he=null):Ae=he.sibling;var Be=V(H,he,P[Ce],X);if(Be===null){he===null&&(he=Ae);break}e&&he&&Be.alternate===null&&t(H,he),L=f(Be,L,Ce),Ie===null?me=Be:Ie.sibling=Be,Ie=Be,he=Ae}if(Ce===P.length)return o(H,he),ze&&On(H,Ce),me;if(he===null){for(;Ce<P.length;Ce++)he=te(H,P[Ce],X),he!==null&&(L=f(he,L,Ce),Ie===null?me=he:Ie.sibling=he,Ie=he);return ze&&On(H,Ce),me}for(he=l(he);Ce<P.length;Ce++)Ae=Y(he,H,Ce,P[Ce],X),Ae!==null&&(e&&Ae.alternate!==null&&he.delete(Ae.key===null?Ce:Ae.key),L=f(Ae,L,Ce),Ie===null?me=Ae:Ie.sibling=Ae,Ie=Ae);return e&&he.forEach(function(_i){return t(H,_i)}),ze&&On(H,Ce),me}function ve(H,L,P,X){if(P==null)throw Error(a(151));for(var me=null,Ie=null,he=L,Ce=L=0,Ae=null,Be=P.next();he!==null&&!Be.done;Ce++,Be=P.next()){he.index>Ce?(Ae=he,he=null):Ae=he.sibling;var _i=V(H,he,Be.value,X);if(_i===null){he===null&&(he=Ae);break}e&&he&&_i.alternate===null&&t(H,he),L=f(_i,L,Ce),Ie===null?me=_i:Ie.sibling=_i,Ie=_i,he=Ae}if(Be.done)return o(H,he),ze&&On(H,Ce),me;if(he===null){for(;!Be.done;Ce++,Be=P.next())Be=te(H,Be.value,X),Be!==null&&(L=f(Be,L,Ce),Ie===null?me=Be:Ie.sibling=Be,Ie=Be);return ze&&On(H,Ce),me}for(he=l(he);!Be.done;Ce++,Be=P.next())Be=Y(he,H,Ce,Be.value,X),Be!==null&&(e&&Be.alternate!==null&&he.delete(Be.key===null?Ce:Be.key),L=f(Be,L,Ce),Ie===null?me=Be:Ie.sibling=Be,Ie=Be);return e&&he.forEach(function(Eb){return t(H,Eb)}),ze&&On(H,Ce),me}function He(H,L,P,X){if(typeof P=="object"&&P!==null&&P.type===j&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case _:e:{for(var me=P.key;L!==null;){if(L.key===me){if(me=P.type,me===j){if(L.tag===7){o(H,L.sibling),X=u(L,P.props.children),X.return=H,H=X;break e}}else if(L.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===M&&Pi(me)===L.type){o(H,L.sibling),X=u(L,P.props),Er(X,P),X.return=H,H=X;break e}o(H,L);break}else t(H,L);L=L.sibling}P.type===j?(X=Wi(P.props.children,H.mode,X,P.key),X.return=H,H=X):(X=Yo(P.type,P.key,P.props,null,H.mode,X),Er(X,P),X.return=H,H=X)}return b(H);case w:e:{for(me=P.key;L!==null;){if(L.key===me)if(L.tag===4&&L.stateNode.containerInfo===P.containerInfo&&L.stateNode.implementation===P.implementation){o(H,L.sibling),X=u(L,P.children||[]),X.return=H,H=X;break e}else{o(H,L);break}else t(H,L);L=L.sibling}X=Fl(P,H.mode,X),X.return=H,H=X}return b(H);case M:return P=Pi(P),He(H,L,P,X)}if($(P))return de(H,L,P,X);if(ne(P)){if(me=ne(P),typeof me!="function")throw Error(a(150));return P=me.call(P),ve(H,L,P,X)}if(typeof P.then=="function")return He(H,L,na(P),X);if(P.$$typeof===y)return He(H,L,Jo(H,P),X);ia(H,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,L!==null&&L.tag===6?(o(H,L.sibling),X=u(L,P),X.return=H,H=X):(o(H,L),X=Zl(P,H.mode,X),X.return=H,H=X),b(H)):o(H,L)}return function(H,L,P,X){try{Rr=0;var me=He(H,L,P,X);return Ds=null,me}catch(he){if(he===zs||he===ea)throw he;var Ie=Ut(29,he,null,H.mode);return Ie.lanes=X,Ie.return=H,Ie}}}var Vi=ff(!0),pf=ff(!1),ai=!1;function oc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ac(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function li(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ci(e,t,o){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Me&2)!==0){var u=l.pending;return u===null?t.next=t:(t.next=u.next,u.next=t),l.pending=t,t=Fo(e),Kh(e,null,o),t}return Zo(e,l,t,o),Fo(e)}function Tr(e,t,o){if(t=t.updateQueue,t!==null&&(t=t.shared,(o&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,o|=l,t.lanes=o,sh(e,o)}}function lc(e,t){var o=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,o===l)){var u=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var b={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?u=f=b:f=f.next=b,o=o.next}while(o!==null);f===null?u=f=t:f=f.next=t}else u=f=t;o={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:f,shared:l.shared,callbacks:l.callbacks},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=t:e.next=t,o.lastBaseUpdate=t}var cc=!1;function Ar(){if(cc){var e=As;if(e!==null)throw e}}function zr(e,t,o,l){cc=!1;var u=e.updateQueue;ai=!1;var f=u.firstBaseUpdate,b=u.lastBaseUpdate,R=u.shared.pending;if(R!==null){u.shared.pending=null;var N=R,G=N.next;N.next=null,b===null?f=G:b.next=G,b=N;var J=e.alternate;J!==null&&(J=J.updateQueue,R=J.lastBaseUpdate,R!==b&&(R===null?J.firstBaseUpdate=G:R.next=G,J.lastBaseUpdate=N))}if(f!==null){var te=u.baseState;b=0,J=G=N=null,R=f;do{var V=R.lane&-536870913,Y=V!==R.lane;if(Y?(Te&V)===V:(l&V)===V){V!==0&&V===Ts&&(cc=!0),J!==null&&(J=J.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var de=e,ve=R;V=t;var He=o;switch(ve.tag){case 1:if(de=ve.payload,typeof de=="function"){te=de.call(He,te,V);break e}te=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=ve.payload,V=typeof de=="function"?de.call(He,te,V):de,V==null)break e;te=k({},te,V);break e;case 2:ai=!0}}V=R.callback,V!==null&&(e.flags|=64,Y&&(e.flags|=8192),Y=u.callbacks,Y===null?u.callbacks=[V]:Y.push(V))}else Y={lane:V,tag:R.tag,payload:R.payload,callback:R.callback,next:null},J===null?(G=J=Y,N=te):J=J.next=Y,b|=V;if(R=R.next,R===null){if(R=u.shared.pending,R===null)break;Y=R,R=Y.next,Y.next=null,u.lastBaseUpdate=Y,u.shared.pending=null}}while(!0);J===null&&(N=te),u.baseState=N,u.firstBaseUpdate=G,u.lastBaseUpdate=J,f===null&&(u.shared.lanes=0),pi|=b,e.lanes=b,e.memoizedState=te}}function gf(e,t){if(typeof e!="function")throw Error(a(191,e));e.call(t)}function mf(e,t){var o=e.callbacks;if(o!==null)for(e.callbacks=null,e=0;e<o.length;e++)gf(o[e],t)}var Os=I(null),sa=I(0);function xf(e,t){e=Pn,Q(sa,e),Q(Os,t),Pn=e|t.baseLanes}function dc(){Q(sa,Pn),Q(Os,Os.current)}function uc(){Pn=sa.current,U(Os),U(sa)}var Lt=I(null),sn=null;function di(e){var t=e.alternate;Q(tt,tt.current&1),Q(Lt,e),sn===null&&(t===null||Os.current!==null||t.memoizedState!==null)&&(sn=e)}function hc(e){Q(tt,tt.current),Q(Lt,e),sn===null&&(sn=e)}function yf(e){e.tag===22?(Q(tt,tt.current),Q(Lt,e),sn===null&&(sn=e)):ui()}function ui(){Q(tt,tt.current),Q(Lt,Lt.current)}function $t(e){U(Lt),sn===e&&(sn=null),U(tt)}var tt=I(0);function ra(e){for(var t=e;t!==null;){if(t.tag===13){var o=t.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||yd(o)||bd(o)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Nn=0,je=null,Le=null,rt=null,oa=!1,Is=!1,Zi=!1,aa=0,Dr=0,Bs=null,y0=0;function Je(){throw Error(a(321))}function fc(e,t){if(t===null)return!1;for(var o=0;o<t.length&&o<e.length;o++)if(!Wt(e[o],t[o]))return!1;return!0}function pc(e,t,o,l,u,f){return Nn=f,je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=e===null||e.memoizedState===null?tp:Tc,Zi=!1,f=o(l,u),Zi=!1,Is&&(f=vf(t,o,l,u)),bf(e),f}function bf(e){O.H=Br;var t=Le!==null&&Le.next!==null;if(Nn=0,rt=Le=je=null,oa=!1,Dr=0,Bs=null,t)throw Error(a(300));e===null||ot||(e=e.dependencies,e!==null&&Qo(e)&&(ot=!0))}function vf(e,t,o,l){je=e;var u=0;do{if(Is&&(Bs=null),Dr=0,Is=!1,25<=u)throw Error(a(301));if(u+=1,rt=Le=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}O.H=np,f=t(o,l)}while(Is);return f}function b0(){var e=O.H,t=e.useState()[0];return t=typeof t.then=="function"?Or(t):t,e=e.useState()[0],(Le!==null?Le.memoizedState:null)!==e&&(je.flags|=1024),t}function gc(){var e=aa!==0;return aa=0,e}function mc(e,t,o){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o}function xc(e){if(oa){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}oa=!1}Nn=0,rt=Le=je=null,Is=!1,Dr=aa=0,Bs=null}function wt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?je.memoizedState=rt=e:rt=rt.next=e,rt}function nt(){if(Le===null){var e=je.alternate;e=e!==null?e.memoizedState:null}else e=Le.next;var t=rt===null?je.memoizedState:rt.next;if(t!==null)rt=t,Le=e;else{if(e===null)throw je.alternate===null?Error(a(467)):Error(a(310));Le=e,e={memoizedState:Le.memoizedState,baseState:Le.baseState,baseQueue:Le.baseQueue,queue:Le.queue,next:null},rt===null?je.memoizedState=rt=e:rt=rt.next=e}return rt}function la(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Or(e){var t=Dr;return Dr+=1,Bs===null&&(Bs=[]),e=df(Bs,e,t),t=je,(rt===null?t.memoizedState:rt.next)===null&&(t=t.alternate,O.H=t===null||t.memoizedState===null?tp:Tc),e}function ca(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Or(e);if(e.$$typeof===y)return xt(e)}throw Error(a(438,String(e)))}function yc(e){var t=null,o=je.updateQueue;if(o!==null&&(t=o.memoCache),t==null){var l=je.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(u){return u.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),o===null&&(o=la(),je.updateQueue=o),o.memoCache=t,o=t.data[t.index],o===void 0)for(o=t.data[t.index]=Array(e),l=0;l<e;l++)o[l]=ee;return t.index++,o}function Mn(e,t){return typeof t=="function"?t(e):t}function da(e){var t=nt();return bc(t,Le,e)}function bc(e,t,o){var l=e.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=o;var u=e.baseQueue,f=l.pending;if(f!==null){if(u!==null){var b=u.next;u.next=f.next,f.next=b}t.baseQueue=u=f,l.pending=null}if(f=e.baseState,u===null)e.memoizedState=f;else{t=u.next;var R=b=null,N=null,G=t,J=!1;do{var te=G.lane&-536870913;if(te!==G.lane?(Te&te)===te:(Nn&te)===te){var V=G.revertLane;if(V===0)N!==null&&(N=N.next={lane:0,revertLane:0,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null}),te===Ts&&(J=!0);else if((Nn&V)===V){G=G.next,V===Ts&&(J=!0);continue}else te={lane:0,revertLane:G.revertLane,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},N===null?(R=N=te,b=f):N=N.next=te,je.lanes|=V,pi|=V;te=G.action,Zi&&o(f,te),f=G.hasEagerState?G.eagerState:o(f,te)}else V={lane:te,revertLane:G.revertLane,gesture:G.gesture,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},N===null?(R=N=V,b=f):N=N.next=V,je.lanes|=te,pi|=te;G=G.next}while(G!==null&&G!==t);if(N===null?b=f:N.next=R,!Wt(f,e.memoizedState)&&(ot=!0,J&&(o=As,o!==null)))throw o;e.memoizedState=f,e.baseState=b,e.baseQueue=N,l.lastRenderedState=f}return u===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function vc(e){var t=nt(),o=t.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=e;var l=o.dispatch,u=o.pending,f=t.memoizedState;if(u!==null){o.pending=null;var b=u=u.next;do f=e(f,b.action),b=b.next;while(b!==u);Wt(f,t.memoizedState)||(ot=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),o.lastRenderedState=f}return[f,l]}function Sf(e,t,o){var l=je,u=nt(),f=ze;if(f){if(o===void 0)throw Error(a(407));o=o()}else o=t();var b=!Wt((Le||u).memoizedState,o);if(b&&(u.memoizedState=o,ot=!0),u=u.queue,wc(_f.bind(null,l,u,e),[e]),u.getSnapshot!==t||b||rt!==null&&rt.memoizedState.tag&1){if(l.flags|=2048,Ns(9,{destroy:void 0},wf.bind(null,l,u,o,t),null),Ge===null)throw Error(a(349));f||(Nn&127)!==0||kf(l,t,o)}return o}function kf(e,t,o){e.flags|=16384,e={getSnapshot:t,value:o},t=je.updateQueue,t===null?(t=la(),je.updateQueue=t,t.stores=[e]):(o=t.stores,o===null?t.stores=[e]:o.push(e))}function wf(e,t,o,l){t.value=o,t.getSnapshot=l,jf(t)&&Cf(e)}function _f(e,t,o){return o(function(){jf(t)&&Cf(e)})}function jf(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!Wt(e,o)}catch{return!0}}function Cf(e){var t=qi(e,2);t!==null&&It(t,e,2)}function Sc(e){var t=wt();if(typeof e=="function"){var o=e;if(e=o(),Zi){ei(!0);try{o()}finally{ei(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mn,lastRenderedState:e},t}function Rf(e,t,o,l){return e.baseState=o,bc(e,Le,typeof l=="function"?l:Mn)}function v0(e,t,o,l,u){if(fa(e))throw Error(a(485));if(e=t.action,e!==null){var f={payload:u,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){f.listeners.push(b)}};O.T!==null?o(!0):f.isTransition=!1,l(f),o=t.pending,o===null?(f.next=t.pending=f,Ef(t,f)):(f.next=o.next,t.pending=o.next=f)}}function Ef(e,t){var o=t.action,l=t.payload,u=e.state;if(t.isTransition){var f=O.T,b={};O.T=b;try{var R=o(u,l),N=O.S;N!==null&&N(b,R),Tf(e,t,R)}catch(G){kc(e,t,G)}finally{f!==null&&b.types!==null&&(f.types=b.types),O.T=f}}else try{f=o(u,l),Tf(e,t,f)}catch(G){kc(e,t,G)}}function Tf(e,t,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(l){Af(e,t,l)},function(l){return kc(e,t,l)}):Af(e,t,o)}function Af(e,t,o){t.status="fulfilled",t.value=o,zf(t),e.state=o,t=e.pending,t!==null&&(o=t.next,o===t?e.pending=null:(o=o.next,t.next=o,Ef(e,o)))}function kc(e,t,o){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=o,zf(t),t=t.next;while(t!==l)}e.action=null}function zf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Df(e,t){return t}function Of(e,t){if(ze){var o=Ge.formState;if(o!==null){e:{var l=je;if(ze){if(Ze){t:{for(var u=Ze,f=nn;u.nodeType!==8;){if(!f){u=null;break t}if(u=rn(u.nextSibling),u===null){u=null;break t}}f=u.data,u=f==="F!"||f==="F"?u:null}if(u){Ze=rn(u.nextSibling),l=u.data==="F!";break e}}ri(l)}l=!1}l&&(t=o[0])}}return o=wt(),o.memoizedState=o.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Df,lastRenderedState:t},o.queue=l,o=Jf.bind(null,je,l),l.dispatch=o,l=Sc(!1),f=Ec.bind(null,je,!1,l.queue),l=wt(),u={state:t,dispatch:null,action:e,pending:null},l.queue=u,o=v0.bind(null,je,u,f,o),u.dispatch=o,l.memoizedState=e,[t,o,!1]}function If(e){var t=nt();return Bf(t,Le,e)}function Bf(e,t,o){if(t=bc(e,t,Df)[0],e=da(Mn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=Or(t)}catch(b){throw b===zs?ea:b}else l=t;t=nt();var u=t.queue,f=u.dispatch;return o!==t.memoizedState&&(je.flags|=2048,Ns(9,{destroy:void 0},S0.bind(null,u,o),null)),[l,f,e]}function S0(e,t){e.action=t}function Nf(e){var t=nt(),o=Le;if(o!==null)return Bf(t,o,e);nt(),t=t.memoizedState,o=nt();var l=o.queue.dispatch;return o.memoizedState=e,[t,l,!1]}function Ns(e,t,o,l){return e={tag:e,create:o,deps:l,inst:t,next:null},t=je.updateQueue,t===null&&(t=la(),je.updateQueue=t),o=t.lastEffect,o===null?t.lastEffect=e.next=e:(l=o.next,o.next=e,e.next=l,t.lastEffect=e),e}function Mf(){return nt().memoizedState}function ua(e,t,o,l){var u=wt();je.flags|=e,u.memoizedState=Ns(1|t,{destroy:void 0},o,l===void 0?null:l)}function ha(e,t,o,l){var u=nt();l=l===void 0?null:l;var f=u.memoizedState.inst;Le!==null&&l!==null&&fc(l,Le.memoizedState.deps)?u.memoizedState=Ns(t,f,o,l):(je.flags|=e,u.memoizedState=Ns(1|t,f,o,l))}function qf(e,t){ua(8390656,8,e,t)}function wc(e,t){ha(2048,8,e,t)}function k0(e){je.flags|=4;var t=je.updateQueue;if(t===null)t=la(),je.updateQueue=t,t.events=[e];else{var o=t.events;o===null?t.events=[e]:o.push(e)}}function Wf(e){var t=nt().memoizedState;return k0({ref:t,nextImpl:e}),function(){if((Me&2)!==0)throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Uf(e,t){return ha(4,2,e,t)}function Lf(e,t){return ha(4,4,e,t)}function $f(e,t){if(typeof t=="function"){e=e();var o=t(e);return function(){typeof o=="function"?o():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Hf(e,t,o){o=o!=null?o.concat([e]):null,ha(4,4,$f.bind(null,t,e),o)}function _c(){}function Pf(e,t){var o=nt();t=t===void 0?null:t;var l=o.memoizedState;return t!==null&&fc(t,l[1])?l[0]:(o.memoizedState=[e,t],e)}function Gf(e,t){var o=nt();t=t===void 0?null:t;var l=o.memoizedState;if(t!==null&&fc(t,l[1]))return l[0];if(l=e(),Zi){ei(!0);try{e()}finally{ei(!1)}}return o.memoizedState=[l,t],l}function jc(e,t,o){return o===void 0||(Nn&1073741824)!==0&&(Te&261930)===0?e.memoizedState=t:(e.memoizedState=o,e=Vp(),je.lanes|=e,pi|=e,o)}function Vf(e,t,o,l){return Wt(o,t)?o:Os.current!==null?(e=jc(e,o,l),Wt(e,t)||(ot=!0),e):(Nn&42)===0||(Nn&1073741824)!==0&&(Te&261930)===0?(ot=!0,e.memoizedState=o):(e=Vp(),je.lanes|=e,pi|=e,t)}function Zf(e,t,o,l,u){var f=q.p;q.p=f!==0&&8>f?f:8;var b=O.T,R={};O.T=R,Ec(e,!1,t,o);try{var N=u(),G=O.S;if(G!==null&&G(R,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var J=x0(N,l);Ir(e,t,J,Gt(e))}else Ir(e,t,l,Gt(e))}catch(te){Ir(e,t,{then:function(){},status:"rejected",reason:te},Gt())}finally{q.p=f,b!==null&&R.types!==null&&(b.types=R.types),O.T=b}}function w0(){}function Cc(e,t,o,l){if(e.tag!==5)throw Error(a(476));var u=Ff(e).queue;Zf(e,u,t,Z,o===null?w0:function(){return Yf(e),o(l)})}function Ff(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mn,lastRenderedState:Z},next:null};var o={};return t.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mn,lastRenderedState:o},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Yf(e){var t=Ff(e);t.next===null&&(t=e.alternate.memoizedState),Ir(e,t.next.queue,{},Gt())}function Rc(){return xt(Qr)}function Kf(){return nt().memoizedState}function Qf(){return nt().memoizedState}function _0(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var o=Gt();e=li(o);var l=ci(t,e,o);l!==null&&(It(l,t,o),Tr(l,t,o)),t={cache:nc()},e.payload=t;return}t=t.return}}function j0(e,t,o){var l=Gt();o={lane:l,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},fa(e)?Xf(t,o):(o=Gl(e,t,o,l),o!==null&&(It(o,e,l),ep(o,t,l)))}function Jf(e,t,o){var l=Gt();Ir(e,t,o,l)}function Ir(e,t,o,l){var u={lane:l,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(fa(e))Xf(t,u);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var b=t.lastRenderedState,R=f(b,o);if(u.hasEagerState=!0,u.eagerState=R,Wt(R,b))return Zo(e,t,u,0),Ge===null&&Vo(),!1}catch{}if(o=Gl(e,t,u,l),o!==null)return It(o,e,l),ep(o,t,l),!0}return!1}function Ec(e,t,o,l){if(l={lane:2,revertLane:od(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},fa(e)){if(t)throw Error(a(479))}else t=Gl(e,o,l,2),t!==null&&It(t,e,2)}function fa(e){var t=e.alternate;return e===je||t!==null&&t===je}function Xf(e,t){Is=oa=!0;var o=e.pending;o===null?t.next=t:(t.next=o.next,o.next=t),e.pending=t}function ep(e,t,o){if((o&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,o|=l,t.lanes=o,sh(e,o)}}var Br={readContext:xt,use:ca,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};Br.useEffectEvent=Je;var tp={readContext:xt,use:ca,useCallback:function(e,t){return wt().memoizedState=[e,t===void 0?null:t],e},useContext:xt,useEffect:qf,useImperativeHandle:function(e,t,o){o=o!=null?o.concat([e]):null,ua(4194308,4,$f.bind(null,t,e),o)},useLayoutEffect:function(e,t){return ua(4194308,4,e,t)},useInsertionEffect:function(e,t){ua(4,2,e,t)},useMemo:function(e,t){var o=wt();t=t===void 0?null:t;var l=e();if(Zi){ei(!0);try{e()}finally{ei(!1)}}return o.memoizedState=[l,t],l},useReducer:function(e,t,o){var l=wt();if(o!==void 0){var u=o(t);if(Zi){ei(!0);try{o(t)}finally{ei(!1)}}}else u=t;return l.memoizedState=l.baseState=u,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:u},l.queue=e,e=e.dispatch=j0.bind(null,je,e),[l.memoizedState,e]},useRef:function(e){var t=wt();return e={current:e},t.memoizedState=e},useState:function(e){e=Sc(e);var t=e.queue,o=Jf.bind(null,je,t);return t.dispatch=o,[e.memoizedState,o]},useDebugValue:_c,useDeferredValue:function(e,t){var o=wt();return jc(o,e,t)},useTransition:function(){var e=Sc(!1);return e=Zf.bind(null,je,e.queue,!0,!1),wt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,o){var l=je,u=wt();if(ze){if(o===void 0)throw Error(a(407));o=o()}else{if(o=t(),Ge===null)throw Error(a(349));(Te&127)!==0||kf(l,t,o)}u.memoizedState=o;var f={value:o,getSnapshot:t};return u.queue=f,qf(_f.bind(null,l,f,e),[e]),l.flags|=2048,Ns(9,{destroy:void 0},wf.bind(null,l,f,o,t),null),o},useId:function(){var e=wt(),t=Ge.identifierPrefix;if(ze){var o=kn,l=Sn;o=(l&~(1<<32-qt(l)-1)).toString(32)+o,t="_"+t+"R_"+o,o=aa++,0<o&&(t+="H"+o.toString(32)),t+="_"}else o=y0++,t="_"+t+"r_"+o.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Rc,useFormState:Of,useActionState:Of,useOptimistic:function(e){var t=wt();t.memoizedState=t.baseState=e;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=o,t=Ec.bind(null,je,!0,o),o.dispatch=t,[e,t]},useMemoCache:yc,useCacheRefresh:function(){return wt().memoizedState=_0.bind(null,je)},useEffectEvent:function(e){var t=wt(),o={impl:e};return t.memoizedState=o,function(){if((Me&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}},Tc={readContext:xt,use:ca,useCallback:Pf,useContext:xt,useEffect:wc,useImperativeHandle:Hf,useInsertionEffect:Uf,useLayoutEffect:Lf,useMemo:Gf,useReducer:da,useRef:Mf,useState:function(){return da(Mn)},useDebugValue:_c,useDeferredValue:function(e,t){var o=nt();return Vf(o,Le.memoizedState,e,t)},useTransition:function(){var e=da(Mn)[0],t=nt().memoizedState;return[typeof e=="boolean"?e:Or(e),t]},useSyncExternalStore:Sf,useId:Kf,useHostTransitionStatus:Rc,useFormState:If,useActionState:If,useOptimistic:function(e,t){var o=nt();return Rf(o,Le,e,t)},useMemoCache:yc,useCacheRefresh:Qf};Tc.useEffectEvent=Wf;var np={readContext:xt,use:ca,useCallback:Pf,useContext:xt,useEffect:wc,useImperativeHandle:Hf,useInsertionEffect:Uf,useLayoutEffect:Lf,useMemo:Gf,useReducer:vc,useRef:Mf,useState:function(){return vc(Mn)},useDebugValue:_c,useDeferredValue:function(e,t){var o=nt();return Le===null?jc(o,e,t):Vf(o,Le.memoizedState,e,t)},useTransition:function(){var e=vc(Mn)[0],t=nt().memoizedState;return[typeof e=="boolean"?e:Or(e),t]},useSyncExternalStore:Sf,useId:Kf,useHostTransitionStatus:Rc,useFormState:Nf,useActionState:Nf,useOptimistic:function(e,t){var o=nt();return Le!==null?Rf(o,Le,e,t):(o.baseState=e,[e,o.queue.dispatch])},useMemoCache:yc,useCacheRefresh:Qf};np.useEffectEvent=Wf;function Ac(e,t,o,l){t=e.memoizedState,o=o(l,t),o=o==null?t:k({},t,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var zc={enqueueSetState:function(e,t,o){e=e._reactInternals;var l=Gt(),u=li(l);u.payload=t,o!=null&&(u.callback=o),t=ci(e,u,l),t!==null&&(It(t,e,l),Tr(t,e,l))},enqueueReplaceState:function(e,t,o){e=e._reactInternals;var l=Gt(),u=li(l);u.tag=1,u.payload=t,o!=null&&(u.callback=o),t=ci(e,u,l),t!==null&&(It(t,e,l),Tr(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var o=Gt(),l=li(o);l.tag=2,t!=null&&(l.callback=t),t=ci(e,l,o),t!==null&&(It(t,e,o),Tr(t,e,o))}};function ip(e,t,o,l,u,f,b){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,f,b):t.prototype&&t.prototype.isPureReactComponent?!Sr(o,l)||!Sr(u,f):!0}function sp(e,t,o,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(o,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(o,l),t.state!==e&&zc.enqueueReplaceState(t,t.state,null)}function Fi(e,t){var o=t;if("ref"in t){o={};for(var l in t)l!=="ref"&&(o[l]=t[l])}if(e=e.defaultProps){o===t&&(o=k({},o));for(var u in e)o[u]===void 0&&(o[u]=e[u])}return o}function rp(e){Go(e)}function op(e){console.error(e)}function ap(e){Go(e)}function pa(e,t){try{var o=e.onUncaughtError;o(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function lp(e,t,o){try{var l=e.onCaughtError;l(o.value,{componentStack:o.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(u){setTimeout(function(){throw u})}}function Dc(e,t,o){return o=li(o),o.tag=3,o.payload={element:null},o.callback=function(){pa(e,t)},o}function cp(e){return e=li(e),e.tag=3,e}function dp(e,t,o,l){var u=o.type.getDerivedStateFromError;if(typeof u=="function"){var f=l.value;e.payload=function(){return u(f)},e.callback=function(){lp(t,o,l)}}var b=o.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(e.callback=function(){lp(t,o,l),typeof u!="function"&&(gi===null?gi=new Set([this]):gi.add(this));var R=l.stack;this.componentDidCatch(l.value,{componentStack:R!==null?R:""})})}function C0(e,t,o,l,u){if(o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=o.alternate,t!==null&&Es(t,o,u,!0),o=Lt.current,o!==null){switch(o.tag){case 31:case 13:return sn===null?Ca():o.alternate===null&&Xe===0&&(Xe=3),o.flags&=-257,o.flags|=65536,o.lanes=u,l===ta?o.flags|=16384:(t=o.updateQueue,t===null?o.updateQueue=new Set([l]):t.add(l),id(e,l,u)),!1;case 22:return o.flags|=65536,l===ta?o.flags|=16384:(t=o.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},o.updateQueue=t):(o=t.retryQueue,o===null?t.retryQueue=new Set([l]):o.add(l)),id(e,l,u)),!1}throw Error(a(435,o.tag))}return id(e,l,u),Ca(),!1}if(ze)return t=Lt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=u,l!==Ql&&(e=Error(a(422),{cause:l}),_r(Xt(e,o)))):(l!==Ql&&(t=Error(a(423),{cause:l}),_r(Xt(t,o))),e=e.current.alternate,e.flags|=65536,u&=-u,e.lanes|=u,l=Xt(l,o),u=Dc(e.stateNode,l,u),lc(e,u),Xe!==4&&(Xe=2)),!1;var f=Error(a(520),{cause:l});if(f=Xt(f,o),Hr===null?Hr=[f]:Hr.push(f),Xe!==4&&(Xe=2),t===null)return!0;l=Xt(l,o),o=t;do{switch(o.tag){case 3:return o.flags|=65536,e=u&-u,o.lanes|=e,e=Dc(o.stateNode,l,e),lc(o,e),!1;case 1:if(t=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(gi===null||!gi.has(f))))return o.flags|=65536,u&=-u,o.lanes|=u,u=cp(u),dp(u,e,o,l),lc(o,u),!1}o=o.return}while(o!==null);return!1}var Oc=Error(a(461)),ot=!1;function yt(e,t,o,l){t.child=e===null?pf(t,null,o,l):Vi(t,e.child,o,l)}function up(e,t,o,l,u){o=o.render;var f=t.ref;if("ref"in l){var b={};for(var R in l)R!=="ref"&&(b[R]=l[R])}else b=l;return $i(t),l=pc(e,t,o,b,f,u),R=gc(),e!==null&&!ot?(mc(e,t,u),qn(e,t,u)):(ze&&R&&Yl(t),t.flags|=1,yt(e,t,l,u),t.child)}function hp(e,t,o,l,u){if(e===null){var f=o.type;return typeof f=="function"&&!Vl(f)&&f.defaultProps===void 0&&o.compare===null?(t.tag=15,t.type=f,fp(e,t,f,l,u)):(e=Yo(o.type,null,l,t,t.mode,u),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!Lc(e,u)){var b=f.memoizedProps;if(o=o.compare,o=o!==null?o:Sr,o(b,l)&&e.ref===t.ref)return qn(e,t,u)}return t.flags|=1,e=Dn(f,l),e.ref=t.ref,e.return=t,t.child=e}function fp(e,t,o,l,u){if(e!==null){var f=e.memoizedProps;if(Sr(f,l)&&e.ref===t.ref)if(ot=!1,t.pendingProps=l=f,Lc(e,u))(e.flags&131072)!==0&&(ot=!0);else return t.lanes=e.lanes,qn(e,t,u)}return Ic(e,t,o,l,u)}function pp(e,t,o,l){var u=l.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,e!==null){for(l=t.child=e.child,u=0;l!==null;)u=u|l.lanes|l.childLanes,l=l.sibling;l=u&~f}else l=0,t.child=null;return gp(e,t,f,o,l)}if((o&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Xo(t,f!==null?f.cachePool:null),f!==null?xf(t,f):dc(),yf(t);else return l=t.lanes=536870912,gp(e,t,f!==null?f.baseLanes|o:o,o,l)}else f!==null?(Xo(t,f.cachePool),xf(t,f),ui(),t.memoizedState=null):(e!==null&&Xo(t,null),dc(),ui());return yt(e,t,u,o),t.child}function Nr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function gp(e,t,o,l,u){var f=sc();return f=f===null?null:{parent:st._currentValue,pool:f},t.memoizedState={baseLanes:o,cachePool:f},e!==null&&Xo(t,null),dc(),yf(t),e!==null&&Es(e,t,l,!0),t.childLanes=u,null}function ga(e,t){return t=xa({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function mp(e,t,o){return Vi(t,e.child,null,o),e=ga(t,t.pendingProps),e.flags|=2,$t(t),t.memoizedState=null,e}function R0(e,t,o){var l=t.pendingProps,u=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(ze){if(l.mode==="hidden")return e=ga(t,l),t.lanes=536870912,Nr(null,e);if(hc(t),(e=Ze)?(e=Eg(e,nn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ii!==null?{id:Sn,overflow:kn}:null,retryLane:536870912,hydrationErrors:null},o=Jh(e),o.return=t,t.child=o,mt=t,Ze=null)):e=null,e===null)throw ri(t);return t.lanes=536870912,null}return ga(t,l)}var f=e.memoizedState;if(f!==null){var b=f.dehydrated;if(hc(t),u)if(t.flags&256)t.flags&=-257,t=mp(e,t,o);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(a(558));else if(ot||Es(e,t,o,!1),u=(o&e.childLanes)!==0,ot||u){if(l=Ge,l!==null&&(b=rh(l,o),b!==0&&b!==f.retryLane))throw f.retryLane=b,qi(e,b),It(l,e,b),Oc;Ca(),t=mp(e,t,o)}else e=f.treeContext,Ze=rn(b.nextSibling),mt=t,ze=!0,si=null,nn=!1,e!==null&&tf(t,e),t=ga(t,l),t.flags|=4096;return t}return e=Dn(e.child,{mode:l.mode,children:l.children}),e.ref=t.ref,t.child=e,e.return=t,e}function ma(e,t){var o=t.ref;if(o===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(e===null||e.ref!==o)&&(t.flags|=4194816)}}function Ic(e,t,o,l,u){return $i(t),o=pc(e,t,o,l,void 0,u),l=gc(),e!==null&&!ot?(mc(e,t,u),qn(e,t,u)):(ze&&l&&Yl(t),t.flags|=1,yt(e,t,o,u),t.child)}function xp(e,t,o,l,u,f){return $i(t),t.updateQueue=null,o=vf(t,l,o,u),bf(e),l=gc(),e!==null&&!ot?(mc(e,t,f),qn(e,t,f)):(ze&&l&&Yl(t),t.flags|=1,yt(e,t,o,f),t.child)}function yp(e,t,o,l,u){if($i(t),t.stateNode===null){var f=_s,b=o.contextType;typeof b=="object"&&b!==null&&(f=xt(b)),f=new o(l,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=zc,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=l,f.state=t.memoizedState,f.refs={},oc(t),b=o.contextType,f.context=typeof b=="object"&&b!==null?xt(b):_s,f.state=t.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(Ac(t,o,b,l),f.state=t.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(b=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),b!==f.state&&zc.enqueueReplaceState(f,f.state,null),zr(t,l,f,u),Ar(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){f=t.stateNode;var R=t.memoizedProps,N=Fi(o,R);f.props=N;var G=f.context,J=o.contextType;b=_s,typeof J=="object"&&J!==null&&(b=xt(J));var te=o.getDerivedStateFromProps;J=typeof te=="function"||typeof f.getSnapshotBeforeUpdate=="function",R=t.pendingProps!==R,J||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(R||G!==b)&&sp(t,f,l,b),ai=!1;var V=t.memoizedState;f.state=V,zr(t,l,f,u),Ar(),G=t.memoizedState,R||V!==G||ai?(typeof te=="function"&&(Ac(t,o,te,l),G=t.memoizedState),(N=ai||ip(t,o,N,l,V,G,b))?(J||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=G),f.props=l,f.state=G,f.context=b,l=N):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{f=t.stateNode,ac(e,t),b=t.memoizedProps,J=Fi(o,b),f.props=J,te=t.pendingProps,V=f.context,G=o.contextType,N=_s,typeof G=="object"&&G!==null&&(N=xt(G)),R=o.getDerivedStateFromProps,(G=typeof R=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(b!==te||V!==N)&&sp(t,f,l,N),ai=!1,V=t.memoizedState,f.state=V,zr(t,l,f,u),Ar();var Y=t.memoizedState;b!==te||V!==Y||ai||e!==null&&e.dependencies!==null&&Qo(e.dependencies)?(typeof R=="function"&&(Ac(t,o,R,l),Y=t.memoizedState),(J=ai||ip(t,o,J,l,V,Y,N)||e!==null&&e.dependencies!==null&&Qo(e.dependencies))?(G||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(l,Y,N),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(l,Y,N)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=Y),f.props=l,f.state=Y,f.context=N,l=J):(typeof f.componentDidUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||b===e.memoizedProps&&V===e.memoizedState||(t.flags|=1024),l=!1)}return f=l,ma(e,t),l=(t.flags&128)!==0,f||l?(f=t.stateNode,o=l&&typeof o.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&l?(t.child=Vi(t,e.child,null,u),t.child=Vi(t,null,o,u)):yt(e,t,o,u),t.memoizedState=f.state,e=t.child):e=qn(e,t,u),e}function bp(e,t,o,l){return Ui(),t.flags|=256,yt(e,t,o,l),t.child}var Bc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nc(e){return{baseLanes:e,cachePool:lf()}}function Mc(e,t,o){return e=e!==null?e.childLanes&~o:0,t&&(e|=Pt),e}function vp(e,t,o){var l=t.pendingProps,u=!1,f=(t.flags&128)!==0,b;if((b=f)||(b=e!==null&&e.memoizedState===null?!1:(tt.current&2)!==0),b&&(u=!0,t.flags&=-129),b=(t.flags&32)!==0,t.flags&=-33,e===null){if(ze){if(u?di(t):ui(),(e=Ze)?(e=Eg(e,nn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ii!==null?{id:Sn,overflow:kn}:null,retryLane:536870912,hydrationErrors:null},o=Jh(e),o.return=t,t.child=o,mt=t,Ze=null)):e=null,e===null)throw ri(t);return bd(e)?t.lanes=32:t.lanes=536870912,null}var R=l.children;return l=l.fallback,u?(ui(),u=t.mode,R=xa({mode:"hidden",children:R},u),l=Wi(l,u,o,null),R.return=t,l.return=t,R.sibling=l,t.child=R,l=t.child,l.memoizedState=Nc(o),l.childLanes=Mc(e,b,o),t.memoizedState=Bc,Nr(null,l)):(di(t),qc(t,R))}var N=e.memoizedState;if(N!==null&&(R=N.dehydrated,R!==null)){if(f)t.flags&256?(di(t),t.flags&=-257,t=Wc(e,t,o)):t.memoizedState!==null?(ui(),t.child=e.child,t.flags|=128,t=null):(ui(),R=l.fallback,u=t.mode,l=xa({mode:"visible",children:l.children},u),R=Wi(R,u,o,null),R.flags|=2,l.return=t,R.return=t,l.sibling=R,t.child=l,Vi(t,e.child,null,o),l=t.child,l.memoizedState=Nc(o),l.childLanes=Mc(e,b,o),t.memoizedState=Bc,t=Nr(null,l));else if(di(t),bd(R)){if(b=R.nextSibling&&R.nextSibling.dataset,b)var G=b.dgst;b=G,l=Error(a(419)),l.stack="",l.digest=b,_r({value:l,source:null,stack:null}),t=Wc(e,t,o)}else if(ot||Es(e,t,o,!1),b=(o&e.childLanes)!==0,ot||b){if(b=Ge,b!==null&&(l=rh(b,o),l!==0&&l!==N.retryLane))throw N.retryLane=l,qi(e,l),It(b,e,l),Oc;yd(R)||Ca(),t=Wc(e,t,o)}else yd(R)?(t.flags|=192,t.child=e.child,t=null):(e=N.treeContext,Ze=rn(R.nextSibling),mt=t,ze=!0,si=null,nn=!1,e!==null&&tf(t,e),t=qc(t,l.children),t.flags|=4096);return t}return u?(ui(),R=l.fallback,u=t.mode,N=e.child,G=N.sibling,l=Dn(N,{mode:"hidden",children:l.children}),l.subtreeFlags=N.subtreeFlags&65011712,G!==null?R=Dn(G,R):(R=Wi(R,u,o,null),R.flags|=2),R.return=t,l.return=t,l.sibling=R,t.child=l,Nr(null,l),l=t.child,R=e.child.memoizedState,R===null?R=Nc(o):(u=R.cachePool,u!==null?(N=st._currentValue,u=u.parent!==N?{parent:N,pool:N}:u):u=lf(),R={baseLanes:R.baseLanes|o,cachePool:u}),l.memoizedState=R,l.childLanes=Mc(e,b,o),t.memoizedState=Bc,Nr(e.child,l)):(di(t),o=e.child,e=o.sibling,o=Dn(o,{mode:"visible",children:l.children}),o.return=t,o.sibling=null,e!==null&&(b=t.deletions,b===null?(t.deletions=[e],t.flags|=16):b.push(e)),t.child=o,t.memoizedState=null,o)}function qc(e,t){return t=xa({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function xa(e,t){return e=Ut(22,e,null,t),e.lanes=0,e}function Wc(e,t,o){return Vi(t,e.child,null,o),e=qc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Sp(e,t,o){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),ec(e.return,t,o)}function Uc(e,t,o,l,u,f){var b=e.memoizedState;b===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:o,tailMode:u,treeForkCount:f}:(b.isBackwards=t,b.rendering=null,b.renderingStartTime=0,b.last=l,b.tail=o,b.tailMode=u,b.treeForkCount=f)}function kp(e,t,o){var l=t.pendingProps,u=l.revealOrder,f=l.tail;l=l.children;var b=tt.current,R=(b&2)!==0;if(R?(b=b&1|2,t.flags|=128):b&=1,Q(tt,b),yt(e,t,l,o),l=ze?wr:0,!R&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Sp(e,o,t);else if(e.tag===19)Sp(e,o,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(u){case"forwards":for(o=t.child,u=null;o!==null;)e=o.alternate,e!==null&&ra(e)===null&&(u=o),o=o.sibling;o=u,o===null?(u=t.child,t.child=null):(u=o.sibling,o.sibling=null),Uc(t,!1,u,o,f,l);break;case"backwards":case"unstable_legacy-backwards":for(o=null,u=t.child,t.child=null;u!==null;){if(e=u.alternate,e!==null&&ra(e)===null){t.child=u;break}e=u.sibling,u.sibling=o,o=u,u=e}Uc(t,!0,o,null,f,l);break;case"together":Uc(t,!1,null,null,void 0,l);break;default:t.memoizedState=null}return t.child}function qn(e,t,o){if(e!==null&&(t.dependencies=e.dependencies),pi|=t.lanes,(o&t.childLanes)===0)if(e!==null){if(Es(e,t,o,!1),(o&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(a(153));if(t.child!==null){for(e=t.child,o=Dn(e,e.pendingProps),t.child=o,o.return=t;e.sibling!==null;)e=e.sibling,o=o.sibling=Dn(e,e.pendingProps),o.return=t;o.sibling=null}return t.child}function Lc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Qo(e)))}function E0(e,t,o){switch(t.tag){case 3:Pe(t,t.stateNode.containerInfo),oi(t,st,e.memoizedState.cache),Ui();break;case 27:case 5:dt(t);break;case 4:Pe(t,t.stateNode.containerInfo);break;case 10:oi(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,hc(t),null;break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(di(t),t.flags|=128,null):(o&t.child.childLanes)!==0?vp(e,t,o):(di(t),e=qn(e,t,o),e!==null?e.sibling:null);di(t);break;case 19:var u=(e.flags&128)!==0;if(l=(o&t.childLanes)!==0,l||(Es(e,t,o,!1),l=(o&t.childLanes)!==0),u){if(l)return kp(e,t,o);t.flags|=128}if(u=t.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Q(tt,tt.current),l)break;return null;case 22:return t.lanes=0,pp(e,t,o,t.pendingProps);case 24:oi(t,st,e.memoizedState.cache)}return qn(e,t,o)}function wp(e,t,o){if(e!==null)if(e.memoizedProps!==t.pendingProps)ot=!0;else{if(!Lc(e,o)&&(t.flags&128)===0)return ot=!1,E0(e,t,o);ot=(e.flags&131072)!==0}else ot=!1,ze&&(t.flags&1048576)!==0&&ef(t,wr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var l=t.pendingProps;if(e=Pi(t.elementType),t.type=e,typeof e=="function")Vl(e)?(l=Fi(e,l),t.tag=1,t=yp(null,t,e,l,o)):(t.tag=0,t=Ic(null,t,e,l,o));else{if(e!=null){var u=e.$$typeof;if(u===C){t.tag=11,t=up(null,t,e,l,o);break e}else if(u===W){t.tag=14,t=hp(null,t,e,l,o);break e}}throw t=B(e)||e,Error(a(306,t,""))}}return t;case 0:return Ic(e,t,t.type,t.pendingProps,o);case 1:return l=t.type,u=Fi(l,t.pendingProps),yp(e,t,l,u,o);case 3:e:{if(Pe(t,t.stateNode.containerInfo),e===null)throw Error(a(387));l=t.pendingProps;var f=t.memoizedState;u=f.element,ac(e,t),zr(t,l,null,o);var b=t.memoizedState;if(l=b.cache,oi(t,st,l),l!==f.cache&&tc(t,[st],o,!0),Ar(),l=b.element,f.isDehydrated)if(f={element:l,isDehydrated:!1,cache:b.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=bp(e,t,l,o);break e}else if(l!==u){u=Xt(Error(a(424)),t),_r(u),t=bp(e,t,l,o);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,Ze=rn(e.firstChild),mt=t,ze=!0,si=null,nn=!0,o=pf(t,null,l,o),t.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ui(),l===u){t=qn(e,t,o);break e}yt(e,t,l,o)}t=t.child}return t;case 26:return ma(e,t),e===null?(o=Ig(t.type,null,t.pendingProps,null))?t.memoizedState=o:ze||(o=t.type,e=t.pendingProps,l=Oa(ce.current).createElement(o),l[gt]=t,l[Et]=e,bt(l,o,e),ft(l),t.stateNode=l):t.memoizedState=Ig(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return dt(t),e===null&&ze&&(l=t.stateNode=zg(t.type,t.pendingProps,ce.current),mt=t,nn=!0,u=Ze,bi(t.type)?(vd=u,Ze=rn(l.firstChild)):Ze=u),yt(e,t,t.pendingProps.children,o),ma(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&ze&&((u=l=Ze)&&(l=sb(l,t.type,t.pendingProps,nn),l!==null?(t.stateNode=l,mt=t,Ze=rn(l.firstChild),nn=!1,u=!0):u=!1),u||ri(t)),dt(t),u=t.type,f=t.pendingProps,b=e!==null?e.memoizedProps:null,l=f.children,gd(u,f)?l=null:b!==null&&gd(u,b)&&(t.flags|=32),t.memoizedState!==null&&(u=pc(e,t,b0,null,null,o),Qr._currentValue=u),ma(e,t),yt(e,t,l,o),t.child;case 6:return e===null&&ze&&((e=o=Ze)&&(o=rb(o,t.pendingProps,nn),o!==null?(t.stateNode=o,mt=t,Ze=null,e=!0):e=!1),e||ri(t)),null;case 13:return vp(e,t,o);case 4:return Pe(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Vi(t,null,l,o):yt(e,t,l,o),t.child;case 11:return up(e,t,t.type,t.pendingProps,o);case 7:return yt(e,t,t.pendingProps,o),t.child;case 8:return yt(e,t,t.pendingProps.children,o),t.child;case 12:return yt(e,t,t.pendingProps.children,o),t.child;case 10:return l=t.pendingProps,oi(t,t.type,l.value),yt(e,t,l.children,o),t.child;case 9:return u=t.type._context,l=t.pendingProps.children,$i(t),u=xt(u),l=l(u),t.flags|=1,yt(e,t,l,o),t.child;case 14:return hp(e,t,t.type,t.pendingProps,o);case 15:return fp(e,t,t.type,t.pendingProps,o);case 19:return kp(e,t,o);case 31:return R0(e,t,o);case 22:return pp(e,t,o,t.pendingProps);case 24:return $i(t),l=xt(st),e===null?(u=sc(),u===null&&(u=Ge,f=nc(),u.pooledCache=f,f.refCount++,f!==null&&(u.pooledCacheLanes|=o),u=f),t.memoizedState={parent:l,cache:u},oc(t),oi(t,st,u)):((e.lanes&o)!==0&&(ac(e,t),zr(t,null,null,o),Ar()),u=e.memoizedState,f=t.memoizedState,u.parent!==l?(u={parent:l,cache:l},t.memoizedState=u,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=u),oi(t,st,l)):(l=f.cache,oi(t,st,l),l!==u.cache&&tc(t,[st],o,!0))),yt(e,t,t.pendingProps.children,o),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function Wn(e){e.flags|=4}function $c(e,t,o,l,u){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(u&335544128)===u)if(e.stateNode.complete)e.flags|=8192;else if(Kp())e.flags|=8192;else throw Gi=ta,rc}else e.flags&=-16777217}function _p(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Wg(t))if(Kp())e.flags|=8192;else throw Gi=ta,rc}function ya(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?nh():536870912,e.lanes|=t,Us|=t)}function Mr(e,t){if(!ze)switch(e.tailMode){case"hidden":t=e.tail;for(var o=null;t!==null;)t.alternate!==null&&(o=t),t=t.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Fe(e){var t=e.alternate!==null&&e.alternate.child===e.child,o=0,l=0;if(t)for(var u=e.child;u!==null;)o|=u.lanes|u.childLanes,l|=u.subtreeFlags&65011712,l|=u.flags&65011712,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)o|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=l,e.childLanes=o,t}function T0(e,t,o){var l=t.pendingProps;switch(Kl(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fe(t),null;case 1:return Fe(t),null;case 3:return o=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),Bn(st),Ne(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(Rs(t)?Wn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Jl())),Fe(t),null;case 26:var u=t.type,f=t.memoizedState;return e===null?(Wn(t),f!==null?(Fe(t),_p(t,f)):(Fe(t),$c(t,u,null,l,o))):f?f!==e.memoizedState?(Wn(t),Fe(t),_p(t,f)):(Fe(t),t.flags&=-16777217):(e=e.memoizedProps,e!==l&&Wn(t),Fe(t),$c(t,u,e,l,o)),null;case 27:if(Bt(t),o=ce.current,u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&Wn(t);else{if(!l){if(t.stateNode===null)throw Error(a(166));return Fe(t),null}e=ie.current,Rs(t)?nf(t):(e=zg(u,l,o),t.stateNode=e,Wn(t))}return Fe(t),null;case 5:if(Bt(t),u=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&Wn(t);else{if(!l){if(t.stateNode===null)throw Error(a(166));return Fe(t),null}if(f=ie.current,Rs(t))nf(t);else{var b=Oa(ce.current);switch(f){case 1:f=b.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:f=b.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":f=b.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":f=b.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":f=b.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof l.is=="string"?b.createElement("select",{is:l.is}):b.createElement("select"),l.multiple?f.multiple=!0:l.size&&(f.size=l.size);break;default:f=typeof l.is=="string"?b.createElement(u,{is:l.is}):b.createElement(u)}}f[gt]=t,f[Et]=l;e:for(b=t.child;b!==null;){if(b.tag===5||b.tag===6)f.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===t)break e;for(;b.sibling===null;){if(b.return===null||b.return===t)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}t.stateNode=f;e:switch(bt(f,u,l),u){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&Wn(t)}}return Fe(t),$c(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,o),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&Wn(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(a(166));if(e=ce.current,Rs(t)){if(e=t.stateNode,o=t.memoizedProps,l=null,u=mt,u!==null)switch(u.tag){case 27:case 5:l=u.memoizedProps}e[gt]=t,e=!!(e.nodeValue===o||l!==null&&l.suppressHydrationWarning===!0||vg(e.nodeValue,o)),e||ri(t,!0)}else e=Oa(e).createTextNode(l),e[gt]=t,t.stateNode=e}return Fe(t),null;case 31:if(o=t.memoizedState,e===null||e.memoizedState!==null){if(l=Rs(t),o!==null){if(e===null){if(!l)throw Error(a(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[gt]=t}else Ui(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Fe(t),e=!1}else o=Jl(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=o),e=!0;if(!e)return t.flags&256?($t(t),t):($t(t),null);if((t.flags&128)!==0)throw Error(a(558))}return Fe(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(u=Rs(t),l!==null&&l.dehydrated!==null){if(e===null){if(!u)throw Error(a(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(a(317));u[gt]=t}else Ui(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Fe(t),u=!1}else u=Jl(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=u),u=!0;if(!u)return t.flags&256?($t(t),t):($t(t),null)}return $t(t),(t.flags&128)!==0?(t.lanes=o,t):(o=l!==null,e=e!==null&&e.memoizedState!==null,o&&(l=t.child,u=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(u=l.alternate.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==u&&(l.flags|=2048)),o!==e&&o&&(t.child.flags|=8192),ya(t,t.updateQueue),Fe(t),null);case 4:return Ne(),e===null&&dd(t.stateNode.containerInfo),Fe(t),null;case 10:return Bn(t.type),Fe(t),null;case 19:if(U(tt),l=t.memoizedState,l===null)return Fe(t),null;if(u=(t.flags&128)!==0,f=l.rendering,f===null)if(u)Mr(l,!1);else{if(Xe!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=ra(e),f!==null){for(t.flags|=128,Mr(l,!1),e=f.updateQueue,t.updateQueue=e,ya(t,e),t.subtreeFlags=0,e=o,o=t.child;o!==null;)Qh(o,e),o=o.sibling;return Q(tt,tt.current&1|2),ze&&On(t,l.treeForkCount),t.child}e=e.sibling}l.tail!==null&&Nt()>wa&&(t.flags|=128,u=!0,Mr(l,!1),t.lanes=4194304)}else{if(!u)if(e=ra(f),e!==null){if(t.flags|=128,u=!0,e=e.updateQueue,t.updateQueue=e,ya(t,e),Mr(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!ze)return Fe(t),null}else 2*Nt()-l.renderingStartTime>wa&&o!==536870912&&(t.flags|=128,u=!0,Mr(l,!1),t.lanes=4194304);l.isBackwards?(f.sibling=t.child,t.child=f):(e=l.last,e!==null?e.sibling=f:t.child=f,l.last=f)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=Nt(),e.sibling=null,o=tt.current,Q(tt,u?o&1|2:o&1),ze&&On(t,l.treeForkCount),e):(Fe(t),null);case 22:case 23:return $t(t),uc(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(o&536870912)!==0&&(t.flags&128)===0&&(Fe(t),t.subtreeFlags&6&&(t.flags|=8192)):Fe(t),o=t.updateQueue,o!==null&&ya(t,o.retryQueue),o=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(o=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==o&&(t.flags|=2048),e!==null&&U(Hi),null;case 24:return o=null,e!==null&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),Bn(st),Fe(t),null;case 25:return null;case 30:return null}throw Error(a(156,t.tag))}function A0(e,t){switch(Kl(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bn(st),Ne(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Bt(t),null;case 31:if(t.memoizedState!==null){if($t(t),t.alternate===null)throw Error(a(340));Ui()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if($t(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(a(340));Ui()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return U(tt),null;case 4:return Ne(),null;case 10:return Bn(t.type),null;case 22:case 23:return $t(t),uc(),e!==null&&U(Hi),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Bn(st),null;case 25:return null;default:return null}}function jp(e,t){switch(Kl(t),t.tag){case 3:Bn(st),Ne();break;case 26:case 27:case 5:Bt(t);break;case 4:Ne();break;case 31:t.memoizedState!==null&&$t(t);break;case 13:$t(t);break;case 19:U(tt);break;case 10:Bn(t.type);break;case 22:case 23:$t(t),uc(),e!==null&&U(Hi);break;case 24:Bn(st)}}function qr(e,t){try{var o=t.updateQueue,l=o!==null?o.lastEffect:null;if(l!==null){var u=l.next;o=u;do{if((o.tag&e)===e){l=void 0;var f=o.create,b=o.inst;l=f(),b.destroy=l}o=o.next}while(o!==u)}}catch(R){Ue(t,t.return,R)}}function hi(e,t,o){try{var l=t.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var f=u.next;l=f;do{if((l.tag&e)===e){var b=l.inst,R=b.destroy;if(R!==void 0){b.destroy=void 0,u=t;var N=o,G=R;try{G()}catch(J){Ue(u,N,J)}}}l=l.next}while(l!==f)}}catch(J){Ue(t,t.return,J)}}function Cp(e){var t=e.updateQueue;if(t!==null){var o=e.stateNode;try{mf(t,o)}catch(l){Ue(e,e.return,l)}}}function Rp(e,t,o){o.props=Fi(e.type,e.memoizedProps),o.state=e.memoizedState;try{o.componentWillUnmount()}catch(l){Ue(e,t,l)}}function Wr(e,t){try{var o=e.ref;if(o!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof o=="function"?e.refCleanup=o(l):o.current=l}}catch(u){Ue(e,t,u)}}function wn(e,t){var o=e.ref,l=e.refCleanup;if(o!==null)if(typeof l=="function")try{l()}catch(u){Ue(e,t,u)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(u){Ue(e,t,u)}else o.current=null}function Ep(e){var t=e.type,o=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":o.autoFocus&&l.focus();break e;case"img":o.src?l.src=o.src:o.srcSet&&(l.srcset=o.srcSet)}}catch(u){Ue(e,e.return,u)}}function Hc(e,t,o){try{var l=e.stateNode;J0(l,e.type,o,t),l[Et]=t}catch(u){Ue(e,e.return,u)}}function Tp(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&bi(e.type)||e.tag===4}function Pc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&bi(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gc(e,t,o){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(e,t):(t=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,t.appendChild(e),o=o._reactRootContainer,o!=null||t.onclick!==null||(t.onclick=An));else if(l!==4&&(l===27&&bi(e.type)&&(o=e.stateNode,t=null),e=e.child,e!==null))for(Gc(e,t,o),e=e.sibling;e!==null;)Gc(e,t,o),e=e.sibling}function ba(e,t,o){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?o.insertBefore(e,t):o.appendChild(e);else if(l!==4&&(l===27&&bi(e.type)&&(o=e.stateNode),e=e.child,e!==null))for(ba(e,t,o),e=e.sibling;e!==null;)ba(e,t,o),e=e.sibling}function Ap(e){var t=e.stateNode,o=e.memoizedProps;try{for(var l=e.type,u=t.attributes;u.length;)t.removeAttributeNode(u[0]);bt(t,l,o),t[gt]=e,t[Et]=o}catch(f){Ue(e,e.return,f)}}var Un=!1,at=!1,Vc=!1,zp=typeof WeakSet=="function"?WeakSet:Set,pt=null;function z0(e,t){if(e=e.containerInfo,fd=Ua,e=$h(e),Wl(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var l=o.getSelection&&o.getSelection();if(l&&l.rangeCount!==0){o=l.anchorNode;var u=l.anchorOffset,f=l.focusNode;l=l.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var b=0,R=-1,N=-1,G=0,J=0,te=e,V=null;t:for(;;){for(var Y;te!==o||u!==0&&te.nodeType!==3||(R=b+u),te!==f||l!==0&&te.nodeType!==3||(N=b+l),te.nodeType===3&&(b+=te.nodeValue.length),(Y=te.firstChild)!==null;)V=te,te=Y;for(;;){if(te===e)break t;if(V===o&&++G===u&&(R=b),V===f&&++J===l&&(N=b),(Y=te.nextSibling)!==null)break;te=V,V=te.parentNode}te=Y}o=R===-1||N===-1?null:{start:R,end:N}}else o=null}o=o||{start:0,end:0}}else o=null;for(pd={focusedElem:e,selectionRange:o},Ua=!1,pt=t;pt!==null;)if(t=pt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pt=e;else for(;pt!==null;){switch(t=pt,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(o=0;o<e.length;o++)u=e[o],u.ref.impl=u.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,o=t,u=f.memoizedProps,f=f.memoizedState,l=o.stateNode;try{var de=Fi(o.type,u);e=l.getSnapshotBeforeUpdate(de,f),l.__reactInternalSnapshotBeforeUpdate=e}catch(ve){Ue(o,o.return,ve)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,o=e.nodeType,o===9)xd(e);else if(o===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":xd(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=t.sibling,e!==null){e.return=t.return,pt=e;break}pt=t.return}}function Dp(e,t,o){var l=o.flags;switch(o.tag){case 0:case 11:case 15:$n(e,o),l&4&&qr(5,o);break;case 1:if($n(e,o),l&4)if(e=o.stateNode,t===null)try{e.componentDidMount()}catch(b){Ue(o,o.return,b)}else{var u=Fi(o.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(u,t,e.__reactInternalSnapshotBeforeUpdate)}catch(b){Ue(o,o.return,b)}}l&64&&Cp(o),l&512&&Wr(o,o.return);break;case 3:if($n(e,o),l&64&&(e=o.updateQueue,e!==null)){if(t=null,o.child!==null)switch(o.child.tag){case 27:case 5:t=o.child.stateNode;break;case 1:t=o.child.stateNode}try{mf(e,t)}catch(b){Ue(o,o.return,b)}}break;case 27:t===null&&l&4&&Ap(o);case 26:case 5:$n(e,o),t===null&&l&4&&Ep(o),l&512&&Wr(o,o.return);break;case 12:$n(e,o);break;case 31:$n(e,o),l&4&&Bp(e,o);break;case 13:$n(e,o),l&4&&Np(e,o),l&64&&(e=o.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(o=U0.bind(null,o),ob(e,o))));break;case 22:if(l=o.memoizedState!==null||Un,!l){t=t!==null&&t.memoizedState!==null||at,u=Un;var f=at;Un=l,(at=t)&&!f?Hn(e,o,(o.subtreeFlags&8772)!==0):$n(e,o),Un=u,at=f}break;case 30:break;default:$n(e,o)}}function Op(e){var t=e.alternate;t!==null&&(e.alternate=null,Op(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&kl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ye=null,At=!1;function Ln(e,t,o){for(o=o.child;o!==null;)Ip(e,t,o),o=o.sibling}function Ip(e,t,o){if(Mt&&typeof Mt.onCommitFiberUnmount=="function")try{Mt.onCommitFiberUnmount(cr,o)}catch{}switch(o.tag){case 26:at||wn(o,t),Ln(e,t,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:at||wn(o,t);var l=Ye,u=At;bi(o.type)&&(Ye=o.stateNode,At=!1),Ln(e,t,o),Fr(o.stateNode),Ye=l,At=u;break;case 5:at||wn(o,t);case 6:if(l=Ye,u=At,Ye=null,Ln(e,t,o),Ye=l,At=u,Ye!==null)if(At)try{(Ye.nodeType===9?Ye.body:Ye.nodeName==="HTML"?Ye.ownerDocument.body:Ye).removeChild(o.stateNode)}catch(f){Ue(o,t,f)}else try{Ye.removeChild(o.stateNode)}catch(f){Ue(o,t,f)}break;case 18:Ye!==null&&(At?(e=Ye,Cg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,o.stateNode),Fs(e)):Cg(Ye,o.stateNode));break;case 4:l=Ye,u=At,Ye=o.stateNode.containerInfo,At=!0,Ln(e,t,o),Ye=l,At=u;break;case 0:case 11:case 14:case 15:hi(2,o,t),at||hi(4,o,t),Ln(e,t,o);break;case 1:at||(wn(o,t),l=o.stateNode,typeof l.componentWillUnmount=="function"&&Rp(o,t,l)),Ln(e,t,o);break;case 21:Ln(e,t,o);break;case 22:at=(l=at)||o.memoizedState!==null,Ln(e,t,o),at=l;break;default:Ln(e,t,o)}}function Bp(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Fs(e)}catch(o){Ue(t,t.return,o)}}}function Np(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Fs(e)}catch(o){Ue(t,t.return,o)}}function D0(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new zp),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new zp),t;default:throw Error(a(435,e.tag))}}function va(e,t){var o=D0(e);t.forEach(function(l){if(!o.has(l)){o.add(l);var u=L0.bind(null,e,l);l.then(u,u)}})}function zt(e,t){var o=t.deletions;if(o!==null)for(var l=0;l<o.length;l++){var u=o[l],f=e,b=t,R=b;e:for(;R!==null;){switch(R.tag){case 27:if(bi(R.type)){Ye=R.stateNode,At=!1;break e}break;case 5:Ye=R.stateNode,At=!1;break e;case 3:case 4:Ye=R.stateNode.containerInfo,At=!0;break e}R=R.return}if(Ye===null)throw Error(a(160));Ip(f,b,u),Ye=null,At=!1,f=u.alternate,f!==null&&(f.return=null),u.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Mp(t,e),t=t.sibling}var un=null;function Mp(e,t){var o=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:zt(t,e),Dt(e),l&4&&(hi(3,e,e.return),qr(3,e),hi(5,e,e.return));break;case 1:zt(t,e),Dt(e),l&512&&(at||o===null||wn(o,o.return)),l&64&&Un&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(o=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=o===null?l:o.concat(l))));break;case 26:var u=un;if(zt(t,e),Dt(e),l&512&&(at||o===null||wn(o,o.return)),l&4){var f=o!==null?o.memoizedState:null;if(l=e.memoizedState,o===null)if(l===null)if(e.stateNode===null){e:{l=e.type,o=e.memoizedProps,u=u.ownerDocument||u;t:switch(l){case"title":f=u.getElementsByTagName("title")[0],(!f||f[hr]||f[gt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=u.createElement(l),u.head.insertBefore(f,u.querySelector("head > title"))),bt(f,l,o),f[gt]=e,ft(f),l=f;break e;case"link":var b=Mg("link","href",u).get(l+(o.href||""));if(b){for(var R=0;R<b.length;R++)if(f=b[R],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){b.splice(R,1);break t}}f=u.createElement(l),bt(f,l,o),u.head.appendChild(f);break;case"meta":if(b=Mg("meta","content",u).get(l+(o.content||""))){for(R=0;R<b.length;R++)if(f=b[R],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){b.splice(R,1);break t}}f=u.createElement(l),bt(f,l,o),u.head.appendChild(f);break;default:throw Error(a(468,l))}f[gt]=e,ft(f),l=f}e.stateNode=l}else qg(u,e.type,e.stateNode);else e.stateNode=Ng(u,l,e.memoizedProps);else f!==l?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,l===null?qg(u,e.type,e.stateNode):Ng(u,l,e.memoizedProps)):l===null&&e.stateNode!==null&&Hc(e,e.memoizedProps,o.memoizedProps)}break;case 27:zt(t,e),Dt(e),l&512&&(at||o===null||wn(o,o.return)),o!==null&&l&4&&Hc(e,e.memoizedProps,o.memoizedProps);break;case 5:if(zt(t,e),Dt(e),l&512&&(at||o===null||wn(o,o.return)),e.flags&32){u=e.stateNode;try{xs(u,"")}catch(de){Ue(e,e.return,de)}}l&4&&e.stateNode!=null&&(u=e.memoizedProps,Hc(e,u,o!==null?o.memoizedProps:u)),l&1024&&(Vc=!0);break;case 6:if(zt(t,e),Dt(e),l&4){if(e.stateNode===null)throw Error(a(162));l=e.memoizedProps,o=e.stateNode;try{o.nodeValue=l}catch(de){Ue(e,e.return,de)}}break;case 3:if(Na=null,u=un,un=Ia(t.containerInfo),zt(t,e),un=u,Dt(e),l&4&&o!==null&&o.memoizedState.isDehydrated)try{Fs(t.containerInfo)}catch(de){Ue(e,e.return,de)}Vc&&(Vc=!1,qp(e));break;case 4:l=un,un=Ia(e.stateNode.containerInfo),zt(t,e),Dt(e),un=l;break;case 12:zt(t,e),Dt(e);break;case 31:zt(t,e),Dt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,va(e,l)));break;case 13:zt(t,e),Dt(e),e.child.flags&8192&&e.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(ka=Nt()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,va(e,l)));break;case 22:u=e.memoizedState!==null;var N=o!==null&&o.memoizedState!==null,G=Un,J=at;if(Un=G||u,at=J||N,zt(t,e),at=J,Un=G,Dt(e),l&8192)e:for(t=e.stateNode,t._visibility=u?t._visibility&-2:t._visibility|1,u&&(o===null||N||Un||at||Yi(e)),o=null,t=e;;){if(t.tag===5||t.tag===26){if(o===null){N=o=t;try{if(f=N.stateNode,u)b=f.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{R=N.stateNode;var te=N.memoizedProps.style,V=te!=null&&te.hasOwnProperty("display")?te.display:null;R.style.display=V==null||typeof V=="boolean"?"":(""+V).trim()}}catch(de){Ue(N,N.return,de)}}}else if(t.tag===6){if(o===null){N=t;try{N.stateNode.nodeValue=u?"":N.memoizedProps}catch(de){Ue(N,N.return,de)}}}else if(t.tag===18){if(o===null){N=t;try{var Y=N.stateNode;u?Rg(Y,!0):Rg(N.stateNode,!1)}catch(de){Ue(N,N.return,de)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;o===t&&(o=null),t=t.return}o===t&&(o=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(o=l.retryQueue,o!==null&&(l.retryQueue=null,va(e,o))));break;case 19:zt(t,e),Dt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,va(e,l)));break;case 30:break;case 21:break;default:zt(t,e),Dt(e)}}function Dt(e){var t=e.flags;if(t&2){try{for(var o,l=e.return;l!==null;){if(Tp(l)){o=l;break}l=l.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var u=o.stateNode,f=Pc(e);ba(e,f,u);break;case 5:var b=o.stateNode;o.flags&32&&(xs(b,""),o.flags&=-33);var R=Pc(e);ba(e,R,b);break;case 3:case 4:var N=o.stateNode.containerInfo,G=Pc(e);Gc(e,G,N);break;default:throw Error(a(161))}}catch(J){Ue(e,e.return,J)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function qp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;qp(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function $n(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Dp(e,t.alternate,t),t=t.sibling}function Yi(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:hi(4,t,t.return),Yi(t);break;case 1:wn(t,t.return);var o=t.stateNode;typeof o.componentWillUnmount=="function"&&Rp(t,t.return,o),Yi(t);break;case 27:Fr(t.stateNode);case 26:case 5:wn(t,t.return),Yi(t);break;case 22:t.memoizedState===null&&Yi(t);break;case 30:Yi(t);break;default:Yi(t)}e=e.sibling}}function Hn(e,t,o){for(o=o&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,u=e,f=t,b=f.flags;switch(f.tag){case 0:case 11:case 15:Hn(u,f,o),qr(4,f);break;case 1:if(Hn(u,f,o),l=f,u=l.stateNode,typeof u.componentDidMount=="function")try{u.componentDidMount()}catch(G){Ue(l,l.return,G)}if(l=f,u=l.updateQueue,u!==null){var R=l.stateNode;try{var N=u.shared.hiddenCallbacks;if(N!==null)for(u.shared.hiddenCallbacks=null,u=0;u<N.length;u++)gf(N[u],R)}catch(G){Ue(l,l.return,G)}}o&&b&64&&Cp(f),Wr(f,f.return);break;case 27:Ap(f);case 26:case 5:Hn(u,f,o),o&&l===null&&b&4&&Ep(f),Wr(f,f.return);break;case 12:Hn(u,f,o);break;case 31:Hn(u,f,o),o&&b&4&&Bp(u,f);break;case 13:Hn(u,f,o),o&&b&4&&Np(u,f);break;case 22:f.memoizedState===null&&Hn(u,f,o),Wr(f,f.return);break;case 30:break;default:Hn(u,f,o)}t=t.sibling}}function Zc(e,t){var o=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(o=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==o&&(e!=null&&e.refCount++,o!=null&&jr(o))}function Fc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&jr(e))}function hn(e,t,o,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Wp(e,t,o,l),t=t.sibling}function Wp(e,t,o,l){var u=t.flags;switch(t.tag){case 0:case 11:case 15:hn(e,t,o,l),u&2048&&qr(9,t);break;case 1:hn(e,t,o,l);break;case 3:hn(e,t,o,l),u&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&jr(e)));break;case 12:if(u&2048){hn(e,t,o,l),e=t.stateNode;try{var f=t.memoizedProps,b=f.id,R=f.onPostCommit;typeof R=="function"&&R(b,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){Ue(t,t.return,N)}}else hn(e,t,o,l);break;case 31:hn(e,t,o,l);break;case 13:hn(e,t,o,l);break;case 23:break;case 22:f=t.stateNode,b=t.alternate,t.memoizedState!==null?f._visibility&2?hn(e,t,o,l):Ur(e,t):f._visibility&2?hn(e,t,o,l):(f._visibility|=2,Ms(e,t,o,l,(t.subtreeFlags&10256)!==0||!1)),u&2048&&Zc(b,t);break;case 24:hn(e,t,o,l),u&2048&&Fc(t.alternate,t);break;default:hn(e,t,o,l)}}function Ms(e,t,o,l,u){for(u=u&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,b=t,R=o,N=l,G=b.flags;switch(b.tag){case 0:case 11:case 15:Ms(f,b,R,N,u),qr(8,b);break;case 23:break;case 22:var J=b.stateNode;b.memoizedState!==null?J._visibility&2?Ms(f,b,R,N,u):Ur(f,b):(J._visibility|=2,Ms(f,b,R,N,u)),u&&G&2048&&Zc(b.alternate,b);break;case 24:Ms(f,b,R,N,u),u&&G&2048&&Fc(b.alternate,b);break;default:Ms(f,b,R,N,u)}t=t.sibling}}function Ur(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var o=e,l=t,u=l.flags;switch(l.tag){case 22:Ur(o,l),u&2048&&Zc(l.alternate,l);break;case 24:Ur(o,l),u&2048&&Fc(l.alternate,l);break;default:Ur(o,l)}t=t.sibling}}var Lr=8192;function qs(e,t,o){if(e.subtreeFlags&Lr)for(e=e.child;e!==null;)Up(e,t,o),e=e.sibling}function Up(e,t,o){switch(e.tag){case 26:qs(e,t,o),e.flags&Lr&&e.memoizedState!==null&&yb(o,un,e.memoizedState,e.memoizedProps);break;case 5:qs(e,t,o);break;case 3:case 4:var l=un;un=Ia(e.stateNode.containerInfo),qs(e,t,o),un=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=Lr,Lr=16777216,qs(e,t,o),Lr=l):qs(e,t,o));break;default:qs(e,t,o)}}function Lp(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function $r(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var o=0;o<t.length;o++){var l=t[o];pt=l,Hp(l,e)}Lp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)$p(e),e=e.sibling}function $p(e){switch(e.tag){case 0:case 11:case 15:$r(e),e.flags&2048&&hi(9,e,e.return);break;case 3:$r(e);break;case 12:$r(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Sa(e)):$r(e);break;default:$r(e)}}function Sa(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var o=0;o<t.length;o++){var l=t[o];pt=l,Hp(l,e)}Lp(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:hi(8,t,t.return),Sa(t);break;case 22:o=t.stateNode,o._visibility&2&&(o._visibility&=-3,Sa(t));break;default:Sa(t)}e=e.sibling}}function Hp(e,t){for(;pt!==null;){var o=pt;switch(o.tag){case 0:case 11:case 15:hi(8,o,t);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var l=o.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:jr(o.memoizedState.cache)}if(l=o.child,l!==null)l.return=o,pt=l;else e:for(o=e;pt!==null;){l=pt;var u=l.sibling,f=l.return;if(Op(l),l===o){pt=null;break e}if(u!==null){u.return=f,pt=u;break e}pt=f}}}var O0={getCacheForType:function(e){var t=xt(st),o=t.data.get(e);return o===void 0&&(o=e(),t.data.set(e,o)),o},cacheSignal:function(){return xt(st).controller.signal}},I0=typeof WeakMap=="function"?WeakMap:Map,Me=0,Ge=null,Re=null,Te=0,We=0,Ht=null,fi=!1,Ws=!1,Yc=!1,Pn=0,Xe=0,pi=0,Ki=0,Kc=0,Pt=0,Us=0,Hr=null,Ot=null,Qc=!1,ka=0,Pp=0,wa=1/0,_a=null,gi=null,ut=0,mi=null,Ls=null,Gn=0,Jc=0,Xc=null,Gp=null,Pr=0,ed=null;function Gt(){return(Me&2)!==0&&Te!==0?Te&-Te:O.T!==null?od():oh()}function Vp(){if(Pt===0)if((Te&536870912)===0||ze){var e=Do;Do<<=1,(Do&3932160)===0&&(Do=262144),Pt=e}else Pt=536870912;return e=Lt.current,e!==null&&(e.flags|=32),Pt}function It(e,t,o){(e===Ge&&(We===2||We===9)||e.cancelPendingCommit!==null)&&($s(e,0),xi(e,Te,Pt,!1)),ur(e,o),((Me&2)===0||e!==Ge)&&(e===Ge&&((Me&2)===0&&(Ki|=o),Xe===4&&xi(e,Te,Pt,!1)),_n(e))}function Zp(e,t,o){if((Me&6)!==0)throw Error(a(327));var l=!o&&(t&127)===0&&(t&e.expiredLanes)===0||dr(e,t),u=l?M0(e,t):nd(e,t,!0),f=l;do{if(u===0){Ws&&!l&&xi(e,t,0,!1);break}else{if(o=e.current.alternate,f&&!B0(o)){u=nd(e,t,!1),f=!1;continue}if(u===2){if(f=t,e.errorRecoveryDisabledLanes&f)var b=0;else b=e.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){t=b;e:{var R=e;u=Hr;var N=R.current.memoizedState.isDehydrated;if(N&&($s(R,b).flags|=256),b=nd(R,b,!1),b!==2){if(Yc&&!N){R.errorRecoveryDisabledLanes|=f,Ki|=f,u=4;break e}f=Ot,Ot=u,f!==null&&(Ot===null?Ot=f:Ot.push.apply(Ot,f))}u=b}if(f=!1,u!==2)continue}}if(u===1){$s(e,0),xi(e,t,0,!0);break}e:{switch(l=e,f=u,f){case 0:case 1:throw Error(a(345));case 4:if((t&4194048)!==t)break;case 6:xi(l,t,Pt,!fi);break e;case 2:Ot=null;break;case 3:case 5:break;default:throw Error(a(329))}if((t&62914560)===t&&(u=ka+300-Nt(),10<u)){if(xi(l,t,Pt,!fi),Io(l,0,!0)!==0)break e;Gn=t,l.timeoutHandle=_g(Fp.bind(null,l,o,Ot,_a,Qc,t,Pt,Ki,Us,fi,f,"Throttled",-0,0),u);break e}Fp(l,o,Ot,_a,Qc,t,Pt,Ki,Us,fi,f,null,-0,0)}}break}while(!0);_n(e)}function Fp(e,t,o,l,u,f,b,R,N,G,J,te,V,Y){if(e.timeoutHandle=-1,te=t.subtreeFlags,te&8192||(te&16785408)===16785408){te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:An},Up(t,f,te);var de=(f&62914560)===f?ka-Nt():(f&4194048)===f?Pp-Nt():0;if(de=bb(te,de),de!==null){Gn=f,e.cancelPendingCommit=de(ng.bind(null,e,t,f,o,l,u,b,R,N,J,te,null,V,Y)),xi(e,f,b,!G);return}}ng(e,t,f,o,l,u,b,R,N)}function B0(e){for(var t=e;;){var o=t.tag;if((o===0||o===11||o===15)&&t.flags&16384&&(o=t.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var l=0;l<o.length;l++){var u=o[l],f=u.getSnapshot;u=u.value;try{if(!Wt(f(),u))return!1}catch{return!1}}if(o=t.child,t.subtreeFlags&16384&&o!==null)o.return=t,t=o;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xi(e,t,o,l){t&=~Kc,t&=~Ki,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var u=t;0<u;){var f=31-qt(u),b=1<<f;l[f]=-1,u&=~b}o!==0&&ih(e,o,t)}function ja(){return(Me&6)===0?(Gr(0),!1):!0}function td(){if(Re!==null){if(We===0)var e=Re.return;else e=Re,In=Li=null,xc(e),Ds=null,Rr=0,e=Re;for(;e!==null;)jp(e.alternate,e),e=e.return;Re=null}}function $s(e,t){var o=e.timeoutHandle;o!==-1&&(e.timeoutHandle=-1,tb(o)),o=e.cancelPendingCommit,o!==null&&(e.cancelPendingCommit=null,o()),Gn=0,td(),Ge=e,Re=o=Dn(e.current,null),Te=t,We=0,Ht=null,fi=!1,Ws=dr(e,t),Yc=!1,Us=Pt=Kc=Ki=pi=Xe=0,Ot=Hr=null,Qc=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var u=31-qt(l),f=1<<u;t|=e[u],l&=~f}return Pn=t,Vo(),o}function Yp(e,t){je=null,O.H=Br,t===zs||t===ea?(t=uf(),We=3):t===rc?(t=uf(),We=4):We=t===Oc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ht=t,Re===null&&(Xe=1,pa(e,Xt(t,e.current)))}function Kp(){var e=Lt.current;return e===null?!0:(Te&4194048)===Te?sn===null:(Te&62914560)===Te||(Te&536870912)!==0?e===sn:!1}function Qp(){var e=O.H;return O.H=Br,e===null?Br:e}function Jp(){var e=O.A;return O.A=O0,e}function Ca(){Xe=4,fi||(Te&4194048)!==Te&&Lt.current!==null||(Ws=!0),(pi&134217727)===0&&(Ki&134217727)===0||Ge===null||xi(Ge,Te,Pt,!1)}function nd(e,t,o){var l=Me;Me|=2;var u=Qp(),f=Jp();(Ge!==e||Te!==t)&&(_a=null,$s(e,t)),t=!1;var b=Xe;e:do try{if(We!==0&&Re!==null){var R=Re,N=Ht;switch(We){case 8:td(),b=6;break e;case 3:case 2:case 9:case 6:Lt.current===null&&(t=!0);var G=We;if(We=0,Ht=null,Hs(e,R,N,G),o&&Ws){b=0;break e}break;default:G=We,We=0,Ht=null,Hs(e,R,N,G)}}N0(),b=Xe;break}catch(J){Yp(e,J)}while(!0);return t&&e.shellSuspendCounter++,In=Li=null,Me=l,O.H=u,O.A=f,Re===null&&(Ge=null,Te=0,Vo()),b}function N0(){for(;Re!==null;)Xp(Re)}function M0(e,t){var o=Me;Me|=2;var l=Qp(),u=Jp();Ge!==e||Te!==t?(_a=null,wa=Nt()+500,$s(e,t)):Ws=dr(e,t);e:do try{if(We!==0&&Re!==null){t=Re;var f=Ht;t:switch(We){case 1:We=0,Ht=null,Hs(e,t,f,1);break;case 2:case 9:if(cf(f)){We=0,Ht=null,eg(t);break}t=function(){We!==2&&We!==9||Ge!==e||(We=7),_n(e)},f.then(t,t);break e;case 3:We=7;break e;case 4:We=5;break e;case 7:cf(f)?(We=0,Ht=null,eg(t)):(We=0,Ht=null,Hs(e,t,f,7));break;case 5:var b=null;switch(Re.tag){case 26:b=Re.memoizedState;case 5:case 27:var R=Re;if(b?Wg(b):R.stateNode.complete){We=0,Ht=null;var N=R.sibling;if(N!==null)Re=N;else{var G=R.return;G!==null?(Re=G,Ra(G)):Re=null}break t}}We=0,Ht=null,Hs(e,t,f,5);break;case 6:We=0,Ht=null,Hs(e,t,f,6);break;case 8:td(),Xe=6;break e;default:throw Error(a(462))}}q0();break}catch(J){Yp(e,J)}while(!0);return In=Li=null,O.H=l,O.A=u,Me=o,Re!==null?0:(Ge=null,Te=0,Vo(),Xe)}function q0(){for(;Re!==null&&!ay();)Xp(Re)}function Xp(e){var t=wp(e.alternate,e,Pn);e.memoizedProps=e.pendingProps,t===null?Ra(e):Re=t}function eg(e){var t=e,o=t.alternate;switch(t.tag){case 15:case 0:t=xp(o,t,t.pendingProps,t.type,void 0,Te);break;case 11:t=xp(o,t,t.pendingProps,t.type.render,t.ref,Te);break;case 5:xc(t);default:jp(o,t),t=Re=Qh(t,Pn),t=wp(o,t,Pn)}e.memoizedProps=e.pendingProps,t===null?Ra(e):Re=t}function Hs(e,t,o,l){In=Li=null,xc(t),Ds=null,Rr=0;var u=t.return;try{if(C0(e,u,t,o,Te)){Xe=1,pa(e,Xt(o,e.current)),Re=null;return}}catch(f){if(u!==null)throw Re=u,f;Xe=1,pa(e,Xt(o,e.current)),Re=null;return}t.flags&32768?(ze||l===1?e=!0:Ws||(Te&536870912)!==0?e=!1:(fi=e=!0,(l===2||l===9||l===3||l===6)&&(l=Lt.current,l!==null&&l.tag===13&&(l.flags|=16384))),tg(t,e)):Ra(t)}function Ra(e){var t=e;do{if((t.flags&32768)!==0){tg(t,fi);return}e=t.return;var o=T0(t.alternate,t,Pn);if(o!==null){Re=o;return}if(t=t.sibling,t!==null){Re=t;return}Re=t=e}while(t!==null);Xe===0&&(Xe=5)}function tg(e,t){do{var o=A0(e.alternate,e);if(o!==null){o.flags&=32767,Re=o;return}if(o=e.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!t&&(e=e.sibling,e!==null)){Re=e;return}Re=e=o}while(e!==null);Xe=6,Re=null}function ng(e,t,o,l,u,f,b,R,N){e.cancelPendingCommit=null;do Ea();while(ut!==0);if((Me&6)!==0)throw Error(a(327));if(t!==null){if(t===e.current)throw Error(a(177));if(f=t.lanes|t.childLanes,f|=Pl,xy(e,o,f,b,R,N),e===Ge&&(Re=Ge=null,Te=0),Ls=t,mi=e,Gn=o,Jc=f,Xc=u,Gp=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,$0(Ao,function(){return ag(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=O.T,O.T=null,u=q.p,q.p=2,b=Me,Me|=4;try{z0(e,t,o)}finally{Me=b,q.p=u,O.T=l}}ut=1,ig(),sg(),rg()}}function ig(){if(ut===1){ut=0;var e=mi,t=Ls,o=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||o){o=O.T,O.T=null;var l=q.p;q.p=2;var u=Me;Me|=4;try{Mp(t,e);var f=pd,b=$h(e.containerInfo),R=f.focusedElem,N=f.selectionRange;if(b!==R&&R&&R.ownerDocument&&Lh(R.ownerDocument.documentElement,R)){if(N!==null&&Wl(R)){var G=N.start,J=N.end;if(J===void 0&&(J=G),"selectionStart"in R)R.selectionStart=G,R.selectionEnd=Math.min(J,R.value.length);else{var te=R.ownerDocument||document,V=te&&te.defaultView||window;if(V.getSelection){var Y=V.getSelection(),de=R.textContent.length,ve=Math.min(N.start,de),He=N.end===void 0?ve:Math.min(N.end,de);!Y.extend&&ve>He&&(b=He,He=ve,ve=b);var H=Uh(R,ve),L=Uh(R,He);if(H&&L&&(Y.rangeCount!==1||Y.anchorNode!==H.node||Y.anchorOffset!==H.offset||Y.focusNode!==L.node||Y.focusOffset!==L.offset)){var P=te.createRange();P.setStart(H.node,H.offset),Y.removeAllRanges(),ve>He?(Y.addRange(P),Y.extend(L.node,L.offset)):(P.setEnd(L.node,L.offset),Y.addRange(P))}}}}for(te=[],Y=R;Y=Y.parentNode;)Y.nodeType===1&&te.push({element:Y,left:Y.scrollLeft,top:Y.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<te.length;R++){var X=te[R];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}Ua=!!fd,pd=fd=null}finally{Me=u,q.p=l,O.T=o}}e.current=t,ut=2}}function sg(){if(ut===2){ut=0;var e=mi,t=Ls,o=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||o){o=O.T,O.T=null;var l=q.p;q.p=2;var u=Me;Me|=4;try{Dp(e,t.alternate,t)}finally{Me=u,q.p=l,O.T=o}}ut=3}}function rg(){if(ut===4||ut===3){ut=0,ly();var e=mi,t=Ls,o=Gn,l=Gp;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?ut=5:(ut=0,Ls=mi=null,og(e,e.pendingLanes));var u=e.pendingLanes;if(u===0&&(gi=null),vl(o),t=t.stateNode,Mt&&typeof Mt.onCommitFiberRoot=="function")try{Mt.onCommitFiberRoot(cr,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=O.T,u=q.p,q.p=2,O.T=null;try{for(var f=e.onRecoverableError,b=0;b<l.length;b++){var R=l[b];f(R.value,{componentStack:R.stack})}}finally{O.T=t,q.p=u}}(Gn&3)!==0&&Ea(),_n(e),u=e.pendingLanes,(o&261930)!==0&&(u&42)!==0?e===ed?Pr++:(Pr=0,ed=e):Pr=0,Gr(0)}}function og(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,jr(t)))}function Ea(){return ig(),sg(),rg(),ag()}function ag(){if(ut!==5)return!1;var e=mi,t=Jc;Jc=0;var o=vl(Gn),l=O.T,u=q.p;try{q.p=32>o?32:o,O.T=null,o=Xc,Xc=null;var f=mi,b=Gn;if(ut=0,Ls=mi=null,Gn=0,(Me&6)!==0)throw Error(a(331));var R=Me;if(Me|=4,$p(f.current),Wp(f,f.current,b,o),Me=R,Gr(0,!1),Mt&&typeof Mt.onPostCommitFiberRoot=="function")try{Mt.onPostCommitFiberRoot(cr,f)}catch{}return!0}finally{q.p=u,O.T=l,og(e,t)}}function lg(e,t,o){t=Xt(o,t),t=Dc(e.stateNode,t,2),e=ci(e,t,2),e!==null&&(ur(e,2),_n(e))}function Ue(e,t,o){if(e.tag===3)lg(e,e,o);else for(;t!==null;){if(t.tag===3){lg(t,e,o);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(gi===null||!gi.has(l))){e=Xt(o,e),o=cp(2),l=ci(t,o,2),l!==null&&(dp(o,l,t,e),ur(l,2),_n(l));break}}t=t.return}}function id(e,t,o){var l=e.pingCache;if(l===null){l=e.pingCache=new I0;var u=new Set;l.set(t,u)}else u=l.get(t),u===void 0&&(u=new Set,l.set(t,u));u.has(o)||(Yc=!0,u.add(o),e=W0.bind(null,e,t,o),t.then(e,e))}function W0(e,t,o){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&o,e.warmLanes&=~o,Ge===e&&(Te&o)===o&&(Xe===4||Xe===3&&(Te&62914560)===Te&&300>Nt()-ka?(Me&2)===0&&$s(e,0):Kc|=o,Us===Te&&(Us=0)),_n(e)}function cg(e,t){t===0&&(t=nh()),e=qi(e,t),e!==null&&(ur(e,t),_n(e))}function U0(e){var t=e.memoizedState,o=0;t!==null&&(o=t.retryLane),cg(e,o)}function L0(e,t){var o=0;switch(e.tag){case 31:case 13:var l=e.stateNode,u=e.memoizedState;u!==null&&(o=u.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(a(314))}l!==null&&l.delete(t),cg(e,o)}function $0(e,t){return cn(e,t)}var Ta=null,Ps=null,sd=!1,Aa=!1,rd=!1,yi=0;function _n(e){e!==Ps&&e.next===null&&(Ps===null?Ta=Ps=e:Ps=Ps.next=e),Aa=!0,sd||(sd=!0,P0())}function Gr(e,t){if(!rd&&Aa){rd=!0;do for(var o=!1,l=Ta;l!==null;){if(e!==0){var u=l.pendingLanes;if(u===0)var f=0;else{var b=l.suspendedLanes,R=l.pingedLanes;f=(1<<31-qt(42|e)+1)-1,f&=u&~(b&~R),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,fg(l,f))}else f=Te,f=Io(l,l===Ge?f:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(f&3)===0||dr(l,f)||(o=!0,fg(l,f));l=l.next}while(o);rd=!1}}function H0(){dg()}function dg(){Aa=sd=!1;var e=0;yi!==0&&eb()&&(e=yi);for(var t=Nt(),o=null,l=Ta;l!==null;){var u=l.next,f=ug(l,t);f===0?(l.next=null,o===null?Ta=u:o.next=u,u===null&&(Ps=o)):(o=l,(e!==0||(f&3)!==0)&&(Aa=!0)),l=u}ut!==0&&ut!==5||Gr(e),yi!==0&&(yi=0)}function ug(e,t){for(var o=e.suspendedLanes,l=e.pingedLanes,u=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var b=31-qt(f),R=1<<b,N=u[b];N===-1?((R&o)===0||(R&l)!==0)&&(u[b]=my(R,t)):N<=t&&(e.expiredLanes|=R),f&=~R}if(t=Ge,o=Te,o=Io(e,e===t?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,o===0||e===t&&(We===2||We===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&Di(l),e.callbackNode=null,e.callbackPriority=0;if((o&3)===0||dr(e,o)){if(t=o&-o,t===e.callbackPriority)return t;switch(l!==null&&Di(l),vl(o)){case 2:case 8:o=eh;break;case 32:o=Ao;break;case 268435456:o=th;break;default:o=Ao}return l=hg.bind(null,e),o=cn(o,l),e.callbackPriority=t,e.callbackNode=o,t}return l!==null&&l!==null&&Di(l),e.callbackPriority=2,e.callbackNode=null,2}function hg(e,t){if(ut!==0&&ut!==5)return e.callbackNode=null,e.callbackPriority=0,null;var o=e.callbackNode;if(Ea()&&e.callbackNode!==o)return null;var l=Te;return l=Io(e,e===Ge?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(Zp(e,l,t),ug(e,Nt()),e.callbackNode!=null&&e.callbackNode===o?hg.bind(null,e):null)}function fg(e,t){if(Ea())return null;Zp(e,t,!0)}function P0(){nb(function(){(Me&6)!==0?cn(Xu,H0):dg()})}function od(){if(yi===0){var e=Ts;e===0&&(e=zo,zo<<=1,(zo&261888)===0&&(zo=256)),yi=e}return yi}function pg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:qo(""+e)}function gg(e,t){var o=t.ownerDocument.createElement("input");return o.name=t.name,o.value=t.value,e.id&&o.setAttribute("form",e.id),t.parentNode.insertBefore(o,t),e=new FormData(e),o.parentNode.removeChild(o),e}function G0(e,t,o,l,u){if(t==="submit"&&o&&o.stateNode===u){var f=pg((u[Et]||null).action),b=l.submitter;b&&(t=(t=b[Et]||null)?pg(t.formAction):b.getAttribute("formAction"),t!==null&&(f=t,b=null));var R=new $o("action","action",null,l,u);e.push({event:R,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(yi!==0){var N=b?gg(u,b):new FormData(u);Cc(o,{pending:!0,data:N,method:u.method,action:f},null,N)}}else typeof f=="function"&&(R.preventDefault(),N=b?gg(u,b):new FormData(u),Cc(o,{pending:!0,data:N,method:u.method,action:f},f,N))},currentTarget:u}]})}}for(var ad=0;ad<Hl.length;ad++){var ld=Hl[ad],V0=ld.toLowerCase(),Z0=ld[0].toUpperCase()+ld.slice(1);dn(V0,"on"+Z0)}dn(Gh,"onAnimationEnd"),dn(Vh,"onAnimationIteration"),dn(Zh,"onAnimationStart"),dn("dblclick","onDoubleClick"),dn("focusin","onFocus"),dn("focusout","onBlur"),dn(c0,"onTransitionRun"),dn(d0,"onTransitionStart"),dn(u0,"onTransitionCancel"),dn(Fh,"onTransitionEnd"),gs("onMouseEnter",["mouseout","mouseover"]),gs("onMouseLeave",["mouseout","mouseover"]),gs("onPointerEnter",["pointerout","pointerover"]),gs("onPointerLeave",["pointerout","pointerover"]),Ii("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ii("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ii("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ii("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ii("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ii("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F0=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vr));function mg(e,t){t=(t&4)!==0;for(var o=0;o<e.length;o++){var l=e[o],u=l.event;l=l.listeners;e:{var f=void 0;if(t)for(var b=l.length-1;0<=b;b--){var R=l[b],N=R.instance,G=R.currentTarget;if(R=R.listener,N!==f&&u.isPropagationStopped())break e;f=R,u.currentTarget=G;try{f(u)}catch(J){Go(J)}u.currentTarget=null,f=N}else for(b=0;b<l.length;b++){if(R=l[b],N=R.instance,G=R.currentTarget,R=R.listener,N!==f&&u.isPropagationStopped())break e;f=R,u.currentTarget=G;try{f(u)}catch(J){Go(J)}u.currentTarget=null,f=N}}}}function Ee(e,t){var o=t[Sl];o===void 0&&(o=t[Sl]=new Set);var l=e+"__bubble";o.has(l)||(xg(t,e,2,!1),o.add(l))}function cd(e,t,o){var l=0;t&&(l|=4),xg(o,e,l,t)}var za="_reactListening"+Math.random().toString(36).slice(2);function dd(e){if(!e[za]){e[za]=!0,ch.forEach(function(o){o!=="selectionchange"&&(F0.has(o)||cd(o,!1,e),cd(o,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[za]||(t[za]=!0,cd("selectionchange",!1,t))}}function xg(e,t,o,l){switch(Vg(t)){case 2:var u=kb;break;case 8:u=wb;break;default:u=jd}o=u.bind(null,t,o,e),u=void 0,!Al||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(u=!0),l?u!==void 0?e.addEventListener(t,o,{capture:!0,passive:u}):e.addEventListener(t,o,!0):u!==void 0?e.addEventListener(t,o,{passive:u}):e.addEventListener(t,o,!1)}function ud(e,t,o,l,u){var f=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var b=l.tag;if(b===3||b===4){var R=l.stateNode.containerInfo;if(R===u)break;if(b===4)for(b=l.return;b!==null;){var N=b.tag;if((N===3||N===4)&&b.stateNode.containerInfo===u)return;b=b.return}for(;R!==null;){if(b=hs(R),b===null)return;if(N=b.tag,N===5||N===6||N===26||N===27){l=f=b;continue e}R=R.parentNode}}l=l.return}Sh(function(){var G=f,J=El(o),te=[];e:{var V=Yh.get(e);if(V!==void 0){var Y=$o,de=e;switch(e){case"keypress":if(Uo(o)===0)break e;case"keydown":case"keyup":Y=Ly;break;case"focusin":de="focus",Y=Il;break;case"focusout":de="blur",Y=Il;break;case"beforeblur":case"afterblur":Y=Il;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=_h;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=Ty;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=Py;break;case Gh:case Vh:case Zh:Y=Dy;break;case Fh:Y=Vy;break;case"scroll":case"scrollend":Y=Ry;break;case"wheel":Y=Fy;break;case"copy":case"cut":case"paste":Y=Iy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=Ch;break;case"toggle":case"beforetoggle":Y=Ky}var ve=(t&4)!==0,He=!ve&&(e==="scroll"||e==="scrollend"),H=ve?V!==null?V+"Capture":null:V;ve=[];for(var L=G,P;L!==null;){var X=L;if(P=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||P===null||H===null||(X=pr(L,H),X!=null&&ve.push(Zr(L,X,P))),He)break;L=L.return}0<ve.length&&(V=new Y(V,de,null,o,J),te.push({event:V,listeners:ve}))}}if((t&7)===0){e:{if(V=e==="mouseover"||e==="pointerover",Y=e==="mouseout"||e==="pointerout",V&&o!==Rl&&(de=o.relatedTarget||o.fromElement)&&(hs(de)||de[us]))break e;if((Y||V)&&(V=J.window===J?J:(V=J.ownerDocument)?V.defaultView||V.parentWindow:window,Y?(de=o.relatedTarget||o.toElement,Y=G,de=de?hs(de):null,de!==null&&(He=d(de),ve=de.tag,de!==He||ve!==5&&ve!==27&&ve!==6)&&(de=null)):(Y=null,de=G),Y!==de)){if(ve=_h,X="onMouseLeave",H="onMouseEnter",L="mouse",(e==="pointerout"||e==="pointerover")&&(ve=Ch,X="onPointerLeave",H="onPointerEnter",L="pointer"),He=Y==null?V:fr(Y),P=de==null?V:fr(de),V=new ve(X,L+"leave",Y,o,J),V.target=He,V.relatedTarget=P,X=null,hs(J)===G&&(ve=new ve(H,L+"enter",de,o,J),ve.target=P,ve.relatedTarget=He,X=ve),He=X,Y&&de)t:{for(ve=Y0,H=Y,L=de,P=0,X=H;X;X=ve(X))P++;X=0;for(var me=L;me;me=ve(me))X++;for(;0<P-X;)H=ve(H),P--;for(;0<X-P;)L=ve(L),X--;for(;P--;){if(H===L||L!==null&&H===L.alternate){ve=H;break t}H=ve(H),L=ve(L)}ve=null}else ve=null;Y!==null&&yg(te,V,Y,ve,!1),de!==null&&He!==null&&yg(te,He,de,ve,!0)}}e:{if(V=G?fr(G):window,Y=V.nodeName&&V.nodeName.toLowerCase(),Y==="select"||Y==="input"&&V.type==="file")var Ie=Ih;else if(Dh(V))if(Bh)Ie=o0;else{Ie=s0;var he=i0}else Y=V.nodeName,!Y||Y.toLowerCase()!=="input"||V.type!=="checkbox"&&V.type!=="radio"?G&&Cl(G.elementType)&&(Ie=Ih):Ie=r0;if(Ie&&(Ie=Ie(e,G))){Oh(te,Ie,o,J);break e}he&&he(e,V,G),e==="focusout"&&G&&V.type==="number"&&G.memoizedProps.value!=null&&jl(V,"number",V.value)}switch(he=G?fr(G):window,e){case"focusin":(Dh(he)||he.contentEditable==="true")&&(Ss=he,Ul=G,kr=null);break;case"focusout":kr=Ul=Ss=null;break;case"mousedown":Ll=!0;break;case"contextmenu":case"mouseup":case"dragend":Ll=!1,Hh(te,o,J);break;case"selectionchange":if(l0)break;case"keydown":case"keyup":Hh(te,o,J)}var Ce;if(Nl)e:{switch(e){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else vs?Ah(e,o)&&(Ae="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Ae="onCompositionStart");Ae&&(Rh&&o.locale!=="ko"&&(vs||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&vs&&(Ce=kh()):(ni=J,zl="value"in ni?ni.value:ni.textContent,vs=!0)),he=Da(G,Ae),0<he.length&&(Ae=new jh(Ae,e,null,o,J),te.push({event:Ae,listeners:he}),Ce?Ae.data=Ce:(Ce=zh(o),Ce!==null&&(Ae.data=Ce)))),(Ce=Jy?Xy(e,o):e0(e,o))&&(Ae=Da(G,"onBeforeInput"),0<Ae.length&&(he=new jh("onBeforeInput","beforeinput",null,o,J),te.push({event:he,listeners:Ae}),he.data=Ce)),G0(te,e,G,o,J)}mg(te,t)})}function Zr(e,t,o){return{instance:e,listener:t,currentTarget:o}}function Da(e,t){for(var o=t+"Capture",l=[];e!==null;){var u=e,f=u.stateNode;if(u=u.tag,u!==5&&u!==26&&u!==27||f===null||(u=pr(e,o),u!=null&&l.unshift(Zr(e,u,f)),u=pr(e,t),u!=null&&l.push(Zr(e,u,f))),e.tag===3)return l;e=e.return}return[]}function Y0(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function yg(e,t,o,l,u){for(var f=t._reactName,b=[];o!==null&&o!==l;){var R=o,N=R.alternate,G=R.stateNode;if(R=R.tag,N!==null&&N===l)break;R!==5&&R!==26&&R!==27||G===null||(N=G,u?(G=pr(o,f),G!=null&&b.unshift(Zr(o,G,N))):u||(G=pr(o,f),G!=null&&b.push(Zr(o,G,N)))),o=o.return}b.length!==0&&e.push({event:t,listeners:b})}var K0=/\r\n?/g,Q0=/\u0000|\uFFFD/g;function bg(e){return(typeof e=="string"?e:""+e).replace(K0,`
`).replace(Q0,"")}function vg(e,t){return t=bg(t),bg(e)===t}function $e(e,t,o,l,u,f){switch(o){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||xs(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&xs(e,""+l);break;case"className":No(e,"class",l);break;case"tabIndex":No(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":No(e,o,l);break;case"style":bh(e,l,f);break;case"data":if(t!=="object"){No(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||o!=="href")){e.removeAttribute(o);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(o);break}l=qo(""+l),e.setAttribute(o,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(t!=="input"&&$e(e,t,"name",u.name,u,null),$e(e,t,"formEncType",u.formEncType,u,null),$e(e,t,"formMethod",u.formMethod,u,null),$e(e,t,"formTarget",u.formTarget,u,null)):($e(e,t,"encType",u.encType,u,null),$e(e,t,"method",u.method,u,null),$e(e,t,"target",u.target,u,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(o);break}l=qo(""+l),e.setAttribute(o,l);break;case"onClick":l!=null&&(e.onclick=An);break;case"onScroll":l!=null&&Ee("scroll",e);break;case"onScrollEnd":l!=null&&Ee("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(a(61));if(o=l.__html,o!=null){if(u.children!=null)throw Error(a(60));e.innerHTML=o}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}o=qo(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(o,""+l):e.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(o,""):e.removeAttribute(o);break;case"capture":case"download":l===!0?e.setAttribute(o,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(o,l):e.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(o,l):e.removeAttribute(o);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(o):e.setAttribute(o,l);break;case"popover":Ee("beforetoggle",e),Ee("toggle",e),Bo(e,"popover",l);break;case"xlinkActuate":Tn(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Tn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Tn(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Tn(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Tn(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Tn(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Tn(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Tn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Tn(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Bo(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=jy.get(o)||o,Bo(e,o,l))}}function hd(e,t,o,l,u,f){switch(o){case"style":bh(e,l,f);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(a(61));if(o=l.__html,o!=null){if(u.children!=null)throw Error(a(60));e.innerHTML=o}}break;case"children":typeof l=="string"?xs(e,l):(typeof l=="number"||typeof l=="bigint")&&xs(e,""+l);break;case"onScroll":l!=null&&Ee("scroll",e);break;case"onScrollEnd":l!=null&&Ee("scrollend",e);break;case"onClick":l!=null&&(e.onclick=An);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!dh.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(u=o.endsWith("Capture"),t=o.slice(2,u?o.length-7:void 0),f=e[Et]||null,f=f!=null?f[o]:null,typeof f=="function"&&e.removeEventListener(t,f,u),typeof l=="function")){typeof f!="function"&&f!==null&&(o in e?e[o]=null:e.hasAttribute(o)&&e.removeAttribute(o)),e.addEventListener(t,l,u);break e}o in e?e[o]=l:l===!0?e.setAttribute(o,""):Bo(e,o,l)}}}function bt(e,t,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ee("error",e),Ee("load",e);var l=!1,u=!1,f;for(f in o)if(o.hasOwnProperty(f)){var b=o[f];if(b!=null)switch(f){case"src":l=!0;break;case"srcSet":u=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:$e(e,t,f,b,o,null)}}u&&$e(e,t,"srcSet",o.srcSet,o,null),l&&$e(e,t,"src",o.src,o,null);return;case"input":Ee("invalid",e);var R=f=b=u=null,N=null,G=null;for(l in o)if(o.hasOwnProperty(l)){var J=o[l];if(J!=null)switch(l){case"name":u=J;break;case"type":b=J;break;case"checked":N=J;break;case"defaultChecked":G=J;break;case"value":f=J;break;case"defaultValue":R=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(a(137,t));break;default:$e(e,t,l,J,o,null)}}gh(e,f,R,N,G,b,u,!1);return;case"select":Ee("invalid",e),l=b=f=null;for(u in o)if(o.hasOwnProperty(u)&&(R=o[u],R!=null))switch(u){case"value":f=R;break;case"defaultValue":b=R;break;case"multiple":l=R;default:$e(e,t,u,R,o,null)}t=f,o=b,e.multiple=!!l,t!=null?ms(e,!!l,t,!1):o!=null&&ms(e,!!l,o,!0);return;case"textarea":Ee("invalid",e),f=u=l=null;for(b in o)if(o.hasOwnProperty(b)&&(R=o[b],R!=null))switch(b){case"value":l=R;break;case"defaultValue":u=R;break;case"children":f=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(a(91));break;default:$e(e,t,b,R,o,null)}xh(e,l,u,f);return;case"option":for(N in o)o.hasOwnProperty(N)&&(l=o[N],l!=null)&&(N==="selected"?e.selected=l&&typeof l!="function"&&typeof l!="symbol":$e(e,t,N,l,o,null));return;case"dialog":Ee("beforetoggle",e),Ee("toggle",e),Ee("cancel",e),Ee("close",e);break;case"iframe":case"object":Ee("load",e);break;case"video":case"audio":for(l=0;l<Vr.length;l++)Ee(Vr[l],e);break;case"image":Ee("error",e),Ee("load",e);break;case"details":Ee("toggle",e);break;case"embed":case"source":case"link":Ee("error",e),Ee("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(G in o)if(o.hasOwnProperty(G)&&(l=o[G],l!=null))switch(G){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:$e(e,t,G,l,o,null)}return;default:if(Cl(t)){for(J in o)o.hasOwnProperty(J)&&(l=o[J],l!==void 0&&hd(e,t,J,l,o,void 0));return}}for(R in o)o.hasOwnProperty(R)&&(l=o[R],l!=null&&$e(e,t,R,l,o,null))}function J0(e,t,o,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var u=null,f=null,b=null,R=null,N=null,G=null,J=null;for(Y in o){var te=o[Y];if(o.hasOwnProperty(Y)&&te!=null)switch(Y){case"checked":break;case"value":break;case"defaultValue":N=te;default:l.hasOwnProperty(Y)||$e(e,t,Y,null,l,te)}}for(var V in l){var Y=l[V];if(te=o[V],l.hasOwnProperty(V)&&(Y!=null||te!=null))switch(V){case"type":f=Y;break;case"name":u=Y;break;case"checked":G=Y;break;case"defaultChecked":J=Y;break;case"value":b=Y;break;case"defaultValue":R=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(a(137,t));break;default:Y!==te&&$e(e,t,V,Y,l,te)}}_l(e,b,R,N,G,J,f,u);return;case"select":Y=b=R=V=null;for(f in o)if(N=o[f],o.hasOwnProperty(f)&&N!=null)switch(f){case"value":break;case"multiple":Y=N;default:l.hasOwnProperty(f)||$e(e,t,f,null,l,N)}for(u in l)if(f=l[u],N=o[u],l.hasOwnProperty(u)&&(f!=null||N!=null))switch(u){case"value":V=f;break;case"defaultValue":R=f;break;case"multiple":b=f;default:f!==N&&$e(e,t,u,f,l,N)}t=R,o=b,l=Y,V!=null?ms(e,!!o,V,!1):!!l!=!!o&&(t!=null?ms(e,!!o,t,!0):ms(e,!!o,o?[]:"",!1));return;case"textarea":Y=V=null;for(R in o)if(u=o[R],o.hasOwnProperty(R)&&u!=null&&!l.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:$e(e,t,R,null,l,u)}for(b in l)if(u=l[b],f=o[b],l.hasOwnProperty(b)&&(u!=null||f!=null))switch(b){case"value":V=u;break;case"defaultValue":Y=u;break;case"children":break;case"dangerouslySetInnerHTML":if(u!=null)throw Error(a(91));break;default:u!==f&&$e(e,t,b,u,l,f)}mh(e,V,Y);return;case"option":for(var de in o)V=o[de],o.hasOwnProperty(de)&&V!=null&&!l.hasOwnProperty(de)&&(de==="selected"?e.selected=!1:$e(e,t,de,null,l,V));for(N in l)V=l[N],Y=o[N],l.hasOwnProperty(N)&&V!==Y&&(V!=null||Y!=null)&&(N==="selected"?e.selected=V&&typeof V!="function"&&typeof V!="symbol":$e(e,t,N,V,l,Y));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ve in o)V=o[ve],o.hasOwnProperty(ve)&&V!=null&&!l.hasOwnProperty(ve)&&$e(e,t,ve,null,l,V);for(G in l)if(V=l[G],Y=o[G],l.hasOwnProperty(G)&&V!==Y&&(V!=null||Y!=null))switch(G){case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(a(137,t));break;default:$e(e,t,G,V,l,Y)}return;default:if(Cl(t)){for(var He in o)V=o[He],o.hasOwnProperty(He)&&V!==void 0&&!l.hasOwnProperty(He)&&hd(e,t,He,void 0,l,V);for(J in l)V=l[J],Y=o[J],!l.hasOwnProperty(J)||V===Y||V===void 0&&Y===void 0||hd(e,t,J,V,l,Y);return}}for(var H in o)V=o[H],o.hasOwnProperty(H)&&V!=null&&!l.hasOwnProperty(H)&&$e(e,t,H,null,l,V);for(te in l)V=l[te],Y=o[te],!l.hasOwnProperty(te)||V===Y||V==null&&Y==null||$e(e,t,te,V,l,Y)}function Sg(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function X0(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,o=performance.getEntriesByType("resource"),l=0;l<o.length;l++){var u=o[l],f=u.transferSize,b=u.initiatorType,R=u.duration;if(f&&R&&Sg(b)){for(b=0,R=u.responseEnd,l+=1;l<o.length;l++){var N=o[l],G=N.startTime;if(G>R)break;var J=N.transferSize,te=N.initiatorType;J&&Sg(te)&&(N=N.responseEnd,b+=J*(N<R?1:(R-G)/(N-G)))}if(--l,t+=8*(f+b)/(u.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var fd=null,pd=null;function Oa(e){return e.nodeType===9?e:e.ownerDocument}function kg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wg(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function gd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var md=null;function eb(){var e=window.event;return e&&e.type==="popstate"?e===md?!1:(md=e,!0):(md=null,!1)}var _g=typeof setTimeout=="function"?setTimeout:void 0,tb=typeof clearTimeout=="function"?clearTimeout:void 0,jg=typeof Promise=="function"?Promise:void 0,nb=typeof queueMicrotask=="function"?queueMicrotask:typeof jg<"u"?function(e){return jg.resolve(null).then(e).catch(ib)}:_g;function ib(e){setTimeout(function(){throw e})}function bi(e){return e==="head"}function Cg(e,t){var o=t,l=0;do{var u=o.nextSibling;if(e.removeChild(o),u&&u.nodeType===8)if(o=u.data,o==="/$"||o==="/&"){if(l===0){e.removeChild(u),Fs(t);return}l--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")l++;else if(o==="html")Fr(e.ownerDocument.documentElement);else if(o==="head"){o=e.ownerDocument.head,Fr(o);for(var f=o.firstChild;f;){var b=f.nextSibling,R=f.nodeName;f[hr]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=b}}else o==="body"&&Fr(e.ownerDocument.body);o=u}while(o);Fs(t)}function Rg(e,t){var o=e;e=0;do{var l=o.nextSibling;if(o.nodeType===1?t?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(t?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),l&&l.nodeType===8)if(o=l.data,o==="/$"){if(e===0)break;e--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||e++;o=l}while(o)}function xd(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var o=t;switch(t=t.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":xd(o),kl(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}e.removeChild(o)}}function sb(e,t,o,l){for(;e.nodeType===1;){var u=o;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[hr])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==u.rel||e.getAttribute("href")!==(u.href==null||u.href===""?null:u.href)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin)||e.getAttribute("title")!==(u.title==null?null:u.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(u.src==null?null:u.src)||e.getAttribute("type")!==(u.type==null?null:u.type)||e.getAttribute("crossorigin")!==(u.crossOrigin==null?null:u.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=u.name==null?null:""+u.name;if(u.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=rn(e.nextSibling),e===null)break}return null}function rb(e,t,o){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!o||(e=rn(e.nextSibling),e===null))return null;return e}function Eg(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=rn(e.nextSibling),e===null))return null;return e}function yd(e){return e.data==="$?"||e.data==="$~"}function bd(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function ob(e,t){var o=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||o.readyState!=="loading")t();else{var l=function(){t(),o.removeEventListener("DOMContentLoaded",l)};o.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function rn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var vd=null;function Tg(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"||o==="/&"){if(t===0)return rn(e.nextSibling);t--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||t++}e=e.nextSibling}return null}function Ag(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(t===0)return e;t--}else o!=="/$"&&o!=="/&"||t++}e=e.previousSibling}return null}function zg(e,t,o){switch(t=Oa(o),e){case"html":if(e=t.documentElement,!e)throw Error(a(452));return e;case"head":if(e=t.head,!e)throw Error(a(453));return e;case"body":if(e=t.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function Fr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);kl(e)}var on=new Map,Dg=new Set;function Ia(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Vn=q.d;q.d={f:ab,r:lb,D:cb,C:db,L:ub,m:hb,X:pb,S:fb,M:gb};function ab(){var e=Vn.f(),t=ja();return e||t}function lb(e){var t=fs(e);t!==null&&t.tag===5&&t.type==="form"?Yf(t):Vn.r(e)}var Gs=typeof document>"u"?null:document;function Og(e,t,o){var l=Gs;if(l&&typeof t=="string"&&t){var u=Qt(t);u='link[rel="'+e+'"][href="'+u+'"]',typeof o=="string"&&(u+='[crossorigin="'+o+'"]'),Dg.has(u)||(Dg.add(u),e={rel:e,crossOrigin:o,href:t},l.querySelector(u)===null&&(t=l.createElement("link"),bt(t,"link",e),ft(t),l.head.appendChild(t)))}}function cb(e){Vn.D(e),Og("dns-prefetch",e,null)}function db(e,t){Vn.C(e,t),Og("preconnect",e,t)}function ub(e,t,o){Vn.L(e,t,o);var l=Gs;if(l&&e&&t){var u='link[rel="preload"][as="'+Qt(t)+'"]';t==="image"&&o&&o.imageSrcSet?(u+='[imagesrcset="'+Qt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(u+='[imagesizes="'+Qt(o.imageSizes)+'"]')):u+='[href="'+Qt(e)+'"]';var f=u;switch(t){case"style":f=Vs(e);break;case"script":f=Zs(e)}on.has(f)||(e=k({rel:"preload",href:t==="image"&&o&&o.imageSrcSet?void 0:e,as:t},o),on.set(f,e),l.querySelector(u)!==null||t==="style"&&l.querySelector(Yr(f))||t==="script"&&l.querySelector(Kr(f))||(t=l.createElement("link"),bt(t,"link",e),ft(t),l.head.appendChild(t)))}}function hb(e,t){Vn.m(e,t);var o=Gs;if(o&&e){var l=t&&typeof t.as=="string"?t.as:"script",u='link[rel="modulepreload"][as="'+Qt(l)+'"][href="'+Qt(e)+'"]',f=u;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Zs(e)}if(!on.has(f)&&(e=k({rel:"modulepreload",href:e},t),on.set(f,e),o.querySelector(u)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Kr(f)))return}l=o.createElement("link"),bt(l,"link",e),ft(l),o.head.appendChild(l)}}}function fb(e,t,o){Vn.S(e,t,o);var l=Gs;if(l&&e){var u=ps(l).hoistableStyles,f=Vs(e);t=t||"default";var b=u.get(f);if(!b){var R={loading:0,preload:null};if(b=l.querySelector(Yr(f)))R.loading=5;else{e=k({rel:"stylesheet",href:e,"data-precedence":t},o),(o=on.get(f))&&Sd(e,o);var N=b=l.createElement("link");ft(N),bt(N,"link",e),N._p=new Promise(function(G,J){N.onload=G,N.onerror=J}),N.addEventListener("load",function(){R.loading|=1}),N.addEventListener("error",function(){R.loading|=2}),R.loading|=4,Ba(b,t,l)}b={type:"stylesheet",instance:b,count:1,state:R},u.set(f,b)}}}function pb(e,t){Vn.X(e,t);var o=Gs;if(o&&e){var l=ps(o).hoistableScripts,u=Zs(e),f=l.get(u);f||(f=o.querySelector(Kr(u)),f||(e=k({src:e,async:!0},t),(t=on.get(u))&&kd(e,t),f=o.createElement("script"),ft(f),bt(f,"link",e),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(u,f))}}function gb(e,t){Vn.M(e,t);var o=Gs;if(o&&e){var l=ps(o).hoistableScripts,u=Zs(e),f=l.get(u);f||(f=o.querySelector(Kr(u)),f||(e=k({src:e,async:!0,type:"module"},t),(t=on.get(u))&&kd(e,t),f=o.createElement("script"),ft(f),bt(f,"link",e),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},l.set(u,f))}}function Ig(e,t,o,l){var u=(u=ce.current)?Ia(u):null;if(!u)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(t=Vs(o.href),o=ps(u).hoistableStyles,l=o.get(t),l||(l={type:"style",instance:null,count:0,state:null},o.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){e=Vs(o.href);var f=ps(u).hoistableStyles,b=f.get(e);if(b||(u=u.ownerDocument||u,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,b),(f=u.querySelector(Yr(e)))&&!f._p&&(b.instance=f,b.state.loading=5),on.has(e)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},on.set(e,o),f||mb(u,e,o,b.state))),t&&l===null)throw Error(a(528,""));return b}if(t&&l!==null)throw Error(a(529,""));return null;case"script":return t=o.async,o=o.src,typeof o=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Zs(o),o=ps(u).hoistableScripts,l=o.get(t),l||(l={type:"script",instance:null,count:0,state:null},o.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Vs(e){return'href="'+Qt(e)+'"'}function Yr(e){return'link[rel="stylesheet"]['+e+"]"}function Bg(e){return k({},e,{"data-precedence":e.precedence,precedence:null})}function mb(e,t,o,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),bt(t,"link",o),ft(t),e.head.appendChild(t))}function Zs(e){return'[src="'+Qt(e)+'"]'}function Kr(e){return"script[async]"+e}function Ng(e,t,o){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+Qt(o.href)+'"]');if(l)return t.instance=l,ft(l),l;var u=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),ft(l),bt(l,"style",u),Ba(l,o.precedence,e),t.instance=l;case"stylesheet":u=Vs(o.href);var f=e.querySelector(Yr(u));if(f)return t.state.loading|=4,t.instance=f,ft(f),f;l=Bg(o),(u=on.get(u))&&Sd(l,u),f=(e.ownerDocument||e).createElement("link"),ft(f);var b=f;return b._p=new Promise(function(R,N){b.onload=R,b.onerror=N}),bt(f,"link",l),t.state.loading|=4,Ba(f,o.precedence,e),t.instance=f;case"script":return f=Zs(o.src),(u=e.querySelector(Kr(f)))?(t.instance=u,ft(u),u):(l=o,(u=on.get(f))&&(l=k({},o),kd(l,u)),e=e.ownerDocument||e,u=e.createElement("script"),ft(u),bt(u,"link",l),e.head.appendChild(u),t.instance=u);case"void":return null;default:throw Error(a(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,Ba(l,o.precedence,e));return t.instance}function Ba(e,t,o){for(var l=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),u=l.length?l[l.length-1]:null,f=u,b=0;b<l.length;b++){var R=l[b];if(R.dataset.precedence===t)f=R;else if(f!==u)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=o.nodeType===9?o.head:o,t.insertBefore(e,t.firstChild))}function Sd(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function kd(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Na=null;function Mg(e,t,o){if(Na===null){var l=new Map,u=Na=new Map;u.set(o,l)}else u=Na,l=u.get(o),l||(l=new Map,u.set(o,l));if(l.has(e))return l;for(l.set(e,null),o=o.getElementsByTagName(e),u=0;u<o.length;u++){var f=o[u];if(!(f[hr]||f[gt]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var b=f.getAttribute(t)||"";b=e+b;var R=l.get(b);R?R.push(f):l.set(b,[f])}}return l}function qg(e,t,o){e=e.ownerDocument||e,e.head.insertBefore(o,t==="title"?e.querySelector("head > title"):null)}function xb(e,t,o){if(o===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Wg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function yb(e,t,o,l){if(o.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var u=Vs(l.href),f=t.querySelector(Yr(u));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Ma.bind(e),t.then(e,e)),o.state.loading|=4,o.instance=f,ft(f);return}f=t.ownerDocument||t,l=Bg(l),(u=on.get(u))&&Sd(l,u),f=f.createElement("link"),ft(f);var b=f;b._p=new Promise(function(R,N){b.onload=R,b.onerror=N}),bt(f,"link",l),o.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(o,t),(t=o.state.preload)&&(o.state.loading&3)===0&&(e.count++,o=Ma.bind(e),t.addEventListener("load",o),t.addEventListener("error",o))}}var wd=0;function bb(e,t){return e.stylesheets&&e.count===0&&Wa(e,e.stylesheets),0<e.count||0<e.imgCount?function(o){var l=setTimeout(function(){if(e.stylesheets&&Wa(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&wd===0&&(wd=62500*X0());var u=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Wa(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>wd?50:800)+t);return e.unsuspend=o,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(u)}}:null}function Ma(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wa(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var qa=null;function Wa(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,qa=new Map,t.forEach(vb,e),qa=null,Ma.call(e))}function vb(e,t){if(!(t.state.loading&4)){var o=qa.get(e);if(o)var l=o.get(null);else{o=new Map,qa.set(e,o);for(var u=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<u.length;f++){var b=u[f];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(o.set(b.dataset.precedence,b),l=b)}l&&o.set(null,l)}u=t.instance,b=u.getAttribute("data-precedence"),f=o.get(b)||l,f===l&&o.set(null,u),o.set(b,u),this.count++,l=Ma.bind(this),u.addEventListener("load",l),u.addEventListener("error",l),f?f.parentNode.insertBefore(u,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(u,e.firstChild)),t.state.loading|=4}}var Qr={$$typeof:y,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function Sb(e,t,o,l,u,f,b,R,N){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yl(0),this.hiddenUpdates=yl(null),this.identifierPrefix=l,this.onUncaughtError=u,this.onCaughtError=f,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function Ug(e,t,o,l,u,f,b,R,N,G,J,te){return e=new Sb(e,t,o,b,N,G,J,te,R),t=1,f===!0&&(t|=24),f=Ut(3,null,null,t),e.current=f,f.stateNode=e,t=nc(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:l,isDehydrated:o,cache:t},oc(f),e}function Lg(e){return e?(e=_s,e):_s}function $g(e,t,o,l,u,f){u=Lg(u),l.context===null?l.context=u:l.pendingContext=u,l=li(t),l.payload={element:o},f=f===void 0?null:f,f!==null&&(l.callback=f),o=ci(e,l,t),o!==null&&(It(o,e,t),Tr(o,e,t))}function Hg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<t?o:t}}function _d(e,t){Hg(e,t),(e=e.alternate)&&Hg(e,t)}function Pg(e){if(e.tag===13||e.tag===31){var t=qi(e,67108864);t!==null&&It(t,e,67108864),_d(e,67108864)}}function Gg(e){if(e.tag===13||e.tag===31){var t=Gt();t=bl(t);var o=qi(e,t);o!==null&&It(o,e,t),_d(e,t)}}var Ua=!0;function kb(e,t,o,l){var u=O.T;O.T=null;var f=q.p;try{q.p=2,jd(e,t,o,l)}finally{q.p=f,O.T=u}}function wb(e,t,o,l){var u=O.T;O.T=null;var f=q.p;try{q.p=8,jd(e,t,o,l)}finally{q.p=f,O.T=u}}function jd(e,t,o,l){if(Ua){var u=Cd(l);if(u===null)ud(e,t,l,La,o),Zg(e,l);else if(jb(u,e,t,o,l))l.stopPropagation();else if(Zg(e,l),t&4&&-1<_b.indexOf(e)){for(;u!==null;){var f=fs(u);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var b=Oi(f.pendingLanes);if(b!==0){var R=f;for(R.pendingLanes|=2,R.entangledLanes|=2;b;){var N=1<<31-qt(b);R.entanglements[1]|=N,b&=~N}_n(f),(Me&6)===0&&(wa=Nt()+500,Gr(0))}}break;case 31:case 13:R=qi(f,2),R!==null&&It(R,f,2),ja(),_d(f,2)}if(f=Cd(l),f===null&&ud(e,t,l,La,o),f===u)break;u=f}u!==null&&l.stopPropagation()}else ud(e,t,l,null,o)}}function Cd(e){return e=El(e),Rd(e)}var La=null;function Rd(e){if(La=null,e=hs(e),e!==null){var t=d(e);if(t===null)e=null;else{var o=t.tag;if(o===13){if(e=h(t),e!==null)return e;e=null}else if(o===31){if(e=p(t),e!==null)return e;e=null}else if(o===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return La=e,null}function Vg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(cy()){case Xu:return 2;case eh:return 8;case Ao:case dy:return 32;case th:return 268435456;default:return 32}default:return 32}}var Ed=!1,vi=null,Si=null,ki=null,Jr=new Map,Xr=new Map,wi=[],_b="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Zg(e,t){switch(e){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":Si=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":Jr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xr.delete(t.pointerId)}}function eo(e,t,o,l,u,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:o,eventSystemFlags:l,nativeEvent:f,targetContainers:[u]},t!==null&&(t=fs(t),t!==null&&Pg(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,u!==null&&t.indexOf(u)===-1&&t.push(u),e)}function jb(e,t,o,l,u){switch(t){case"focusin":return vi=eo(vi,e,t,o,l,u),!0;case"dragenter":return Si=eo(Si,e,t,o,l,u),!0;case"mouseover":return ki=eo(ki,e,t,o,l,u),!0;case"pointerover":var f=u.pointerId;return Jr.set(f,eo(Jr.get(f)||null,e,t,o,l,u)),!0;case"gotpointercapture":return f=u.pointerId,Xr.set(f,eo(Xr.get(f)||null,e,t,o,l,u)),!0}return!1}function Fg(e){var t=hs(e.target);if(t!==null){var o=d(t);if(o!==null){if(t=o.tag,t===13){if(t=h(o),t!==null){e.blockedOn=t,ah(e.priority,function(){Gg(o)});return}}else if(t===31){if(t=p(o),t!==null){e.blockedOn=t,ah(e.priority,function(){Gg(o)});return}}else if(t===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $a(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var o=Cd(e.nativeEvent);if(o===null){o=e.nativeEvent;var l=new o.constructor(o.type,o);Rl=l,o.target.dispatchEvent(l),Rl=null}else return t=fs(o),t!==null&&Pg(t),e.blockedOn=o,!1;t.shift()}return!0}function Yg(e,t,o){$a(e)&&o.delete(t)}function Cb(){Ed=!1,vi!==null&&$a(vi)&&(vi=null),Si!==null&&$a(Si)&&(Si=null),ki!==null&&$a(ki)&&(ki=null),Jr.forEach(Yg),Xr.forEach(Yg)}function Ha(e,t){e.blockedOn===t&&(e.blockedOn=null,Ed||(Ed=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Cb)))}var Pa=null;function Kg(e){Pa!==e&&(Pa=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Pa===e&&(Pa=null);for(var t=0;t<e.length;t+=3){var o=e[t],l=e[t+1],u=e[t+2];if(typeof l!="function"){if(Rd(l||o)===null)continue;break}var f=fs(o);f!==null&&(e.splice(t,3),t-=3,Cc(f,{pending:!0,data:u,method:o.method,action:l},l,u))}}))}function Fs(e){function t(N){return Ha(N,e)}vi!==null&&Ha(vi,e),Si!==null&&Ha(Si,e),ki!==null&&Ha(ki,e),Jr.forEach(t),Xr.forEach(t);for(var o=0;o<wi.length;o++){var l=wi[o];l.blockedOn===e&&(l.blockedOn=null)}for(;0<wi.length&&(o=wi[0],o.blockedOn===null);)Fg(o),o.blockedOn===null&&wi.shift();if(o=(e.ownerDocument||e).$$reactFormReplay,o!=null)for(l=0;l<o.length;l+=3){var u=o[l],f=o[l+1],b=u[Et]||null;if(typeof f=="function")b||Kg(o);else if(b){var R=null;if(f&&f.hasAttribute("formAction")){if(u=f,b=f[Et]||null)R=b.formAction;else if(Rd(u)!==null)continue}else R=b.action;typeof R=="function"?o[l+1]=R:(o.splice(l,3),l-=3),Kg(o)}}}function Qg(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(b){return u=b})},focusReset:"manual",scroll:"manual"})}function t(){u!==null&&(u(),u=null),l||setTimeout(o,20)}function o(){if(!l&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,u=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(o,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),u!==null&&(u(),u=null)}}}function Td(e){this._internalRoot=e}Ga.prototype.render=Td.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(a(409));var o=t.current,l=Gt();$g(o,l,e,t,null,null)},Ga.prototype.unmount=Td.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;$g(e.current,2,null,e,null,null),ja(),t[us]=null}};function Ga(e){this._internalRoot=e}Ga.prototype.unstable_scheduleHydration=function(e){if(e){var t=oh();e={blockedOn:null,target:e,priority:t};for(var o=0;o<wi.length&&t!==0&&t<wi[o].priority;o++);wi.splice(o,0,e),o===0&&Fg(e)}};var Jg=i.version;if(Jg!=="19.2.3")throw Error(a(527,Jg,"19.2.3"));q.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(t),e=e!==null?x(e):null,e=e===null?null:e.stateNode,e};var Rb={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Va=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Va.isDisabled&&Va.supportsFiber)try{cr=Va.inject(Rb),Mt=Va}catch{}}return no.createRoot=function(e,t){if(!c(e))throw Error(a(299));var o=!1,l="",u=rp,f=op,b=ap;return t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(u=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(b=t.onRecoverableError)),t=Ug(e,1,!1,null,null,o,l,null,u,f,b,Qg),e[us]=t.current,dd(e),new Td(t)},no.hydrateRoot=function(e,t,o){if(!c(e))throw Error(a(299));var l=!1,u="",f=rp,b=op,R=ap,N=null;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(u=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(R=o.onRecoverableError),o.formState!==void 0&&(N=o.formState)),t=Ug(e,1,!0,t,o??null,l,u,N,f,b,R,Qg),t.context=Lg(null),o=t.current,l=Gt(),l=bl(l),u=li(l),u.callback=null,ci(o,u,l),o=l,t.current.lanes=o,ur(t,o),_n(t),e[us]=t.current,dd(e),new Ga(t)},no.version="19.2.3",no}var lm;function Mb(){if(lm)return Dd.exports;lm=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(i){console.error(i)}}return n(),Dd.exports=Nb(),Dd.exports}var qb=Mb();var cm="popstate";function Wb(n={}){function i(a,c){let{pathname:d,search:h,hash:p}=a.location;return hu("",{pathname:d,search:h,hash:p},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function r(a,c){return typeof c=="string"?c:po(c)}return Lb(i,r,null,n)}function Qe(n,i){if(n===!1||n===null||typeof n>"u")throw new Error(i)}function vn(n,i){if(!n){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function Ub(){return Math.random().toString(36).substring(2,10)}function dm(n,i){return{usr:n.state,key:n.key,idx:i}}function hu(n,i,r=null,a){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof i=="string"?ar(i):i,state:r,key:i&&i.key||a||Ub()}}function po({pathname:n="/",search:i="",hash:r=""}){return i&&i!=="?"&&(n+=i.charAt(0)==="?"?i:"?"+i),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function ar(n){let i={};if(n){let r=n.indexOf("#");r>=0&&(i.hash=n.substring(r),n=n.substring(0,r));let a=n.indexOf("?");a>=0&&(i.search=n.substring(a),n=n.substring(0,a)),n&&(i.pathname=n)}return i}function Lb(n,i,r,a={}){let{window:c=document.defaultView,v5Compat:d=!1}=a,h=c.history,p="POP",g=null,m=x();m==null&&(m=0,h.replaceState({...h.state,idx:m},""));function x(){return(h.state||{idx:null}).idx}function k(){p="POP";let A=x(),z=A==null?null:A-m;m=A,g&&g({action:p,location:j.location,delta:z})}function S(A,z){p="PUSH";let D=hu(j.location,A,z);m=x()+1;let y=dm(D,m),C=j.createHref(D);try{h.pushState(y,"",C)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;c.location.assign(C)}d&&g&&g({action:p,location:j.location,delta:1})}function _(A,z){p="REPLACE";let D=hu(j.location,A,z);m=x();let y=dm(D,m),C=j.createHref(D);h.replaceState(y,"",C),d&&g&&g({action:p,location:j.location,delta:0})}function w(A){return $b(A)}let j={get action(){return p},get location(){return n(c,h)},listen(A){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(cm,k),g=A,()=>{c.removeEventListener(cm,k),g=null}},createHref(A){return i(c,A)},createURL:w,encodeLocation(A){let z=w(A);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:S,replace:_,go(A){return h.go(A)}};return j}function $b(n,i=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Qe(r,"No window.location.(origin|href) available to create URL");let a=typeof n=="string"?n:po(n);return a=a.replace(/ $/,"%20"),!i&&a.startsWith("//")&&(a=r+a),new URL(a,r)}function sx(n,i,r="/"){return Hb(n,i,r,!1)}function Hb(n,i,r,a){let c=typeof i=="string"?ar(i):i,d=Kn(c.pathname||"/",r);if(d==null)return null;let h=rx(n);Pb(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let m=tv(d);p=Xb(h[g],m,a)}return p}function rx(n,i=[],r=[],a="",c=!1){let d=(h,p,g=c,m)=>{let x={relativePath:m===void 0?h.path||"":m,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(a)&&g)return;Qe(x.relativePath.startsWith(a),`Absolute route path "${x.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(a.length)}let k=Yn([a,x.relativePath]),S=r.concat(x);h.children&&h.children.length>0&&(Qe(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),rx(h.children,i,S,k,g)),!(h.path==null&&!h.index)&&i.push({path:k,score:Qb(k,h.index),routesMeta:S})};return n.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))d(h,p);else for(let g of ox(h.path))d(h,p,!0,g)}),i}function ox(n){let i=n.split("/");if(i.length===0)return[];let[r,...a]=i,c=r.endsWith("?"),d=r.replace(/\?$/,"");if(a.length===0)return c?[d,""]:[d];let h=ox(a.join("/")),p=[];return p.push(...h.map(g=>g===""?d:[d,g].join("/"))),c&&p.push(...h),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function Pb(n){n.sort((i,r)=>i.score!==r.score?r.score-i.score:Jb(i.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var Gb=/^:[\w-]+$/,Vb=3,Zb=2,Fb=1,Yb=10,Kb=-2,um=n=>n==="*";function Qb(n,i){let r=n.split("/"),a=r.length;return r.some(um)&&(a+=Kb),i&&(a+=Zb),r.filter(c=>!um(c)).reduce((c,d)=>c+(Gb.test(d)?Vb:d===""?Fb:Yb),a)}function Jb(n,i){return n.length===i.length&&n.slice(0,-1).every((a,c)=>a===i[c])?n[n.length-1]-i[i.length-1]:0}function Xb(n,i,r=!1){let{routesMeta:a}=n,c={},d="/",h=[];for(let p=0;p<a.length;++p){let g=a[p],m=p===a.length-1,x=d==="/"?i:i.slice(d.length)||"/",k=sl({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},x),S=g.route;if(!k&&m&&r&&!a[a.length-1].route.index&&(k=sl({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!k)return null;Object.assign(c,k.params),h.push({params:c,pathname:Yn([d,k.pathname]),pathnameBase:rv(Yn([d,k.pathnameBase])),route:S}),k.pathnameBase!=="/"&&(d=Yn([d,k.pathnameBase]))}return h}function sl(n,i){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[r,a]=ev(n.path,n.caseSensitive,n.end),c=i.match(r);if(!c)return null;let d=c[0],h=d.replace(/(.)\/+$/,"$1"),p=c.slice(1);return{params:a.reduce((m,{paramName:x,isOptional:k},S)=>{if(x==="*"){let w=p[S]||"";h=d.slice(0,d.length-w.length).replace(/(.)\/+$/,"$1")}const _=p[S];return k&&!_?m[x]=void 0:m[x]=(_||"").replace(/%2F/g,"/"),m},{}),pathname:d,pathnameBase:h,pattern:n}}function ev(n,i=!1,r=!0){vn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let a=[],c="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(a.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(a.push({paramName:"*"}),c+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?c+="\\/*$":n!==""&&n!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,i?void 0:"i"),a]}function tv(n){try{return n.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return vn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${i}).`),n}}function Kn(n,i){if(i==="/")return n;if(!n.toLowerCase().startsWith(i.toLowerCase()))return null;let r=i.endsWith("/")?i.length-1:i.length,a=n.charAt(r);return a&&a!=="/"?null:n.slice(r)||"/"}var ax=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nv=n=>ax.test(n);function iv(n,i="/"){let{pathname:r,search:a="",hash:c=""}=typeof n=="string"?ar(n):n,d;if(r)if(nv(r))d=r;else{if(r.includes("//")){let h=r;r=r.replace(/\/\/+/g,"/"),vn(!1,`Pathnames cannot have embedded double slashes - normalizing ${h} -> ${r}`)}r.startsWith("/")?d=hm(r.substring(1),"/"):d=hm(r,i)}else d=i;return{pathname:d,search:ov(a),hash:av(c)}}function hm(n,i){let r=i.replace(/\/+$/,"").split("/");return n.split("/").forEach(c=>{c===".."?r.length>1&&r.pop():c!=="."&&r.push(c)}),r.length>1?r.join("/"):"/"}function Nd(n,i,r,a){return`Cannot include a '${n}' character in a manually specified \`to.${i}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sv(n){return n.filter((i,r)=>r===0||i.route.path&&i.route.path.length>0)}function lx(n){let i=sv(n);return i.map((r,a)=>a===i.length-1?r.pathname:r.pathnameBase)}function cx(n,i,r,a=!1){let c;typeof n=="string"?c=ar(n):(c={...n},Qe(!c.pathname||!c.pathname.includes("?"),Nd("?","pathname","search",c)),Qe(!c.pathname||!c.pathname.includes("#"),Nd("#","pathname","hash",c)),Qe(!c.search||!c.search.includes("#"),Nd("#","search","hash",c)));let d=n===""||c.pathname==="",h=d?"/":c.pathname,p;if(h==null)p=r;else{let k=i.length-1;if(!a&&h.startsWith("..")){let S=h.split("/");for(;S[0]==="..";)S.shift(),k-=1;c.pathname=S.join("/")}p=k>=0?i[k]:"/"}let g=iv(c,p),m=h&&h!=="/"&&h.endsWith("/"),x=(d||h===".")&&r.endsWith("/");return!g.pathname.endsWith("/")&&(m||x)&&(g.pathname+="/"),g}var Yn=n=>n.join("/").replace(/\/\/+/g,"/"),rv=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),ov=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,av=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,lv=class{constructor(n,i,r,a=!1){this.status=n,this.statusText=i||"",this.internal=a,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function cv(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function dv(n){return n.map(i=>i.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var dx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ux(n,i){let r=n;if(typeof r!="string"||!ax.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let a=r,c=!1;if(dx)try{let d=new URL(window.location.href),h=r.startsWith("//")?new URL(d.protocol+r):new URL(r),p=Kn(h.pathname,i);h.origin===d.origin&&p!=null?r=p+h.search+h.hash:c=!0}catch{vn(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:c,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var hx=["POST","PUT","PATCH","DELETE"];new Set(hx);var uv=["GET",...hx];new Set(uv);var lr=v.createContext(null);lr.displayName="DataRouter";var hl=v.createContext(null);hl.displayName="DataRouterState";var hv=v.createContext(!1),fx=v.createContext({isTransitioning:!1});fx.displayName="ViewTransition";var fv=v.createContext(new Map);fv.displayName="Fetchers";var pv=v.createContext(null);pv.displayName="Await";var ln=v.createContext(null);ln.displayName="Navigation";var jo=v.createContext(null);jo.displayName="Location";var En=v.createContext({outlet:null,matches:[],isDataRoute:!1});En.displayName="Route";var Ou=v.createContext(null);Ou.displayName="RouteError";var px="REACT_ROUTER_ERROR",gv="REDIRECT",mv="ROUTE_ERROR_RESPONSE";function xv(n){if(n.startsWith(`${px}:${gv}:{`))try{let i=JSON.parse(n.slice(28));if(typeof i=="object"&&i&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.location=="string"&&typeof i.reloadDocument=="boolean"&&typeof i.replace=="boolean")return i}catch{}}function yv(n){if(n.startsWith(`${px}:${mv}:{`))try{let i=JSON.parse(n.slice(40));if(typeof i=="object"&&i&&typeof i.status=="number"&&typeof i.statusText=="string")return new lv(i.status,i.statusText,i.data)}catch{}}function bv(n,{relative:i}={}){Qe(Co(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=v.useContext(ln),{hash:c,pathname:d,search:h}=Ro(n,{relative:i}),p=d;return r!=="/"&&(p=d==="/"?r:Yn([r,d])),a.createHref({pathname:p,search:h,hash:c})}function Co(){return v.useContext(jo)!=null}function cs(){return Qe(Co(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(jo).location}var gx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function mx(n){v.useContext(ln).static||v.useLayoutEffect(n)}function xe(){let{isDataRoute:n}=v.useContext(En);return n?Dv():vv()}function vv(){Qe(Co(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(lr),{basename:i,navigator:r}=v.useContext(ln),{matches:a}=v.useContext(En),{pathname:c}=cs(),d=JSON.stringify(lx(a)),h=v.useRef(!1);return mx(()=>{h.current=!0}),v.useCallback((g,m={})=>{if(vn(h.current,gx),!h.current)return;if(typeof g=="number"){r.go(g);return}let x=cx(g,JSON.parse(d),c,m.relative==="path");n==null&&i!=="/"&&(x.pathname=x.pathname==="/"?i:Yn([i,x.pathname])),(m.replace?r.replace:r.push)(x,m.state,m)},[i,r,d,c,n])}v.createContext(null);function fl(){let{matches:n}=v.useContext(En),i=n[n.length-1];return i?i.params:{}}function Ro(n,{relative:i}={}){let{matches:r}=v.useContext(En),{pathname:a}=cs(),c=JSON.stringify(lx(r));return v.useMemo(()=>cx(n,JSON.parse(c),a,i==="path"),[n,c,a,i])}function Sv(n,i){return xx(n,i)}function xx(n,i,r,a,c){Qe(Co(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:d}=v.useContext(ln),{matches:h}=v.useContext(En),p=h[h.length-1],g=p?p.params:{},m=p?p.pathname:"/",x=p?p.pathnameBase:"/",k=p&&p.route;{let D=k&&k.path||"";bx(m,!k||D.endsWith("*")||D.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${D}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${D}"> to <Route path="${D==="/"?"*":`${D}/*`}">.`)}let S=cs(),_;if(i){let D=typeof i=="string"?ar(i):i;Qe(x==="/"||D.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${D.pathname}" was given in the \`location\` prop.`),_=D}else _=S;let w=_.pathname||"/",j=w;if(x!=="/"){let D=x.replace(/^\//,"").split("/");j="/"+w.replace(/^\//,"").split("/").slice(D.length).join("/")}let A=sx(n,{pathname:j});vn(k||A!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),vn(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let z=Cv(A&&A.map(D=>Object.assign({},D,{params:Object.assign({},g,D.params),pathname:Yn([x,d.encodeLocation?d.encodeLocation(D.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?x:Yn([x,d.encodeLocation?d.encodeLocation(D.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathnameBase])})),h,r,a,c);return i&&z?v.createElement(jo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},z):z}function kv(){let n=zv(),i=cv(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),r=n instanceof Error?n.stack:null,a="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:a},d={padding:"2px 4px",backgroundColor:a},h=null;return console.error("Error handled by React Router default ErrorBoundary:",n),h=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:d},"ErrorBoundary")," or"," ",v.createElement("code",{style:d},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},i),r?v.createElement("pre",{style:c},r):null,h)}var wv=v.createElement(kv,null),yx=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,i){return i.location!==n.location||i.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:i.error,location:i.location,revalidation:n.revalidation||i.revalidation}}componentDidCatch(n,i){this.props.onError?this.props.onError(n,i):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const r=yv(n.digest);r&&(n=r)}let i=n!==void 0?v.createElement(En.Provider,{value:this.props.routeContext},v.createElement(Ou.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(_v,{error:n},i):i}};yx.contextType=hv;var Md=new WeakMap;function _v({children:n,error:i}){let{basename:r}=v.useContext(ln);if(typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){let a=xv(i.digest);if(a){let c=Md.get(i);if(c)throw c;let d=ux(a.location,r);if(dx&&!Md.get(i))if(d.isExternal||a.reloadDocument)window.location.href=d.absoluteURL||d.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(d.to,{replace:a.replace}));throw Md.set(i,h),h}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${d.absoluteURL||d.to}`})}}return n}function jv({routeContext:n,match:i,children:r}){let a=v.useContext(lr);return a&&a.static&&a.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=i.route.id),v.createElement(En.Provider,{value:n},r)}function Cv(n,i=[],r=null,a=null,c=null){if(n==null){if(!r)return null;if(r.errors)n=r.matches;else if(i.length===0&&!r.initialized&&r.matches.length>0)n=r.matches;else return null}let d=n,h=r?.errors;if(h!=null){let x=d.findIndex(k=>k.route.id&&h?.[k.route.id]!==void 0);Qe(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),d=d.slice(0,Math.min(d.length,x+1))}let p=!1,g=-1;if(r)for(let x=0;x<d.length;x++){let k=d[x];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=x),k.route.id){let{loaderData:S,errors:_}=r,w=k.route.loader&&!S.hasOwnProperty(k.route.id)&&(!_||_[k.route.id]===void 0);if(k.route.lazy||w){p=!0,g>=0?d=d.slice(0,g+1):d=[d[0]];break}}}let m=r&&a?(x,k)=>{a(x,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:dv(r.matches),errorInfo:k})}:void 0;return d.reduceRight((x,k,S)=>{let _,w=!1,j=null,A=null;r&&(_=h&&k.route.id?h[k.route.id]:void 0,j=k.route.errorElement||wv,p&&(g<0&&S===0?(bx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,A=null):g===S&&(w=!0,A=k.route.hydrateFallbackElement||null)));let z=i.concat(d.slice(0,S+1)),D=()=>{let y;return _?y=j:w?y=A:k.route.Component?y=v.createElement(k.route.Component,null):k.route.element?y=k.route.element:y=x,v.createElement(jv,{match:k,routeContext:{outlet:x,matches:z,isDataRoute:r!=null},children:y})};return r&&(k.route.ErrorBoundary||k.route.errorElement||S===0)?v.createElement(yx,{location:r.location,revalidation:r.revalidation,component:j,error:_,children:D(),routeContext:{outlet:null,matches:z,isDataRoute:!0},onError:m}):D()},null)}function Iu(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Rv(n){let i=v.useContext(lr);return Qe(i,Iu(n)),i}function Ev(n){let i=v.useContext(hl);return Qe(i,Iu(n)),i}function Tv(n){let i=v.useContext(En);return Qe(i,Iu(n)),i}function Bu(n){let i=Tv(n),r=i.matches[i.matches.length-1];return Qe(r.route.id,`${n} can only be used on routes that contain a unique "id"`),r.route.id}function Av(){return Bu("useRouteId")}function zv(){let n=v.useContext(Ou),i=Ev("useRouteError"),r=Bu("useRouteError");return n!==void 0?n:i.errors?.[r]}function Dv(){let{router:n}=Rv("useNavigate"),i=Bu("useNavigate"),r=v.useRef(!1);return mx(()=>{r.current=!0}),v.useCallback(async(c,d={})=>{vn(r.current,gx),r.current&&(typeof c=="number"?await n.navigate(c):await n.navigate(c,{fromRouteId:i,...d}))},[n,i])}var fm={};function bx(n,i,r){!i&&!fm[n]&&(fm[n]=!0,vn(!1,r))}v.memo(Ov);function Ov({routes:n,future:i,state:r,onError:a}){return xx(n,void 0,r,a,i)}function be(n){Qe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Iv({basename:n="/",children:i=null,location:r,navigationType:a="POP",navigator:c,static:d=!1,unstable_useTransitions:h}){Qe(!Co(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:c,static:d,unstable_useTransitions:h,future:{}}),[p,c,d,h]);typeof r=="string"&&(r=ar(r));let{pathname:m="/",search:x="",hash:k="",state:S=null,key:_="default"}=r,w=v.useMemo(()=>{let j=Kn(m,p);return j==null?null:{location:{pathname:j,search:x,hash:k,state:S,key:_},navigationType:a}},[p,m,x,k,S,_,a]);return vn(w!=null,`<Router basename="${p}"> is not able to match the URL "${m}${x}${k}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:v.createElement(ln.Provider,{value:g},v.createElement(jo.Provider,{children:i,value:w}))}function Bv({children:n,location:i}){return Sv(fu(n),i)}function fu(n,i=[]){let r=[];return v.Children.forEach(n,(a,c)=>{if(!v.isValidElement(a))return;let d=[...i,c];if(a.type===v.Fragment){r.push.apply(r,fu(a.props.children,d));return}Qe(a.type===be,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qe(!a.props.index||!a.props.children,"An index route cannot have child routes.");let h={id:a.props.id||d.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(h.children=fu(a.props.children,d)),r.push(h)}),r}var tl="get",nl="application/x-www-form-urlencoded";function pl(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function Nv(n){return pl(n)&&n.tagName.toLowerCase()==="button"}function Mv(n){return pl(n)&&n.tagName.toLowerCase()==="form"}function qv(n){return pl(n)&&n.tagName.toLowerCase()==="input"}function Wv(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Uv(n,i){return n.button===0&&(!i||i==="_self")&&!Wv(n)}var Za=null;function Lv(){if(Za===null)try{new FormData(document.createElement("form"),0),Za=!1}catch{Za=!0}return Za}var $v=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qd(n){return n!=null&&!$v.has(n)?(vn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${nl}"`),null):n}function Hv(n,i){let r,a,c,d,h;if(Mv(n)){let p=n.getAttribute("action");a=p?Kn(p,i):null,r=n.getAttribute("method")||tl,c=qd(n.getAttribute("enctype"))||nl,d=new FormData(n)}else if(Nv(n)||qv(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(a=g?Kn(g,i):null,r=n.getAttribute("formmethod")||p.getAttribute("method")||tl,c=qd(n.getAttribute("formenctype"))||qd(p.getAttribute("enctype"))||nl,d=new FormData(p,n),!Lv()){let{name:m,type:x,value:k}=n;if(x==="image"){let S=m?`${m}.`:"";d.append(`${S}x`,"0"),d.append(`${S}y`,"0")}else m&&d.append(m,k)}}else{if(pl(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=tl,a=null,c=nl,h=n}return d&&c==="text/plain"&&(h=d,d=void 0),{action:a,method:r.toLowerCase(),encType:c,formData:d,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Nu(n,i){if(n===!1||n===null||typeof n>"u")throw new Error(i)}function Pv(n,i,r,a){let c=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r?c.pathname.endsWith("/")?c.pathname=`${c.pathname}_.${a}`:c.pathname=`${c.pathname}.${a}`:c.pathname==="/"?c.pathname=`_root.${a}`:i&&Kn(c.pathname,i)==="/"?c.pathname=`${i.replace(/\/$/,"")}/_root.${a}`:c.pathname=`${c.pathname.replace(/\/$/,"")}.${a}`,c}async function Gv(n,i){if(n.id in i)return i[n.id];try{let r=await import(n.module);return i[n.id]=r,r}catch(r){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Vv(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Zv(n,i,r){let a=await Promise.all(n.map(async c=>{let d=i.routes[c.route.id];if(d){let h=await Gv(d,r);return h.links?h.links():[]}return[]}));return Qv(a.flat(1).filter(Vv).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function pm(n,i,r,a,c,d){let h=(g,m)=>r[m]?g.route.id!==r[m].route.id:!0,p=(g,m)=>r[m].pathname!==g.pathname||r[m].route.path?.endsWith("*")&&r[m].params["*"]!==g.params["*"];return d==="assets"?i.filter((g,m)=>h(g,m)||p(g,m)):d==="data"?i.filter((g,m)=>{let x=a.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(h(g,m)||p(g,m))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function Fv(n,i,{includeHydrateFallback:r}={}){return Yv(n.map(a=>{let c=i.routes[a.route.id];if(!c)return[];let d=[c.module];return c.clientActionModule&&(d=d.concat(c.clientActionModule)),c.clientLoaderModule&&(d=d.concat(c.clientLoaderModule)),r&&c.hydrateFallbackModule&&(d=d.concat(c.hydrateFallbackModule)),c.imports&&(d=d.concat(c.imports)),d}).flat(1))}function Yv(n){return[...new Set(n)]}function Kv(n){let i={},r=Object.keys(n).sort();for(let a of r)i[a]=n[a];return i}function Qv(n,i){let r=new Set;return new Set(i),n.reduce((a,c)=>{let d=JSON.stringify(Kv(c));return r.has(d)||(r.add(d),a.push({key:d,link:c})),a},[])}function vx(){let n=v.useContext(lr);return Nu(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Jv(){let n=v.useContext(hl);return Nu(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Mu=v.createContext(void 0);Mu.displayName="FrameworkContext";function Sx(){let n=v.useContext(Mu);return Nu(n,"You must render this element inside a <HydratedRouter> element"),n}function Xv(n,i){let r=v.useContext(Mu),[a,c]=v.useState(!1),[d,h]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:m,onMouseLeave:x,onTouchStart:k}=i,S=v.useRef(null);v.useEffect(()=>{if(n==="render"&&h(!0),n==="viewport"){let j=z=>{z.forEach(D=>{h(D.isIntersecting)})},A=new IntersectionObserver(j,{threshold:.5});return S.current&&A.observe(S.current),()=>{A.disconnect()}}},[n]),v.useEffect(()=>{if(a){let j=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(j)}}},[a]);let _=()=>{c(!0)},w=()=>{c(!1),h(!1)};return r?n!=="intent"?[d,S,{}]:[d,S,{onFocus:io(p,_),onBlur:io(g,w),onMouseEnter:io(m,_),onMouseLeave:io(x,w),onTouchStart:io(k,_)}]:[!1,S,{}]}function io(n,i){return r=>{n&&n(r),r.defaultPrevented||i(r)}}function e1({page:n,...i}){let{router:r}=vx(),a=v.useMemo(()=>sx(r.routes,n,r.basename),[r.routes,n,r.basename]);return a?v.createElement(n1,{page:n,matches:a,...i}):null}function t1(n){let{manifest:i,routeModules:r}=Sx(),[a,c]=v.useState([]);return v.useEffect(()=>{let d=!1;return Zv(n,i,r).then(h=>{d||c(h)}),()=>{d=!0}},[n,i,r]),a}function n1({page:n,matches:i,...r}){let a=cs(),{future:c,manifest:d,routeModules:h}=Sx(),{basename:p}=vx(),{loaderData:g,matches:m}=Jv(),x=v.useMemo(()=>pm(n,i,m,d,a,"data"),[n,i,m,d,a]),k=v.useMemo(()=>pm(n,i,m,d,a,"assets"),[n,i,m,d,a]),S=v.useMemo(()=>{if(n===a.pathname+a.search+a.hash)return[];let j=new Set,A=!1;if(i.forEach(D=>{let y=d.routes[D.route.id];!y||!y.hasLoader||(!x.some(C=>C.route.id===D.route.id)&&D.route.id in g&&h[D.route.id]?.shouldRevalidate||y.hasClientLoader?A=!0:j.add(D.route.id))}),j.size===0)return[];let z=Pv(n,p,c.unstable_trailingSlashAwareDataRequests,"data");return A&&j.size>0&&z.searchParams.set("_routes",i.filter(D=>j.has(D.route.id)).map(D=>D.route.id).join(",")),[z.pathname+z.search]},[p,c.unstable_trailingSlashAwareDataRequests,g,a,d,x,i,n,h]),_=v.useMemo(()=>Fv(k,d),[k,d]),w=t1(k);return v.createElement(v.Fragment,null,S.map(j=>v.createElement("link",{key:j,rel:"prefetch",as:"fetch",href:j,...r})),_.map(j=>v.createElement("link",{key:j,rel:"modulepreload",href:j,...r})),w.map(({key:j,link:A})=>v.createElement("link",{key:j,nonce:r.nonce,...A})))}function i1(...n){return i=>{n.forEach(r=>{typeof r=="function"?r(i):r!=null&&(r.current=i)})}}var s1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{s1&&(window.__reactRouterVersion="7.12.0")}catch{}function r1({basename:n,children:i,unstable_useTransitions:r,window:a}){let c=v.useRef();c.current==null&&(c.current=Wb({window:a,v5Compat:!0}));let d=c.current,[h,p]=v.useState({action:d.action,location:d.location}),g=v.useCallback(m=>{r===!1?p(m):v.startTransition(()=>p(m))},[r]);return v.useLayoutEffect(()=>d.listen(g),[d,g]),v.createElement(Iv,{basename:n,children:i,location:h.location,navigationType:h.action,navigator:d,unstable_useTransitions:r})}var kx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wx=v.forwardRef(function({onClick:i,discover:r="render",prefetch:a="none",relative:c,reloadDocument:d,replace:h,state:p,target:g,to:m,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:S,..._},w){let{basename:j,unstable_useTransitions:A}=v.useContext(ln),z=typeof m=="string"&&kx.test(m),D=ux(m,j);m=D.to;let y=bv(m,{relative:c}),[C,T,E]=Xv(a,_),W=c1(m,{replace:h,state:p,target:g,preventScrollReset:x,relative:c,viewTransition:k,unstable_defaultShouldRevalidate:S,unstable_useTransitions:A});function M(ee){i&&i(ee),ee.defaultPrevented||W(ee)}let K=v.createElement("a",{..._,...E,href:D.absoluteURL||y,onClick:D.isExternal||d?i:M,ref:i1(w,T),target:g,"data-discover":!z&&r==="render"?"true":void 0});return C&&!z?v.createElement(v.Fragment,null,K,v.createElement(e1,{page:y})):K});wx.displayName="Link";var o1=v.forwardRef(function({"aria-current":i="page",caseSensitive:r=!1,className:a="",end:c=!1,style:d,to:h,viewTransition:p,children:g,...m},x){let k=Ro(h,{relative:m.relative}),S=cs(),_=v.useContext(hl),{navigator:w,basename:j}=v.useContext(ln),A=_!=null&&p1(k)&&p===!0,z=w.encodeLocation?w.encodeLocation(k).pathname:k.pathname,D=S.pathname,y=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;r||(D=D.toLowerCase(),y=y?y.toLowerCase():null,z=z.toLowerCase()),y&&j&&(y=Kn(y,j)||y);const C=z!=="/"&&z.endsWith("/")?z.length-1:z.length;let T=D===z||!c&&D.startsWith(z)&&D.charAt(C)==="/",E=y!=null&&(y===z||!c&&y.startsWith(z)&&y.charAt(z.length)==="/"),W={isActive:T,isPending:E,isTransitioning:A},M=T?i:void 0,K;typeof a=="function"?K=a(W):K=[a,T?"active":null,E?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let ee=typeof d=="function"?d(W):d;return v.createElement(wx,{...m,"aria-current":M,className:K,ref:x,style:ee,to:h,viewTransition:p},typeof g=="function"?g(W):g)});o1.displayName="NavLink";var a1=v.forwardRef(({discover:n="render",fetcherKey:i,navigate:r,reloadDocument:a,replace:c,state:d,method:h=tl,action:p,onSubmit:g,relative:m,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:S,..._},w)=>{let{unstable_useTransitions:j}=v.useContext(ln),A=h1(),z=f1(p,{relative:m}),D=h.toLowerCase()==="get"?"get":"post",y=typeof p=="string"&&kx.test(p),C=T=>{if(g&&g(T),T.defaultPrevented)return;T.preventDefault();let E=T.nativeEvent.submitter,W=E?.getAttribute("formmethod")||h,M=()=>A(E||T.currentTarget,{fetcherKey:i,method:W,navigate:r,replace:c,state:d,relative:m,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:S});j&&r!==!1?v.startTransition(()=>M()):M()};return v.createElement("form",{ref:w,method:D,action:z,onSubmit:a?g:C,..._,"data-discover":!y&&n==="render"?"true":void 0})});a1.displayName="Form";function l1(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _x(n){let i=v.useContext(lr);return Qe(i,l1(n)),i}function c1(n,{target:i,replace:r,state:a,preventScrollReset:c,relative:d,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let m=xe(),x=cs(),k=Ro(n,{relative:d});return v.useCallback(S=>{if(Uv(S,i)){S.preventDefault();let _=r!==void 0?r:po(x)===po(k),w=()=>m(n,{replace:_,state:a,preventScrollReset:c,relative:d,viewTransition:h,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>w()):w()}},[x,m,k,r,a,i,n,c,d,h,p,g])}var d1=0,u1=()=>`__${String(++d1)}__`;function h1(){let{router:n}=_x("useSubmit"),{basename:i}=v.useContext(ln),r=Av(),a=n.fetch,c=n.navigate;return v.useCallback(async(d,h={})=>{let{action:p,method:g,encType:m,formData:x,body:k}=Hv(d,i);if(h.navigate===!1){let S=h.fetcherKey||u1();await a(S,r,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:x,body:k,formMethod:h.method||g,formEncType:h.encType||m,flushSync:h.flushSync})}else await c(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:x,body:k,formMethod:h.method||g,formEncType:h.encType||m,replace:h.replace,state:h.state,fromRouteId:r,flushSync:h.flushSync,viewTransition:h.viewTransition})},[a,c,i,r])}function f1(n,{relative:i}={}){let{basename:r}=v.useContext(ln),a=v.useContext(En);Qe(a,"useFormAction must be used inside a RouteContext");let[c]=a.matches.slice(-1),d={...Ro(n||".",{relative:i})},h=cs();if(n==null){d.search=h.search;let p=new URLSearchParams(d.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let x=p.toString();d.search=x?`?${x}`:""}}return(!n||n===".")&&c.route.index&&(d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(d.pathname=d.pathname==="/"?r:Yn([r,d.pathname])),po(d)}function p1(n,{relative:i}={}){let r=v.useContext(fx);Qe(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=_x("useViewTransitionState"),c=Ro(n,{relative:i});if(!r.isTransitioning)return!1;let d=Kn(r.currentLocation.pathname,a)||r.currentLocation.pathname,h=Kn(r.nextLocation.pathname,a)||r.nextLocation.pathname;return sl(c.pathname,h)!=null||sl(c.pathname,d)!=null}function gl(n,i){var r={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&i.indexOf(a)<0&&(r[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,a=Object.getOwnPropertySymbols(n);c<a.length;c++)i.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(n,a[c])&&(r[a[c]]=n[a[c]]);return r}function g1(n,i,r,a){function c(d){return d instanceof r?d:new r(function(h){h(d)})}return new(r||(r=Promise))(function(d,h){function p(x){try{m(a.next(x))}catch(k){h(k)}}function g(x){try{m(a.throw(x))}catch(k){h(k)}}function m(x){x.done?d(x.value):c(x.value).then(p,g)}m((a=a.apply(n,i||[])).next())})}const m1=n=>n?(...i)=>n(...i):(...i)=>fetch(...i);class qu extends Error{constructor(i,r="FunctionsError",a){super(i),this.name=r,this.context=a}}class x1 extends qu{constructor(i){super("Failed to send a request to the Edge Function","FunctionsFetchError",i)}}class gm extends qu{constructor(i){super("Relay Error invoking the Edge Function","FunctionsRelayError",i)}}class mm extends qu{constructor(i){super("Edge Function returned a non-2xx status code","FunctionsHttpError",i)}}var pu;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(pu||(pu={}));class y1{constructor(i,{headers:r={},customFetch:a,region:c=pu.Any}={}){this.url=i,this.headers=r,this.region=c,this.fetch=m1(a)}setAuth(i){this.headers.Authorization=`Bearer ${i}`}invoke(i){return g1(this,arguments,void 0,function*(r,a={}){var c;let d,h;try{const{headers:p,method:g,body:m,signal:x,timeout:k}=a;let S={},{region:_}=a;_||(_=this.region);const w=new URL(`${this.url}/${r}`);_&&_!=="any"&&(S["x-region"]=_,w.searchParams.set("forceFunctionRegion",_));let j;m&&(p&&!Object.prototype.hasOwnProperty.call(p,"Content-Type")||!p)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(S["Content-Type"]="application/octet-stream",j=m):typeof m=="string"?(S["Content-Type"]="text/plain",j=m):typeof FormData<"u"&&m instanceof FormData?j=m:(S["Content-Type"]="application/json",j=JSON.stringify(m)):m&&typeof m!="string"&&!(typeof Blob<"u"&&m instanceof Blob)&&!(m instanceof ArrayBuffer)&&!(typeof FormData<"u"&&m instanceof FormData)?j=JSON.stringify(m):j=m;let A=x;k&&(h=new AbortController,d=setTimeout(()=>h.abort(),k),x?(A=h.signal,x.addEventListener("abort",()=>h.abort())):A=h.signal);const z=yield this.fetch(w.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},S),this.headers),p),body:j,signal:A}).catch(T=>{throw new x1(T)}),D=z.headers.get("x-relay-error");if(D&&D==="true")throw new gm(z);if(!z.ok)throw new mm(z);let y=((c=z.headers.get("Content-Type"))!==null&&c!==void 0?c:"text/plain").split(";")[0].trim(),C;return y==="application/json"?C=yield z.json():y==="application/octet-stream"||y==="application/pdf"?C=yield z.blob():y==="text/event-stream"?C=z:y==="multipart/form-data"?C=yield z.formData():C=yield z.text(),{data:C,error:null,response:z}}catch(p){return{data:null,error:p,response:p instanceof mm||p instanceof gm?p.context:void 0}}finally{d&&clearTimeout(d)}})}}var b1=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},v1=class{constructor(n){var i,r;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(i=n.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=n.signal,this.isMaybeSingle=(r=n.isMaybeSingle)!==null&&r!==void 0?r:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,i){return this.headers=new Headers(this.headers),this.headers.set(n,i),this}then(n,i){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let c=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{let h=null,p=null,g=null,m=d.status,x=d.statusText;if(d.ok){var k,S;if(r.method!=="HEAD"){var _;const z=await d.text();z===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?p=z:p=JSON.parse(z))}const j=(k=r.headers.get("Prefer"))===null||k===void 0?void 0:k.match(/count=(exact|planned|estimated)/),A=(S=d.headers.get("content-range"))===null||S===void 0?void 0:S.split("/");j&&A&&A.length>1&&(g=parseInt(A[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(p)&&(p.length>1?(h={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,g=null,m=406,x="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{var w;const j=await d.text();try{h=JSON.parse(j),Array.isArray(h)&&d.status===404&&(p=[],h=null,m=200,x="OK")}catch{d.status===404&&j===""?(m=204,x="No Content"):h={message:j}}if(h&&r.isMaybeSingle&&(!(h==null||(w=h.details)===null||w===void 0)&&w.includes("0 rows"))&&(h=null,m=200,x="OK"),h&&r.shouldThrowOnError)throw new b1(h)}return{error:h,data:p,count:g,status:m,statusText:x}});return this.shouldThrowOnError||(c=c.catch(d=>{var h;let p="";const g=d?.cause;if(g){var m,x,k,S;const w=(m=g?.message)!==null&&m!==void 0?m:"",j=(x=g?.code)!==null&&x!==void 0?x:"";p=`${(k=d?.name)!==null&&k!==void 0?k:"FetchError"}: ${d?.message}`,p+=`

Caused by: ${(S=g?.name)!==null&&S!==void 0?S:"Error"}: ${w}`,j&&(p+=` (${j})`),g?.stack&&(p+=`
${g.stack}`)}else{var _;p=(_=d?.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(h=d?.name)!==null&&h!==void 0?h:"FetchError"}: ${d?.message}`,details:p,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),c.then(n,i)}returns(){return this}overrideTypes(){return this}},S1=class extends v1{select(n){let i=!1;const r=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:i=!0,nullsFirst:r,foreignTable:a,referencedTable:c=a}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${n}.${i?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:r=i}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:r,referencedTable:a=r}={}){const c=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(d,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:i=!1,settings:r=!1,buffers:a=!1,wal:c=!1,format:d="text"}={}){var h;const p=[n?"analyze":null,i?"verbose":null,r?"settings":null,a?"buffers":null,c?"wal":null].filter(Boolean).join("|"),g=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${g}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const xm=new RegExp("[,()]");var tr=class extends S1{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}regexMatch(n,i){return this.url.searchParams.append(n,`match.${i}`),this}regexIMatch(n,i){return this.url.searchParams.append(n,`imatch.${i}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}isDistinct(n,i){return this.url.searchParams.append(n,`isdistinct.${i}`),this}in(n,i){const r=Array.from(new Set(i)).map(a=>typeof a=="string"&&xm.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${r})`),this}notIn(n,i){const r=Array.from(new Set(i)).map(a=>typeof a=="string"&&xm.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`not.in.(${r})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:r,type:a}={}){let c="";a==="plain"?c="pl":a==="phrase"?c="ph":a==="websearch"&&(c="w");const d=r===void 0?"":`(${r})`;return this.url.searchParams.append(n,`${c}fts${d}.${i}`),this}match(n){return Object.entries(n).forEach(([i,r])=>{this.url.searchParams.append(i,`eq.${r}`)}),this}not(n,i,r){return this.url.searchParams.append(n,`not.${i}.${r}`),this}or(n,{foreignTable:i,referencedTable:r=i}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,r){return this.url.searchParams.append(n,`${i}.${r}`),this}},k1=class{constructor(n,{headers:i={},schema:r,fetch:a}){this.url=n,this.headers=new Headers(i),this.schema=r,this.fetch=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,i){const{head:r=!1,count:a}=i??{},c=r?"HEAD":"GET";let d=!1;const h=(n??"*").split("").map(m=>/\s/.test(m)&&!d?"":(m==='"'&&(d=!d),m)).join(""),{url:p,headers:g}=this.cloneRequestState();return p.searchParams.set("select",h),a&&g.append("Prefer",`count=${a}`),new tr({method:c,url:p,headers:g,schema:this.schema,fetch:this.fetch})}insert(n,{count:i,defaultToNull:r=!0}={}){var a;const c="POST",{url:d,headers:h}=this.cloneRequestState();if(i&&h.append("Prefer",`count=${i}`),r||h.append("Prefer","missing=default"),Array.isArray(n)){const p=n.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(p.length>0){const g=[...new Set(p)].map(m=>`"${m}"`);d.searchParams.set("columns",g.join(","))}}return new tr({method:c,url:d,headers:h,schema:this.schema,body:n,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(n,{onConflict:i,ignoreDuplicates:r=!1,count:a,defaultToNull:c=!0}={}){var d;const h="POST",{url:p,headers:g}=this.cloneRequestState();if(g.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),i!==void 0&&p.searchParams.set("on_conflict",i),a&&g.append("Prefer",`count=${a}`),c||g.append("Prefer","missing=default"),Array.isArray(n)){const m=n.reduce((x,k)=>x.concat(Object.keys(k)),[]);if(m.length>0){const x=[...new Set(m)].map(k=>`"${k}"`);p.searchParams.set("columns",x.join(","))}}return new tr({method:h,url:p,headers:g,schema:this.schema,body:n,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(n,{count:i}={}){var r;const a="PATCH",{url:c,headers:d}=this.cloneRequestState();return i&&d.append("Prefer",`count=${i}`),new tr({method:a,url:c,headers:d,schema:this.schema,body:n,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:n}={}){var i;const r="DELETE",{url:a,headers:c}=this.cloneRequestState();return n&&c.append("Prefer",`count=${n}`),new tr({method:r,url:a,headers:c,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}},w1=class jx{constructor(i,{headers:r={},schema:a,fetch:c}={}){this.url=i,this.headers=new Headers(r),this.schemaName=a,this.fetch=c}from(i){if(!i||typeof i!="string"||i.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new k1(new URL(`${this.url}/${i}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new jx(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,r={},{head:a=!1,get:c=!1,count:d}={}){var h;let p;const g=new URL(`${this.url}/rpc/${i}`);let m;const x=_=>_!==null&&typeof _=="object"&&(!Array.isArray(_)||_.some(x)),k=a&&Object.values(r).some(x);k?(p="POST",m=r):a||c?(p=a?"HEAD":"GET",Object.entries(r).filter(([_,w])=>w!==void 0).map(([_,w])=>[_,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([_,w])=>{g.searchParams.append(_,w)})):(p="POST",m=r);const S=new Headers(this.headers);return k?S.set("Prefer",d?`count=${d},return=minimal`:"return=minimal"):d&&S.set("Prefer",`count=${d}`),new tr({method:p,url:g,headers:S,schema:this.schemaName,body:m,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}};class _1{constructor(){}static detectEnvironment(){var i;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((i=navigator.userAgent)===null||i===void 0)&&i.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const a=r.versions;if(a&&a.node){const c=a.node,d=parseInt(c.replace(/^v/,"").split(".")[0]);return d>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${d} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${d} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const i=this.detectEnvironment();if(i.constructor)return i.constructor;let r=i.error||"WebSocket not supported in this environment.";throw i.workaround&&(r+=`

Suggested solution: ${i.workaround}`),new Error(r)}static createWebSocket(i,r){const a=this.getWebSocketConstructor();return new a(i,r)}static isWebSocketSupported(){try{const i=this.detectEnvironment();return i.type==="native"||i.type==="ws"}catch{return!1}}}const j1="2.91.0",C1=`realtime-js/${j1}`,R1="1.0.0",Cx="2.0.0",ym=Cx,gu=1e4,E1=1e3,T1=100;var ji;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(ji||(ji={}));var ht;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(ht||(ht={}));var gn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(gn||(gn={}));var mu;(function(n){n.websocket="websocket"})(mu||(mu={}));var ns;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ns||(ns={}));class A1{constructor(i){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=i??[]}encode(i,r){if(i.event===this.BROADCAST_EVENT&&!(i.payload instanceof ArrayBuffer)&&typeof i.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(i));let a=[i.join_ref,i.ref,i.topic,i.event,i.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(i){var r;return this._isArrayBuffer((r=i.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(i):this._encodeJsonUserBroadcastPush(i)}_encodeBinaryUserBroadcastPush(i){var r,a;const c=(a=(r=i.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(i,this.BINARY_ENCODING,c)}_encodeJsonUserBroadcastPush(i){var r,a;const c=(a=(r=i.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},h=new TextEncoder().encode(JSON.stringify(c)).buffer;return this._encodeUserBroadcastPush(i,this.JSON_ENCODING,h)}_encodeUserBroadcastPush(i,r,a){var c,d;const h=i.topic,p=(c=i.ref)!==null&&c!==void 0?c:"",g=(d=i.join_ref)!==null&&d!==void 0?d:"",m=i.payload.event,x=this.allowedMetadataKeys?this._pick(i.payload,this.allowedMetadataKeys):{},k=Object.keys(x).length===0?"":JSON.stringify(x);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`ref length ${p.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`topic length ${h.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(k.length>255)throw new Error(`metadata length ${k.length} exceeds maximum of 255`);const S=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+p.length+h.length+m.length+k.length,_=new ArrayBuffer(this.HEADER_LENGTH+S);let w=new DataView(_),j=0;w.setUint8(j++,this.KINDS.userBroadcastPush),w.setUint8(j++,g.length),w.setUint8(j++,p.length),w.setUint8(j++,h.length),w.setUint8(j++,m.length),w.setUint8(j++,k.length),w.setUint8(j++,r),Array.from(g,z=>w.setUint8(j++,z.charCodeAt(0))),Array.from(p,z=>w.setUint8(j++,z.charCodeAt(0))),Array.from(h,z=>w.setUint8(j++,z.charCodeAt(0))),Array.from(m,z=>w.setUint8(j++,z.charCodeAt(0))),Array.from(k,z=>w.setUint8(j++,z.charCodeAt(0)));var A=new Uint8Array(_.byteLength+a.byteLength);return A.set(new Uint8Array(_),0),A.set(new Uint8Array(a),_.byteLength),A.buffer}decode(i,r){if(this._isArrayBuffer(i)){let a=this._binaryDecode(i);return r(a)}if(typeof i=="string"){const a=JSON.parse(i),[c,d,h,p,g]=a;return r({join_ref:c,ref:d,topic:h,event:p,payload:g})}return r({})}_binaryDecode(i){const r=new DataView(i),a=r.getUint8(0),c=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(i,r,c)}_decodeUserBroadcast(i,r,a){const c=r.getUint8(1),d=r.getUint8(2),h=r.getUint8(3),p=r.getUint8(4);let g=this.HEADER_LENGTH+4;const m=a.decode(i.slice(g,g+c));g=g+c;const x=a.decode(i.slice(g,g+d));g=g+d;const k=a.decode(i.slice(g,g+h));g=g+h;const S=i.slice(g,i.byteLength),_=p===this.JSON_ENCODING?JSON.parse(a.decode(S)):S,w={type:this.BROADCAST_EVENT,event:x,payload:_};return h>0&&(w.meta=JSON.parse(k)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(i){var r;return i instanceof ArrayBuffer||((r=i?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(i,r){return!i||typeof i!="object"?{}:Object.fromEntries(Object.entries(i).filter(([a])=>r.includes(a)))}}class Rx{constructor(i,r){this.callback=i,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=i,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ve;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ve||(Ve={}));const bm=(n,i,r={})=>{var a;const c=(a=r.skipTypes)!==null&&a!==void 0?a:[];return i?Object.keys(i).reduce((d,h)=>(d[h]=z1(h,n,i,c),d),{}):{}},z1=(n,i,r,a)=>{const c=i.find(p=>p.name===n),d=c?.type,h=r[n];return d&&!a.includes(d)?Ex(d,h):xu(h)},Ex=(n,i)=>{if(n.charAt(0)==="_"){const r=n.slice(1,n.length);return B1(i,r)}switch(n){case Ve.bool:return D1(i);case Ve.float4:case Ve.float8:case Ve.int2:case Ve.int4:case Ve.int8:case Ve.numeric:case Ve.oid:return O1(i);case Ve.json:case Ve.jsonb:return I1(i);case Ve.timestamp:return N1(i);case Ve.abstime:case Ve.date:case Ve.daterange:case Ve.int4range:case Ve.int8range:case Ve.money:case Ve.reltime:case Ve.text:case Ve.time:case Ve.timestamptz:case Ve.timetz:case Ve.tsrange:case Ve.tstzrange:return xu(i);default:return xu(i)}},xu=n=>n,D1=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},O1=n=>{if(typeof n=="string"){const i=parseFloat(n);if(!Number.isNaN(i))return i}return n},I1=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},B1=(n,i)=>{if(typeof n!="string")return n;const r=n.length-1,a=n[r];if(n[0]==="{"&&a==="}"){let d;const h=n.slice(1,r);try{d=JSON.parse("["+h+"]")}catch{d=h?h.split(","):[]}return d.map(p=>Ex(i,p))}return n},N1=n=>typeof n=="string"?n.replace(" ","T"):n,Tx=n=>{const i=new URL(n);return i.protocol=i.protocol.replace(/^ws/i,"http"),i.pathname=i.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),i.pathname===""||i.pathname==="/"?i.pathname="/api/broadcast":i.pathname=i.pathname+"/api/broadcast",i.href};class Wd{constructor(i,r,a={},c=gu){this.channel=i,this.event=r,this.payload=a,this.timeout=c,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(i){this.timeout=i,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(i){this.payload=Object.assign(Object.assign({},this.payload),i)}receive(i,r){var a;return this._hasReceived(i)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:i,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const i=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},i),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(i,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:i,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:i,response:r}){this.recHooks.filter(a=>a.status===i).forEach(a=>a.callback(r))}_hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}}var vm;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(vm||(vm={}));class lo{constructor(i,r){this.channel=i,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},c=>{const{onJoin:d,onLeave:h,onSync:p}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lo.syncState(this.state,c,d,h),this.pendingDiffs.forEach(g=>{this.state=lo.syncDiff(this.state,g,d,h)}),this.pendingDiffs=[],p()}),this.channel._on(a.diff,{},c=>{const{onJoin:d,onLeave:h,onSync:p}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(c):(this.state=lo.syncDiff(this.state,c,d,h),p())}),this.onJoin((c,d,h)=>{this.channel._trigger("presence",{event:"join",key:c,currentPresences:d,newPresences:h})}),this.onLeave((c,d,h)=>{this.channel._trigger("presence",{event:"leave",key:c,currentPresences:d,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(i,r,a,c){const d=this.cloneDeep(i),h=this.transformState(r),p={},g={};return this.map(d,(m,x)=>{h[m]||(g[m]=x)}),this.map(h,(m,x)=>{const k=d[m];if(k){const S=x.map(A=>A.presence_ref),_=k.map(A=>A.presence_ref),w=x.filter(A=>_.indexOf(A.presence_ref)<0),j=k.filter(A=>S.indexOf(A.presence_ref)<0);w.length>0&&(p[m]=w),j.length>0&&(g[m]=j)}else p[m]=x}),this.syncDiff(d,{joins:p,leaves:g},a,c)}static syncDiff(i,r,a,c){const{joins:d,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),c||(c=()=>{}),this.map(d,(p,g)=>{var m;const x=(m=i[p])!==null&&m!==void 0?m:[];if(i[p]=this.cloneDeep(g),x.length>0){const k=i[p].map(_=>_.presence_ref),S=x.filter(_=>k.indexOf(_.presence_ref)<0);i[p].unshift(...S)}a(p,x,g)}),this.map(h,(p,g)=>{let m=i[p];if(!m)return;const x=g.map(k=>k.presence_ref);m=m.filter(k=>x.indexOf(k.presence_ref)<0),i[p]=m,c(p,m,g),m.length===0&&delete i[p]}),i}static map(i,r){return Object.getOwnPropertyNames(i).map(a=>r(a,i[a]))}static transformState(i){return i=this.cloneDeep(i),Object.getOwnPropertyNames(i).reduce((r,a)=>{const c=i[a];return"metas"in c?r[a]=c.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):r[a]=c,r},{})}static cloneDeep(i){return JSON.parse(JSON.stringify(i))}onJoin(i){this.caller.onJoin=i}onLeave(i){this.caller.onLeave=i}onSync(i){this.caller.onSync=i}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Sm;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Sm||(Sm={}));var co;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(co||(co={}));var Fn;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Fn||(Fn={}));class sr{constructor(i,r={config:{}},a){var c,d;if(this.topic=i,this.params=r,this.socket=a,this.bindings={},this.state=ht.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=i.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Wd(this,gn.join,this.params,this.timeout),this.rejoinTimer=new Rx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ht.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ht.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gn.reply,{},(h,p)=>{this._trigger(this._replyEventName(p),h)}),this.presence=new lo(this),this.broadcastEndpointURL=Tx(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(c=this.params.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(i,r=this.timeout){var a,c,d;if(this.socket.isConnected()||this.socket.connect(),this.state==ht.closed){const{config:{broadcast:h,presence:p,private:g}}=this.params,m=(c=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(_=>_.filter))!==null&&c!==void 0?c:[],x=!!this.bindings[co.PRESENCE]&&this.bindings[co.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,k={},S={broadcast:h,presence:Object.assign(Object.assign({},p),{enabled:x}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(k.access_token=this.socket.accessTokenValue),this._onError(_=>i?.(Fn.CHANNEL_ERROR,_)),this._onClose(()=>i?.(Fn.CLOSED)),this.updateJoinPayload(Object.assign({config:S},k)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){i?.(Fn.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,A=(w=j?.length)!==null&&w!==void 0?w:0,z=[];for(let D=0;D<A;D++){const y=j[D],{filter:{event:C,schema:T,table:E,filter:W}}=y,M=_&&_[D];if(M&&M.event===C&&sr.isFilterValueEqual(M.schema,T)&&sr.isFilterValueEqual(M.table,E)&&sr.isFilterValueEqual(M.filter,W))z.push(Object.assign(Object.assign({},y),{id:M.id}));else{this.unsubscribe(),this.state=ht.errored,i?.(Fn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=z,i&&i(Fn.SUBSCRIBED);return}}).receive("error",_=>{this.state=ht.errored,i?.(Fn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{i?.(Fn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(i,r={}){return await this.send({type:"presence",event:"track",payload:i},r.timeout||this.timeout)}async untrack(i={}){return await this.send({type:"presence",event:"untrack"},i)}on(i,r,a){return this.state===ht.joined&&i===co.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(i,r,a)}async httpSend(i,r,a={}){var c;if(r==null)return Promise.reject("Payload is required for httpSend()");const d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:r,private:this.private}]})},p=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(c=a.timeout)!==null&&c!==void 0?c:this.timeout);if(p.status===202)return{success:!0};let g=p.statusText;try{const m=await p.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(i,r={}){var a,c;if(!this._canPush()&&i.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:h}=i,p={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(p.Authorization=`Bearer ${this.socket.accessTokenValue}`);const g={method:"POST",headers:p,body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:h,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((c=m.body)===null||c===void 0?void 0:c.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var h,p,g;const m=this._push(i.type,i,r.timeout||this.timeout);i.type==="broadcast"&&!(!((g=(p=(h=this.params)===null||h===void 0?void 0:h.config)===null||p===void 0?void 0:p.broadcast)===null||g===void 0)&&g.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(i){this.joinPush.updatePayload(i)}unsubscribe(i=this.timeout){this.state=ht.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gn.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(c=>{a=new Wd(this,gn.leave,{},i),a.receive("ok",()=>{r(),c("ok")}).receive("timeout",()=>{r(),c("timed out")}).receive("error",()=>{c("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(i=>i.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ht.closed,this.bindings={}}async _fetchWithTimeout(i,r,a){const c=new AbortController,d=setTimeout(()=>c.abort(),a),h=await this.socket.fetch(i,Object.assign(Object.assign({},r),{signal:c.signal}));return clearTimeout(d),h}_push(i,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${i}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let c=new Wd(this,i,r,a);return this._canPush()?c.send():this._addToPushBuffer(c),c}_addToPushBuffer(i){if(i.startTimeout(),this.pushBuffer.push(i),this.pushBuffer.length>T1){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(i,r,a){return r}_isMember(i){return this.topic===i}_joinRef(){return this.joinPush.ref}_trigger(i,r,a){var c,d;const h=i.toLocaleLowerCase(),{close:p,error:g,leave:m,join:x}=gn;if(a&&[p,g,m,x].indexOf(h)>=0&&a!==this._joinRef())return;let S=this._onMessage(h,r,a);if(r&&!S)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(c=this.bindings.postgres_changes)===null||c===void 0||c.filter(_=>{var w,j,A;return((w=_.filter)===null||w===void 0?void 0:w.event)==="*"||((A=(j=_.filter)===null||j===void 0?void 0:j.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===h}).map(_=>_.callback(S,a)):(d=this.bindings[h])===null||d===void 0||d.filter(_=>{var w,j,A,z,D,y,C,T;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in _){const E=_.id,W=(w=_.filter)===null||w===void 0?void 0:w.event;return E&&((j=r.ids)===null||j===void 0?void 0:j.includes(E))&&(W==="*"||W?.toLocaleLowerCase()===((A=r.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))&&(!(!((z=_.filter)===null||z===void 0)&&z.table)||_.filter.table===((D=r.data)===null||D===void 0?void 0:D.table))}else{const E=(C=(y=_?.filter)===null||y===void 0?void 0:y.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return E==="*"||E===((T=r?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===h}).map(_=>{if(typeof S=="object"&&"ids"in S){const w=S.data,{schema:j,table:A,commit_timestamp:z,type:D,errors:y}=w;S=Object.assign(Object.assign({},{schema:j,table:A,commit_timestamp:z,eventType:D,new:{},old:{},errors:y}),this._getPayloadRecords(w))}_.callback(S,a)})}_isClosed(){return this.state===ht.closed}_isJoined(){return this.state===ht.joined}_isJoining(){return this.state===ht.joining}_isLeaving(){return this.state===ht.leaving}_replyEventName(i){return`chan_reply_${i}`}_on(i,r,a){const c=i.toLocaleLowerCase(),d={type:c,filter:r,callback:a};return this.bindings[c]?this.bindings[c].push(d):this.bindings[c]=[d],this}_off(i,r){const a=i.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(c=>{var d;return!(((d=c.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===a&&sr.isEqual(c.filter,r))})),this}static isEqual(i,r){if(Object.keys(i).length!==Object.keys(r).length)return!1;for(const a in i)if(i[a]!==r[a])return!1;return!0}static isFilterValueEqual(i,r){return(i??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(i){this._on(gn.close,{},i)}_onError(i){this._on(gn.error,{},r=>i(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(i=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ht.joining,this.joinPush.resend(i))}_getPayloadRecords(i){const r={new:{},old:{}};return(i.type==="INSERT"||i.type==="UPDATE")&&(r.new=bm(i.columns,i.record)),(i.type==="UPDATE"||i.type==="DELETE")&&(r.old=bm(i.columns,i.old_record)),r}}const Ud=()=>{},Fa={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},M1=[1e3,2e3,5e3,1e4],q1=1e4,W1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class U1{constructor(i,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=gu,this.transport=null,this.heartbeatIntervalMs=Fa.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ud,this.ref=0,this.reconnectTimer=null,this.vsn=ym,this.logger=Ud,this.conn=null,this.sendBuffer=[],this.serializer=new A1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=c=>c?(...d)=>c(...d):(...d)=>fetch(...d),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${i}/${mu.websocket}`,this.httpEndpoint=Tx(i),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=_1.createWebSocket(this.endpointURL())}catch(i){this._setConnectionState("disconnected");const r=i.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(i,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(i?this.conn.close(i,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(i){const r=await i.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const i=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),i}log(i,r,a){this.logger(i,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ji.connecting:return ns.Connecting;case ji.open:return ns.Open;case ji.closing:return ns.Closing;default:return ns.Closed}}isConnected(){return this.connectionState()===ns.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(i,r={config:{}}){const a=`realtime:${i}`,c=this.getChannels().find(d=>d.topic===a);if(c)return c;{const d=new sr(`realtime:${i}`,r,this);return this.channels.push(d),d}}push(i){const{topic:r,event:a,payload:c,ref:d}=i,h=()=>{this.encode(i,p=>{var g;(g=this.conn)===null||g===void 0||g.send(p)})};this.log("push",`${r} ${a} (${d})`,c),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(i=null){this._authPromise=this._performAuth(i);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var i;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(i=this.conn)===null||i===void 0||i.close(E1,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Fa.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(i){this.heartbeatCallback=i}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}_makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}_leaveOpenTopic(i){let r=this.channels.find(a=>a.topic===i&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${i}"`),r.unsubscribe())}_remove(i){this.channels=this.channels.filter(r=>r.topic!==i.topic)}_onConnMessage(i){this.decode(i.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const m=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",m)}catch(x){this.log("error","error in heartbeat callback",x)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:a,event:c,payload:d,ref:h}=r,p=h?`(${h})`:"",g=d.status||"";this.log("receive",`${g} ${a} ${c} ${p}`.trim(),d),this.channels.filter(m=>m._isMember(a)).forEach(m=>m._trigger(c,d,h)),this._triggerStateCallbacks("message",r)})}_clearTimer(i){var r;i==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):i==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=i=>this._onConnError(i),this.conn.onmessage=i=>this._onConnMessage(i),this.conn.onclose=i=>this._onConnClose(i),this.conn.readyState===ji.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ji.open||this.conn.readyState===ji.connecting)try{this.conn.close()}catch(i){this.log("error","Error closing connection",i)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(i=>i.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const i=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(i),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(i){var r;this._setConnectionState("disconnected"),this.log("transport","close",i),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",i)}_onConnError(i){this._setConnectionState("disconnected"),this.log("transport",`${i}`),this._triggerChanError(),this._triggerStateCallbacks("error",i)}_triggerChanError(){this.channels.forEach(i=>i._trigger(gn.error))}_appendParams(i,r){if(Object.keys(r).length===0)return i;const a=i.match(/\?/)?"&":"?",c=new URLSearchParams(r);return`${i}${a}${c}`}_workerObjectUrl(i){let r;if(i)r=i;else{const a=new Blob([W1],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(i,r=!1){this._connectionState=i,i==="connecting"?this._wasManualDisconnect=!1:i==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(i=null){let r,a=!1;if(i)r=i,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(c){this.log("error","Error fetching access token from callback",c),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(c=>{const d={access_token:r,version:C1};r&&c.updateJoinPayload(d),c.joinedOnce&&c._isJoined()&&c._push(gn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(i="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${i}`,r)})}_triggerStateCallbacks(i,r){try{this.stateChangeCallbacks[i].forEach(a=>{try{a(r)}catch(c){this.log("error",`error in ${i} callback`,c)}})}catch(a){this.log("error",`error triggering ${i} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Rx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fa.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(i){var r,a,c,d,h,p,g,m,x,k,S,_;switch(this.transport=(r=i?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=i?.timeout)!==null&&a!==void 0?a:gu,this.heartbeatIntervalMs=(c=i?.heartbeatIntervalMs)!==null&&c!==void 0?c:Fa.HEARTBEAT_INTERVAL,this.worker=(d=i?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(h=i?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(p=i?.heartbeatCallback)!==null&&p!==void 0?p:Ud,this.vsn=(g=i?.vsn)!==null&&g!==void 0?g:ym,i?.params&&(this.params=i.params),i?.logger&&(this.logger=i.logger),(i?.logLevel||i?.log_level)&&(this.logLevel=i.logLevel||i.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=i?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>M1[w-1]||q1),this.vsn){case R1:this.encode=(x=i?.encode)!==null&&x!==void 0?x:((w,j)=>j(JSON.stringify(w))),this.decode=(k=i?.decode)!==null&&k!==void 0?k:((w,j)=>j(JSON.parse(w)));break;case Cx:this.encode=(S=i?.encode)!==null&&S!==void 0?S:this.serializer.encode.bind(this.serializer),this.decode=(_=i?.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=i?.workerUrl}}}var go=class extends Error{constructor(n,i){super(n),this.name="IcebergError",this.status=i.status,this.icebergType=i.icebergType,this.icebergCode=i.icebergCode,this.details=i.details,this.isCommitStateUnknown=i.icebergType==="CommitStateUnknownException"||[500,502,504].includes(i.status)&&i.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function L1(n,i,r){const a=new URL(i,n);if(r)for(const[c,d]of Object.entries(r))d!==void 0&&a.searchParams.set(c,d);return a.toString()}async function $1(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function H1(n){const i=n.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:c,body:d,headers:h}){const p=L1(n.baseUrl,a,c),g=await $1(n.auth),m=await i(p,{method:r,headers:{...d?{"Content-Type":"application/json"}:{},...g,...h},body:d?JSON.stringify(d):void 0}),x=await m.text(),k=(m.headers.get("content-type")||"").includes("application/json"),S=k&&x?JSON.parse(x):x;if(!m.ok){const _=k?S:void 0,w=_?.error;throw new go(w?.message??`Request failed with status ${m.status}`,{status:m.status,icebergType:w?.type,icebergCode:w?.code,details:_})}return{status:m.status,headers:m.headers,data:S}}}}function Ya(n){return n.join("")}var P1=class{constructor(n,i=""){this.client=n,this.prefix=i}async listNamespaces(n){const i=n?{parent:Ya(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:i})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(n,i){const r={namespace:n.namespace,properties:i?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ya(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ya(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ya(n.namespace)}`}),!0}catch(i){if(i instanceof go&&i.status===404)return!1;throw i}}async createNamespaceIfNotExists(n,i){try{return await this.createNamespace(n,i)}catch(r){if(r instanceof go&&r.status===409)return;throw r}}};function Ys(n){return n.join("")}var G1=class{constructor(n,i="",r){this.client=n,this.prefix=i,this.accessDelegation=r}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ys(n.namespace)}/tables`})).data.identifiers}async createTable(n,i){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ys(n.namespace)}/tables`,body:i,headers:r})).data.metadata}async updateTable(n,i){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ys(n.namespace)}/tables/${n.name}`,body:i});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(n,i){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ys(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String(i?.purge??!1)}})}async loadTable(n){const i={};return this.accessDelegation&&(i["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ys(n.namespace)}/tables/${n.name}`,headers:i})).data.metadata}async tableExists(n){const i={};this.accessDelegation&&(i["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ys(n.namespace)}/tables/${n.name}`,headers:i}),!0}catch(r){if(r instanceof go&&r.status===404)return!1;throw r}}async createTableIfNotExists(n,i){try{return await this.createTable(n,i)}catch(r){if(r instanceof go&&r.status===409)return await this.loadTable({namespace:n.namespace,name:i.name});throw r}}},V1=class{constructor(n){let i="v1";n.catalogName&&(i+=`/${n.catalogName}`);const r=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=H1({baseUrl:r,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=n.accessDelegation?.join(","),this.namespaceOps=new P1(this.client,i),this.tableOps=new G1(this.client,i,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,i){return this.namespaceOps.createNamespace(n,i)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,i){return this.tableOps.createTable(n,i)}async updateTable(n,i){return this.tableOps.updateTable(n,i)}async dropTable(n,i){await this.tableOps.dropTable(n,i)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,i){return this.namespaceOps.createNamespaceIfNotExists(n,i)}async createTableIfNotExists(n,i){return this.tableOps.createTableIfNotExists(n,i)}},ml=class extends Error{constructor(n){super(n),this.__isStorageError=!0,this.name="StorageError"}};function Ke(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var Z1=class extends ml{constructor(n,i,r){super(n),this.name="StorageApiError",this.status=i,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},yu=class extends ml{constructor(n,i){super(n),this.name="StorageUnknownError",this.originalError=i}};const Wu=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),F1=()=>Response,bu=n=>{if(Array.isArray(n))return n.map(r=>bu(r));if(typeof n=="function"||n!==Object(n))return n;const i={};return Object.entries(n).forEach(([r,a])=>{const c=r.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));i[c]=bu(a)}),i},Y1=n=>{if(typeof n!="object"||n===null)return!1;const i=Object.getPrototypeOf(n);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},K1=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function mo(n){"@babel/helpers - typeof";return mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},mo(n)}function Q1(n,i){if(mo(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var a=r.call(n,i);if(mo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(n)}function J1(n){var i=Q1(n,"string");return mo(i)=="symbol"?i:i+""}function X1(n,i,r){return(i=J1(i))in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,n}function km(n,i){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);i&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),r.push.apply(r,a)}return r}function ke(n){for(var i=1;i<arguments.length;i++){var r=arguments[i]!=null?arguments[i]:{};i%2?km(Object(r),!0).forEach(function(a){X1(n,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):km(Object(r)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))})}return n}const Ld=n=>{var i;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(i=n.error)===null||i===void 0?void 0:i.message)||JSON.stringify(n)},eS=async(n,i,r)=>{n instanceof await F1()&&!r?.noResolveJson?n.json().then(a=>{const c=n.status||500,d=a?.statusCode||c+"";i(new Z1(Ld(a),c,d))}).catch(a=>{i(new yu(Ld(a),a))}):i(new yu(Ld(n),n))},tS=(n,i,r,a)=>{const c={method:n,headers:i?.headers||{}};return n==="GET"||!a?c:(Y1(a)?(c.headers=ke({"Content-Type":"application/json"},i?.headers),c.body=JSON.stringify(a)):c.body=a,i?.duplex&&(c.duplex=i.duplex),ke(ke({},c),r))};async function Eo(n,i,r,a,c,d){return new Promise((h,p)=>{n(r,tS(i,a,c,d)).then(g=>{if(!g.ok)throw g;return a?.noResolveJson?g:g.json()}).then(g=>h(g)).catch(g=>eS(g,p,a))})}async function xo(n,i,r,a){return Eo(n,"GET",i,r,a)}async function pn(n,i,r,a,c){return Eo(n,"POST",i,a,c,r)}async function vu(n,i,r,a,c){return Eo(n,"PUT",i,a,c,r)}async function nS(n,i,r,a){return Eo(n,"HEAD",i,ke(ke({},r),{},{noResolveJson:!0}),a)}async function Uu(n,i,r,a,c){return Eo(n,"DELETE",i,a,c,r)}var iS=class{constructor(n,i){this.downloadFn=n,this.shouldThrowOnError=i}then(n,i){return this.execute().then(n,i)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ke(i))return{data:null,error:i};throw i}}};let Ax;Ax=Symbol.toStringTag;var sS=class{constructor(n,i){this.downloadFn=n,this.shouldThrowOnError=i,this[Ax]="BlobDownloadBuilder",this.promise=null}asStream(){return new iS(this.downloadFn,this.shouldThrowOnError)}then(n,i){return this.getPromise().then(n,i)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(Ke(i))return{data:null,error:i};throw i}}};const rS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},wm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var oS=class{constructor(n,i={},r,a){this.shouldThrowOnError=!1,this.url=n,this.headers=i,this.bucketId=r,this.fetch=Wu(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(n,i,r,a){var c=this;try{let d;const h=ke(ke({},wm),a);let p=ke(ke({},c.headers),n==="POST"&&{"x-upsert":String(h.upsert)});const g=h.metadata;typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),g&&d.append("metadata",c.encodeMetadata(g)),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.has("cacheControl")||d.append("cacheControl",h.cacheControl),g&&!d.has("metadata")&&d.append("metadata",c.encodeMetadata(g))):(d=r,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType,g&&(p["x-metadata"]=c.toBase64(c.encodeMetadata(g))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!h.duplex&&(h.duplex="half")),a?.headers&&(p=ke(ke({},p),a.headers));const m=c._removeEmptyFolders(i),x=c._getFinalPath(m),k=await(n=="PUT"?vu:pn)(c.fetch,`${c.url}/object/${x}`,d,ke({headers:p},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:m,id:k.Id,fullPath:k.Key},error:null}}catch(d){if(c.shouldThrowOnError)throw d;if(Ke(d))return{data:null,error:d};throw d}}async upload(n,i,r){return this.uploadOrUpdate("POST",n,i,r)}async uploadToSignedUrl(n,i,r,a){var c=this;const d=c._removeEmptyFolders(n),h=c._getFinalPath(d),p=new URL(c.url+`/object/upload/sign/${h}`);p.searchParams.set("token",i);try{let g;const m=ke({upsert:wm.upsert},a),x=ke(ke({},c.headers),{"x-upsert":String(m.upsert)});return typeof Blob<"u"&&r instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",r)):typeof FormData<"u"&&r instanceof FormData?(g=r,g.append("cacheControl",m.cacheControl)):(g=r,x["cache-control"]=`max-age=${m.cacheControl}`,x["content-type"]=m.contentType),{data:{path:d,fullPath:(await vu(c.fetch,p.toString(),g,{headers:x})).Key},error:null}}catch(g){if(c.shouldThrowOnError)throw g;if(Ke(g))return{data:null,error:g};throw g}}async createSignedUploadUrl(n,i){var r=this;try{let a=r._getFinalPath(n);const c=ke({},r.headers);i?.upsert&&(c["x-upsert"]="true");const d=await pn(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:c}),h=new URL(r.url+d.url),p=h.searchParams.get("token");if(!p)throw new ml("No token returned by API");return{data:{signedUrl:h.toString(),path:n,token:p},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}}async update(n,i,r){return this.uploadOrUpdate("PUT",n,i,r)}async move(n,i,r){var a=this;try{return{data:await pn(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:n,destinationKey:i,destinationBucket:r?.destinationBucket},{headers:a.headers}),error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Ke(c))return{data:null,error:c};throw c}}async copy(n,i,r){var a=this;try{return{data:{path:(await pn(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:n,destinationKey:i,destinationBucket:r?.destinationBucket},{headers:a.headers})).Key},error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Ke(c))return{data:null,error:c};throw c}}async createSignedUrl(n,i,r){var a=this;try{let c=a._getFinalPath(n),d=await pn(a.fetch,`${a.url}/object/sign/${c}`,ke({expiresIn:i},r?.transform?{transform:r.transform}:{}),{headers:a.headers});const h=r?.download?`&download=${r.download===!0?"":r.download}`:"";return d={signedUrl:encodeURI(`${a.url}${d.signedURL}${h}`)},{data:d,error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Ke(c))return{data:null,error:c};throw c}}async createSignedUrls(n,i,r){var a=this;try{const c=await pn(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:i,paths:n},{headers:a.headers}),d=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:c.map(h=>ke(ke({},h),{},{signedUrl:h.signedURL?encodeURI(`${a.url}${h.signedURL}${d}`):null})),error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Ke(c))return{data:null,error:c};throw c}}download(n,i){const r=typeof i?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(i?.transform||{}),c=a?`?${a}`:"",d=this._getFinalPath(n),h=()=>xo(this.fetch,`${this.url}/${r}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new sS(h,this.shouldThrowOnError)}async info(n){var i=this;const r=i._getFinalPath(n);try{return{data:bu(await xo(i.fetch,`${i.url}/object/info/${r}`,{headers:i.headers})),error:null}}catch(a){if(i.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}}async exists(n){var i=this;const r=i._getFinalPath(n);try{return await nS(i.fetch,`${i.url}/object/${r}`,{headers:i.headers}),{data:!0,error:null}}catch(a){if(i.shouldThrowOnError)throw a;if(Ke(a)&&a instanceof yu){const c=a.originalError;if([400,404].includes(c?.status))return{data:!1,error:a}}throw a}}getPublicUrl(n,i){const r=this._getFinalPath(n),a=[],c=i?.download?`download=${i.download===!0?"":i.download}`:"";c!==""&&a.push(c);const d=typeof i?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(i?.transform||{});h!==""&&a.push(h);let p=a.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${r}${p}`)}}}async remove(n){var i=this;try{return{data:await Uu(i.fetch,`${i.url}/object/${i.bucketId}`,{prefixes:n},{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}async list(n,i,r){var a=this;try{const c=ke(ke(ke({},rS),i),{},{prefix:n||""});return{data:await pn(a.fetch,`${a.url}/object/list/${a.bucketId}`,c,{headers:a.headers},r),error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Ke(c))return{data:null,error:c};throw c}}async listV2(n,i){var r=this;try{const a=ke({},n);return{data:await pn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},i),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const i=[];return n.width&&i.push(`width=${n.width}`),n.height&&i.push(`height=${n.height}`),n.resize&&i.push(`resize=${n.resize}`),n.format&&i.push(`format=${n.format}`),n.quality&&i.push(`quality=${n.quality}`),i.join("&")}};const zx="2.91.0",Dx={"X-Client-Info":`storage-js/${zx}`};var aS=class{constructor(n,i={},r,a){this.shouldThrowOnError=!1;const c=new URL(n);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href.replace(/\/$/,""),this.headers=ke(ke({},Dx),i),this.fetch=Wu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(n){var i=this;try{const r=i.listBucketOptionsToQueryString(n);return{data:await xo(i.fetch,`${i.url}/bucket${r}`,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}async getBucket(n){var i=this;try{return{data:await xo(i.fetch,`${i.url}/bucket/${n}`,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}async createBucket(n,i={public:!1}){var r=this;try{return{data:await pn(r.fetch,`${r.url}/bucket`,{id:n,name:n,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}}async updateBucket(n,i){var r=this;try{return{data:await vu(r.fetch,`${r.url}/bucket/${n}`,{id:n,name:n,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Ke(a))return{data:null,error:a};throw a}}async emptyBucket(n){var i=this;try{return{data:await pn(i.fetch,`${i.url}/bucket/${n}/empty`,{},{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}async deleteBucket(n){var i=this;try{return{data:await Uu(i.fetch,`${i.url}/bucket/${n}`,{},{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(n){const i={};return n&&("limit"in n&&(i.limit=String(n.limit)),"offset"in n&&(i.offset=String(n.offset)),n.search&&(i.search=n.search),n.sortColumn&&(i.sortColumn=n.sortColumn),n.sortOrder&&(i.sortOrder=n.sortOrder)),Object.keys(i).length>0?"?"+new URLSearchParams(i).toString():""}},lS=class{constructor(n,i={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ke(ke({},Dx),i),this.fetch=Wu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var i=this;try{return{data:await pn(i.fetch,`${i.url}/bucket`,{name:n},{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}async listBuckets(n){var i=this;try{const r=new URLSearchParams;n?.limit!==void 0&&r.set("limit",n.limit.toString()),n?.offset!==void 0&&r.set("offset",n.offset.toString()),n?.sortColumn&&r.set("sortColumn",n.sortColumn),n?.sortOrder&&r.set("sortOrder",n.sortOrder),n?.search&&r.set("search",n.search);const a=r.toString(),c=a?`${i.url}/bucket?${a}`:`${i.url}/bucket`;return{data:await xo(i.fetch,c,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}async deleteBucket(n){var i=this;try{return{data:await Uu(i.fetch,`${i.url}/bucket/${n}`,{},{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Ke(r))return{data:null,error:r};throw r}}from(n){var i=this;if(!K1(n))throw new ml("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new V1({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>i.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(c,d){const h=c[d];return typeof h!="function"?h:async(...p)=>{try{return{data:await h.apply(c,p),error:null}}catch(g){if(a)throw g;return{data:null,error:g}}}}})}};const Lu={"X-Client-Info":`storage-js/${zx}`,"Content-Type":"application/json"};var Ox=class extends Error{constructor(n){super(n),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Zt(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var $d=class extends Ox{constructor(n,i,r){super(n),this.name="StorageVectorsApiError",this.status=i,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},cS=class extends Ox{constructor(n,i){super(n),this.name="StorageVectorsUnknownError",this.originalError=i}};const $u=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),dS=n=>{if(typeof n!="object"||n===null)return!1;const i=Object.getPrototypeOf(n);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},_m=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),uS=async(n,i,r)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!r?.noResolveJson){const a=n.status||500,c=n;if(typeof c.json=="function")c.json().then(d=>{const h=d?.statusCode||d?.code||a+"";i(new $d(_m(d),a,h))}).catch(()=>{const d=a+"";i(new $d(c.statusText||`HTTP ${a} error`,a,d))});else{const d=a+"";i(new $d(c.statusText||`HTTP ${a} error`,a,d))}}else i(new cS(_m(n),n))},hS=(n,i,r,a)=>{const c={method:n,headers:i?.headers||{}};return a?(dS(a)?(c.headers=ke({"Content-Type":"application/json"},i?.headers),c.body=JSON.stringify(a)):c.body=a,ke(ke({},c),r)):c};async function fS(n,i,r,a,c,d){return new Promise((h,p)=>{n(r,hS(i,a,c,d)).then(g=>{if(!g.ok)throw g;if(a?.noResolveJson)return g;const m=g.headers.get("content-type");return!m||!m.includes("application/json")?{}:g.json()}).then(g=>h(g)).catch(g=>uS(g,p,a))})}async function Ft(n,i,r,a,c){return fS(n,"POST",i,a,c,r)}var pS=class{constructor(n,i={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ke(ke({},Lu),i),this.fetch=$u(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(n){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/CreateIndex`,n,{headers:i.headers})||{},error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async getIndex(n,i){var r=this;try{return{data:await Ft(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:n,indexName:i},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Zt(a))return{data:null,error:a};throw a}}async listIndexes(n){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/ListIndexes`,n,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async deleteIndex(n,i){var r=this;try{return{data:await Ft(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:n,indexName:i},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Zt(a))return{data:null,error:a};throw a}}},gS=class{constructor(n,i={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ke(ke({},Lu),i),this.fetch=$u(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(n){var i=this;try{if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ft(i.fetch,`${i.url}/PutVectors`,n,{headers:i.headers})||{},error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async getVectors(n){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/GetVectors`,n,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async listVectors(n){var i=this;try{if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return{data:await Ft(i.fetch,`${i.url}/ListVectors`,n,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async queryVectors(n){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/QueryVectors`,n,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async deleteVectors(n){var i=this;try{if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ft(i.fetch,`${i.url}/DeleteVectors`,n,{headers:i.headers})||{},error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}},mS=class{constructor(n,i={},r){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ke(ke({},Lu),i),this.fetch=$u(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:i.headers})||{},error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async getBucket(n){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/GetVectorBucket`,{vectorBucketName:n},{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async listBuckets(n={}){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/ListVectorBuckets`,n,{headers:i.headers}),error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}async deleteBucket(n){var i=this;try{return{data:await Ft(i.fetch,`${i.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:i.headers})||{},error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(Zt(r))return{data:null,error:r};throw r}}},xS=class extends mS{constructor(n,i={}){super(n,i.headers||{},i.fetch)}from(n){return new yS(this.url,this.headers,n,this.fetch)}async createBucket(n){var i=()=>super.createBucket,r=this;return i().call(r,n)}async getBucket(n){var i=()=>super.getBucket,r=this;return i().call(r,n)}async listBuckets(n={}){var i=()=>super.listBuckets,r=this;return i().call(r,n)}async deleteBucket(n){var i=()=>super.deleteBucket,r=this;return i().call(r,n)}},yS=class extends pS{constructor(n,i,r,a){super(n,i,a),this.vectorBucketName=r}async createIndex(n){var i=()=>super.createIndex,r=this;return i().call(r,ke(ke({},n),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(n={}){var i=()=>super.listIndexes,r=this;return i().call(r,ke(ke({},n),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(n){var i=()=>super.getIndex,r=this;return i().call(r,r.vectorBucketName,n)}async deleteIndex(n){var i=()=>super.deleteIndex,r=this;return i().call(r,r.vectorBucketName,n)}index(n){return new bS(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},bS=class extends gS{constructor(n,i,r,a,c){super(n,i,c),this.vectorBucketName=r,this.indexName=a}async putVectors(n){var i=()=>super.putVectors,r=this;return i().call(r,ke(ke({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(n){var i=()=>super.getVectors,r=this;return i().call(r,ke(ke({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(n={}){var i=()=>super.listVectors,r=this;return i().call(r,ke(ke({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(n){var i=()=>super.queryVectors,r=this;return i().call(r,ke(ke({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(n){var i=()=>super.deleteVectors,r=this;return i().call(r,ke(ke({},n),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},vS=class extends aS{constructor(n,i={},r,a){super(n,i,r,a)}from(n){return new oS(this.url,this.headers,n,this.fetch)}get vectors(){return new xS(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new lS(this.url+"/iceberg",this.headers,this.fetch)}};const Ix="2.91.0",nr=30*1e3,Su=3,Hd=Su*nr,SS="http://localhost:9999",kS="supabase.auth.token",wS={"X-Client-Info":`gotrue-js/${Ix}`},ku="X-Supabase-Api-Version",Bx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_S=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jS=600*1e3;class yo extends Error{constructor(i,r,a){super(i),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function pe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class CS extends yo{constructor(i,r,a){super(i,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function RS(n){return pe(n)&&n.name==="AuthApiError"}class is extends yo{constructor(i,r){super(i),this.name="AuthUnknownError",this.originalError=r}}class Qn extends yo{constructor(i,r,a,c){super(i,a,c),this.name=r,this.status=a}}class Vt extends Qn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ES(n){return pe(n)&&n.name==="AuthSessionMissingError"}class Ks extends Qn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ka extends Qn{constructor(i){super(i,"AuthInvalidCredentialsError",400,void 0)}}class Qa extends Qn{constructor(i,r=null){super(i,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function TS(n){return pe(n)&&n.name==="AuthImplicitGrantRedirectError"}class jm extends Qn{constructor(i,r=null){super(i,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AS extends Qn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class wu extends Qn{constructor(i,r){super(i,"AuthRetryableFetchError",r,void 0)}}function Pd(n){return pe(n)&&n.name==="AuthRetryableFetchError"}class Cm extends Qn{constructor(i,r,a){super(i,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class _u extends Qn{constructor(i){super(i,"AuthInvalidJwtError",400,"invalid_jwt")}}const rl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Rm=` 	
\r=`.split(""),zS=(()=>{const n=new Array(128);for(let i=0;i<n.length;i+=1)n[i]=-1;for(let i=0;i<Rm.length;i+=1)n[Rm[i].charCodeAt(0)]=-2;for(let i=0;i<rl.length;i+=1)n[rl[i].charCodeAt(0)]=i;return n})();function Em(n,i,r){if(n!==null)for(i.queue=i.queue<<8|n,i.queuedBits+=8;i.queuedBits>=6;){const a=i.queue>>i.queuedBits-6&63;r(rl[a]),i.queuedBits-=6}else if(i.queuedBits>0)for(i.queue=i.queue<<6-i.queuedBits,i.queuedBits=6;i.queuedBits>=6;){const a=i.queue>>i.queuedBits-6&63;r(rl[a]),i.queuedBits-=6}}function Nx(n,i,r){const a=zS[n];if(a>-1)for(i.queue=i.queue<<6|a,i.queuedBits+=6;i.queuedBits>=8;)r(i.queue>>i.queuedBits-8&255),i.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Tm(n){const i=[],r=h=>{i.push(String.fromCodePoint(h))},a={utf8seq:0,codepoint:0},c={queue:0,queuedBits:0},d=h=>{IS(h,a,r)};for(let h=0;h<n.length;h+=1)Nx(n.charCodeAt(h),c,d);return i.join("")}function DS(n,i){if(n<=127){i(n);return}else if(n<=2047){i(192|n>>6),i(128|n&63);return}else if(n<=65535){i(224|n>>12),i(128|n>>6&63),i(128|n&63);return}else if(n<=1114111){i(240|n>>18),i(128|n>>12&63),i(128|n>>6&63),i(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function OS(n,i){for(let r=0;r<n.length;r+=1){let a=n.charCodeAt(r);if(a>55295&&a<=56319){const c=(a-55296)*1024&65535;a=(n.charCodeAt(r+1)-56320&65535|c)+65536,r+=1}DS(a,i)}}function IS(n,i,r){if(i.utf8seq===0){if(n<=127){r(n);return}for(let a=1;a<6;a+=1)if((n>>7-a&1)===0){i.utf8seq=a;break}if(i.utf8seq===2)i.codepoint=n&31;else if(i.utf8seq===3)i.codepoint=n&15;else if(i.utf8seq===4)i.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");i.utf8seq-=1}else if(i.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");i.codepoint=i.codepoint<<6|n&63,i.utf8seq-=1,i.utf8seq===0&&r(i.codepoint)}}function rr(n){const i=[],r={queue:0,queuedBits:0},a=c=>{i.push(c)};for(let c=0;c<n.length;c+=1)Nx(n.charCodeAt(c),r,a);return new Uint8Array(i)}function BS(n){const i=[];return OS(n,r=>i.push(r)),new Uint8Array(i)}function ss(n){const i=[],r={queue:0,queuedBits:0},a=c=>{i.push(c)};return n.forEach(c=>Em(c,r,a)),Em(null,r,a),i.join("")}function NS(n){return Math.round(Date.now()/1e3)+n}function MS(){return Symbol("auth-callback")}const St=()=>typeof window<"u"&&typeof document<"u",Qi={tested:!1,writable:!1},Mx=()=>{if(!St())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Qi.tested)return Qi.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Qi.tested=!0,Qi.writable=!0}catch{Qi.tested=!0,Qi.writable=!1}return Qi.writable};function qS(n){const i={},r=new URL(n);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((c,d)=>{i[d]=c})}catch{}return r.searchParams.forEach((a,c)=>{i[c]=a}),i}const qx=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),WS=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ir=async(n,i,r)=>{await n.setItem(i,JSON.stringify(r))},Ji=async(n,i)=>{const r=await n.getItem(i);if(!r)return null;try{return JSON.parse(r)}catch{return r}},vt=async(n,i)=>{await n.removeItem(i)};class xl{constructor(){this.promise=new xl.promiseConstructor((i,r)=>{this.resolve=i,this.reject=r})}}xl.promiseConstructor=Promise;function Gd(n){const i=n.split(".");if(i.length!==3)throw new _u("Invalid JWT structure");for(let a=0;a<i.length;a++)if(!_S.test(i[a]))throw new _u("JWT not in base64url format");return{header:JSON.parse(Tm(i[0])),payload:JSON.parse(Tm(i[1])),signature:rr(i[2]),raw:{header:i[0],payload:i[1]}}}async function US(n){return await new Promise(i=>{setTimeout(()=>i(null),n)})}function LS(n,i){return new Promise((a,c)=>{(async()=>{for(let d=0;d<1/0;d++)try{const h=await n(d);if(!i(d,null,h)){a(h);return}}catch(h){if(!i(d,h)){c(h);return}}})()})}function $S(n){return("0"+n.toString(16)).substr(-2)}function HS(){const i=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let c="";for(let d=0;d<56;d++)c+=r.charAt(Math.floor(Math.random()*a));return c}return crypto.getRandomValues(i),Array.from(i,$S).join("")}async function PS(n){const r=new TextEncoder().encode(n),a=await crypto.subtle.digest("SHA-256",r),c=new Uint8Array(a);return Array.from(c).map(d=>String.fromCharCode(d)).join("")}async function GS(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const r=await PS(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Qs(n,i,r=!1){const a=HS();let c=a;r&&(c+="/PASSWORD_RECOVERY"),await ir(n,`${i}-code-verifier`,c);const d=await GS(a);return[d,a===d?"plain":"s256"]}const VS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ZS(n){const i=n.headers.get(ku);if(!i||!i.match(VS))return null;try{return new Date(`${i}T00:00:00.0Z`)}catch{return null}}function FS(n){if(!n)throw new Error("Missing exp claim");const i=Math.floor(Date.now()/1e3);if(n<=i)throw new Error("JWT has expired")}function YS(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const KS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Js(n){if(!KS.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Vd(){const n={};return new Proxy(n,{get:(i,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(i,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(i,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function QS(n,i){return new Proxy(n,{get:(r,a,c)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const d=a.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,c)}return!i.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i.value=!0),Reflect.get(r,a,c)}})}function Am(n){return JSON.parse(JSON.stringify(n))}const Xi=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),JS=[502,503,504];async function zm(n){var i;if(!WS(n))throw new wu(Xi(n),0);if(JS.includes(n.status))throw new wu(Xi(n),n.status);let r;try{r=await n.json()}catch(d){throw new is(Xi(d),d)}let a;const c=ZS(n);if(c&&c.getTime()>=Bx["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Cm(Xi(r),n.status,((i=r.weak_password)===null||i===void 0?void 0:i.reasons)||[]);if(a==="session_not_found")throw new Vt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((d,h)=>d&&typeof h=="string",!0))throw new Cm(Xi(r),n.status,r.weak_password.reasons);throw new CS(Xi(r),n.status||500,a)}const XS=(n,i,r,a)=>{const c={method:n,headers:i?.headers||{}};return n==="GET"?c:(c.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},i?.headers),c.body=JSON.stringify(a),Object.assign(Object.assign({},c),r))};async function Se(n,i,r,a){var c;const d=Object.assign({},a?.headers);d[ku]||(d[ku]=Bx["2024-01-01"].name),a?.jwt&&(d.Authorization=`Bearer ${a.jwt}`);const h=(c=a?.query)!==null&&c!==void 0?c:{};a?.redirectTo&&(h.redirect_to=a.redirectTo);const p=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",g=await ek(n,i,r+p,{headers:d,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(g):{data:Object.assign({},g),error:null}}async function ek(n,i,r,a,c,d){const h=XS(i,a,c,d);let p;try{p=await n(r,Object.assign({},h))}catch(g){throw console.error(g),new wu(Xi(g),0)}if(p.ok||await zm(p),a?.noResolveJson)return p;try{return await p.json()}catch(g){await zm(g)}}function fn(n){var i;let r=null;ik(n)&&(r=Object.assign({},n),n.expires_at||(r.expires_at=NS(n.expires_in)));const a=(i=n.user)!==null&&i!==void 0?i:n;return{data:{session:r,user:a},error:null}}function Dm(n){const i=fn(n);return!i.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(i.data.weak_password=n.weak_password),i}function Ci(n){var i;return{data:{user:(i=n.user)!==null&&i!==void 0?i:n},error:null}}function tk(n){return{data:n,error:null}}function nk(n){const{action_link:i,email_otp:r,hashed_token:a,redirect_to:c,verification_type:d}=n,h=gl(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),p={action_link:i,email_otp:r,hashed_token:a,redirect_to:c,verification_type:d},g=Object.assign({},h);return{data:{properties:p,user:g},error:null}}function Om(n){return n}function ik(n){return n.access_token&&n.refresh_token&&n.expires_in}const Zd=["global","local","others"];class sk{constructor({url:i="",headers:r={},fetch:a}){this.url=i,this.headers=r,this.fetch=qx(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(i,r=Zd[0]){if(Zd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zd.join(", ")}`);try{return await Se(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:i,noResolveJson:!0}),{data:null,error:null}}catch(a){if(pe(a))return{data:null,error:a};throw a}}async inviteUserByEmail(i,r={}){try{return await Se(this.fetch,"POST",`${this.url}/invite`,{body:{email:i,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ci})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async generateLink(i){try{const{options:r}=i,a=gl(i,["options"]),c=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(c.new_email=a?.newEmail,delete c.newEmail),await Se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:c,headers:this.headers,xform:nk,redirectTo:r?.redirectTo})}catch(r){if(pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(i){try{return await Se(this.fetch,"POST",`${this.url}/admin/users`,{body:i,headers:this.headers,xform:Ci})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async listUsers(i){var r,a,c,d,h,p,g;try{const m={nextPage:null,lastPage:0,total:0},x=await Se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=i?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(d=(c=i?.perPage)===null||c===void 0?void 0:c.toString())!==null&&d!==void 0?d:""},xform:Om});if(x.error)throw x.error;const k=await x.json(),S=(h=x.headers.get("x-total-count"))!==null&&h!==void 0?h:0,_=(g=(p=x.headers.get("link"))===null||p===void 0?void 0:p.split(","))!==null&&g!==void 0?g:[];return _.length>0&&(_.forEach(w=>{const j=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(w.split(";")[1].split("=")[1]);m[`${A}Page`]=j}),m.total=parseInt(S)),{data:Object.assign(Object.assign({},k),m),error:null}}catch(m){if(pe(m))return{data:{users:[]},error:m};throw m}}async getUserById(i){Js(i);try{return await Se(this.fetch,"GET",`${this.url}/admin/users/${i}`,{headers:this.headers,xform:Ci})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(i,r){Js(i);try{return await Se(this.fetch,"PUT",`${this.url}/admin/users/${i}`,{body:r,headers:this.headers,xform:Ci})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async deleteUser(i,r=!1){Js(i);try{return await Se(this.fetch,"DELETE",`${this.url}/admin/users/${i}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ci})}catch(a){if(pe(a))return{data:{user:null},error:a};throw a}}async _listFactors(i){Js(i.userId);try{const{data:r,error:a}=await Se(this.fetch,"GET",`${this.url}/admin/users/${i.userId}/factors`,{headers:this.headers,xform:c=>({data:{factors:c},error:null})});return{data:r,error:a}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _deleteFactor(i){Js(i.userId),Js(i.id);try{return{data:await Se(this.fetch,"DELETE",`${this.url}/admin/users/${i.userId}/factors/${i.id}`,{headers:this.headers}),error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _listOAuthClients(i){var r,a,c,d,h,p,g;try{const m={nextPage:null,lastPage:0,total:0},x=await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=i?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(d=(c=i?.perPage)===null||c===void 0?void 0:c.toString())!==null&&d!==void 0?d:""},xform:Om});if(x.error)throw x.error;const k=await x.json(),S=(h=x.headers.get("x-total-count"))!==null&&h!==void 0?h:0,_=(g=(p=x.headers.get("link"))===null||p===void 0?void 0:p.split(","))!==null&&g!==void 0?g:[];return _.length>0&&(_.forEach(w=>{const j=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(w.split(";")[1].split("=")[1]);m[`${A}Page`]=j}),m.total=parseInt(S)),{data:Object.assign(Object.assign({},k),m),error:null}}catch(m){if(pe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(i){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:i,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _getOAuthClient(i){try{return await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients/${i}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(i,r){try{return await Se(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${i}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(pe(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(i){try{return await Se(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${i}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(i){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients/${i}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(pe(r))return{data:null,error:r};throw r}}}function Im(n={}){return{getItem:i=>n[i]||null,setItem:(i,r)=>{n[i]=r},removeItem:i=>{delete n[i]}}}const Xs={debug:!!(globalThis&&Mx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Wx extends Error{constructor(i){super(i),this.isAcquireTimeout=!0}}class rk extends Wx{}async function ok(n,i,r){Xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,i);const a=new globalThis.AbortController;return i>0&&setTimeout(()=>{a.abort(),Xs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},i),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,i===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async c=>{if(c){Xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,c.name);try{return await r()}finally{Xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,c.name)}}else{if(i===0)throw Xs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new rk(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Xs.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function ak(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ux(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function lk(n){return parseInt(n,16)}function ck(n){const i=new TextEncoder().encode(n);return"0x"+Array.from(i,a=>a.toString(16).padStart(2,"0")).join("")}function dk(n){var i;const{chainId:r,domain:a,expirationTime:c,issuedAt:d=new Date,nonce:h,notBefore:p,requestId:g,resources:m,scheme:x,uri:k,version:S}=n;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!k)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(S!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${S}`);if(!((i=n.statement)===null||i===void 0)&&i.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const _=Ux(n.address),w=x?`${x}://${a}`:a,j=n.statement?`${n.statement}
`:"",A=`${w} wants you to sign in with your Ethereum account:
${_}

${j}`;let z=`URI: ${k}
Version: ${S}
Chain ID: ${r}${h?`
Nonce: ${h}`:""}
Issued At: ${d.toISOString()}`;if(c&&(z+=`
Expiration Time: ${c.toISOString()}`),p&&(z+=`
Not Before: ${p.toISOString()}`),g&&(z+=`
Request ID: ${g}`),m){let D=`
Resources:`;for(const y of m){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);D+=`
- ${y}`}z+=D}return`${A}
${z}`}class lt extends Error{constructor({message:i,code:r,cause:a,name:c}){var d;super(i,{cause:a}),this.__isWebAuthnError=!0,this.name=(d=c??(a instanceof Error?a.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=r}}class ol extends lt{constructor(i,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:i}),this.name="WebAuthnUnknownError",this.originalError=r}}function uk({error:n,options:i}){var r,a,c;const{publicKey:d}=i;if(!d)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(i.signal instanceof AbortSignal)return new lt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((r=d.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new lt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(i.mediation==="conditional"&&((a=d.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new lt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((c=d.authenticatorSelection)===null||c===void 0?void 0:c.userVerification)==="required")return new lt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new lt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new lt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return d.pubKeyCredParams.filter(p=>p.type==="public-key").length===0?new lt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new lt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const h=window.location.hostname;if(Lx(h)){if(d.rp.id!==h)return new lt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new lt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new lt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new lt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new lt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function hk({error:n,options:i}){const{publicKey:r}=i;if(!r)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(i.signal instanceof AbortSignal)return new lt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new lt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const a=window.location.hostname;if(Lx(a)){if(r.rpId!==a)return new lt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new lt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new lt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new lt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class fk{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const i=new AbortController;return this.controller=i,i.signal}cancelCeremony(){if(this.controller){const i=new Error("Manually cancelling existing WebAuthn API call");i.name="AbortError",this.controller.abort(i),this.controller=void 0}}}const pk=new fk;function gk(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:i,user:r,excludeCredentials:a}=n,c=gl(n,["challenge","user","excludeCredentials"]),d=rr(i).buffer,h=Object.assign(Object.assign({},r),{id:rr(r.id).buffer}),p=Object.assign(Object.assign({},c),{challenge:d,user:h});if(a&&a.length>0){p.excludeCredentials=new Array(a.length);for(let g=0;g<a.length;g++){const m=a[g];p.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:rr(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return p}function mk(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:i,allowCredentials:r}=n,a=gl(n,["challenge","allowCredentials"]),c=rr(i).buffer,d=Object.assign(Object.assign({},a),{challenge:c});if(r&&r.length>0){d.allowCredentials=new Array(r.length);for(let h=0;h<r.length;h++){const p=r[h];d.allowCredentials[h]=Object.assign(Object.assign({},p),{id:rr(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return d}function xk(n){var i;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const r=n;return{id:n.id,rawId:n.id,response:{attestationObject:ss(new Uint8Array(n.response.attestationObject)),clientDataJSON:ss(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(i=r.authenticatorAttachment)!==null&&i!==void 0?i:void 0}}function yk(n){var i;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const r=n,a=n.getClientExtensionResults(),c=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:ss(new Uint8Array(c.authenticatorData)),clientDataJSON:ss(new Uint8Array(c.clientDataJSON)),signature:ss(new Uint8Array(c.signature)),userHandle:c.userHandle?ss(new Uint8Array(c.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(i=r.authenticatorAttachment)!==null&&i!==void 0?i:void 0}}function Lx(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Bm(){var n,i;return!!(St()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((i=navigator?.credentials)===null||i===void 0?void 0:i.get)=="function")}async function bk(n){try{const i=await navigator.credentials.create(n);return i?i instanceof PublicKeyCredential?{data:i,error:null}:{data:null,error:new ol("Browser returned unexpected credential type",i)}:{data:null,error:new ol("Empty credential response",i)}}catch(i){return{data:null,error:uk({error:i,options:n})}}}async function vk(n){try{const i=await navigator.credentials.get(n);return i?i instanceof PublicKeyCredential?{data:i,error:null}:{data:null,error:new ol("Browser returned unexpected credential type",i)}:{data:null,error:new ol("Empty credential response",i)}}catch(i){return{data:null,error:hk({error:i,options:n})}}}const Sk={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},kk={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function al(...n){const i=c=>c!==null&&typeof c=="object"&&!Array.isArray(c),r=c=>c instanceof ArrayBuffer||ArrayBuffer.isView(c),a={};for(const c of n)if(c)for(const d in c){const h=c[d];if(h!==void 0)if(Array.isArray(h))a[d]=h;else if(r(h))a[d]=h;else if(i(h)){const p=a[d];i(p)?a[d]=al(p,h):a[d]=al(h)}else a[d]=h}return a}function wk(n,i){return al(Sk,n,i||{})}function _k(n,i){return al(kk,n,i||{})}class jk{constructor(i){this.client=i,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(i){return this.client.mfa.enroll(Object.assign(Object.assign({},i),{factorType:"webauthn"}))}async _challenge({factorId:i,webauthn:r,friendlyName:a,signal:c},d){try{const{data:h,error:p}=await this.client.mfa.challenge({factorId:i,webauthn:r});if(!h)return{data:null,error:p};const g=c??pk.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${a}`),m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=wk(h.webauthn.credential_options.publicKey,d?.create),{data:x,error:k}=await bk({publicKey:m,signal:g});return x?{data:{factorId:i,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:x}},error:null}:{data:null,error:k}}case"request":{const m=_k(h.webauthn.credential_options.publicKey,d?.request),{data:x,error:k}=await vk(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:g}));return x?{data:{factorId:i,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:x}},error:null}:{data:null,error:k}}}}catch(h){return pe(h)?{data:null,error:h}:{data:null,error:new is("Unexpected error in challenge",h)}}}async _verify({challengeId:i,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:i,webauthn:a})}async _authenticate({factorId:i,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:c}={}},d){if(!r)return{data:null,error:new yo("rpId is required for WebAuthn authentication")};try{if(!Bm())return{data:null,error:new is("Browser does not support WebAuthn",null)};const{data:h,error:p}=await this.challenge({factorId:i,webauthn:{rpId:r,rpOrigins:a},signal:c},{request:d});if(!h)return{data:null,error:p};const{webauthn:g}=h;return this._verify({factorId:i,challengeId:h.challengeId,webauthn:{type:g.type,rpId:r,rpOrigins:a,credential_response:g.credential_response}})}catch(h){return pe(h)?{data:null,error:h}:{data:null,error:new is("Unexpected error in authenticate",h)}}}async _register({friendlyName:i,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:c}={}},d){if(!r)return{data:null,error:new yo("rpId is required for WebAuthn registration")};try{if(!Bm())return{data:null,error:new is("Browser does not support WebAuthn",null)};const{data:h,error:p}=await this._enroll({friendlyName:i});if(!h)return await this.client.mfa.listFactors().then(x=>{var k;return(k=x.data)===null||k===void 0?void 0:k.all.find(S=>S.factor_type==="webauthn"&&S.friendly_name===i&&S.status!=="unverified")}).then(x=>x?this.client.mfa.unenroll({factorId:x?.id}):void 0),{data:null,error:p};const{data:g,error:m}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:c},{create:d});return g?this._verify({factorId:h.id,challengeId:g.challengeId,webauthn:{rpId:r,rpOrigins:a,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(h){return pe(h)?{data:null,error:h}:{data:null,error:new is("Unexpected error in register",h)}}}}ak();const Ck={url:SS,storageKey:kS,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Nm(n,i,r){return await r()}const er={};class bo{get jwks(){var i,r;return(r=(i=er[this.storageKey])===null||i===void 0?void 0:i.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(i){er[this.storageKey]=Object.assign(Object.assign({},er[this.storageKey]),{jwks:i})}get jwks_cached_at(){var i,r;return(r=(i=er[this.storageKey])===null||i===void 0?void 0:i.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(i){er[this.storageKey]=Object.assign(Object.assign({},er[this.storageKey]),{cachedAt:i})}constructor(i){var r,a,c;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},Ck),i);if(this.storageKey=d.storageKey,this.instanceID=(r=bo.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,bo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&St()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new sk({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=qx(d.fetch),this.lock=d.lock||Nm,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,this.lockAcquireTimeout=d.lockAcquireTimeout,d.lock?this.lock=d.lock:this.persistSession&&St()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=ok:this.lock=Nm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new jk(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:Mx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Im(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=Im(this.memoryStorage)),St()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(c=this.broadcastChannel)===null||c===void 0||c.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(i){if(this.throwOnError&&i&&i.error)throw i.error;return i}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Ix}) ${new Date().toISOString()}`}_debug(...i){return this.logDebugMessages&&this.logger(this._logPrefix(),...i),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var i;try{let r={},a="none";if(St()&&(r=qS(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),St()&&this.detectSessionInUrl&&a!=="none"){const{data:c,error:d}=await this._getSessionFromURL(r,a);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),TS(d)){const g=(i=d.details)===null||i===void 0?void 0:i.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:d}}return{error:d}}const{session:h,redirectType:p}=c;return this._debug("#_initialize()","detected session in URL",h,"redirect type",p),await this._saveSession(h),setTimeout(async()=>{p==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return pe(r)?this._returnResult({error:r}):this._returnResult({error:new is("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(i){var r,a,c;try{const d=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=i?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(c=i?.options)===null||c===void 0?void 0:c.captchaToken}},xform:fn}),{data:h,error:p}=d;if(p||!h)return this._returnResult({data:{user:null,session:null},error:p});const g=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(d){if(pe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(i){var r,a,c;try{let d;if("email"in i){const{email:x,password:k,options:S}=i;let _=null,w=null;this.flowType==="pkce"&&([_,w]=await Qs(this.storage,this.storageKey)),d=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:S?.emailRedirectTo,body:{email:x,password:k,data:(r=S?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:S?.captchaToken},code_challenge:_,code_challenge_method:w},xform:fn})}else if("phone"in i){const{phone:x,password:k,options:S}=i;d=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:k,data:(a=S?.data)!==null&&a!==void 0?a:{},channel:(c=S?.channel)!==null&&c!==void 0?c:"sms",gotrue_meta_security:{captcha_token:S?.captchaToken}},xform:fn})}else throw new Ka("You must provide either an email or phone number and a password");const{data:h,error:p}=d;if(p||!h)return await vt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:p});const g=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(d){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(i){try{let r;if("email"in i){const{email:d,password:h,options:p}=i;r=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Dm})}else if("phone"in i){const{phone:d,password:h,options:p}=i;r=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Dm})}else throw new Ka("You must provide either an email or phone number and a password");const{data:a,error:c}=r;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a||!a.session||!a.user){const d=new Ks;return this._returnResult({data:{user:null,session:null},error:d})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:c})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(i){var r,a,c,d;return await this._handleProviderSignIn(i.provider,{redirectTo:(r=i.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=i.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=i.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:(d=i.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(i){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(i))}async signInWithWeb3(i){const{chain:r}=i;switch(r){case"ethereum":return await this.signInWithEthereum(i);case"solana":return await this.signInWithSolana(i);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(i){var r,a,c,d,h,p,g,m,x,k,S;let _,w;if("message"in i)_=i.message,w=i.signature;else{const{chain:j,wallet:A,statement:z,options:D}=i;let y;if(St())if(typeof A=="object")y=A;else{const K=window;if("ethereum"in K&&typeof K.ethereum=="object"&&"request"in K.ethereum&&typeof K.ethereum.request=="function")y=K.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!D?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=A}const C=new URL((r=D?.url)!==null&&r!==void 0?r:window.location.href),T=await y.request({method:"eth_requestAccounts"}).then(K=>K).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=Ux(T[0]);let W=(a=D?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!W){const K=await y.request({method:"eth_chainId"});W=lk(K)}const M={domain:C.host,address:E,statement:z,uri:C.href,version:"1",chainId:W,nonce:(c=D?.signInWithEthereum)===null||c===void 0?void 0:c.nonce,issuedAt:(h=(d=D?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(p=D?.signInWithEthereum)===null||p===void 0?void 0:p.expirationTime,notBefore:(g=D?.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=D?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(x=D?.signInWithEthereum)===null||x===void 0?void 0:x.resources};_=dk(M),w=await y.request({method:"personal_sign",params:[ck(_),E]})}try{const{data:j,error:A}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:w},!((k=i.options)===null||k===void 0)&&k.captchaToken?{gotrue_meta_security:{captcha_token:(S=i.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:fn});if(A)throw A;if(!j||!j.session||!j.user){const z=new Ks;return this._returnResult({data:{user:null,session:null},error:z})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:A})}catch(j){if(pe(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async signInWithSolana(i){var r,a,c,d,h,p,g,m,x,k,S,_;let w,j;if("message"in i)w=i.message,j=i.signature;else{const{chain:A,wallet:z,statement:D,options:y}=i;let C;if(St())if(typeof z=="object")C=z;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))C=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof z!="object"||!y?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=z}const T=new URL((r=y?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in C&&C.signIn){const E=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y?.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),D?{statement:D}:null));let W;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")W=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)W=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in W&&"signature"in W&&(typeof W.signedMessage=="string"||W.signedMessage instanceof Uint8Array)&&W.signature instanceof Uint8Array)w=typeof W.signedMessage=="string"?W.signedMessage:new TextDecoder().decode(W.signedMessage),j=W.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${T.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...D?["",D,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(c=(a=y?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&c!==void 0?c:new Date().toISOString()}`,...!((d=y?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((h=y?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((p=y?.signInWithSolana)===null||p===void 0)&&p.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((g=y?.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((m=y?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((k=(x=y?.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||k===void 0)&&k.length?["Resources",...y.signInWithSolana.resources.map(W=>`- ${W}`)]:[]].join(`
`);const E=await C.signMessage(new TextEncoder().encode(w),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=E}}try{const{data:A,error:z}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:ss(j)},!((S=i.options)===null||S===void 0)&&S.captchaToken?{gotrue_meta_security:{captcha_token:(_=i.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:fn});if(z)throw z;if(!A||!A.session||!A.user){const D=new Ks;return this._returnResult({data:{user:null,session:null},error:D})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:z})}catch(A){if(pe(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async _exchangeCodeForSession(i){const r=await Ji(this.storage,`${this.storageKey}-code-verifier`),[a,c]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new AS;const{data:d,error:h}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:i,code_verifier:a},xform:fn});if(await vt(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!d||!d.session||!d.user){const p=new Ks;return this._returnResult({data:{user:null,session:null,redirectType:null},error:p})}return d.session&&(await this._saveSession(d.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",d.session)},0)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:c??null}),error:h})}catch(d){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(i){try{const{options:r,provider:a,token:c,access_token:d,nonce:h}=i,p=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:c,access_token:d,nonce:h,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:fn}),{data:g,error:m}=p;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!g||!g.session||!g.user){const x=new Ks;return this._returnResult({data:{user:null,session:null},error:x})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:m})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(i){var r,a,c,d,h;try{if("email"in i){const{email:p,options:g}=i;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Qs(this.storage,this.storageKey));const{error:k}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:p,data:(r=g?.data)!==null&&r!==void 0?r:{},create_user:(a=g?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:g?.captchaToken},code_challenge:m,code_challenge_method:x},redirectTo:g?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:k})}if("phone"in i){const{phone:p,options:g}=i,{data:m,error:x}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:p,data:(c=g?.data)!==null&&c!==void 0?c:{},create_user:(d=g?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:g?.captchaToken},channel:(h=g?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:x})}throw new Ka("You must provide either an email or phone number.")}catch(p){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async verifyOtp(i){var r,a;try{let c,d;"options"in i&&(c=(r=i.options)===null||r===void 0?void 0:r.redirectTo,d=(a=i.options)===null||a===void 0?void 0:a.captchaToken);const{data:h,error:p}=await Se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},i),{gotrue_meta_security:{captcha_token:d}}),redirectTo:c,xform:fn});if(p)throw p;if(!h)throw new Error("An error occurred on token verification.");const g=h.session,m=h.user;return g?.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(i.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(c){if(pe(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signInWithSSO(i){var r,a,c,d,h;try{let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Qs(this.storage,this.storageKey));const m=await Se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in i?{provider_id:i.providerId}:null),"domain"in i?{domain:i.domain}:null),{redirect_to:(a=(r=i.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((c=i?.options)===null||c===void 0)&&c.captchaToken?{gotrue_meta_security:{captcha_token:i.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:p,code_challenge_method:g}),headers:this.headers,xform:tk});return!((d=m.data)===null||d===void 0)&&d.url&&St()&&!(!((h=i.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(p){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(p))return this._returnResult({data:null,error:p});throw p}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async i=>{const{data:{session:r},error:a}=i;if(a)throw a;if(!r)throw new Vt;const{error:c}=await Se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:c})})}catch(i){if(pe(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async resend(i){try{const r=`${this.url}/resend`;if("email"in i){const{email:a,type:c,options:d}=i,{error:h}=await Se(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in i){const{phone:a,type:c,options:d}=i,{data:h,error:p}=await Se(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:c,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:p})}throw new Ka("You must provide either an email or phone number and a type")}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(i,r){this._debug("#_acquireLock","begin",i);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await c}catch{}})()),c}return await this.lock(`lock:${this.storageKey}`,i,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const c=[...this.pendingInLock];await Promise.all(c),this.pendingInLock.splice(0,c.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(i){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await i(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let i=null;const r=await Ji(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?i=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!i)return{data:{session:null},error:null};const a=i.expires_at?i.expires_at*1e3-Date.now()<Hd:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",i.expires_at),!a){if(this.userStorage){const h=await Ji(this.userStorage,this.storageKey+"-user");h?.user?i.user=h.user:i.user=Vd()}if(this.storage.isServer&&i.user&&!i.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};i.user=QS(i.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:i},error:null}}const{data:c,error:d}=await this._callRefreshToken(i.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:c},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(i){if(i)return await this._getUser(i);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(i){try{return i?await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:i,xform:Ci}):await this._useSession(async r=>{var a,c,d;const{data:h,error:p}=r;if(p)throw p;return!(!((a=h.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vt}:await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0,xform:Ci})})}catch(r){if(pe(r))return ES(r)&&(await this._removeSession(),await vt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(i,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(i,r))}async _updateUser(i,r={}){try{return await this._useSession(async a=>{const{data:c,error:d}=a;if(d)throw d;if(!c.session)throw new Vt;const h=c.session;let p=null,g=null;this.flowType==="pkce"&&i.email!=null&&([p,g]=await Qs(this.storage,this.storageKey));const{data:m,error:x}=await Se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},i),{code_challenge:p,code_challenge_method:g}),jwt:h.access_token,xform:Ci});if(x)throw x;return h.user=m.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(a){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(i){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(i))}async _setSession(i){try{if(!i.access_token||!i.refresh_token)throw new Vt;const r=Date.now()/1e3;let a=r,c=!0,d=null;const{payload:h}=Gd(i.access_token);if(h.exp&&(a=h.exp,c=a<=r),c){const{data:p,error:g}=await this._callRefreshToken(i.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!p)return{data:{user:null,session:null},error:null};d=p}else{const{data:p,error:g}=await this._getUser(i.access_token);if(g)throw g;d={access_token:i.access_token,refresh_token:i.refresh_token,user:p.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(r){if(pe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(i){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(i))}async _refreshSession(i){try{return await this._useSession(async r=>{var a;if(!i){const{data:h,error:p}=r;if(p)throw p;i=(a=h.session)!==null&&a!==void 0?a:void 0}if(!i?.refresh_token)throw new Vt;const{data:c,error:d}=await this._callRefreshToken(i.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):c?this._returnResult({data:{user:c.user,session:c},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(i,r){try{if(!St())throw new Qa("No browser detected.");if(i.error||i.error_description||i.error_code)throw new Qa(i.error_description||"Error in URL with unspecified error_description",{error:i.error||"unspecified_error",code:i.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new jm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qa("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!i.code)throw new jm("No code detected.");const{data:D,error:y}=await this._exchangeCodeForSession(i.code);if(y)throw y;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:c,access_token:d,refresh_token:h,expires_in:p,expires_at:g,token_type:m}=i;if(!d||!p||!h||!m)throw new Qa("No session defined in URL");const x=Math.round(Date.now()/1e3),k=parseInt(p);let S=x+k;g&&(S=parseInt(g));const _=S-x;_*1e3<=nr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${k}s`);const w=S-k;x-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,S,x):x-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,S,x);const{data:j,error:A}=await this._getUser(d);if(A)throw A;const z={provider_token:a,provider_refresh_token:c,access_token:d,expires_in:k,expires_at:S,refresh_token:h,token_type:m,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:z,redirectType:i.type},error:null})}catch(a){if(pe(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(i){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),i):!!(i.access_token||i.error_description)}async _isPKCECallback(i){const r=await Ji(this.storage,`${this.storageKey}-code-verifier`);return!!(i.code&&r)}async signOut(i={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(i))}async _signOut({scope:i}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:c,error:d}=r;if(d)return this._returnResult({error:d});const h=(a=c.session)===null||a===void 0?void 0:a.access_token;if(h){const{error:p}=await this.admin.signOut(h,i);if(p&&!(RS(p)&&(p.status===404||p.status===401||p.status===403)))return this._returnResult({error:p})}return i!=="others"&&(await this._removeSession(),await vt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(i){const r=MS(),a={id:r,callback:i,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(i){return await this._useSession(async r=>{var a,c;try{const{data:{session:d},error:h}=r;if(h)throw h;await((a=this.stateChangeEmitters.get(i))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",i,"session",d)}catch(d){await((c=this.stateChangeEmitters.get(i))===null||c===void 0?void 0:c.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",i,"error",d),console.error(d)}})}async resetPasswordForEmail(i,r={}){let a=null,c=null;this.flowType==="pkce"&&([a,c]=await Qs(this.storage,this.storageKey,!0));try{return await Se(this.fetch,"POST",`${this.url}/recover`,{body:{email:i,code_challenge:a,code_challenge_method:c,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(d){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var i;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(i=r.user.identities)!==null&&i!==void 0?i:[]},error:null})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(i){return"token"in i?this.linkIdentityIdToken(i):this.linkIdentityOAuth(i)}async linkIdentityOAuth(i){var r;try{const{data:a,error:c}=await this._useSession(async d=>{var h,p,g,m,x;const{data:k,error:S}=d;if(S)throw S;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,i.provider,{redirectTo:(h=i.options)===null||h===void 0?void 0:h.redirectTo,scopes:(p=i.options)===null||p===void 0?void 0:p.scopes,queryParams:(g=i.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Se(this.fetch,"GET",_,{headers:this.headers,jwt:(x=(m=k.session)===null||m===void 0?void 0:m.access_token)!==null&&x!==void 0?x:void 0})});if(c)throw c;return St()&&!(!((r=i.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:i.provider,url:a?.url},error:null})}catch(a){if(pe(a))return this._returnResult({data:{provider:i.provider,url:null},error:a});throw a}}async linkIdentityIdToken(i){return await this._useSession(async r=>{var a;try{const{error:c,data:{session:d}}=r;if(c)throw c;const{options:h,provider:p,token:g,access_token:m,nonce:x}=i,k=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=d?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:p,id_token:g,access_token:m,nonce:x,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:fn}),{data:S,error:_}=k;return _?this._returnResult({data:{user:null,session:null},error:_}):!S||!S.session||!S.user?this._returnResult({data:{user:null,session:null},error:new Ks}):(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("USER_UPDATED",S.session)),this._returnResult({data:S,error:_}))}catch(c){if(await vt(this.storage,`${this.storageKey}-code-verifier`),pe(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}})}async unlinkIdentity(i){try{return await this._useSession(async r=>{var a,c;const{data:d,error:h}=r;if(h)throw h;return await Se(this.fetch,"DELETE",`${this.url}/user/identities/${i.identity_id}`,{headers:this.headers,jwt:(c=(a=d.session)===null||a===void 0?void 0:a.access_token)!==null&&c!==void 0?c:void 0})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(i){const r=`#_refreshAccessToken(${i.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await LS(async c=>(c>0&&await US(200*Math.pow(2,c-1)),this._debug(r,"refreshing attempt",c),await Se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:i},headers:this.headers,xform:fn})),(c,d)=>{const h=200*Math.pow(2,c);return d&&Pd(d)&&Date.now()+h-a<nr})}catch(a){if(this._debug(r,"error",a),pe(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(i){return typeof i=="object"&&i!==null&&"access_token"in i&&"refresh_token"in i&&"expires_at"in i}async _handleProviderSignIn(i,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,i,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",i,"options",r,"url",a),St()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:i,url:a},error:null}}async _recoverAndRefresh(){var i,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const c=await Ji(this.storage,this.storageKey);if(c&&this.userStorage){let h=await Ji(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:c.user},await ir(this.userStorage,this.storageKey+"-user",h)),c.user=(i=h?.user)!==null&&i!==void 0?i:Vd()}else if(c&&!c.user&&!c.user){const h=await Ji(this.storage,this.storageKey+"-user");h&&h?.user?(c.user=h.user,await vt(this.storage,this.storageKey+"-user"),await ir(this.storage,this.storageKey,c)):c.user=Vd()}if(this._debug(a,"session from storage",c),!this._isValidSession(c)){this._debug(a,"session is not valid"),c!==null&&await this._removeSession();return}const d=((r=c.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Hd;if(this._debug(a,`session has${d?"":" not"} expired with margin of ${Hd}s`),d){if(this.autoRefreshToken&&c.refresh_token){const{error:h}=await this._callRefreshToken(c.refresh_token);h&&(console.error(h),Pd(h)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(c.user&&c.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:p}=await this._getUser(c.access_token);!p&&h?.user?(c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(a,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",c)}catch(c){this._debug(a,"error",c),console.error(c);return}finally{this._debug(a,"end")}}async _callRefreshToken(i){var r,a;if(!i)throw new Vt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const c=`#_callRefreshToken(${i.substring(0,5)}...)`;this._debug(c,"begin");try{this.refreshingDeferred=new xl;const{data:d,error:h}=await this._refreshAccessToken(i);if(h)throw h;if(!d.session)throw new Vt;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const p={data:d.session,error:null};return this.refreshingDeferred.resolve(p),p}catch(d){if(this._debug(c,"error",d),pe(d)){const h={data:null,error:d};return Pd(d)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(d),d}finally{this.refreshingDeferred=null,this._debug(c,"end")}}async _notifyAllSubscribers(i,r,a=!0){const c=`#_notifyAllSubscribers(${i})`;this._debug(c,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:i,session:r});const d=[],h=Array.from(this.stateChangeEmitters.values()).map(async p=>{try{await p.callback(i,r)}catch(g){d.push(g)}});if(await Promise.all(h),d.length>0){for(let p=0;p<d.length;p+=1)console.error(d[p]);throw d[0]}}finally{this._debug(c,"end")}}async _saveSession(i){this._debug("#_saveSession()",i),this.suppressGetSessionWarning=!0,await vt(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},i),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await ir(this.userStorage,this.storageKey+"-user",{user:r.user});const c=Object.assign({},r);delete c.user;const d=Am(c);await ir(this.storage,this.storageKey,d)}else{const c=Am(r);await ir(this.storage,this.storageKey,c)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await vt(this.storage,this.storageKey),await vt(this.storage,this.storageKey+"-code-verifier"),await vt(this.storage,this.storageKey+"-user"),this.userStorage&&await vt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const i=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{i&&St()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",i)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const i=setInterval(()=>this._autoRefreshTokenTick(),nr);this.autoRefreshTicker=i,i&&typeof i=="object"&&typeof i.unref=="function"?i.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(i);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const i=this.autoRefreshTicker;this.autoRefreshTicker=null,i&&clearInterval(i);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const i=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const c=Math.floor((a.expires_at*1e3-i)/nr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${c} ticks, a tick lasts ${nr}ms, refresh threshold is ${Su} ticks`),c<=Su&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(i){if(i.isAcquireTimeout||i instanceof Wx)this._debug("auto refresh token tick lock not available");else throw i}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!St()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(i){console.error("_handleVisibilityChange",i)}}async _onVisibilityChanged(i){const r=`#_onVisibilityChanged(${i})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),i||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(i,r,a){const c=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&c.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&c.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[d,h]=await Qs(this.storage,this.storageKey),p=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(h)}`});c.push(p.toString())}if(a?.queryParams){const d=new URLSearchParams(a.queryParams);c.push(d.toString())}return a?.skipBrowserRedirect&&c.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${i}?${c.join("&")}`}async _unenroll(i){try{return await this._useSession(async r=>{var a;const{data:c,error:d}=r;return d?this._returnResult({data:null,error:d}):await Se(this.fetch,"DELETE",`${this.url}/factors/${i.factorId}`,{headers:this.headers,jwt:(a=c?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(i){try{return await this._useSession(async r=>{var a,c;const{data:d,error:h}=r;if(h)return this._returnResult({data:null,error:h});const p=Object.assign({friendly_name:i.friendlyName,factor_type:i.factorType},i.factorType==="phone"?{phone:i.phone}:i.factorType==="totp"?{issuer:i.issuer}:{}),{data:g,error:m}=await Se(this.fetch,"POST",`${this.url}/factors`,{body:p,headers:this.headers,jwt:(a=d?.session)===null||a===void 0?void 0:a.access_token});return m?this._returnResult({data:null,error:m}):(i.factorType==="totp"&&g.type==="totp"&&(!((c=g?.totp)===null||c===void 0)&&c.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(i){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:c,error:d}=r;if(d)return this._returnResult({data:null,error:d});const h=Object.assign({challenge_id:i.challengeId},"webauthn"in i?{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_response:i.webauthn.type==="create"?xk(i.webauthn.credential_response):yk(i.webauthn.credential_response)})}:{code:i.code}),{data:p,error:g}=await Se(this.fetch,"POST",`${this.url}/factors/${i.factorId}/verify`,{body:h,headers:this.headers,jwt:(a=c?.session)===null||a===void 0?void 0:a.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+p.expires_in},p)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",p),this._returnResult({data:p,error:g}))})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(i){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:c,error:d}=r;if(d)return this._returnResult({data:null,error:d});const h=await Se(this.fetch,"POST",`${this.url}/factors/${i.factorId}/challenge`,{body:i,headers:this.headers,jwt:(a=c?.session)===null||a===void 0?void 0:a.access_token});if(h.error)return h;const{data:p}=h;if(p.type!=="webauthn")return{data:p,error:null};switch(p.webauthn.type){case"create":return{data:Object.assign(Object.assign({},p),{webauthn:Object.assign(Object.assign({},p.webauthn),{credential_options:Object.assign(Object.assign({},p.webauthn.credential_options),{publicKey:gk(p.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},p),{webauthn:Object.assign(Object.assign({},p.webauthn),{credential_options:Object.assign(Object.assign({},p.webauthn.credential_options),{publicKey:mk(p.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(i){const{data:r,error:a}=await this._challenge({factorId:i.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:i.factorId,challengeId:r.id,code:i.code})}async _listFactors(){var i;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const c={all:[],phone:[],totp:[],webauthn:[]};for(const d of(i=r?.factors)!==null&&i!==void 0?i:[])c.all.push(d),d.status==="verified"&&c[d.factor_type].push(d);return{data:c,error:null}}async _getAuthenticatorAssuranceLevel(){var i,r;const{data:{session:a},error:c}=await this.getSession();if(c)return this._returnResult({data:null,error:c});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=Gd(a.access_token);let h=null;d.aal&&(h=d.aal);let p=h;((r=(i=a.user.factors)===null||i===void 0?void 0:i.filter(x=>x.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(p="aal2");const m=d.amr||[];return{data:{currentLevel:h,nextLevel:p,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(i){try{return await this._useSession(async r=>{const{data:{session:a},error:c}=r;return c?this._returnResult({data:null,error:c}):a?await Se(this.fetch,"GET",`${this.url}/oauth/authorizations/${i}`,{headers:this.headers,jwt:a.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new Vt})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(i,r){try{return await this._useSession(async a=>{const{data:{session:c},error:d}=a;if(d)return this._returnResult({data:null,error:d});if(!c)return this._returnResult({data:null,error:new Vt});const h=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${i}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"approve"},xform:p=>({data:p,error:null})});return h.data&&h.data.redirect_url&&St()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(a){if(pe(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(i,r){try{return await this._useSession(async a=>{const{data:{session:c},error:d}=a;if(d)return this._returnResult({data:null,error:d});if(!c)return this._returnResult({data:null,error:new Vt});const h=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${i}/consent`,{headers:this.headers,jwt:c.access_token,body:{action:"deny"},xform:p=>({data:p,error:null})});return h.data&&h.data.redirect_url&&St()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(a){if(pe(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async i=>{const{data:{session:r},error:a}=i;return a?this._returnResult({data:null,error:a}):r?await Se(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:c=>({data:c,error:null})}):this._returnResult({data:null,error:new Vt})})}catch(i){if(pe(i))return this._returnResult({data:null,error:i});throw i}}async _revokeOAuthGrant(i){try{return await this._useSession(async r=>{const{data:{session:a},error:c}=r;return c?this._returnResult({data:null,error:c}):a?(await Se(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:i.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Vt})})}catch(r){if(pe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(i,r={keys:[]}){let a=r.keys.find(p=>p.kid===i);if(a)return a;const c=Date.now();if(a=this.jwks.keys.find(p=>p.kid===i),a&&this.jwks_cached_at+jS>c)return a;const{data:d,error:h}=await Se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=c,a=d.keys.find(p=>p.kid===i),!a)?null:a}async getClaims(i,r={}){try{let a=i;if(!a){const{data:_,error:w}=await this.getSession();if(w||!_.session)return this._returnResult({data:null,error:w});a=_.session.access_token}const{header:c,payload:d,signature:h,raw:{header:p,payload:g}}=Gd(a);r?.allowExpired||FS(d.exp);const m=!c.alg||c.alg.startsWith("HS")||!c.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(c.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!m){const{error:_}=await this.getUser(a);if(_)throw _;return{data:{claims:d,header:c,signature:h},error:null}}const x=YS(c.alg),k=await crypto.subtle.importKey("jwk",m,x,!0,["verify"]);if(!await crypto.subtle.verify(x,k,h,BS(`${p}.${g}`)))throw new _u("Invalid JWT signature");return{data:{claims:d,header:c,signature:h},error:null}}catch(a){if(pe(a))return this._returnResult({data:null,error:a});throw a}}}bo.nextInstanceID={};const Rk=bo,Ek="2.91.0";let ro="";typeof Deno<"u"?ro="deno":typeof document<"u"?ro="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ro="react-native":ro="node";const Tk={"X-Client-Info":`supabase-js-${ro}/${Ek}`},Ak={headers:Tk},zk={schema:"public"},Dk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ok={};function vo(n){"@babel/helpers - typeof";return vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},vo(n)}function Ik(n,i){if(vo(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var a=r.call(n,i);if(vo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(n)}function Bk(n){var i=Ik(n,"string");return vo(i)=="symbol"?i:i+""}function Nk(n,i,r){return(i=Bk(i))in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,n}function Mm(n,i){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);i&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),r.push.apply(r,a)}return r}function et(n){for(var i=1;i<arguments.length;i++){var r=arguments[i]!=null?arguments[i]:{};i%2?Mm(Object(r),!0).forEach(function(a){Nk(n,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):Mm(Object(r)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))})}return n}const Mk=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),qk=()=>Headers,Wk=(n,i,r)=>{const a=Mk(r),c=qk();return async(d,h)=>{var p;const g=(p=await i())!==null&&p!==void 0?p:n;let m=new c(h?.headers);return m.has("apikey")||m.set("apikey",n),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),a(d,et(et({},h),{},{headers:m}))}};function Uk(n){return n.endsWith("/")?n:n+"/"}function Lk(n,i){var r,a;const{db:c,auth:d,realtime:h,global:p}=n,{db:g,auth:m,realtime:x,global:k}=i,S={db:et(et({},g),c),auth:et(et({},m),d),realtime:et(et({},x),h),storage:{},global:et(et(et({},k),p),{},{headers:et(et({},(r=k?.headers)!==null&&r!==void 0?r:{}),(a=p?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return n.accessToken?S.accessToken=n.accessToken:delete S.accessToken,S}function $k(n){const i=n?.trim();if(!i)throw new Error("supabaseUrl is required.");if(!i.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Uk(i))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Hk=class extends Rk{constructor(n){super(n)}},Pk=class{constructor(n,i,r){var a,c;this.supabaseUrl=n,this.supabaseKey=i;const d=$k(n);if(!i)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const h=`sb-${d.hostname.split(".")[0]}-auth-token`,p={db:zk,realtime:Ok,auth:et(et({},Dk),{},{storageKey:h}),global:Ak},g=Lk(r??{},p);if(this.storageKey=(a=g.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(c=g.global.headers)!==null&&c!==void 0?c:{},g.accessToken)this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(x,k)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(k)} is not possible`)}});else{var m;this.auth=this._initSupabaseAuthClient((m=g.auth)!==null&&m!==void 0?m:{},this.headers,g.global.fetch)}this.fetch=Wk(i,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(et({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new w1(new URL("rest/v1",d).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new vS(this.storageUrl.href,this.headers,this.fetch,r?.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new y1(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,i={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,i,r)}channel(n,i={config:{}}){return this.realtime.channel(n,i)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,i,r;if(n.accessToken)return await n.accessToken();const{data:a}=await n.auth.getSession();return(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:i,detectSessionInUrl:r,storage:a,userStorage:c,storageKey:d,flowType:h,lock:p,debug:g,throwOnError:m},x,k){const S={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Hk({url:this.authUrl.href,headers:et(et({},S),x),storageKey:d,autoRefreshToken:n,persistSession:i,detectSessionInUrl:r,storage:a,userStorage:c,flowType:h,lock:p,debug:g,throwOnError:m,fetch:k,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new U1(this.realtimeUrl.href,et(et({},n),{},{params:et(et({},{apikey:this.supabaseKey}),n?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i?.access_token)})}_handleTokenChanged(n,i,r){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),i=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Gk=(n,i,r)=>new Pk(n,i,r);function Vk(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const i=n.version;if(i==null)return!1;const r=i.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Vk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Zk="https://wybxbrutuoohiujjyfry.supabase.co",Fk="sb_publishable_f5XH0nc0vypEmY7sXOJ6kA_iqQpWYb9",ct=Gk(Zk,Fk),Yk=n=>{let i=n,r="image/jpeg";if(n.includes(",")){const a=n.split(","),c=a[0].match(/:(.*?);/);c&&(r=c[1]),i=a[1]}return fetch(`data:${r};base64,${i}`).then(a=>a.blob())},Kk=async(n,i=500)=>{const r=n.length*3/4/1024;return r<=i?n:(console.log(`[uploadPhoto] Image too large (${Math.round(r)}KB), compressing...`),new Promise(a=>{const c=new Image;c.onload=()=>{const d=document.createElement("canvas");let h=c.width,p=c.height;const g=Math.sqrt(i/r);h=Math.floor(h*g),p=Math.floor(p*g),h=Math.max(h,400),p=Math.max(p,300),d.width=h,d.height=p,d.getContext("2d").drawImage(c,0,0,h,p);const x=d.toDataURL("image/jpeg",.7);console.log(`[uploadPhoto] Compressed to ${Math.round(x.length*3/4/1024)}KB`),a(x)},c.onerror=()=>a(n),c.src=n}))},or=async(n,i="reports",r=3)=>{if(!n)return console.error("[uploadPhoto] No image data provided"),null;const a=await Kk(n);for(let c=1;c<=r;c++)try{console.log(`[uploadPhoto] Attempt ${c}/${r} for folder: ${i}`);const d=await Yk(a);console.log(`[uploadPhoto] Created blob, size: ${d.size} bytes`);const h=`${i}/${Date.now()}_${Math.random().toString(36).substr(2,9)}.jpg`,{error:p}=await ct.storage.from("photos").upload(h,d,{contentType:"image/jpeg",upsert:!1});if(p){if(console.error(`[uploadPhoto] Supabase error on attempt ${c}:`,p),c===r)throw p;await new Promise(m=>setTimeout(m,1e3*c));continue}const{data:g}=ct.storage.from("photos").getPublicUrl(h);return console.log("[uploadPhoto] Success! URL:",g.publicUrl),g.publicUrl}catch(d){if(console.error(`[uploadPhoto] Error on attempt ${c}:`,d),c===r)return console.error("[uploadPhoto] All retries failed, returning null instead of base64"),null;await new Promise(h=>setTimeout(h,1e3*c))}return null},Qk=async n=>{try{console.log("[saveAudit] Starting save..."),console.log("[saveAudit] conditionAlertDetails from auditData:",n.conditionAlertDetails);const i=[];for(const c of n.conditionAlertDetails||[]){const d=c.photos||[];console.log("[saveAudit] Processing alert:",{zoneId:c.zoneId,photoCount:d.length});const h=[];for(const p of d)if(p&&p.startsWith("data:")){console.log("[saveAudit] Uploading photo for zone:",c.zoneId);const g=await or(p,"condition-alerts");console.log("[saveAudit] Upload result:",g?.substring(0,80)),h.push(g)}else p&&h.push(p);i.push({...c,photos:h})}console.log("[saveAudit] Final conditionAlertDetails:",i);const{data:r,error:a}=await ct.from("audits").insert([{date:n.date,time:n.time,campus:n.campus,auditor:n.auditor,auditor_email:n.auditorEmail,status:n.status,defects:n.defects,zones:n.zones,duration:n.duration,tour_ready:n.tourReady,condition_alerts_count:n.conditionAlerts,zone_results:n.zoneResults,condition_alert_details:i,campus_data:n.campusData}]).select().single();if(a)throw a;return r}catch(i){throw console.error("Error saving audit:",i),i}},$x=async(n=50)=>{try{const{data:i,error:r}=await ct.from("audits").select("*").order("created_at",{ascending:!1}).limit(n);if(r)throw r;return(i||[]).map(a=>({id:a.id,date:a.date,time:a.time,campus:a.campus,auditor:a.auditor,auditorEmail:a.auditor_email,status:a.status,defects:a.defects,zones:a.zones,duration:a.duration,tourReady:a.tour_ready,conditionAlerts:a.condition_alerts_count,zoneResults:a.zone_results,conditionAlertDetails:a.condition_alert_details,campusData:a.campus_data,createdAt:a.created_at}))}catch(i){return console.error("Error getting audits:",i),[]}},Jk=async n=>{try{let i=n.photo;n.photo&&n.photo.startsWith("data:")&&(i=await or(n.photo,"reports"));const{data:r,error:a}=await ct.from("reports").insert([{timestamp:n.timestamp,campus:n.campus,photo:i,category:n.category,location:n.location,note:n.note,urgent:n.urgent,team:n.team,status:n.status,campus_data:n.campusData}]).select().single();if(a)throw a;return r}catch(i){throw console.error("Error saving report:",i),i}},Hx=async(n=50)=>{try{const{data:i,error:r}=await ct.from("reports").select("*").order("created_at",{ascending:!1}).limit(n);if(r)throw r;return(i||[]).map(a=>({id:a.id,timestamp:a.timestamp,campus:a.campus,photo:a.photo,category:a.category,location:a.location,note:a.note,urgent:a.urgent,team:a.team,status:a.status,campusData:a.campus_data,createdAt:a.created_at}))}catch(i){return console.error("Error getting reports:",i),[]}},Xk=async(n,i)=>{try{const{error:r}=await ct.from("reports").update({status:i,updated_at:new Date().toISOString()}).eq("id",n);if(r)throw r}catch(r){throw console.error("Error updating report status:",r),r}},e2=async n=>{try{console.log("[saveBGWalkthrough] Starting save...");const i=[];for(const h of n.issues||[]){const p=[];for(const g of h.photos||[])if(g&&g.startsWith("data:")){const m=await or(g,"bg-issues");p.push(m)}else g&&p.push(g);i.push({...h,photos:p})}const r=[];for(const h of n.observations||[]){const p=[];for(const g of h.photos||[])if(g&&g.startsWith("data:")){const m=await or(g,"bg-observations");p.push(m)}else g&&p.push(g);r.push({...h,photos:p})}const a={};for(const[h,p]of Object.entries(n.exitPhotos||{}))p&&p.startsWith("data:")?a[h]=await or(p,"bg-exit"):p&&(a[h]=p);const{data:c,error:d}=await ct.from("bg_walkthroughs").insert([{date:n.date,time:n.time,campus:n.campus,auditor:n.auditor,auditor_email:n.auditorEmail,duration:n.duration,campus_rating:n.campusRating,zone_ratings:n.zoneRatings,zone_results:n.zoneResults,room_results:n.roomResults,selected_rooms:n.selectedRooms,issues:i,observations:r,exit_photos:a,total_issues:n.totalIssues,total_observations:n.totalObservations,green_zones:n.greenZones,amber_zones:n.amberZones,red_zones:n.redZones,campus_data:n.campusData,start_time:n.startTime,end_time:n.endTime,is_complete:!0}]).select().single();if(d)throw d;return console.log("[saveBGWalkthrough] Saved successfully:",c.id),c}catch(i){throw console.error("Error saving B&G walkthrough:",i),i}},Hu=async(n=null,i=50)=>{try{let r=ct.from("bg_walkthroughs").select("*").order("created_at",{ascending:!1}).limit(i);n&&(r=r.eq("campus",n));const{data:a,error:c}=await r;if(c)throw c;return(a||[]).map(d=>({id:d.id,date:d.date,time:d.time,campus:d.campus,auditor:d.auditor,auditorEmail:d.auditor_email,duration:d.duration,campusRating:d.campus_rating,zoneRatings:d.zone_ratings,zoneResults:d.zone_results,roomResults:d.room_results,selectedRooms:d.selected_rooms,issues:d.issues,observations:d.observations,exitPhotos:d.exit_photos,totalIssues:d.total_issues,totalObservations:d.total_observations,greenZones:d.green_zones,amberZones:d.amber_zones,redZones:d.red_zones,campusData:d.campus_data,startTime:d.start_time,endTime:d.end_time,isComplete:d.is_complete,createdAt:d.created_at}))}catch(r){return console.error("Error getting B&G walkthroughs:",r),[]}},t2=async n=>{try{const{data:i,error:r}=await ct.from("bg_walkthroughs").select("*").eq("id",n).single();if(r)throw r;return{id:i.id,date:i.date,time:i.time,campus:i.campus,auditor:i.auditor,auditorEmail:i.auditor_email,duration:i.duration,campusRating:i.campus_rating,zoneRatings:i.zone_ratings,zoneResults:i.zone_results,roomResults:i.room_results,selectedRooms:i.selected_rooms,issues:i.issues,observations:i.observations,exitPhotos:i.exit_photos,totalIssues:i.total_issues,totalObservations:i.total_observations,greenZones:i.green_zones,amberZones:i.amber_zones,redZones:i.red_zones,campusData:i.campus_data,startTime:i.start_time,endTime:i.end_time,isComplete:i.is_complete,createdAt:i.created_at}}catch(i){return console.error("Error getting B&G walkthrough by ID:",i),null}},n2=async n=>{try{console.log("[sendBGWalkthroughEmail] Sending email to:",n.auditorEmail);const i="https://wybxbrutuoohiujjyfry.supabase.co",r="sb_publishable_f5XH0nc0vypEmY7sXOJ6kA_iqQpWYb9",a=await fetch(`${i}/functions/v1/send-bg-report`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({date:n.date,time:n.time,campus:n.campus,auditor:n.auditor,auditorEmail:n.auditorEmail,duration:n.duration,campusRating:n.campusRating,zoneRatings:n.zoneRatings,issues:n.issues||[],observations:n.observations||[],totalIssues:n.totalIssues||0,totalObservations:n.totalObservations||0,greenZones:n.greenZones||0,amberZones:n.amberZones||0,redZones:n.redZones||0})});if(!a.ok){const d=await a.json().catch(()=>({}));throw console.error("[sendBGWalkthroughEmail] API error:",d),new Error(d.error||"Failed to send email")}const c=await a.json();return console.log("[sendBGWalkthroughEmail] Email sent successfully:",c),c}catch(i){throw console.error("[sendBGWalkthroughEmail] Error:",i),i}},i2=(n,i=1200,r=.7)=>new Promise(a=>{const c=new Image;c.onload=()=>{const d=document.createElement("canvas");let h=c.width,p=c.height;h>i&&(p=p*i/h,h=i),d.width=h,d.height=p,d.getContext("2d").drawImage(c,0,0,h,p);const m=d.toDataURL("image/jpeg",r);console.log("[useCamera] Compressed image from",n.length,"to",m.length,"bytes"),a(m)},c.onerror=()=>{console.error("[useCamera] Image compression failed, using original"),a(n)},c.src=n}),s2=()=>{const n=v.useRef(null),i=v.useRef("photos"),r=v.useRef(null),a=v.useRef(null),c=v.useRef(null),d=v.useRef(null),[h,p]=v.useState(!1),[g,m]=v.useState(""),[x,k]=v.useState(!1),[S,_]=v.useState(!1),w=v.useCallback(async C=>{_(!0);try{const T=await i2(C);console.log("[useCamera] Uploading to Supabase...");const E=await or(T,i.current);E?(console.log("[useCamera] Upload successful:",E),n.current&&n.current(E)):(console.error("[useCamera] Upload failed, no URL returned"),n.current&&n.current(null))}catch(T){console.error("[useCamera] Upload error:",T),n.current&&n.current(null)}finally{_(!1)}},[]),j=v.useCallback(async C=>{console.log("[useCamera] handleFileSelect triggered");const T=C.target.files[0];if(T){console.log("[useCamera] File selected:",T.name,T.size,"bytes");const E=new FileReader;E.onload=async W=>{console.log("[useCamera] FileReader loaded, data length:",W.target.result?.length),await w(W.target.result)},E.onerror=W=>{console.error("[useCamera] FileReader error:",W),n.current&&n.current(null)},E.readAsDataURL(T)}else console.log("[useCamera] No file selected");r.current&&(r.current.value="")},[w]),A=v.useCallback(()=>{d.current&&(d.current.getTracks().forEach(C=>C.stop()),d.current=null),k(!1)},[]),z=v.useCallback(()=>{A(),p(!1),m(""),n.current=null},[A]),D=v.useCallback(async()=>{if(!a.current||!c.current||!x){console.error("[useCamera] Cannot capture: video not ready");return}const C=a.current,T=c.current;T.width=C.videoWidth,T.height=C.videoHeight,T.getContext("2d").drawImage(C,0,0);const W=T.toDataURL("image/jpeg",.8);console.log("[useCamera] Photo captured, size:",W.length),z(),await w(W)},[x,z,w]),y=v.useCallback((C,T="Photo",E="bg-walkthrough")=>{if(console.log("[useCamera] openCamera called, callback:",!!C,"folder:",E),n.current=C,i.current=E,m(T),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){console.log("[useCamera] Mobile detected, using file input"),r.current&&r.current.click();return}navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(p(!0),navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}).then(M=>{console.log("[useCamera] Got video stream"),d.current=M,a.current&&(a.current.srcObject=M,a.current.onloadedmetadata=()=>{console.log("[useCamera] Video ready"),k(!0)})}).catch(M=>{console.error("[useCamera] getUserMedia error:",M),p(!1),r.current&&r.current.click()})):(console.log("[useCamera] No getUserMedia, using file input"),r.current&&r.current.click())},[]);return{fileInputRef:r,handleFileSelect:j,isOpen:h,label:g,isVideoReady:x,isUploading:S,videoRef:a,canvasRef:c,openCamera:y,capturePhoto:D,closeCamera:z}},Px={type:"restroom",amberEligible:!1,description:"Any defect = RED",cleanliness:["Toilets and urinals are clean (no soil, stains, or residue)?","Sinks and counters are dry and clean (no water spots or residue)?","Mirrors are clean (no smudges or streaks)?","Floor is clean (no debris, water, or stains)?","Soap dispensers are working and stocked (enough for one full day)?","Paper towels or hand dryers are working and stocked (enough for one full day)?","Toilet paper is fully stocked (fresh rolls in place)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no urine, mold, sewage, or garbage smell)?","Area is safe (no wet floors, broken fixtures, or hazards)?"]},r2=n=>({...Px,name:`Restroom ${n}`}),os={entry:{name:"Entry & Lobby",type:"mandatory",amberEligible:!0,description:"Parent-facing zone",cleanliness:["Floor is clean (no debris, spills, or stains)?","Entry mat is clean and flat (no curled edges or trip hazards)?","Exterior door glass is clean (no smudges or fingerprints)?","Interior glass is clean (no smudges or streaks)?","Reception surfaces are dust-free (counters, desks, shelves)?","High-touch surfaces are clean (door handles, counter edges)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no mold, garbage, or musty smell)?","Area is safe (no wet floors, loose items, or hazards)?"]},hallway:{name:"Hallway / Corridor",type:"mandatory",amberEligible:!0,cleanliness:["Floor is clean (no debris, spills, or stains)?","Edges, corners, and baseboards are dust-free (no buildup)?","Walls are free of scuff marks (no black marks or scrapes)?","Glass and doors are clean (no smudges or fingerprints)?","High-touch surfaces are clean (door handles, railings, light switches)?","Trash cans are empty with liners in place (no overflow)?","Area is safe (no wet floors, obstacles, or hazards)?"]},commons:{name:"Commons Area",type:"mandatory",amberEligible:!0,cleanliness:["Floor is clean (no debris, spills, or stains)?","Tables and surfaces are clean and dry (no sticky spots or residue)?","Furniture is properly arranged (chairs pushed in, not scattered)?","High-touch surfaces are clean (door handles, table edges, chair backs)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no food, mold, or garbage smell)?","Area is safe (no wet floors, broken furniture, or hazards)?"]},supply_closet:{name:"Supply Closet",type:"mandatory",amberEligible:!0,description:"1-week minimum threshold",isSupplyCheck:!0,cleanliness:["Toilet paper supply is sufficient (enough for one week)?","Paper towel supply is sufficient (enough for one week)?","Soap and sanitizer supply is sufficient (enough for one week)?","Trash liner supply is sufficient (enough for one week)?","Cleaning supplies are present and stocked (chemicals, mops, rags)?","Closet is organized (items on shelves, nothing blocking walkway)?"],supplyItems:[0,1,2,3]},classroom:{name:"Classroom",type:"optional",amberEligible:!0,cleanliness:["Floor is clean (no debris, spills, or stains)?","Edges, corners, and baseboards are dust-free (no buildup)?","Student desks and tables are clean (no writing, stickers, or residue)?","Teacher desk and surfaces are clean (no dust or clutter)?","Whiteboard area is clean (tray wiped, ledge dust-free)?","High-touch surfaces are clean (door handle, light switches)?","Trash cans are empty with liners in place (no overflow)?","Area is safe (no tripping hazards, loose wires, or broken items)?"]},office:{name:"Office / Workroom",type:"optional",amberEligible:!0,cleanliness:["Floor is clean (no debris, spills, or stains)?","Desk and work surfaces are dust-free (no buildup or clutter)?","High-touch surfaces are clean (door handles, light switches, shared equipment)?","Trash cans are empty with liners in place (no overflow)?","Area is safe (no tripping hazards, loose wires, or blocked exits)?"]},gym:{name:"Gym / Multi-Purpose",type:"optional",amberEligible:!0,cleanliness:["Floor is clean (no debris, spills, or stains)?","Floor finish is intact (no excessive scuffing, peeling, or damage)?","Bleachers and seating are clean (no dust, debris, or sticky spots)?","Equipment storage area is organized (items put away, nothing on floor)?","High-touch surfaces are clean (door handles, equipment, railings)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no sweat, mold, or musty smell)?","Area is safe (no loose equipment, wet floors, or hazards)?"]},cafeteria:{name:"Cafeteria",type:"optional",amberEligible:!0,cleanliness:["Floor is clean (no debris, spills, or stains)?","Tables and seating are clean and dry (no sticky spots or food residue)?","Service and counter area is clean (no crumbs, spills, or buildup)?","High-touch surfaces are clean (door handles, tray rails, chair backs)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no spoiled food, garbage, or drain smell)?","Area is safe (no wet floors, broken chairs, or hazards)?"]},alpha_standard:{name:"Alpha Standard",type:"final",amberEligible:!1,description:"Final campus review - does this property meet the Alpha Standard?",cleanliness:["Taking one final look at the entire campus - does this property meet the Alpha Standard?"],improvementQuestion:{text:"Even if everything passes, note one thing you would recommend we upgrade to raise the bar.",placeholder:"What one improvement would you recommend?"}}},uo=["entry","hallway","commons","supply_closet"],o2=[],a2=["classroom","office","gym","cafeteria"],Fd=uo,l2=()=>{const[n,i]=v.useState(null),[r,a]=v.useState(""),[c,d]=v.useState(""),[h,p]=v.useState(null),[g,m]=v.useState([]),[x,k]=v.useState(1),[S,_]=v.useState(0),[w,j]=v.useState({}),[A,z]=v.useState([]),[D,y]=v.useState(null),[C,T]=v.useState({}),E=v.useMemo(()=>Array.from({length:x},(ue,ye)=>`restroom_${ye+1}`),[x]),W=v.useMemo(()=>[...uo,...g,...E,...o2],[g,E]),M=v.useMemo(()=>W[S],[W,S]),K=v.useCallback(ue=>{if(!ue)return null;if(ue.startsWith("restroom_")){const ye=parseInt(ue.split("_")[1]);return r2(ye)}return os[ue]},[]),ee=v.useMemo(()=>K(M),[M,K]),F=v.useCallback(ue=>{const ye=w[ue]||{};return Object.values(ye).filter(we=>we==="no").length},[w]),ne=v.useCallback(()=>W.reduce((ue,ye)=>ue+F(ye),0),[W,F]),se=v.useCallback(()=>{let ue=0,ye=!1;for(const we of W){const oe=K(we),le=F(we);ue+=le,oe&&!oe.amberEligible&&le>0&&(ye=!0)}return D==="no"||ye?"RED":ue===0?"GREEN":ue===1?"AMBER":"RED"},[W,F,D,K]),B=v.useCallback(ue=>{const ye=K(ue);if(!ye)return!1;const we=w[ue]||{};return Object.keys(we).length===ye.cleanliness.length},[w,K]),$=v.useCallback((ue,ye,we)=>{j(oe=>({...oe,[ue]:{...oe[ue]||{},[ye]:we}}))},[]),O=v.useCallback((ue,ye,we={})=>{z(oe=>{const le=oe.findIndex(Oe=>Oe.zoneId===ue);if(le>=0){const Oe=[...oe];return Oe[le]={...Oe[le],hasIssue:ye,...ye?we:{photos:[],note:""}},Oe}else return[...oe,{zoneId:ue,hasIssue:ye,note:"",photos:[],...we}]})},[]),q=v.useCallback((ue,ye)=>{console.log("[useAudit] addConditionAlertPhoto called:",{zoneId:ue,photoLength:ye?.length}),z(we=>{const oe=we.findIndex(le=>le.zoneId===ue);if(console.log("[useAudit] Found alert at index:",oe,"for zone:",ue),oe>=0){const le=[...we],Oe=le[oe].photos||[];return le[oe]={...le[oe],photos:[...Oe,ye]},console.log("[useAudit] Updated alert:",le[oe].zoneId,"photoCount:",le[oe].photos.length),le}return console.warn("[useAudit] WARNING: No existing alert found for zone:",ue),we})},[]),Z=v.useCallback((ue,ye)=>{z(we=>{const oe=we.findIndex(le=>le.zoneId===ue);if(oe>=0){const le=[...we],Oe=le[oe].photos||[];return le[oe]={...le[oe],photos:Oe.filter((it,Rt)=>Rt!==ye)},le}return we})},[]),re=v.useCallback((ue,ye)=>{z(we=>{const oe=we.findIndex(le=>le.zoneId===ue);if(oe>=0){const le=[...we];return le[oe]={...le[oe],note:ye},le}return we})},[]),ae=v.useCallback(ue=>{const ye=A.find(we=>we.zoneId===ue);return ye?ye.hasIssue===!1?!0:ye.hasIssue&&ye.photo&&ye.note&&ye.note.length>0:!1},[A]),I=v.useCallback(ue=>A.find(ye=>ye.zoneId===ue),[A]),U=v.useCallback((ue,ye)=>{T(we=>({...we,[ue]:[...we[ue]||[],...ye]}))},[]),Q=v.useCallback(ue=>C[ue]||[],[C]),ie=v.useCallback((ue,ye)=>{T(we=>({...we,[ue]:(we[ue]||[]).filter((oe,le)=>le!==ye)}))},[]),fe=v.useCallback(()=>C,[C]),ce=v.useCallback(()=>{i(null),a(""),d(""),p(null),m([]),k(1),_(0),j({}),z([]),y(null),T({})},[]),ge=v.useCallback((ue,ye,we,oe,le=1)=>{i(ue),a(ye),d(we),m(oe),k(le),p(Date.now())},[]),Pe=v.useCallback(()=>h?Math.round((Date.now()-h)/6e4):0,[h]),Ne=v.useCallback(()=>Object.keys(w).length,[w]),dt=v.useCallback(()=>{for(let ue=0;ue<W.length;ue++)if(!w[W[ue]])return ue;return-1},[W,w]),Bt=v.useCallback(()=>{const ue=A.filter(ye=>ye.hasIssue);return console.log("[useAudit] buildAuditData - conditionAlerts:",A),console.log("[useAudit] buildAuditData - filtered alerts with hasIssue:",ue),ue.forEach((ye,we)=>{console.log(`[useAudit] Alert ${we}:`,{zoneId:ye.zoneId,hasIssue:ye.hasIssue,hasPhoto:!!ye.photo,photoLength:ye.photo?.length,note:ye.note})}),{date:new Date().toLocaleDateString(),time:new Date().toLocaleTimeString(),campus:n?.name||"",auditor:r,auditorEmail:c,status:se(),defects:ne(),zones:W.length,duration:Pe(),tourReady:D==="yes",conditionAlerts:ue.length,zoneResults:w,conditionAlertDetails:ue,campusData:n,zonePhotos:C}},[n,r,c,se,ne,W,Pe,D,A,w,C]);return{campus:n,auditorName:r,auditorEmail:c,startTime:h,selectedOptionalZones:g,restroomCount:x,currentZoneIndex:S,zoneResults:w,conditionAlerts:A,tourReady:D,allZones:W,currentZoneId:M,currentZone:ee,zonePhotos:C,setCampus:i,setAuditorName:a,setAuditorEmail:d,setSelectedOptionalZones:m,setRestroomCount:k,setCurrentZoneIndex:_,setTourReady:y,setResponse:$,setConditionAlert:O,addConditionAlertPhoto:q,removeConditionAlertPhoto:Z,updateConditionAlertNote:re,addZonePhotos:U,getZonePhotos:Q,removeZonePhoto:ie,getAllZonePhotos:fe,countDefects:F,getTotalDefects:ne,calculateStatus:se,isZoneComplete:B,canCompleteCondition:ae,getConditionAlert:I,getZoneConfig:K,getDuration:Pe,getCompletedZonesCount:Ne,getNextIncompleteZoneIndex:dt,resetAudit:ce,beginAudit:ge,buildAuditData:Bt}},c2="MQAAAAED7kv2",Pu=n=>(console.log("[Wrike] TESTING MODE: Using test folder for campus:",n),c2),zi=n=>!0,To=async(n,i={})=>{const{method:r="GET",body:a}=i;console.log(`[Wrike] Calling Edge Function: ${r} ${n}`),a&&console.log("[Wrike] Request body:",JSON.stringify(a).substring(0,500));const{data:c,error:d}=await ct.functions.invoke("wrike-proxy",{body:{endpoint:n,method:r,body:a}});if(console.log("[Wrike] Edge Function response - data:",c?JSON.stringify(c).substring(0,500):"null"),console.log("[Wrike] Edge Function response - error:",d),d)throw console.error("[Wrike] Edge Function error:",d),new Error(d.message||"Wrike API request failed");if(c?.error)throw console.error("[Wrike] API error:",c.error),new Error(c.error);return c},So=async(n,i)=>{console.log("[Wrike] Creating task in folder:",n),console.log("[Wrike] Task data:",i);const{title:r,description:a,priority:c,dates:d}=i,h={title:r,description:a};c&&(h.importance=c),d&&(h.dates=d);const p=await To(`/folders/${n}/tasks`,{method:"POST",body:h});return console.log("[Wrike] Task created:",p.data?.[0]?.id),p.data?.[0]},ds=async n=>{const{checklistType:i,campusName:r,auditorName:a,auditorEmail:c,issues:d,date:h}=n,p=Pu(r);if(!p)return console.log("[Wrike] Campus not configured:",r),null;const g=h||new Date().toLocaleDateString(),m=d&&d.length>0,x=m?`${d.length} issue${d.length!==1?"s":""}`:"All Clear",k=`[${r}] ${i} - ${g} (${x})`;let S="";S+=`<b>Checklist:</b> ${i}<br>`,S+=`<b>Campus:</b> ${r}<br>`,S+=`<b>Auditor:</b> ${a}${c?` (${c})`:""}<br>`,S+=`<b>Date:</b> ${g}<br>`,S+=`<b>Status:</b> ${m?" ISSUES FOUND":" ALL CLEAR"}<br>`,S+="<br><hr><br>",m?(S+="<h3>Issues Requiring Action</h3>",S+="<ol>",d.forEach(w=>{S+="<li>",w.category&&(S+=`<b>${w.category}</b>`,w.section&&(S+=` - ${w.section}`),S+="<br>"),w.check&&(S+=`<b>Check:</b> ${w.check}<br>`),w.description&&(S+=`<b>Issue:</b> ${w.description}<br>`),w.location&&(S+=`<b>Location:</b> ${w.location}<br>`),w.escalateTo&&(S+=`<b>Escalate to:</b> ${w.escalateTo}<br>`),w.photos&&w.photos.length>0&&(S+="<b>Photos:</b><br>",w.photos.forEach((j,A)=>{const z=j.url||j;z&&!z.startsWith("data:")&&(S+=`&nbsp;&nbsp; <a href="${z}">Photo ${A+1}</a><br>`)})),S+="</li>"}),S+="</ol>"):S+="<h3> All checks passed!</h3>";const _=m?"High":"Normal";try{return await So(p,{title:k,description:S,priority:_})}catch(w){throw console.error("[Wrike] Error creating consolidated task:",w),w}},d2=async(n,i)=>{const r=Pu(i);if(!r)return console.log("[Wrike] Campus not configured:",i),null;const a=new Date().toLocaleDateString(),c=n.urgent?" URGENT - ":"",d=`[${i}] ${c}Report: ${n.category} - ${n.location||"No location"}`;let h="";h+="<b>Report Type:</b> See It, Report It<br>",h+=`<b>Campus:</b> ${i}<br>`,h+=`<b>Category:</b> ${n.category}<br>`,h+=`<b>Location:</b> ${n.location||"Not specified"}<br>`,h+=`<b>Urgent:</b> ${n.urgent?" YES":"No"}<br>`,h+=`<b>Date:</b> ${a}<br>`,h+="<br><hr><br>",h+="<h3>Description</h3>",h+=`<p>${n.description||n.note||"No description provided"}</p>`;const p=n.photos||(n.photo?[n.photo]:[]);p.length>0&&(h+="<br><b>Photos:</b><br>",p.forEach((m,x)=>{const k=m.url||m;k&&!k.startsWith("data:")&&(h+=`&nbsp;&nbsp; <a href="${k}">Photo ${x+1}</a><br>`)}));const g=n.urgent?"High":"Normal";try{return await So(r,{title:d,description:h,priority:g})}catch(m){throw console.error("[Wrike] Error creating report task:",m),m}},u2=async()=>{try{const n=await To("/contacts?me=true");return console.log("[Wrike] Connection test successful. User:",n.data?.[0]?.firstName),!0}catch(n){return console.error("[Wrike] Connection test failed:",n),!1}},h2=async n=>{try{return(await To(`/folders/${n}`)).data?.[0]}catch(i){return console.error("[Wrike] Error getting folder info:",i),null}},qm=async n=>{try{const i=`https://www.wrike.com/open.htm?id=${n}`;console.log("[Wrike] Looking up folder from permalink:",i);const r=await To(`/folders?permalink=${encodeURIComponent(i)}`);if(console.log("[Wrike] Folder lookup result:",r),r.data&&r.data.length>0){const a=r.data[0];return console.log("[Wrike] Found folder!"),console.log("[Wrike] Title:",a.title),console.log("[Wrike] Alphanumeric ID (use this!):",a.id),a}return null}catch(i){return console.error("[Wrike] Error looking up folder:",i),null}},f2=async()=>{try{console.log("[Wrike] Fetching all folders...");const n=await To("/folders");return console.log("[Wrike] Found",n.data?.length,"folders"),n.data?.forEach(i=>{console.log(`[Wrike] Folder: "${i.title}" -> ID: ${i.id}`)}),n.data}catch(n){return console.error("[Wrike] Error listing folders:",n),null}};typeof window<"u"&&(window.wrikeDebug={listAllFolders:f2,getFolderFromPermalink:qm,testWrikeConnection:u2,getWrikeFolderInfo:h2,createWrikeTask:So,createTestTask:async()=>{console.log("[Wrike] Creating test task...");try{const n=await So("MQAAAAED7kv2",{title:"[TEST] Manual task creation test - "+new Date().toLocaleTimeString(),description:"Testing if task creation works directly from console",priority:"Normal"});return console.log("[Wrike]  Test task created successfully!",n),n}catch(n){throw console.error("[Wrike]  Test task creation failed:",n),n}}},console.log('[Wrike] Debug functions available: window.wrikeDebug.listAllFolders(), window.wrikeDebug.getFolderFromPermalink("4360915958")'),setTimeout(async()=>{try{console.log("[Wrike] Looking up folder ID for 4360915958...");const n=await qm("4360915958");n&&(console.log("[Wrike]  FOUND! Use this folder ID in code:",n.id),console.log("[Wrike] Folder title:",n.title))}catch(n){console.log("[Wrike] Could not auto-lookup folder:",n.message)}},2e3));const p2=()=>{const[n,i]=v.useState(null),[r,a]=v.useState([]),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(!1),[x,k]=v.useState(null),[S,_]=v.useState(""),[w,j]=v.useState(!1),A=v.useCallback(T=>{a(E=>[...E,T])},[]),z=v.useCallback(T=>{a(E=>E.filter((W,M)=>M!==T))},[]),D=r[0]||null,y=v.useCallback(T=>{a(T?[T]:[])},[]),C=v.useCallback(()=>{i(null),a([]),d(""),p(""),m(!1),k(null),_(""),j(!1)},[]);return{campus:n,photos:r,photo:D,description:c,location:h,isEmergency:g,category:x,note:S,urgent:w,setCampus:i,setPhotos:a,setPhoto:y,addPhoto:A,removePhoto:z,setDescription:d,setLocation:p,setIsEmergency:m,setCategory:k,setNote:_,setUrgent:j,resetReport:C}},ho={1:{resolution:"<12h"},2:{resolution:"<24h"},3:{resolution:"<72h"}},Rn={landscaping:{id:"landscaping",name:"Landscaping",order:1,description:"Turf, beds, trees, mulch, irrigation, drainage",sections:[{name:"Turf (Grass Areas)",checks:[{id:"turf_height",text:"Grass is the same height everywhere (no tall patches or short patches)?",tier:3},{id:"turf_color",text:"Grass is green and healthy looking (no yellow or brown spots)?",tier:3},{id:"turf_weeds",text:"Grass is mostly grass, not weeds (some weeds OK, but grass should be the main plant)?",tier:3,amberEligible:!0},{id:"turf_bare",text:"Grass covers all areas (no bare dirt patches showing)?",tier:2,amberIneligibleIf:"visible from arrival path"},{id:"turf_scalping",text:"Grass is cut properly (not cut too short showing brown, not overgrown and shaggy)?",tier:3}]},{name:"Edging (Where Grass Meets Sidewalk)",checks:[{id:"edging_lines",text:"Edges look neat and straight (clean line between grass and sidewalk)?",tier:3},{id:"edging_overhang",text:"Grass stays in the grass area (not growing over onto sidewalk or curb)?",tier:3},{id:"edging_weeds",text:"Sidewalk cracks are clear (no weeds growing up through the cracks)?",tier:3}]},{name:"Plant Beds (Flower and Shrub Areas)",checks:[{id:"beds_healthy",text:"Plants look healthy (standing up straight, not drooping or wilting)?",tier:3},{id:"beds_pests",text:"Plants are pest-free (no holes in leaves, no bugs visible, no webs)?",tier:3},{id:"beds_dead",text:"All plants are alive (no brown, dead, or dying plants)?",tier:3},{id:"beds_toxic",text:"No dangerous plants present (no oleander, poison ivy, poison oak, or other toxic plants)?",tier:1},{id:"beds_weeds",text:"Beds are mostly plants, not weeds (some weeds OK, but planted flowers/shrubs should be the main plants)?",tier:3,amberEligible:!0},{id:"beds_seasonal",text:"Seasonal flowers are blooming and colorful (if the season calls for flowers, they should be alive and blooming)?",tier:4,amberEligible:!0}]},{name:"Mulch (Wood Chips in Plant Beds)",checks:[{id:"mulch_coverage",text:"Mulch covers all the soil (no bare dirt showing through the wood chips)?",tier:3,amberEligible:!0},{id:"mulch_weeds",text:"Mulch is weed-free (no weeds poking up through the wood chips)?",tier:3}]},{name:"Trees",checks:[{id:"trees_clearance",text:"Tree branches are high enough (an adult can walk under without ducking)?",tier:3},{id:"trees_limbs",text:"All branches are healthy and attached (no dead branches, no broken limbs hanging)?",tier:1},{id:"trees_disease",text:"Trees look healthy (no strange spots on leaves, no fungus on trunk, no oozing sap)?",tier:3},{id:"trees_lean",text:"Trees stand straight (no trees leaning dangerously that could fall)?",tier:1}]},{name:"Irrigation (Sprinkler System)",checks:[{id:"irrigation_leaks",text:"No water leaks visible (no puddles, no water spraying from broken pipes)?",tier:2},{id:"irrigation_dry",text:"All areas are getting water (no dry brown patches from sprinklers not reaching)?",tier:2},{id:"irrigation_overspray",text:"Water stays on plants (sprinklers not spraying onto sidewalks, walls, or parking lot)?",tier:3},{id:"irrigation_heads",text:"Sprinkler heads are intact (no broken, cracked, or missing sprinkler heads)?",tier:3}]},{name:"Debris (Trash and Litter)",checks:[{id:"debris_trash",text:"Grounds are litter-free (no trash, wrappers, bottles, or garbage on the ground)?",tier:3,amberEligible:!0},{id:"debris_leaves",text:"Grounds are clear of yard waste (no piles of leaves, sticks, or branches)?",tier:3,amberEligible:!0}]},{name:"Drainage (Water Flow)",checks:[{id:"drainage_standing",text:"No standing water (no puddles sitting in grass or low spots)?",tier:2},{id:"drainage_erosion",text:"No erosion damage (no washed-out areas, no gullies, no exposed roots from water runoff)?",tier:2}]}]},hardscapes:{id:"hardscapes",name:"Hardscapes & Parking",order:2,description:"Parking surface, striping, walkways, curbing, site furnishings",sections:[{name:"Parking Lot Surface",checks:[{id:"parking_potholes",text:"Parking lot is smooth (no potholes or dips you would walk around)?",tier:1},{id:"parking_cracks_width",text:"No wide cracks (no cracks big enough to fit a pencil inside)?",tier:2},{id:"parking_cracks_length",text:"No long cracks (no cracks longer than the length of your shoe)?",tier:2},{id:"parking_oil",text:"No large oil stains (no stains bigger than your hand)?",tier:3,amberEligible:!0},{id:"parking_stain_pattern",text:"Parking lot looks clean overall (no obvious pattern of stains when you drive in)?",tier:2}]},{name:"Parking Lot Striping (Painted Lines)",checks:[{id:"striping_visible",text:"Parking lines are easy to see (all painted lines are visible and not faded)?",tier:3},{id:"striping_ada",text:"Handicap markings are clear (blue paint and wheelchair symbol are easy to read)?",tier:2}]},{name:"Walkways and Sidewalks",checks:[{id:"walkways_cracks",text:"No wide cracks (no cracks big enough to fit a pencil inside)?",tier:2},{id:"walkways_trip",text:"No trip hazards (no raised edges, uneven sections, or gaps that could trip someone)?",tier:1},{id:"walkways_stains",text:"Walkways are clean (no stains, no chewing gum stuck to concrete)?",tier:3},{id:"walkways_moss",text:"Walkways are safe to walk on (no moss, algae, or slippery spots)?",tier:1}]},{name:"Curbing (Curbs and Borders)",checks:[{id:"curbing_intact",text:"Curbs are solid (no crumbling, chipping, or broken pieces)?",tier:3},{id:"curbing_paint",text:"Curb paint is visible (yellow, red, or white paint still shows where needed)?",tier:4,amberEligible:!0}]},{name:"Outdoor Furniture (Benches, Trash Cans)",checks:[{id:"furnishings_benches",text:"Benches are in good shape (no broken boards, no loose parts, safe to sit on)?",tier:3},{id:"furnishings_graffiti",text:"No graffiti anywhere (no spray paint, markers, or scratched messages)?",tier:2},{id:"furnishings_rust",text:"Metal items are rust-free (no rust holes, no flaking rust)?",tier:3},{id:"furnishings_trash",text:"Trash cans work properly (lids open and close, cans are not broken or overflowing)?",tier:3}]}]},buildingExterior:{id:"buildingExterior",name:"Building Exterior",order:3,description:"Roof, gutters, walls, windows, doors, lighting",sections:[{name:"Roof (What You Can See From Ground)",checks:[{id:"roof_debris",text:"Roof is clear (no leaves, branches, balls, or trash sitting on the roof)?",tier:3},{id:"roof_damage",text:"Roof looks intact (no missing shingles, no sagging areas, no visible damage)?",tier:2}]},{name:"Gutters and Downspouts",checks:[{id:"gutters_clear",text:"Gutters are clear (no leaves or debris sticking out of gutters)?",tier:3,amberEligible:!0},{id:"gutters_overflow",text:"Gutters drain properly (no water stains or streaks running down the walls)?",tier:2},{id:"gutters_attached",text:"Gutters are secure (no sagging sections, no gutters pulling away from building)?",tier:2}]},{name:"Exterior Walls",checks:[{id:"walls_paint",text:"Paint is in good condition (no peeling or flaking spots bigger than a quarter)?",tier:3},{id:"walls_cracks",text:"No deep cracks (no cracks with visible depth or shadow inside them)?",tier:2},{id:"walls_staining",text:"Walls are clean (no dark stains, no mold, no mildew visible from the parking lot)?",tier:2},{id:"walls_dirt",text:"Walls look presentable (no dirt buildup, no cobwebs, no debris on walls you can see walking in)?",tier:3,amberEligible:!0}]},{name:"Exterior Windows",checks:[{id:"windows_intact",text:"All windows are whole (no cracked, chipped, or broken glass)?",tier:2},{id:"windows_clean",text:"Windows are clean (no heavy dirt, dust, or grime buildup)?",tier:3},{id:"windows_seal",text:"Window seals are good (no foggy glass from broken seals, no gaps around frames)?",tier:3}]},{name:"Exterior Doors",checks:[{id:"doors_clean",text:"Doors are clean (no dirt, dust, or grime on door surfaces)?",tier:3},{id:"doors_damage",text:"Doors are undamaged (no dents, scratches, peeling paint, or broken parts)?",tier:2},{id:"doors_weatherstrip",text:"Weatherstripping is present (rubber seal around door edges is visible and intact)?",tier:3}]},{name:"Exterior Lighting",checks:[{id:"lighting_operational",text:"All lights work (no burnt out bulbs, no flickering lights)?",tier:2},{id:"lighting_lenses",text:"Light covers are clean (no heavy dirt, bugs, or debris inside light fixtures)?",tier:4,amberEligible:!0},{id:"lighting_dark",text:"Walkways are well-lit (no dark areas along the path from parking to entrance)?",tier:1}]}]},entrance:{id:"entrance",name:"Entrance & Arrival",order:4,description:"Signage, entry glass, mats, threshold, Ritz-Carlton test",sections:[{name:"Building Signage",checks:[{id:"signage_clean",text:"Signs are clean (no dirt, dust, bird droppings, or grime)?",tier:3},{id:"signage_aligned",text:"Signs are straight (not crooked, tilted, or hanging unevenly)?",tier:3},{id:"signage_illuminated",text:"Lit signs are working (if the sign has lights, they are all on and bright)?",tier:2},{id:"signage_visible",text:"Signs can be seen clearly (nothing blocking the view from the parking lot)?",tier:2}]},{name:"Entry Door Glass",checks:[{id:"entry_glass",text:"Entry glass is spotless (no fingerprints, smudges, streaks, or nose prints)?",tier:2,amberIneligible:!0}]},{name:"Entry Mats",checks:[{id:"mats_centered",text:"Mats are centered in doorway (not pushed to one side or crooked)?",tier:3,amberEligible:!0},{id:"mats_clean",text:"Mats are clean (no heavy dirt, stains, or debris on mat surface)?",tier:3},{id:"mats_trip",text:"Mats are flat and safe (no curled edges, bumps, or corners sticking up)?",tier:1}]},{name:"Door Threshold (Floor at Doorway)",checks:[{id:"threshold_clear",text:"Threshold is clean (no leaves, dirt, sand, or debris at the door)?",tier:3,amberEligible:!0},{id:"threshold_damage",text:"Threshold is in good condition (no chips, cracks, or damage to floor at doorway)?",tier:2}]},{name:"First Impression Test",checks:[{id:"ritz_test",text:"Entrance looks professional (would a guest at a nice hotel find this entrance acceptable)?",tier:2}]}]},interior:{id:"interior",name:"Interior Building Condition",order:5,description:"Walls, floors, ceilings, doors/windows, baseboards, fixtures, furniture",isRoomBased:!0,requiredRooms:{classroom:{min:3,label:"Classrooms"},bathroom:{min:2,label:"Bathrooms"}},classroomSections:[{name:"Interior Walls",checks:[{id:"int_walls_paint",text:"Paint is in good condition (no peeling, flaking, or chipping spots bigger than a quarter)?",tier:3},{id:"int_walls_bubbling",text:"Walls are flat (no bubbles, blisters, or bumps in the paint)?",tier:3},{id:"int_walls_touchup",text:"Touch-up paint matches (no obvious patches of different colored paint)?",tier:3},{id:"int_walls_water",text:"No water damage (no water stains, brown spots, or damp areas bigger than your hand)?",tier:1,amberIneligible:!0},{id:"int_walls_holes",text:"Walls are intact (no holes or gouges bigger than a quarter)?",tier:3},{id:"int_walls_cracks",text:"No deep cracks (no cracks with visible depth or shadow inside them)?",tier:2},{id:"int_walls_seams",text:"Drywall looks smooth (no visible tape lines, seams, or joints when standing arm's length away)?",tier:3},{id:"int_walls_scuffs",text:"Walls are mostly scuff-free (no more than 3 scuff marks on any wall)?",tier:3,amberEligible:!0}]},{name:"Floors",checks:[{id:"int_floors_cracks",text:"Hard floors are intact (no cracks bigger than a quarter)?",tier:2},{id:"int_floors_chips",text:"No chipped edges (no chips or lips that could catch your foot or trip someone)?",tier:1},{id:"int_floors_tiles",text:"Tiles are secure (no loose, wobbly, or cracked tiles)?",tier:2},{id:"int_floors_grout",text:"Grout is solid (no missing grout, no gaps wider than a pencil between tiles)?",tier:3},{id:"int_floors_carpet_wear",text:"Carpet looks good (no worn paths or bald spots you can see from 10 feet away)?",tier:3},{id:"int_floors_carpet_fray",text:"Carpet edges are intact (no fraying, unraveling, or loose threads at edges or seams)?",tier:3,amberEligible:!0},{id:"int_floors_carpet_ripples",text:"Carpet is flat (no bumps, ripples, or waves in the carpet)?",tier:2},{id:"int_floors_transitions",text:"Floor transitions are secure (metal strips between floor types are tight and don't move when stepped on)?",tier:2}]},{name:"Ceilings",checks:[{id:"int_ceilings_flush",text:"Ceiling tiles are in place (all tiles sitting flat in the grid, no gaps)?",tier:3},{id:"int_ceilings_sag",text:"Ceiling tiles are level (no tiles sagging or hanging below the others)?",tier:2},{id:"int_ceilings_stains",text:"No ceiling stains (no brown spots or water marks bigger than your hand)?",tier:1,amberIneligible:!0},{id:"int_ceilings_cracks",text:"No deep cracks (no cracks with visible depth or shadow inside them)?",tier:2},{id:"int_ceilings_fixtures",text:"Ceiling fixtures are secure (lights, vents, and speakers are sitting properly in ceiling)?",tier:3}]},{name:"Doors and Windows",checks:[{id:"int_doors_latch",text:"Doors close properly (door latches shut on the first try without extra pushing)?",tier:2,amberEligible:!0},{id:"int_doors_wobble",text:"Door handles are tight (no wobble or looseness when you turn the handle)?",tier:3},{id:"int_doors_components",text:"Door hardware is complete (all parts present - handle, latch plate, hinges)?",tier:3},{id:"int_doors_hinges",text:"Doors hang straight (door closes flush against the frame, no gaps or rubbing)?",tier:3},{id:"int_doors_glass",text:"Window glass is intact (no cracks, chips, or broken panes of any size)?",tier:2,amberEligible:!0},{id:"int_doors_frames",text:"Door and window frames are undamaged (no dents, chips, or missing pieces)?",tier:3}]},{name:"Baseboards and Trim",checks:[{id:"int_baseboards_gaps",text:"Baseboards are tight to wall (no gaps you can see when standing up)?",tier:3,amberEligible:!0},{id:"int_baseboards_damage",text:"Baseboards are in good shape (no damaged sections longer than your hand)?",tier:3},{id:"int_baseboards_missing",text:"All baseboards are present (no missing sections of baseboard)?",tier:2},{id:"int_baseboards_paint",text:"Baseboard paint is good (no peeling, flaking, or chipping bigger than a quarter)?",tier:3}]},{name:"Lighting and Electrical",checks:[{id:"class_lights_working",text:"All lights work (no burnt out bulbs or flickering lights)?",tier:2},{id:"class_lights_covers",text:"Light covers are in place and clean (no missing or damaged covers)?",tier:3},{id:"class_outlets_covers",text:"All outlet and switch covers are in place (no missing or broken covers)?",tier:3},{id:"class_outlets_secure",text:"Outlets are secure (no loose outlets that move when plugging in)?",tier:2}]},{name:"Furniture (Tables, Chairs, Desks)",checks:[{id:"int_furniture_wobble",text:"Furniture is stable (no wobbling when you sit down or lean on it)?",tier:2},{id:"int_furniture_legs",text:"All legs and supports are intact (no broken, bent, or missing legs)?",tier:2},{id:"int_furniture_broken",text:"Furniture is complete (no broken drawers, missing parts, or damaged pieces)?",tier:2},{id:"int_furniture_edges",text:"No sharp edges exposed (no broken corners, exposed metal, or splintered wood)?",tier:1},{id:"int_furniture_upholstery",text:"Fabric is intact (no tears, rips, or seams coming apart on upholstered items)?",tier:3}]},{name:"Whiteboard/Teaching Surfaces",checks:[{id:"class_whiteboard_surface",text:"Whiteboard surface is undamaged (no dents, scratches, cracks, or delamination)?",tier:3},{id:"class_whiteboard_secure",text:"Whiteboard is securely mounted (no wobble or movement)?",tier:2},{id:"class_markers_tray",text:"Marker tray is intact (no broken or missing tray)?",tier:3}]}],bathroomSections:[{name:"Walls and Partitions",checks:[{id:"bath_walls_paint",text:"Paint is in good condition (no peeling, flaking, or chipping)?",tier:3},{id:"bath_walls_water",text:"No water damage (no water stains, brown spots, or mold)?",tier:1,amberIneligible:!0},{id:"bath_walls_holes",text:"Walls are intact (no holes or damage bigger than a quarter)?",tier:3},{id:"bath_partitions_stable",text:"Stall partitions are stable (no wobbling or loose partitions)?",tier:2},{id:"bath_partitions_hardware",text:"Partition hardware is complete (all hinges, latches, and hooks present)?",tier:3},{id:"bath_partitions_gaps",text:"Partitions provide privacy (no large gaps between panels)?",tier:3}]},{name:"Floors",checks:[{id:"bath_floors_cracks",text:"Floor tiles are intact (no cracks or chips bigger than a quarter)?",tier:2},{id:"bath_floors_grout",text:"Grout is solid and sealed (no missing, crumbling, or discolored grout)?",tier:3},{id:"bath_floors_trip",text:"No trip hazards (no raised edges, loose tiles, or uneven surfaces)?",tier:1},{id:"bath_floors_drain",text:"Floor drains are clear (no standing water around drains)?",tier:2}]},{name:"Ceilings",checks:[{id:"bath_ceilings_stains",text:"No ceiling stains (no water marks or discoloration)?",tier:1,amberIneligible:!0},{id:"bath_ceilings_tiles",text:"Ceiling tiles are in place (no missing or sagging tiles)?",tier:2},{id:"bath_ceilings_vent",text:"Exhaust vent is present and appears functional?",tier:2}]},{name:"Toilets and Urinals",checks:[{id:"bath_toilets_secure",text:"Toilets are securely mounted (no rocking or movement)?",tier:2},{id:"bath_toilets_flush",text:"Toilets flush properly (water drains and refills correctly)?",tier:2},{id:"bath_toilets_seats",text:"Toilet seats are intact (no cracks, chips, or loose seats)?",tier:3},{id:"bath_toilets_handles",text:"Flush handles work (no broken or missing handles)?",tier:2},{id:"bath_urinals_flush",text:"Urinals flush properly (if applicable)?",tier:2},{id:"bath_urinals_dividers",text:"Urinal dividers are in place and secure (if applicable)?",tier:3}]},{name:"Sinks and Counters",checks:[{id:"bath_sinks_secure",text:"Sinks are securely mounted (no wobble or movement)?",tier:2},{id:"bath_sinks_drain",text:"Sinks drain properly (no slow drains or standing water)?",tier:2},{id:"bath_sinks_faucets",text:"Faucets work correctly (no leaks, proper hot/cold)?",tier:2},{id:"bath_sinks_handles",text:"Faucet handles are intact (no loose or missing handles)?",tier:3},{id:"bath_counters_surface",text:"Counter surfaces are intact (no chips, cracks, or delamination)?",tier:3},{id:"bath_counters_caulk",text:"Caulking around sinks is intact (no gaps or peeling)?",tier:3}]},{name:"Mirrors",checks:[{id:"bath_mirrors_intact",text:"Mirrors are intact (no cracks, chips, or damage)?",tier:2},{id:"bath_mirrors_secure",text:"Mirrors are securely mounted (no loose or angled mirrors)?",tier:2}]},{name:"Dispensers and Accessories",checks:[{id:"bath_soap_dispenser",text:"Soap dispensers are present and functional?",tier:2},{id:"bath_paper_dispenser",text:"Paper towel dispensers are present and functional?",tier:2},{id:"bath_tp_holders",text:"Toilet paper holders are present and secure?",tier:3},{id:"bath_trash_cans",text:"Trash receptacles are present and functional?",tier:3},{id:"bath_sanitary",text:"Sanitary product dispensers work (if applicable)?",tier:3}]},{name:"Doors",checks:[{id:"bath_door_main",text:"Main door closes and latches properly?",tier:2},{id:"bath_door_stalls",text:"Stall doors close and latch properly?",tier:2},{id:"bath_door_hardware",text:"Door hardware is complete (handles, locks work)?",tier:3},{id:"bath_door_gaps",text:"Door frames are intact (no large gaps or damage)?",tier:3}]}],sections:[{name:"Interior Walls",checks:[{id:"int_walls_paint",text:"Paint is in good condition (no peeling, flaking, or chipping spots bigger than a quarter)?",tier:3},{id:"int_walls_bubbling",text:"Walls are flat (no bubbles, blisters, or bumps in the paint)?",tier:3},{id:"int_walls_touchup",text:"Touch-up paint matches (no obvious patches of different colored paint)?",tier:3},{id:"int_walls_water",text:"No water damage (no water stains, brown spots, or damp areas bigger than your hand)?",tier:1,amberIneligible:!0},{id:"int_walls_holes",text:"Walls are intact (no holes or gouges bigger than a quarter)?",tier:3},{id:"int_walls_cracks",text:"No deep cracks (no cracks with visible depth or shadow inside them)?",tier:2},{id:"int_walls_seams",text:"Drywall looks smooth (no visible tape lines, seams, or joints when standing arm's length away)?",tier:3},{id:"int_walls_scuffs",text:"Walls are mostly scuff-free (no more than 3 scuff marks on any wall)?",tier:3,amberEligible:!0}]},{name:"Floors",checks:[{id:"int_floors_cracks",text:"Hard floors are intact (no cracks bigger than a quarter)?",tier:2},{id:"int_floors_chips",text:"No chipped edges (no chips or lips that could catch your foot or trip someone)?",tier:1},{id:"int_floors_tiles",text:"Tiles are secure (no loose, wobbly, or cracked tiles)?",tier:2},{id:"int_floors_grout",text:"Grout is solid (no missing grout, no gaps wider than a pencil between tiles)?",tier:3},{id:"int_floors_carpet_wear",text:"Carpet looks good (no worn paths or bald spots you can see from 10 feet away)?",tier:3},{id:"int_floors_carpet_fray",text:"Carpet edges are intact (no fraying, unraveling, or loose threads at edges or seams)?",tier:3,amberEligible:!0},{id:"int_floors_carpet_ripples",text:"Carpet is flat (no bumps, ripples, or waves in the carpet)?",tier:2},{id:"int_floors_transitions",text:"Floor transitions are secure (metal strips between floor types are tight and don't move when stepped on)?",tier:2}]},{name:"Ceilings",checks:[{id:"int_ceilings_flush",text:"Ceiling tiles are in place (all tiles sitting flat in the grid, no gaps)?",tier:3},{id:"int_ceilings_sag",text:"Ceiling tiles are level (no tiles sagging or hanging below the others)?",tier:2},{id:"int_ceilings_stains",text:"No ceiling stains (no brown spots or water marks bigger than your hand)?",tier:1,amberIneligible:!0},{id:"int_ceilings_cracks",text:"No deep cracks (no cracks with visible depth or shadow inside them)?",tier:2},{id:"int_ceilings_fixtures",text:"Ceiling fixtures are secure (lights, vents, and speakers are sitting properly in ceiling)?",tier:3}]},{name:"Interior Doors and Windows",checks:[{id:"int_doors_latch",text:"Doors close properly (door latches shut on the first try without extra pushing)?",tier:2,amberEligible:!0},{id:"int_doors_wobble",text:"Door handles are tight (no wobble or looseness when you turn the handle)?",tier:3},{id:"int_doors_components",text:"Door hardware is complete (all parts present - handle, latch plate, hinges)?",tier:3},{id:"int_doors_hinges",text:"Doors hang straight (door closes flush against the frame, no gaps or rubbing)?",tier:3},{id:"int_doors_glass",text:"Window glass is intact (no cracks, chips, or broken panes of any size)?",tier:2,amberEligible:!0},{id:"int_doors_frames",text:"Door and window frames are undamaged (no dents, chips, or missing pieces)?",tier:3}]},{name:"Baseboards and Trim",checks:[{id:"int_baseboards_gaps",text:"Baseboards are tight to wall (no gaps you can see when standing up)?",tier:3,amberEligible:!0},{id:"int_baseboards_damage",text:"Baseboards are in good shape (no damaged sections longer than your hand)?",tier:3},{id:"int_baseboards_missing",text:"All baseboards are present (no missing sections of baseboard)?",tier:2},{id:"int_baseboards_paint",text:"Baseboard paint is good (no peeling, flaking, or chipping bigger than a quarter)?",tier:3}]},{name:"Fixtures (Sinks, Lights, Outlets)",checks:[{id:"int_fixtures_secure",text:"Fixtures are attached firmly (nothing loose or pulling away from wall or ceiling)?",tier:2},{id:"int_fixtures_broken",text:"All parts work (no broken handles, knobs, switches, or levers)?",tier:2},{id:"int_fixtures_scratches",text:"Fixtures look good (no big chips or scratches you can see from arm's length)?",tier:3,amberEligible:!0},{id:"int_fixtures_covers",text:"All covers are in place (no missing outlet covers, switch plates, or vent covers)?",tier:3}]},{name:"Furniture (Tables, Chairs, Desks)",checks:[{id:"int_furniture_wobble",text:"Furniture is stable (no wobbling when you sit down or lean on it)?",tier:2},{id:"int_furniture_legs",text:"All legs and supports are intact (no broken, bent, or missing legs)?",tier:2},{id:"int_furniture_broken",text:"Furniture is complete (no broken drawers, missing parts, or damaged pieces)?",tier:2},{id:"int_furniture_edges",text:"No sharp edges exposed (no broken corners, exposed metal, or splintered wood)?",tier:1},{id:"int_furniture_upholstery",text:"Fabric is intact (no tears, rips, or seams coming apart on upholstered items)?",tier:3}]}]},observations:{id:"observations",name:"Observations & Routing",order:6,description:"Issues observed that route to other pillars",isObservationZone:!0,routingCategories:[{id:"security",name:"Security",pillar:"Security Pillar",tier:1,items:["Perimeter doors not latching properly","Gates not self-closing and latching","Fencing gaps","Cameras not powered or views obstructed","Access readers not functional","Doors propped open"]},{id:"outdoor_rec",name:"Outdoor Recreation",pillar:"Outdoor Recreation Pillar",tier:2,items:["Equipment with visible damage","Sharp edges or hazards visible","Surfacing voids or displacement","Hard surface exposed in fall zones","Fencing or gate issues","Debris/foreign objects in play area"]},{id:"fire_life_safety",name:"Fire & Life Safety",pillar:"Fire/Life Safety Pillar",tier:1,items:["Extinguishers missing or tags not current","Emergency lighting not functional","Exit signage not illuminated","Address numbers not visible from street","Egress paths obstructed"]},{id:"mechanical",name:"Mechanical",pillar:"Mechanical Domain",tier:2,items:["Temperature complaints","Plumbing issues","Electrical issues","Elevator not functioning"]},{id:"cleanliness",name:"Cleanliness",pillar:"Cleanliness Domain",tier:3,items:["Interior cleanliness issues"]},{id:"structural_capital",name:"Structural/Capital",pillar:"Leadership",tier:3,items:["Structural cracks","Foundation concerns","End-of-life asset conditions","Issues requiring capital investment"]}]},governance:{id:"governance",name:"Governance",order:7,description:"Process compliance and prior week follow-up",isGovernanceZone:!0,sections:[{name:"Prior Week Follow-Up",checks:[{id:"gov_amber_resolved",text:"Last week's Amber issues are fixed (all yellow-rated items from last week have been repaired)?",tier:2},{id:"gov_tickets_closed",text:"Last week's work orders are complete or on track (all tickets from last week are closed or have a plan)?",tier:3}]},{name:"Staff Reporting Queue",checks:[{id:"gov_see_it_empty",text:"Staff reports have been addressed (See It, Snap It queue is empty or caught up)?",tier:3}]},{name:"Alpha Standard",checks:[{id:"alpha_standard_pass",text:"Taking one final look at the entire campus - does this property meet the Alpha Standard?",tier:2},{id:"alpha_standard_improvement",text:"Even if everything passes, note one thing you would recommend we upgrade to raise the bar.",tier:4,isTextInput:!0,placeholder:"What one improvement would you recommend?"}]}]}},Yt=["landscaping","hardscapes","buildingExterior","entrance","interior","governance"],g2=n=>{const i=Rn[n];return!i||!i.sections?[]:i.sections.flatMap(r=>r.checks.map(a=>({...a,section:r.name})))},so=(n,i)=>{const a=g2(n).filter(p=>i[p.id]===!1);return a.length===0?"GREEN":a.some(p=>p.amberIneligible)||a.some(p=>p.tier===1)?"RED":a.every(p=>p.amberEligible)&&a.length<=2?"AMBER":(a.length>2,"RED")},m2=n=>{const i=Object.values(n),a=i.filter(d=>d==="GREEN").length/i.length*100,c=i.includes("SAFETY_FLAG");return a>=85&&!c?"PASS":"FAIL"},x2=n=>{for(const i of Object.values(Rn))if(i.sections)for(const r of i.sections){const a=r.checks.find(c=>c.id===n);if(a)return a.tier}return 3},Yd="bg_walkthrough_state",Kd=()=>({campus:null,campusData:null,auditor:"",auditorEmail:"",startTime:null,currentZoneIndex:0,selectedRooms:{classrooms:[],bathrooms:[]},currentRoomIndex:0,zoneResults:{},roomResults:{},issues:[],observations:[],exitPhotos:{},zoneRatings:{},priorWeekIssues:[],priorWeekResolved:null,isComplete:!1,endTime:null}),y2=()=>{const[n,i]=v.useState(()=>{try{const B=localStorage.getItem(Yd);if(B){const $=JSON.parse(B);if($.startTime&&!$.isComplete){const O=new Date($.startTime).toDateString(),q=new Date().toDateString();if(O===q)return $}}}catch(B){console.error("Error restoring B&G walkthrough state:",B)}return Kd()});v.useEffect(()=>{if(n.startTime&&!n.isComplete)try{localStorage.setItem(Yd,JSON.stringify(n))}catch(B){console.error("[useBGWalkthrough] Error saving to localStorage:",B)}},[n]);const r=v.useCallback(()=>{localStorage.removeItem(Yd)},[]),a=v.useCallback((B,$,O,q)=>{i({...Kd(),campus:B,campusData:$,auditor:O,auditorEmail:q,startTime:new Date().toISOString()})},[]),c=v.useCallback(()=>{r(),i(Kd())},[r]),d=v.useCallback(()=>{const B=Yt[n.currentZoneIndex];return Rn[B]},[n.currentZoneIndex]),h=v.useCallback((B,$)=>{i(O=>({...O,selectedRooms:{classrooms:B,bathrooms:$}}))},[]),p=v.useCallback(()=>[...n.selectedRooms.classrooms.map($=>({name:$,type:"classroom"})),...n.selectedRooms.bathrooms.map($=>({name:$,type:"bathroom"}))][n.currentRoomIndex]||null,[n.selectedRooms,n.currentRoomIndex]),g=v.useCallback(()=>n.selectedRooms.classrooms.length+n.selectedRooms.bathrooms.length,[n.selectedRooms]),m=v.useCallback((B,$,O,q=null)=>{i(Z=>{if(q){const re=`${q}`;return{...Z,roomResults:{...Z.roomResults,[re]:{...Z.roomResults[re]||{},[$]:O}}}}else return{...Z,zoneResults:{...Z.zoneResults,[B]:{...Z.zoneResults[B]||{},[$]:O}}}})},[]),x=v.useCallback((B,$,O=null)=>{i(q=>O?{...q,roomResults:{...q.roomResults,[O]:{...q.roomResults[O]||{},...$}}}:{...q,zoneResults:{...q.zoneResults,[B]:{...q.zoneResults[B]||{},...$}}})},[]),k=v.useCallback(B=>{const $=`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return i(O=>({...O,issues:[...O.issues,{id:$,timestamp:new Date().toISOString(),tier:x2(B.checkId),photos:[],notes:"",...B}]})),$},[]),S=v.useCallback((B,$)=>{i(O=>({...O,issues:O.issues.map(q=>q.id===B?{...q,...$}:q)}))},[]),_=v.useCallback((B,$)=>{i(O=>({...O,issues:O.issues.map(q=>q.id===B?{...q,photos:[...q.photos||[],$]}:q)}))},[]),w=v.useCallback(B=>{i($=>({...$,issues:$.issues.filter(O=>O.id!==B)}))},[]),j=v.useCallback(B=>{i($=>({...$,observations:[...$.observations,{id:`obs_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),photos:[],notes:"",...B}]}))},[]),A=v.useCallback((B,$)=>{i(O=>({...O,observations:O.observations.map(q=>q.id===B?{...q,...$}:q)}))},[]),z=v.useCallback(B=>{i($=>({...$,observations:$.observations.filter(O=>O.id!==B)}))},[]),D=v.useCallback((B,$)=>{i(O=>({...O,exitPhotos:{...O.exitPhotos,[B]:$}}))},[]),y=v.useCallback(B=>{i($=>({...$,priorWeekIssues:B}))},[]),C=v.useCallback(B=>{const $=Rn[B];let O;if($.isRoomBased){const q=Object.values(n.roomResults).reduce((Z,re)=>(Object.entries(re).forEach(([ae,I])=>{(Z[ae]===void 0||I===!1)&&(Z[ae]=I)}),Z),{});O=so(B,q)}else $.isObservationZone?O="GREEN":$.isGovernanceZone?O=so(B,n.zoneResults[B]||{}):O=so(B,n.zoneResults[B]||{});return i(q=>({...q,zoneRatings:{...q.zoneRatings,[B]:O}})),O},[n.zoneResults,n.roomResults]),T=v.useCallback(()=>{i(B=>{const $=B.currentZoneIndex+1;return $>=Yt.length?B:{...B,currentZoneIndex:$,currentRoomIndex:0}})},[]),E=v.useCallback(()=>{i(B=>({...B,currentZoneIndex:Math.max(0,B.currentZoneIndex-1)}))},[]),W=v.useCallback(()=>{i(B=>({...B,currentRoomIndex:B.currentRoomIndex+1}))},[]),M=v.useCallback(()=>{i(B=>({...B,currentRoomIndex:Math.max(0,B.currentRoomIndex-1)}))},[]),K=v.useCallback(B=>{i($=>({...$,currentZoneIndex:B,currentRoomIndex:0}))},[]),ee=v.useCallback(()=>{const B={};Yt.forEach(O=>{const q=Rn[O];if(q.isObservationZone)B[O]="GREEN";else if(q.isRoomBased){const Z=Object.values(n.roomResults).reduce((re,ae)=>(Object.entries(ae).forEach(([I,U])=>{(re[I]===void 0||U===!1)&&(re[I]=U)}),re),{});B[O]=so(O,Z)}else B[O]=so(O,n.zoneResults[O]||{})});const $=m2(B);return i(O=>({...O,zoneRatings:B,campusRating:$,isComplete:!0,endTime:new Date().toISOString()})),r(),{zoneRatings:B,campusRating:$}},[n.zoneResults,n.roomResults,r]),F=v.useCallback(()=>{const B=n.startTime&&n.endTime?Math.round((new Date(n.endTime)-new Date(n.startTime))/6e4):null;return{date:n.startTime?new Date(n.startTime).toLocaleDateString():null,time:n.startTime?new Date(n.startTime).toLocaleTimeString():null,campus:n.campus,campusData:n.campusData,auditor:n.auditor,auditorEmail:n.auditorEmail,duration:B,zoneResults:n.zoneResults,roomResults:n.roomResults,selectedRooms:n.selectedRooms,zoneRatings:n.zoneRatings,campusRating:n.campusRating,issues:n.issues,observations:n.observations,exitPhotos:n.exitPhotos,totalIssues:n.issues.length,totalObservations:n.observations.length,greenZones:Object.values(n.zoneRatings).filter($=>$==="GREEN").length,amberZones:Object.values(n.zoneRatings).filter($=>$==="AMBER").length,redZones:Object.values(n.zoneRatings).filter($=>$==="RED").length,startTime:n.startTime,endTime:n.endTime}},[n]),ne=n.startTime&&!n.isComplete,se=v.useCallback(()=>{const B=d();if(!B)return!1;if(B.isObservationZone)return!0;if(B.isRoomBased){const O=[...n.selectedRooms.classrooms,...n.selectedRooms.bathrooms];return O.length===0?!1:O.every(q=>{const Z=n.roomResults[q]||{};return B.sections.every(re=>re.checks.every(ae=>Z[ae.id]!==void 0))})}const $=n.zoneResults[B.id]||{};return B.sections.every(O=>O.checks.every(q=>$[q.id]!==void 0))},[d,n.zoneResults,n.roomResults,n.selectedRooms]);return{...n,isInProgress:ne,getCurrentZone:d,getCurrentRoom:p,getTotalRoomCount:g,getWalkthroughData:F,isCurrentZoneComplete:se,initWalkthrough:a,resetWalkthrough:c,setSelectedRooms:h,recordCheckResult:m,recordZoneResults:x,addIssue:k,updateIssue:S,addPhotoToIssue:_,removeIssue:w,addObservation:j,updateObservation:A,removeObservation:z,addExitPhoto:D,setPriorWeekIssues:y,calculateAndSetZoneRating:C,nextZone:T,prevZone:E,nextRoom:W,prevRoom:M,goToZone:K,completeWalkthrough:ee,clearSavedState:r}},xn={green:{description:"World Class"},amber:{description:"At Risk",maxOpenIssues:3,maxDaysToFix:45},red:{description:"Not Meeting Standard"}},b2=["staffing_coverage","staffing_gaps","doors_secured","doors_propped","incident_forced_entry","incident_breach","guard_license_valid"],v2=["perimeter_fencing","perimeter_gates","perimeter_lights","perimeter_damage","doors_secured","doors_propped","access_badge_readers","access_doors_unlock","access_doors_autolock","camera_live","camera_clarity","camera_unobstructed","incident_forced_entry","incident_breach"],Ri={daily:{id:"daily",name:"Daily Checks",frequency:"daily",order:1,description:"Complete every day the campus is open",timeNeeded:"15-20 minutes",completionThreshold:.95,sections:[{name:"Perimeter Walk",description:"Walk the outside of the building and property line. Look for anything unusual.",checks:[{id:"perimeter_fencing",text:"Is all fencing intact?",helpText:"No holes, gaps, or damage",tier:"amber",photoRequired:!0},{id:"perimeter_gates",text:"Are all gates working properly?",helpText:"Open, close, and lock correctly",tier:"amber",photoRequired:!0},{id:"perimeter_lights",text:"Are all exterior lights working?",helpText:"Check for burnt out bulbs or dark spots",tier:"amber",photoRequired:!0},{id:"perimeter_damage",text:"Is the perimeter free of damage or tampering?",helpText:"No graffiti, broken items, or signs of forced entry attempts",tier:"amber",photoRequired:!0}]},{name:"Staffing Coverage",description:"Confirm security post was staffed during all open hours.",checks:[{id:"staffing_coverage",text:"Was the security post staffed during all open hours?",tier:"red",instantRed:!0,photoRequired:!1},{id:"staffing_gaps",text:"Were all coverage gaps under 15 minutes?",tier:"red",instantRed:!0,photoRequired:!1}]},{name:"Exterior Doors",description:"Check all exterior doors are properly secured.",checks:[{id:"doors_secured",text:"Are all exterior doors properly secured?",helpText:"Locked or properly controlled",tier:"red",instantRed:!0,photoRequired:!0},{id:"doors_propped",text:"Are all doors that should be closed actually closed?",helpText:"Not propped open",tier:"red",instantRed:!0,photoRequired:!0}]},{name:"Visitor Management",description:"Verify the visitor management system is ready for the day.",checks:[{id:"raptor_functioning",text:"Is the Raptor Visitor Management System functioning?",helpText:"System is powered on and responding",tier:"amber",photoRequired:!1}]}]},weekly:{id:"weekly",name:"Weekly Checks",frequency:"weekly",order:2,description:"Complete once per week",timeNeeded:"10-15 minutes",sections:[{name:"Access Control Spot Check",description:"Test a few badge readers and doors to make sure they are working.",checks:[{id:"access_badge_readers",text:"Do badge readers respond when a badge is tapped?",helpText:"Light or beep indicates response",tier:"amber",photoRequired:!0},{id:"access_doors_unlock",text:"Do doors unlock correctly when a valid badge is used?",tier:"amber",photoRequired:!0},{id:"access_doors_autolock",text:"Do doors lock automatically after opening?",tier:"amber",photoRequired:!0}]},{name:"Camera Spot Check",description:"Look at a few camera feeds to make sure they are working.",checks:[{id:"camera_live",text:"Are cameras showing a live picture?",helpText:"Not frozen or offline",tier:"amber",photoRequired:!0},{id:"camera_clarity",text:"Is the picture clear enough to identify faces at entrances?",tier:"amber",photoRequired:!0},{id:"camera_unobstructed",text:"Are all cameras unobstructed and pointing correctly?",helpText:"Not blocked, dirty, or misaligned",tier:"amber",photoRequired:!0}]}]},monthly:{id:"monthly",name:"Monthly Checks",frequency:"monthly",order:3,description:"Complete once per month",timeNeeded:"20-30 minutes",sections:[{name:"Incident Review",description:"Review any security incidents from the past month.",checks:[{id:"incident_forced_entry",text:"Was the campus free of forced entries or break-ins this month?",tier:"red",instantRed:!0,photoRequired:!0},{id:"incident_breach",text:"Was the campus free of perimeter breaches this month?",tier:"red",instantRed:!0,photoRequired:!0},{id:"incident_documented",text:"Were all incidents documented and fixed within 7 days?",helpText:"Select Yes if no incidents occurred",tier:"amber",photoRequired:!1}]},{name:"Camera System Review",description:"Check the camera system reports for uptime and storage.",checks:[{id:"camera_uptime_critical",text:"Did critical cameras (entrances, perimeter) stay online 99%+ of the time?",tier:"amber",photoRequired:!1},{id:"camera_uptime_other",text:"Did other exterior cameras stay online 97%+ of the time?",tier:"amber",photoRequired:!1},{id:"camera_retention",text:"Is video footage being saved for at least 30 days?",tier:"amber",photoRequired:!1},{id:"camera_retrieval",text:"Can footage be retrieved within 24 hours if needed?",tier:"amber",photoRequired:!1}]},{name:"Alarm System Test",description:"Verify the alarm system is working correctly.",checks:[{id:"alarm_tested",text:"Was the alarm system tested this month?",tier:"amber",photoRequired:!1},{id:"alarm_response",text:"Did the monitoring company respond correctly during the test?",tier:"amber",photoRequired:!1}]}]},annual:{id:"annual",name:"Annual Checks",frequency:"annual",order:4,description:"Complete once per year",timeNeeded:"30-60 minutes",sections:[{name:"Guard Credentials",description:"Verify that all security guards have current licenses and certifications.",checks:[{id:"guard_license_valid",text:"Do all guards have a valid, unexpired security license?",tier:"red",instantRed:!0,photoRequired:!1},{id:"guard_certifications",text:"Are all required certifications up to date?",tier:"amber",photoRequired:!1},{id:"guard_tracking",text:"Is there a system in place to track renewal dates?",tier:"amber",photoRequired:!1}]}]}},S2=n=>{const i=Ri[n];return!i||!i.sections?[]:i.sections.flatMap(r=>r.checks.map(a=>({...a,section:r.name})))},oo=n=>b2.includes(n),es=n=>v2.includes(n),k2=(n,i,r)=>{const c=S2(n).filter(x=>i[x.id]===!1);if(c.length===0)return"GREEN";if(c.some(x=>x.instantRed))return"RED";const h=r.filter(x=>x.status==="open");if(h.length>xn.amber.maxOpenIssues||h.some(x=>!x.owner||!x.fixDate))return"RED";const g=new Date;return h.some(x=>{const k=new Date(x.createdAt);return Math.floor((g-k)/(1e3*60*60*24))>xn.amber.maxDaysToFix})?"RED":"AMBER"},Qd="security_checklist_state",Jd=()=>({campus:null,campusData:null,auditor:"",auditorEmail:"",startTime:null,checklistType:null,checkResults:{},issues:[],rating:null,isComplete:!1,endTime:null}),w2=()=>{const[n,i]=v.useState(()=>{try{const y=localStorage.getItem(Qd);if(y){const C=JSON.parse(y);if(C.startTime&&!C.isComplete){const T=new Date(C.startTime).toDateString(),E=new Date().toDateString();if(T===E)return C}}}catch(y){console.error("Error restoring security checklist state:",y)}return Jd()});v.useEffect(()=>{if(n.startTime&&!n.isComplete)try{localStorage.setItem(Qd,JSON.stringify(n))}catch(y){console.error("[useSecurityChecklist] Error saving to localStorage:",y)}},[n]);const r=v.useCallback(()=>{localStorage.removeItem(Qd)},[]),a=v.useCallback((y,C,T,E,W)=>{i({...Jd(),campus:y,campusData:C,auditor:T,auditorEmail:E,checklistType:W,startTime:new Date().toISOString()})},[]),c=v.useCallback(()=>{r(),i(Jd())},[r]),d=v.useCallback(()=>n.checklistType?Ri[n.checklistType]:null,[n.checklistType]),h=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,[y]:C}}))},[]),p=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,...C}}))},[]),g=v.useCallback(y=>{const C=`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return i(T=>({...T,issues:[...T.issues,{id:C,timestamp:new Date().toISOString(),instantRed:oo(y.checkId),photoRequired:es(y.checkId),photos:[],explanation:"",status:"open",...y}]})),C},[]),m=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,...C}:E)}))},[]),x=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,photos:[...E.photos||[],C]}:E)}))},[]),k=v.useCallback(y=>{i(C=>({...C,issues:C.issues.filter(T=>T.id!==y)}))},[]),S=v.useCallback(y=>{const C=Ri[y||n.checklistType];if(!C)return{complete:!1,answered:0,total:0};let T=0,E=0;return C.sections.forEach(W=>{W.checks.forEach(M=>{T++,n.checkResults[M.id]!==void 0&&E++})}),{complete:E===T,answered:E,total:T}},[n.checkResults,n.checklistType]),_=v.useCallback(()=>n.issues.every(y=>!(!y.explanation||y.explanation.trim()===""||y.photoRequired&&(!y.photos||y.photos.length===0))),[n.issues]),w=v.useCallback(()=>{const y=k2(n.checklistType,n.checkResults,n.issues);return i(C=>({...C,rating:y,isComplete:!0,endTime:new Date().toISOString()})),r(),{rating:y}},[n.checklistType,n.checkResults,n.issues,r]),j=v.useCallback(()=>{const y=n.startTime&&n.endTime?Math.round((new Date(n.endTime)-new Date(n.startTime))/6e4):null,C=Ri[n.checklistType];return{date:n.startTime?new Date(n.startTime).toLocaleDateString():null,time:n.startTime?new Date(n.startTime).toLocaleTimeString():null,campus:n.campus,campusData:n.campusData,auditor:n.auditor,auditorEmail:n.auditorEmail,duration:y,checklistType:n.checklistType,checklistName:C?.name||n.checklistType,checkResults:n.checkResults,rating:n.rating,issues:n.issues,totalIssues:n.issues.length,openIssues:n.issues.filter(T=>T.status==="open").length,instantRedIssues:n.issues.filter(T=>T.instantRed).length,startTime:n.startTime,endTime:n.endTime}},[n]),A=n.startTime&&!n.isComplete,z={[n.checklistType]:n.checkResults},D=n.rating?{[n.checklistType]:n.rating}:{};return{...n,isInProgress:A,currentZoneId:n.checklistType,zoneResults:z,zoneRatings:D,overallRating:n.rating,getCurrentZone:d,getZoneCompletionStatus:S,getChecklistData:j,allIssuesComplete:_,initChecklist:a,resetChecklist:c,recordCheckResult:h,recordZoneResults:p,addIssue:g,updateIssue:m,addPhotoToIssue:x,removeIssue:k,completeChecklist:w,clearSavedState:r,setCurrentZone:()=>{},calculateAndSetZoneRating:()=>{}}},jt={HEALTH_SAFETY:{id:"health_safety",name:"Health & Safety",code:"14.03",principle:"Always ready",color:"#ef4444",escalation:"VP of Ops immediately"},SECURITY:{id:"security",name:"Security",code:"14.04",principle:"Locked tight",color:"#eab308",escalation:"VP of Ops + Security team"},INTERNET:{id:"internet",name:"Internet & Connectivity",code:"14.05",principle:"Never down",color:"#0ea5e9",escalation:"IT/MSP + VP of Ops"},INTERIOR:{id:"interior",name:"Interior Design",code:"14.08",principle:"Looks right",color:"#8b5cf6",escalation:"Worksmith + VP of Ops"},MECHANICAL:{id:"mechanical",name:"Mechanical",code:"14.11",principle:"Always cool",color:"#71717a",escalation:"Worksmith + VP of Ops"},CLEANLINESS:{id:"cleanliness",name:"Cleanliness",code:"vendor_qc",principle:"Tour ready",color:"#10b981",escalation:"Day porter vendor + Worksmith",isVendorQC:!0}},_t=[{id:"exterior",name:"Exterior / Arrival",order:1,timeEstimate:"2 min",description:"Quick scan as you approach and enter the building",passCriteria:"No obvious issues. You'd feel comfortable with a parent arriving right now.",checks:[{id:"ext_1",question:"Is the perimeter secure (gates closed, fences intact)?",metric:"SECURITY",lookingFor:"Gates closed, fences intact, no gaps"},{id:"ext_2",question:"Is the entry path clear and hazard-free?",metric:"HEALTH_SAFETY",lookingFor:"Drop-off area clear, no hazards on walkway"},{id:"ext_3",question:"Are exterior lights working?",metric:"MECHANICAL",lookingFor:"Lights working (if applicable at walk time)",optional:!0,optionalNote:"Check if morning is dark"}]},{id:"entry",name:"Entry / Reception",order:2,timeEstimate:"3 min",description:"First impression zone. This is what families see.",passCriteria:"A family walking in right now would see a professional, welcoming space.",checks:[{id:"entry_1",question:"Is access control working (badge/keypad/buzzer)?",metric:"SECURITY",lookingFor:"Badge reader / keypad / buzzer functional"},{id:"entry_2",question:"Is the visitor sign-in system ready?",metric:"SECURITY",lookingFor:"Log book or digital check-in operational"},{id:"entry_3",question:"Are emergency exits clear and unobstructed?",metric:"HEALTH_SAFETY",lookingFor:"Exit paths unobstructed, signage visible"},{id:"entry_4",question:"Are emergency procedures posted and visible?",metric:"HEALTH_SAFETY",lookingFor:"Procedures visible, current"},{id:"entry_5",question:"Is furniture in position per layout?",metric:"INTERIOR",lookingFor:"Aligned per layout, nothing out of place"},{id:"entry_6",question:"Is signage clean and intact?",metric:"INTERIOR",lookingFor:"Clean, straight, no damage"},{id:"entry_7",question:"Is this area tour-ready right now?",metric:"CLEANLINESS",lookingFor:"Floor clean? Surfaces dusted? No clutter?",isVendorQC:!0}]},{id:"commons",name:"Commons / Hallways",order:3,timeEstimate:"3 min",description:"High-traffic shared spaces.",passCriteria:"You could give a tour through here right now.",checks:[{id:"commons_1",question:"Are walkways clear and hazard-free?",metric:"HEALTH_SAFETY",lookingFor:"No trip hazards, no obstructions"},{id:"commons_2",question:"Are fire extinguishers accessible with current inspection?",metric:"HEALTH_SAFETY",lookingFor:"Visible, not blocked, inspection tag current"},{id:"commons_3",question:"Is first aid kit stocked and accessible?",metric:"HEALTH_SAFETY",lookingFor:"Visible, not blocked, stocked"},{id:"commons_4",question:"Is AED accessible and showing charged?",metric:"HEALTH_SAFETY",lookingFor:"Visible, not blocked, indicator shows charged"},{id:"commons_5",question:"Are cameras visibly operational?",metric:"SECURITY",lookingFor:"Visual check - lights on, positioned correctly"},{id:"commons_6",question:"Is the temperature comfortable?",metric:"MECHANICAL",lookingFor:"Feels right when you walk in"},{id:"commons_7",question:"Is HVAC running normally (no strange noise/smell)?",metric:"MECHANICAL",lookingFor:"No strange noises, no odors, no hot/cold spots"},{id:"commons_8",question:"Is furniture in position with no damage?",metric:"INTERIOR",lookingFor:"Aligned, nothing broken or out of place"},{id:"commons_9",question:"Is this area tour-ready right now?",metric:"CLEANLINESS",lookingFor:"Floors clean? Trash emptied? No spills?",isVendorQC:!0}]},{id:"learning",name:"Learning Space Sample",order:4,timeEstimate:"5 min",description:"Check 2 rooms. Rotate which ones daily.",passCriteria:"Students could walk in and start learning right now.",requiresRoomSelection:!0,roomCount:2,rotationNote:"Don't check the same rooms every day. Rotate so you see all spaces over the course of a week.",checks:[{id:"learning_1",question:"Is WiFi working in this room?",metric:"INTERNET",lookingFor:"Device connects, reasonable speed"},{id:"learning_2",question:"Are student devices charged and accessible?",metric:"INTERNET",lookingFor:"Charged, accessible, powered on"},{id:"learning_3",question:"Is the display/AV system working?",metric:"INTERNET",lookingFor:"Screen on, no error messages"},{id:"learning_4",question:"Is the temperature comfortable?",metric:"MECHANICAL",lookingFor:"Feels right"},{id:"learning_5",question:"Is furniture in position with no damage?",metric:"INTERIOR",lookingFor:"Desks/chairs arranged correctly"},{id:"learning_6",question:"Is this room tour-ready right now?",metric:"CLEANLINESS",lookingFor:"Floor clean? Surfaces wiped? Trash empty?",isVendorQC:!0}]},{id:"restroom",name:"Restroom Sample",order:5,timeEstimate:"4 min",description:"Check 2 restrooms. Rotate daily.",passCriteria:"You'd use this restroom yourself without hesitation.",requiresRoomSelection:!0,roomCount:2,rotationNote:"Hit different restrooms each day. Vendors can't game what they don't know you'll check.",checks:[{id:"restroom_1",question:"Do the locks work?",metric:"SECURITY",lookingFor:"Door locks engage properly"},{id:"restroom_2",question:"Is the floor dry (no slip hazard)?",metric:"HEALTH_SAFETY",lookingFor:"No puddles, no slip hazard"},{id:"restroom_3",question:"Is plumbing working (no leaks, fixtures operational)?",metric:"MECHANICAL",lookingFor:"Toilets flush, sinks drain, no leaks"},{id:"restroom_4",question:"Is this restroom tour-ready right now?",metric:"CLEANLINESS",lookingFor:"Clean, stocked, no odor",isVendorQC:!0}]},{id:"systems",name:"Systems Check",order:6,timeEstimate:"2 min",description:"Can be done from any computer/phone.",passCriteria:"Systems show green. No carryover issues unaddressed.",checks:[{id:"systems_1",question:"Is primary internet connection up?",metric:"INTERNET",lookingFor:"Dashboard green or speed test confirms"},{id:"systems_2",question:"Is CCTV system showing all cameras online?",metric:"SECURITY",lookingFor:"Dashboard shows cameras active"},{id:"systems_3",question:"Have all previous issues been resolved?",metric:"HEALTH_SAFETY",lookingFor:"No open flags or carryover issues from yesterday"}]}],Gx=()=>_t.flatMap(n=>n.checks.map(i=>({...i,stopId:n.id,stopName:n.name}))),_2=n=>Gx().filter(i=>i.metric===n),j2=(n,i)=>{const r=_2(n);for(const a of r){const c=i[a.id];if(!(a.optional&&c===void 0)&&c===!1)return"ISSUE"}return"GREEN"},ju=n=>{const i={};Object.keys(jt).forEach(c=>{const d=jt[c];i[d.id]=j2(c,n)});const a=Object.keys(jt).filter(c=>!jt[c].isVendorQC).every(c=>i[jt[c].id]==="GREEN");return{metricStatuses:i,overall:a?"GREEN":"ISSUE",streakIntact:a}},C2=n=>{const i=Gx().filter(a=>!a.optional),r=i.filter(a=>n[a.id]!==void 0).length;return Math.round(r/i.length*100)},Xd="green_streak_walk_state",eu=()=>({campus:null,campusData:null,coordinator:"",coordinatorEmail:"",startTime:null,currentStopIndex:0,currentCheckIndex:0,roomSelections:{learning:[],restroom:[]},currentRoomIndex:0,checkResults:{},issues:[],isComplete:!1,endTime:null,overallStatus:null,metricStatuses:null}),R2=()=>{const[n,i]=v.useState(()=>{try{const M=localStorage.getItem(Xd);if(M){const K=JSON.parse(M);if(K.startTime&&!K.isComplete){const ee=new Date(K.startTime).toDateString(),F=new Date().toDateString();if(ee===F)return K}}}catch(M){console.error("Error restoring green streak walk state:",M)}return eu()});v.useEffect(()=>{if(n.startTime&&!n.isComplete)try{localStorage.setItem(Xd,JSON.stringify(n))}catch(M){console.error("[useGreenStreakWalk] Error saving to localStorage:",M)}},[n]);const r=v.useCallback(()=>{localStorage.removeItem(Xd)},[]),a=v.useCallback((M,K,ee,F,ne={})=>{i({...eu(),campus:M,campusData:K,coordinator:ee,coordinatorEmail:F,startTime:new Date().toISOString(),roomSelections:{learning:ne.learning||[],restroom:ne.restroom||[]}})},[]),c=v.useCallback(()=>{r(),i(eu())},[r]),d=v.useCallback(()=>_t[n.currentStopIndex]||null,[n.currentStopIndex]),h=v.useCallback(()=>{const M=d();return M&&M.checks[n.currentCheckIndex]||null},[d,n.currentCheckIndex]),p=v.useCallback((M,K,ee=0)=>{i(F=>{const se=[...F.roomSelections[M]||[]];return se[ee]=K,{...F,roomSelections:{...F.roomSelections,[M]:se}}})},[]),g=v.useCallback(()=>n.currentRoomIndex||0,[n.currentRoomIndex]),m=v.useCallback(M=>{i(K=>({...K,currentRoomIndex:M}))},[]),x=v.useCallback((M,K,ee=null)=>{i(F=>{const ne={...F,checkResults:{...F.checkResults,[M]:K}};if(K===!1&&ee){const se={id:`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,checkId:M,timestamp:new Date().toISOString(),...ee};ne.issues=[...F.issues,se]}return ne})},[]),k=v.useCallback(M=>{const K={id:`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),photos:[],...M};return i(ee=>({...ee,issues:[...ee.issues,K]})),K.id},[]),S=v.useCallback((M,K)=>{i(ee=>({...ee,issues:ee.issues.map(F=>F.id===M?{...F,...K}:F)}))},[]),_=v.useCallback((M,K)=>{i(ee=>({...ee,issues:ee.issues.map(F=>F.id===M?{...F,photos:[...F.photos||[],K]}:F)}))},[]),w=v.useCallback(M=>{i(K=>({...K,issues:K.issues.filter(ee=>ee.checkId!==M)}))},[]),j=v.useCallback(()=>{i(M=>{const K=_t[M.currentStopIndex];if(!K)return M;const ee=K.roomCount||1,F=M.currentRoomIndex||0;return M.currentCheckIndex<K.checks.length-1?{...M,currentCheckIndex:M.currentCheckIndex+1}:ee>1&&F<ee-1?{...M,currentCheckIndex:0,currentRoomIndex:F+1}:M.currentStopIndex<_t.length-1?{...M,currentStopIndex:M.currentStopIndex+1,currentCheckIndex:0,currentRoomIndex:0}:M})},[]),A=v.useCallback(()=>{i(M=>{const K=_t[M.currentStopIndex],ee=M.currentRoomIndex||0;if(M.currentCheckIndex>0)return{...M,currentCheckIndex:M.currentCheckIndex-1};if(ee>0)return{...M,currentCheckIndex:K.checks.length-1,currentRoomIndex:ee-1};if(M.currentStopIndex>0){const F=_t[M.currentStopIndex-1],ne=F.roomCount||1;return{...M,currentStopIndex:M.currentStopIndex-1,currentCheckIndex:F.checks.length-1,currentRoomIndex:ne-1}}return M})},[]),z=v.useCallback(M=>{i(K=>({...K,currentStopIndex:M,currentCheckIndex:0}))},[]),D=v.useCallback(()=>{for(const M of _t){const K=M.roomCount||1;for(let ee=0;ee<K;ee++)for(const F of M.checks){if(F.optional)continue;const ne=K>1?`${F.id}_room${ee}`:F.id;if(n.checkResults[ne]===void 0)return!1}}return!0},[n.checkResults]),y=v.useCallback(()=>n.issues.every(M=>M.description&&M.description.trim()!==""),[n.issues]),C=v.useCallback(()=>{const M=ju(n.checkResults);return i(K=>({...K,isComplete:!0,endTime:new Date().toISOString(),overallStatus:M.overall,metricStatuses:M.metricStatuses})),r(),M},[n.checkResults,r]),T=v.useCallback(()=>{const M=n.startTime&&n.endTime?Math.round((new Date(n.endTime)-new Date(n.startTime))/6e4):null,K=ju(n.checkResults);return{type:"green_streak_walk",date:n.startTime?new Date(n.startTime).toLocaleDateString():null,time:n.startTime?new Date(n.startTime).toLocaleTimeString():null,campus:n.campus,campusData:n.campusData,coordinator:n.coordinator,coordinatorEmail:n.coordinatorEmail,duration:M,roomSelections:n.roomSelections,checkResults:n.checkResults,completionPercentage:C2(n.checkResults),overallStatus:K.overall,metricStatuses:K.metricStatuses,streakIntact:K.streakIntact,issues:n.issues,totalIssues:n.issues.length,startTime:n.startTime,endTime:n.endTime}},[n]),E=v.useCallback(()=>{let M=0,K=0,ee=0;for(let F=0;F<_t.length;F++){const ne=_t[F];for(let se=0;se<ne.checks.length;se++){const B=ne.checks[se];B.optional||(M++,n.checkResults[B.id]!==void 0&&K++),(F<n.currentStopIndex||F===n.currentStopIndex&&se<n.currentCheckIndex)&&ee++}}return{currentStop:n.currentStopIndex+1,totalStops:_t.length,currentCheckInStop:n.currentCheckIndex+1,totalChecksInStop:_t[n.currentStopIndex]?.checks.length||0,completedChecks:K,totalChecks:M,percentage:Math.round(K/M*100),currentOverallIndex:ee+1}},[n.currentStopIndex,n.currentCheckIndex,n.checkResults]),W=n.startTime&&!n.isComplete;return{...n,isInProgress:W,stops:_t,metrics:jt,getCurrentStop:d,getCurrentCheck:h,getCurrentRoomIndex:g,getProgress:E,getWalkData:T,isWalkComplete:D,allIssuesHaveDescription:y,initWalk:a,resetWalk:c,setRoomSelection:p,setCurrentRoomIndex:m,recordCheckResult:x,addIssue:k,updateIssue:S,addPhotoToIssue:_,removeIssue:w,nextCheck:j,prevCheck:A,goToStop:z,completeWalk:C,clearSavedState:r}},E2=({isOpen:n,label:i,isVideoReady:r,videoRef:a,canvasRef:c,onCapture:d,onClose:h})=>n?s.jsxs("div",{className:"fixed inset-0 z-50 bg-black",children:[s.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),s.jsx("canvas",{ref:c,className:"hidden"}),s.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[s.jsxs("div",{className:"bg-black/50 p-4 flex justify-between items-center",children:[s.jsx("button",{onClick:h,className:"text-white text-lg",children:" Cancel"}),s.jsxs("span",{className:"text-white text-sm",children:[" ",i]})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center",children:!r&&s.jsx("div",{className:"text-white text-lg bg-black/50 px-4 py-2 rounded-lg",children:"Loading camera..."})}),s.jsx("div",{className:"bg-black/50 p-6 flex justify-center",children:s.jsx("button",{onClick:d,disabled:!r,className:`w-20 h-20 rounded-full border-4 border-white flex items-center justify-center transition-all ${r?"bg-white/20 active:bg-white/40":"bg-gray-500/50 opacity-50 cursor-not-allowed"}`,children:s.jsx("div",{className:`w-16 h-16 rounded-full ${r?"bg-white":"bg-gray-400"}`})})})]})]}):null,Gu=[{id:"cleaning",name:"Cleaning Issue",icon:"",team:"Housekeeping"},{id:"supplies",name:"Supplies Empty",icon:"",team:"Housekeeping"},{id:"spill",name:"Spill / Wet Floor",icon:"",team:"Housekeeping"},{id:"trash",name:"Trash Overflow",icon:"",team:"Housekeeping"},{id:"odor",name:"Odor Issue",icon:"",team:"Housekeeping"},{id:"plumbing",name:"Plumbing",icon:"",team:"B&G"},{id:"electrical",name:"Electrical",icon:"",team:"B&G"},{id:"hvac",name:"HVAC / Temp",icon:"",team:"B&G"},{id:"damage",name:"Building Damage",icon:"",team:"B&G"},{id:"safety",name:"Safety Hazard",icon:"",team:"Facilities Manager"},{id:"pest",name:"Pest Issue",icon:"",team:"Vendor"},{id:"other",name:"Other",icon:"",team:"Facilities Manager"}],T2={yes:"Yes",no:"No",save:"Save",cancel:"Cancel",back:"Back",next:"Next",submit:"Submit",loading:"Loading...",error:"Error",success:"Success",required:"Required",optional:"Optional",select:"Select",language:"Language",english:"English",spanish:"Spanish"},A2={home:"Home",audit:"Daily Cleanliness Check",report:"See It, Report It",bgWalkthrough:"Weekly Building and Grounds Check",history:"History",settings:"Settings"},z2={title:"Daily QC Walkthrough",setup:{title:"Audit Setup",campus:"Campus",campusPlaceholder:"Select a campus",yourName:"Your Name",namePlaceholder:"Enter your name",email:"Email for Report",emailPlaceholder:"Enter your email",restroomCount:"Number of Restrooms",optionalZones:"Optional Zones",selectOptionalZones:"Select additional zones to inspect",beginWalkthrough:"Begin Walkthrough"},walkthrough:{zone:"Zone",of:"of",question:"Question",takePhoto:"Take Photo",addNote:"Add Note",notePlaceholder:"Enter notes about this zone...",photoAdded:"Photo added",photosAdded:"photos added",nextZone:"Next Zone",previousZone:"Previous Zone",finishAudit:"Finish Audit"},summary:{title:"Audit Summary",overallStatus:"Overall Status",zonesInspected:"Zones Inspected",defectsFound:"Defects Found",photosAttached:"Photos Attached",submitAudit:"Submit Audit",tourReady:"Is this facility tour-ready?",tourReadyYes:"Yes, tour-ready",tourReadyNo:"No, needs attention",zones:"Zones",defects:"Defects",duration:"Duration",submitting:"Submitting...",bgIssuesFlagged:"B&G Issue(s) Flagged",sentToBGTeam:"Will be sent to B&G team"},tourReady:{title:"Final Question",question:"Could a parent tour happen right now?",yesTourReady:"Yes - Tour Ready",noNotTourReady:"No - Not Tour Ready",automaticRed:"Automatic RED",reviewSummary:"Review Summary"},complete:{submitted:"Submitted!",done:"Done"},status:{green:"GREEN - All Clear",amber:"AMBER - Minor Issues",red:"RED - Needs Attention",GREEN:"GREEN",AMBER:"AMBER",RED:"RED"},validation:{selectCampus:"Please select a campus",enterName:"Please enter your name",enterEmail:"Please enter your email",completeAllQuestions:"Please answer all questions before proceeding"},bg:{title:"Any building issues to flag for B&G?",addAnotherPhoto:"Add Another Photo",takePhotoOfIssue:"Take Photo of Issue",requiredForAlerts:"Required for B&G alerts",describeIssue:"Describe the issue (required)...",answerAll:"Answer all",selectBGStatus:"Select B&G status",addBGPhoto:"Add B&G photo",describeBGIssue:"Describe B&G issue",completeZone:"Complete Zone",anyDefectRed:"Any defect = RED status"}},D2={title:"See It, Report It",subtitle:"Report a facility issue",snapPhoto:"Snap a Photo",snapPhotoDesc:"Take a photo of the issue and we'll route it to the right team.",setup:{campus:"Campus",campusPlaceholder:"Select a campus",takePhoto:"Take Photo",photoRequired:"Photo helps identify the issue",category:"Issue Category",categoryPlaceholder:"Select a category",location:"Location",locationPlaceholder:"Where is the issue? (e.g., Room 101, Main Hallway)",description:"Description",descriptionPlaceholder:"Describe the issue...",urgent:"Urgent / Safety Issue",urgentDescription:"Mark if this requires immediate attention",submitReport:"Submit Report"},categories:{cleaning:"Cleaning Needed",maintenance:"Maintenance / Repair",safety:"Safety Hazard",supplies:"Supplies Needed",pest:"Pest Issue",odor:"Odor Problem",lighting:"Lighting Issue",hvac:"HVAC / Temperature",plumbing:"Plumbing Issue",electrical:"Electrical Issue",exterior:"Exterior / Grounds",other:"Other"},validation:{selectCampus:"Please select a campus",selectCategory:"Please select a category",enterLocation:"Please enter the location"},success:{title:"Report Submitted",message:"Your report has been submitted successfully.",reference:"Reference #"}},O2={names:{entry:"Entry & Lobby",hallway:"Hallway / Corridor",commons:"Commons Area",supply_closet:"Supply Closet",classroom:"Classroom",office:"Office / Workroom",gym:"Gym / Multi-Purpose",cafeteria:"Cafeteria",restroom:"Restroom"},descriptions:{entry:"Parent-facing zone",supply_closet:"1-week minimum threshold",restroom:"Any defect = RED"}},I2={restroom:["Toilets and urinals are clean (no soil, stains, or residue)?","Sinks and counters are dry and clean (no water spots or residue)?","Mirrors are clean (no smudges or streaks)?","Floor is clean (no debris, water, or stains)?","Soap dispensers are working and stocked (enough for one full day)?","Paper towels or hand dryers are working and stocked (enough for one full day)?","Toilet paper is fully stocked (fresh rolls in place)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no urine, mold, sewage, or garbage smell)?","Area is safe (no wet floors, broken fixtures, or hazards)?"],entry:["Floor is clean (no debris, spills, or stains)?","Entry mat is clean and flat (no curled edges or trip hazards)?","Exterior door glass is clean (no smudges or fingerprints)?","Interior glass is clean (no smudges or streaks)?","Reception surfaces are dust-free (counters, desks, shelves)?","High-touch surfaces are clean (door handles, counter edges)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no mold, garbage, or musty smell)?","Area is safe (no wet floors, loose items, or hazards)?"],hallway:["Floor is clean (no debris, spills, or stains)?","Edges, corners, and baseboards are dust-free (no buildup)?","Walls are free of scuff marks (no black marks or scrapes)?","Glass and doors are clean (no smudges or fingerprints)?","High-touch surfaces are clean (door handles, railings, light switches)?","Trash cans are empty with liners in place (no overflow)?","Area is safe (no wet floors, obstacles, or hazards)?"],commons:["Floor is clean (no debris, spills, or stains)?","Tables and surfaces are clean and dry (no sticky spots or residue)?","Furniture is properly arranged (chairs pushed in, not scattered)?","High-touch surfaces are clean (door handles, table edges, chair backs)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no food, mold, or garbage smell)?","Area is safe (no wet floors, broken furniture, or hazards)?"],supply_closet:["Toilet paper supply is sufficient (enough for one week)?","Paper towel supply is sufficient (enough for one week)?","Soap and sanitizer supply is sufficient (enough for one week)?","Trash liner supply is sufficient (enough for one week)?","Cleaning supplies are present and stocked (chemicals, mops, rags)?","Closet is organized (items on shelves, nothing blocking walkway)?"],classroom:["Floor is clean (no debris, spills, or stains)?","Edges, corners, and baseboards are dust-free (no buildup)?","Student desks and tables are clean (no writing, stickers, or residue)?","Teacher desk and surfaces are clean (no dust or clutter)?","Whiteboard area is clean (tray wiped, ledge dust-free)?","High-touch surfaces are clean (door handle, light switches)?","Trash cans are empty with liners in place (no overflow)?","Area is safe (no tripping hazards, loose wires, or broken items)?"],office:["Floor is clean (no debris, spills, or stains)?","Desk and work surfaces are dust-free (no buildup or clutter)?","High-touch surfaces are clean (door handles, light switches, shared equipment)?","Trash cans are empty with liners in place (no overflow)?","Area is safe (no tripping hazards, loose wires, or blocked exits)?"],gym:["Floor is clean (no debris, spills, or stains)?","Floor finish is intact (no excessive scuffing, peeling, or damage)?","Bleachers and seating are clean (no dust, debris, or sticky spots)?","Equipment storage area is organized (items put away, nothing on floor)?","High-touch surfaces are clean (door handles, equipment, railings)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no sweat, mold, or musty smell)?","Area is safe (no loose equipment, wet floors, or hazards)?"],cafeteria:["Floor is clean (no debris, spills, or stains)?","Tables and seating are clean and dry (no sticky spots or food residue)?","Service and counter area is clean (no crumbs, spills, or buildup)?","High-touch surfaces are clean (door handles, tray rails, chair backs)?","Trash cans are empty with liners in place (no overflow)?","Free of bad odors (no spoiled food, garbage, or drain smell)?","Area is safe (no wet floors, broken chairs, or hazards)?"]},B2={title:"History",audits:"Audits",reports:"Reports",noAudits:"No audits yet",noReports:"No reports yet",viewDetails:"View Details",date:"Date",campus:"Campus",auditor:"Auditor",status:"Status"},N2={title:"Settings",language:"Language",apiKey:"OpenAI API Key",apiKeyDescription:"Used for AI photo analysis (optional)",apiKeyPlaceholder:"Enter your API key",saveSettings:"Save Settings",saved:"Settings saved"},M2={common:T2,nav:A2,audit:z2,report:D2,zones:O2,checklist:I2,history:B2,settings:N2},q2={yes:"S",no:"No",save:"Guardar",cancel:"Cancelar",back:"Atrs",next:"Siguiente",submit:"Enviar",loading:"Cargando...",error:"Error",success:"xito",required:"Requerido",optional:"Opcional",select:"Seleccionar",language:"Idioma",english:"Ingls",spanish:"Espaol"},W2={home:"Inicio",audit:"Inspeccin Diaria de Limpieza",report:"Ver y Reportar",bgWalkthrough:"Inspeccin Semanal de Edificio y Terrenos",history:"Historial",settings:"Configuracin"},U2={title:"Inspeccin Diaria QC",setup:{title:"Configuracin de Inspeccin",campus:"Campus",campusPlaceholder:"Seleccione un campus",yourName:"Su Nombre",namePlaceholder:"Ingrese su nombre",email:"Correo para el Reporte",emailPlaceholder:"Ingrese su correo electrnico",restroomCount:"Nmero de Baos",optionalZones:"Zonas Opcionales",selectOptionalZones:"Seleccione zonas adicionales para inspeccionar",beginWalkthrough:"Comenzar Inspeccin"},walkthrough:{zone:"Zona",of:"de",question:"Pregunta",takePhoto:"Tomar Foto",addNote:"Agregar Nota",notePlaceholder:"Ingrese notas sobre esta zona...",photoAdded:"Foto agregada",photosAdded:"fotos agregadas",nextZone:"Siguiente Zona",previousZone:"Zona Anterior",finishAudit:"Finalizar Inspeccin"},summary:{title:"Resumen de Inspeccin",overallStatus:"Estado General",zonesInspected:"Zonas Inspeccionadas",defectsFound:"Defectos Encontrados",photosAttached:"Fotos Adjuntas",submitAudit:"Enviar Inspeccin",tourReady:"Est esta instalacin lista para visitas?",tourReadyYes:"S, lista para visitas",tourReadyNo:"No, necesita atencin",zones:"Zonas",defects:"Defectos",duration:"Duracin",submitting:"Enviando...",bgIssuesFlagged:"Problema(s) de Mantenimiento Reportado(s)",sentToBGTeam:"Se enviar al equipo de Mantenimiento"},tourReady:{title:"Pregunta Final",question:"Podra ocurrir un recorrido de padres ahora mismo?",yesTourReady:"S - Listo para Recorrido",noNotTourReady:"No - No Listo para Recorrido",automaticRed:"ROJO Automtico",reviewSummary:"Ver Resumen"},complete:{submitted:"Enviado!",done:"Listo"},status:{green:"VERDE - Todo en Orden",amber:"AMARILLO - Problemas Menores",red:"ROJO - Necesita Atencin",GREEN:"VERDE",AMBER:"AMARILLO",RED:"ROJO"},validation:{selectCampus:"Por favor seleccione un campus",enterName:"Por favor ingrese su nombre",enterEmail:"Por favor ingrese su correo electrnico",completeAllQuestions:"Por favor responda todas las preguntas antes de continuar"},bg:{title:"Hay problemas del edificio para reportar a Mantenimiento?",addAnotherPhoto:"Agregar Otra Foto",takePhotoOfIssue:"Tomar Foto del Problema",requiredForAlerts:"Requerido para alertas de Mantenimiento",describeIssue:"Describa el problema (requerido)...",answerAll:"Responda todas",selectBGStatus:"Seleccione estado de Mantenimiento",addBGPhoto:"Agregar foto de Mantenimiento",describeBGIssue:"Describa el problema de Mantenimiento",completeZone:"Completar Zona",anyDefectRed:"Cualquier defecto = estado ROJO"}},L2={title:"Ver y Reportar",subtitle:"Reportar un problema de instalacin",snapPhoto:"Tomar una Foto",snapPhotoDesc:"Tome una foto del problema y lo enviaremos al equipo correcto.",setup:{campus:"Campus",campusPlaceholder:"Seleccione un campus",takePhoto:"Tomar Foto",photoRequired:"La foto ayuda a identificar el problema",category:"Categora del Problema",categoryPlaceholder:"Seleccione una categora",location:"Ubicacin",locationPlaceholder:"Dnde est el problema? (ej., Saln 101, Pasillo Principal)",description:"Descripcin",descriptionPlaceholder:"Describa el problema...",urgent:"Urgente / Problema de Seguridad",urgentDescription:"Marque si esto requiere atencin inmediata",submitReport:"Enviar Reporte"},categories:{cleaning:"Limpieza Necesaria",maintenance:"Mantenimiento / Reparacin",safety:"Peligro de Seguridad",supplies:"Suministros Necesarios",pest:"Problema de Plagas",odor:"Problema de Olor",lighting:"Problema de Iluminacin",hvac:"HVAC / Temperatura",plumbing:"Problema de Plomera",electrical:"Problema Elctrico",exterior:"Exterior / Terrenos",other:"Otro"},validation:{selectCampus:"Por favor seleccione un campus",selectCategory:"Por favor seleccione una categora",enterLocation:"Por favor ingrese la ubicacin"},success:{title:"Reporte Enviado",message:"Su reporte ha sido enviado exitosamente.",reference:"Referencia #"}},$2={names:{entry:"Entrada y Vestbulo",hallway:"Pasillo / Corredor",commons:"rea Comn",supply_closet:"Armario de Suministros",classroom:"Saln de Clases",office:"Oficina / Sala de Trabajo",gym:"Gimnasio / Multiusos",cafeteria:"Cafetera",restroom:"Bao"},descriptions:{entry:"Zona visible para padres",supply_closet:"Mnimo de 1 semana de suministros",restroom:"Cualquier defecto = ROJO"}},H2={restroom:["Los inodoros y urinarios estn limpios (sin suciedad, manchas o residuos)?","Los lavabos y mostradores estn secos y limpios (sin manchas de agua o residuos)?","Los espejos estn limpios (sin manchas o rayas)?","El piso est limpio (sin escombros, agua o manchas)?","Los dispensadores de jabn funcionan y estn abastecidos (suficiente para un da completo)?","Las toallas de papel o secadores de manos funcionan y estn abastecidos (suficiente para un da completo)?","El papel higinico est completamente abastecido (rollos nuevos en su lugar)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","Libre de malos olores (sin olor a orina, moho, aguas residuales o basura)?","El rea es segura (sin pisos mojados, accesorios rotos o peligros)?"],entry:["El piso est limpio (sin escombros, derrames o manchas)?","El tapete de entrada est limpio y plano (sin bordes doblados o peligros de tropiezo)?","El vidrio de la puerta exterior est limpio (sin manchas o huellas)?","El vidrio interior est limpio (sin manchas o rayas)?","Las superficies de recepcin estn libres de polvo (mostradores, escritorios, estantes)?","Las superficies de alto contacto estn limpias (manijas de puertas, bordes de mostradores)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","Libre de malos olores (sin olor a moho, basura o humedad)?","El rea es segura (sin pisos mojados, objetos sueltos o peligros)?"],hallway:["El piso est limpio (sin escombros, derrames o manchas)?","Los bordes, esquinas y rodapi estn libres de polvo (sin acumulacin)?","Las paredes estn libres de marcas de rozaduras (sin marcas negras o rasguos)?","Los vidrios y puertas estn limpios (sin manchas o huellas)?","Las superficies de alto contacto estn limpias (manijas de puertas, pasamanos, interruptores de luz)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","El rea es segura (sin pisos mojados, obstculos o peligros)?"],commons:["El piso est limpio (sin escombros, derrames o manchas)?","Las mesas y superficies estn limpias y secas (sin reas pegajosas o residuos)?","Los muebles estn correctamente ordenados (sillas acomodadas, no dispersas)?","Las superficies de alto contacto estn limpias (manijas de puertas, bordes de mesas, respaldos de sillas)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","Libre de malos olores (sin olor a comida, moho o basura)?","El rea es segura (sin pisos mojados, muebles rotos o peligros)?"],supply_closet:["El suministro de papel higinico es suficiente (suficiente para una semana)?","El suministro de toallas de papel es suficiente (suficiente para una semana)?","El suministro de jabn y desinfectante es suficiente (suficiente para una semana)?","El suministro de bolsas de basura es suficiente (suficiente para una semana)?","Los suministros de limpieza estn presentes y abastecidos (qumicos, trapeadores, trapos)?","El armario est organizado (artculos en estantes, nada bloqueando el paso)?"],classroom:["El piso est limpio (sin escombros, derrames o manchas)?","Los bordes, esquinas y rodapi estn libres de polvo (sin acumulacin)?","Los escritorios y mesas de estudiantes estn limpios (sin escritura, calcomanas o residuos)?","El escritorio y superficies del maestro estn limpios (sin polvo o desorden)?","El rea del pizarrn est limpia (bandeja limpia, repisa sin polvo)?","Las superficies de alto contacto estn limpias (manija de puerta, interruptores de luz)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","El rea es segura (sin peligros de tropiezo, cables sueltos o artculos rotos)?"],office:["El piso est limpio (sin escombros, derrames o manchas)?","Las superficies de escritorios y trabajo estn libres de polvo (sin acumulacin o desorden)?","Las superficies de alto contacto estn limpias (manijas de puertas, interruptores de luz, equipo compartido)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","El rea es segura (sin peligros de tropiezo, cables sueltos o salidas bloqueadas)?"],gym:["El piso est limpio (sin escombros, derrames o manchas)?","El acabado del piso est intacto (sin raspaduras excesivas, descascaramiento o dao)?","Las gradas y asientos estn limpios (sin polvo, escombros o reas pegajosas)?","El rea de almacenamiento de equipo est organizada (artculos guardados, nada en el piso)?","Las superficies de alto contacto estn limpias (manijas de puertas, equipo, pasamanos)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","Libre de malos olores (sin olor a sudor, moho o humedad)?","El rea es segura (sin equipo suelto, pisos mojados o peligros)?"],cafeteria:["El piso est limpio (sin escombros, derrames o manchas)?","Las mesas y asientos estn limpios y secos (sin reas pegajosas o residuos de comida)?","El rea de servicio y mostrador est limpia (sin migajas, derrames o acumulacin)?","Las superficies de alto contacto estn limpias (manijas de puertas, rieles de bandejas, respaldos de sillas)?","Los botes de basura estn vacos con bolsas en su lugar (sin desbordamiento)?","Libre de malos olores (sin olor a comida echada a perder, basura o drenaje)?","El rea es segura (sin pisos mojados, sillas rotas o peligros)?"]},P2={title:"Historial",audits:"Inspecciones",reports:"Reportes",noAudits:"Sin inspecciones todava",noReports:"Sin reportes todava",viewDetails:"Ver Detalles",date:"Fecha",campus:"Campus",auditor:"Inspector",status:"Estado"},G2={title:"Configuracin",language:"Idioma",apiKey:"Clave API de OpenAI",apiKeyDescription:"Usada para anlisis de fotos con IA (opcional)",apiKeyPlaceholder:"Ingrese su clave API",saveSettings:"Guardar Configuracin",saved:"Configuracin guardada"},V2={common:q2,nav:W2,audit:U2,report:L2,zones:$2,checklist:H2,history:P2,settings:G2},Ja={en:M2,es:V2},Vx=v.createContext(),Wm=(n,i)=>i.split(".").reduce((r,a)=>r&&r[a],n);function Z2({children:n}){const[i,r]=v.useState(()=>typeof window<"u"&&localStorage.getItem("app-language")||"en");v.useEffect(()=>{localStorage.setItem("app-language",i)},[i]);const a=(g,m=g)=>{const x=Wm(Ja[i],g);if(x===void 0){console.warn(`Translation missing for key: ${g} in language: ${i}`);const k=Wm(Ja.en,g);return k!==void 0?k:m}return x},p={language:i,setLanguage:r,t:a,getChecklist:g=>{const m=Ja[i]?.checklist?.[g];return m||(console.warn(`Checklist missing for zone: ${g} in language: ${i}`),Ja.en?.checklist?.[g]||[])},getZoneName:g=>a(`zones.names.${g}`,g),getZoneDescription:g=>a(`zones.descriptions.${g}`,""),languages:[{code:"en",name:"English",nativeName:"English"},{code:"es",name:"Spanish",nativeName:"Espaol"}]};return s.jsx(Vx.Provider,{value:p,children:n})}function Jn(){const n=v.useContext(Vx);if(!n)throw new Error("useI18n must be used within an I18nProvider");return n}const F2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Y2=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(i,r,a)=>a?a.toUpperCase():r.toLowerCase()),Um=n=>{const i=Y2(n);return i.charAt(0).toUpperCase()+i.slice(1)},Zx=(...n)=>n.filter((i,r,a)=>!!i&&i.trim()!==""&&a.indexOf(i)===r).join(" ").trim(),K2=n=>{for(const i in n)if(i.startsWith("aria-")||i==="role"||i==="title")return!0};var Q2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const J2=v.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:c="",children:d,iconNode:h,...p},g)=>v.createElement("svg",{ref:g,...Q2,width:i,height:i,stroke:n,strokeWidth:a?Number(r)*24/Number(i):r,className:Zx("lucide",c),...!d&&!K2(p)&&{"aria-hidden":"true"},...p},[...h.map(([m,x])=>v.createElement(m,x)),...Array.isArray(d)?d:[d]]));const De=(n,i)=>{const r=v.forwardRef(({className:a,...c},d)=>v.createElement(J2,{ref:d,iconNode:i,className:Zx(`lucide-${F2(Um(n))}`,`lucide-${n}`,a),...c}));return r.displayName=Um(n),r};const X2=[["path",{d:"M19 9V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v3",key:"irtipd"}],["path",{d:"M3 16a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V11a2 2 0 0 0-4 0z",key:"1qyhux"}],["path",{d:"M5 18v2",key:"ppbyun"}],["path",{d:"M19 18v2",key:"gy7782"}]],ew=De("armchair",X2);const tw=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ko=De("arrow-left",tw);const nw=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],iw=De("arrow-right",nw);const sw=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],rw=De("book-open",sw);const ow=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Fx=De("building-2",ow);const aw=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Vu=De("camera",aw);const lw=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Yx=De("chart-column",lw);const cw=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],dw=De("chevron-left",cw);const uw=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ll=De("chevron-right",uw);const hw=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Lm=De("circle-alert",hw);const fw=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],as=De("circle-check-big",fw);const pw=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],gw=De("circle-x",pw);const mw=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],xw=De("clipboard-list",mw);const yw=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Zu=De("clock",yw);const bw=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],vw=De("cog",bw);const Sw=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],kw=De("external-link",Sw);const ww=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],_w=De("file-text",ww);const jw=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Cw=De("funnel",jw);const Rw=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Cu=De("globe",Rw);const Ew=[["path",{d:"M12 7v4",key:"xawao1"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M14 9h-4",key:"1w2s2s"}],["path",{d:"M18 11h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-9a2 2 0 0 1 2-2h2",key:"1tthqt"}],["path",{d:"M18 21V5a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16",key:"dw4p4i"}]],Tw=De("hospital",Ew);const Aw=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],zw=De("house",Aw);const Dw=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],Ow=De("inbox",Dw);const Iw=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],$m=De("loader",Iw);const Bw=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Nw=De("lock",Bw);const Mw=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ru=De("map-pin",Mw);const qw=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ls=De("refresh-cw",qw);const Ww=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Uw=De("rotate-ccw",Ww);const Lw=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],$w=De("send",Lw);const Hw=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Pw=De("shield",Hw);const Gw=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Vw=De("square-check-big",Gw);const Zw=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wo=De("triangle-alert",Zw);const Fw=[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]],Yw=De("utensils-crossed",Fw);const Kw=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Hm=De("x",Kw);const Qw=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],cl=De("zap",Qw);function Kx({style:n="dropdown"}){const{language:i,setLanguage:r,languages:a,t:c}=Jn();return n==="buttons"?s.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[s.jsx(Cu,{size:18,style:{color:"#666"}}),a.map(d=>s.jsx("button",{onClick:()=>r(d.code),style:{padding:"6px 12px",borderRadius:"6px",border:i===d.code?"2px solid #2B57D0":"1px solid #ddd",backgroundColor:i===d.code?"#EEF2FF":"#fff",color:i===d.code?"#2B57D0":"#333",fontWeight:i===d.code?"600":"400",fontSize:"14px",cursor:"pointer",transition:"all 0.2s ease"},children:d.nativeName},d.code))]}):s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Cu,{size:18,style:{color:"#666"}}),s.jsx("select",{value:i,onChange:d=>r(d.target.value),style:{padding:"8px 12px",borderRadius:"8px",border:"1px solid #ddd",backgroundColor:"#fff",fontSize:"15px",color:"#333",cursor:"pointer",minWidth:"120px"},children:a.map(d=>s.jsx("option",{value:d.code,children:d.nativeName},d.code))})]})}const Jw=()=>{const n=xe(),{t:i}=Jn(),[r,a]=v.useState([]),[c,d]=v.useState([]),[h,p]=v.useState([]),[g,m]=v.useState(!0),[x,k]=v.useState(!1);v.useEffect(()=>{const w=()=>{const j=window.innerWidth>window.innerHeight&&window.innerHeight<500;k(j)};return w(),window.addEventListener("resize",w),window.addEventListener("orientationchange",w),()=>{window.removeEventListener("resize",w),window.removeEventListener("orientationchange",w)}},[]),v.useEffect(()=>{(async()=>{try{const[j,A,z]=await Promise.all([$x(10),Hx(10),Hu(null,10)]);a(j),d(A),p(z)}catch(j){console.error("Error loading data:",j)}finally{m(!1)}})()},[]);const S=c.filter(w=>w.status==="open").length,_=()=>{const w=[...r.map(j=>({...j,type:"audit",sortDate:new Date(j.createdAt||j.date+" "+j.time)})),...h.map(j=>({...j,type:"bg",sortDate:new Date(j.createdAt||j.date+" "+j.time)})),...c.map(j=>({...j,type:"report",sortDate:new Date(j.createdAt||j.timestamp)}))].sort((j,A)=>A.sortDate-j.sortDate).slice(0,5);return w.length===0?s.jsxs("div",{style:{textAlign:"center",padding:"32px 0",color:"#666"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:""}),s.jsx("p",{style:{fontSize:"17px"},children:i("history.noAudits")})]}):s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:w.map((j,A)=>{if(j.type==="audit")return s.jsxs("div",{onClick:()=>j.id&&n(`/audit/${j.id}`),style:{display:"flex",alignItems:"center",padding:"14px",backgroundColor:"#f5f5f5",borderRadius:"12px",cursor:j.id?"pointer":"default"},children:[s.jsx("span",{style:{fontSize:"24px",marginRight:"14px"},children:j.status==="GREEN"?"":j.status==="AMBER"?"":""}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"17px",color:"#092849"},children:j.campus}),s.jsxs("div",{style:{fontSize:"15px",color:"#666",marginTop:"2px"},children:[j.date,"  ",j.defects," defect",j.defects!==1?"s":""]})]}),s.jsx("span",{style:{color:"#9ca3af",fontSize:"20px"},children:""})]},`audit-${j.id||A}`);if(j.type==="bg")return s.jsxs("div",{onClick:()=>j.id&&n(`/bg/${j.id}`),style:{display:"flex",alignItems:"center",padding:"14px",backgroundColor:"#f5f5f5",borderRadius:"12px",cursor:j.id?"pointer":"default"},children:[s.jsx("span",{style:{fontSize:"24px",marginRight:"14px"},children:""}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"17px",color:"#092849"},children:j.campus}),s.jsxs("div",{style:{fontSize:"15px",color:"#666",marginTop:"2px"},children:[j.date,"  B&G  ",j.campusRating||"N/A"]})]}),s.jsx("span",{style:{fontSize:"14px",padding:"6px 12px",borderRadius:"8px",backgroundColor:j.campusRating==="PASS"?"#10b981":"#ef4444",color:"#fff",fontWeight:"500"},children:j.campusRating||"N/A"}),s.jsx("span",{style:{color:"#9ca3af",fontSize:"20px",marginLeft:"8px"},children:""})]},`bg-${j.id||A}`);{const z=Gu.find(D=>D.id===j.category)||{icon:"",name:"See It, Report It"};return s.jsxs("div",{onClick:()=>j.id&&n(`/report/${j.id}`),style:{display:"flex",alignItems:"center",padding:"14px",backgroundColor:"#f5f5f5",borderRadius:"12px",cursor:j.id?"pointer":"default"},children:[s.jsx("span",{style:{fontSize:"24px",marginRight:"14px"},children:z.icon}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"17px",color:"#092849"},children:z.name}),s.jsx("div",{style:{fontSize:"15px",color:"#666",marginTop:"2px"},children:j.campus})]}),s.jsx("span",{style:{fontSize:"14px",padding:"6px 12px",borderRadius:"8px",backgroundColor:j.status==="open"?"#47C4E6":"#C2ECFD",color:j.status==="open"?"#fff":"#092849",fontWeight:"500"},children:j.status}),s.jsx("span",{style:{color:"#9ca3af",fontSize:"20px",marginLeft:"8px"},children:""})]},`report-${j.id||A}`)}})})};return s.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(180deg, #092849 0%, #141685 100%)",display:"flex",flexDirection:"column"},children:[s.jsxs("div",{style:{padding:"20px 24px 0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("div",{style:{backgroundColor:"rgba(255,255,255,0.95)",borderRadius:"10px",padding:"4px 8px"},children:s.jsx(Kx,{style:"dropdown"})}),s.jsx("button",{onClick:()=>n("/settings"),style:{backgroundColor:"rgba(255,255,255,0.15)",border:"none",borderRadius:"50%",width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"22px"},children:""})]}),s.jsx("div",{style:{padding:x?"8px 24px":"16px 24px 20px",textAlign:"center"},children:s.jsx("img",{src:"/Alpha School Logo - Blue.png",alt:"Alpha School",style:{maxWidth:x?"100px":"140px",width:"auto",filter:"brightness(0) invert(1)"},onError:w=>{w.target.style.display="none"}})}),s.jsxs("div",{style:{padding:"0 20px 20px"},children:[s.jsxs("button",{onClick:()=>n("/green-streak"),style:{width:"100%",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:"16px",padding:"20px",border:"none",cursor:"pointer",marginBottom:"12px",display:"flex",alignItems:"center",gap:"16px",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.4)"},children:[s.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"14px",backgroundColor:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(cl,{size:32,color:"#fff"})}),s.jsxs("div",{style:{flex:1,textAlign:"left"},children:[s.jsx("div",{style:{fontSize:"20px",fontWeight:"700",color:"#fff"},children:"Green Streak Walk"}),s.jsx("div",{style:{fontSize:"14px",color:"rgba(255,255,255,0.85)",marginTop:"2px"},children:"Daily CC oversight check - 15 min"})]}),s.jsx(ll,{size:24,color:"rgba(255,255,255,0.7)"})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[s.jsxs("button",{onClick:()=>n("/ops-audits"),style:{backgroundColor:"#fff",borderRadius:"14px",padding:"16px",border:"none",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"#6366f1",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(xw,{size:26,color:"#fff"})}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#092849"},children:"Ops Audits"}),s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:"Detailed checklists"})]})]}),s.jsxs("button",{onClick:()=>n("/report"),style:{backgroundColor:"#fff",borderRadius:"14px",padding:"16px",border:"none",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",position:"relative"},children:[s.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"#f97316",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(Vu,{size:26,color:"#fff"})}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#092849"},children:"See It Report It"}),s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:"Log an issue"})]}),S>0&&s.jsx("div",{style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"#ef4444",color:"#fff",fontSize:"12px",fontWeight:"600",padding:"2px 8px",borderRadius:"10px"},children:S})]})]}),s.jsxs("button",{onClick:()=>n("/issues"),style:{width:"100%",background:"linear-gradient(135deg, #2B57D0 0%, #141685 100%)",borderRadius:"16px",padding:"16px 20px",border:"none",cursor:"pointer",marginTop:"12px",display:"flex",alignItems:"center",gap:"14px",boxShadow:"0 4px 12px rgba(43, 87, 208, 0.3)"},children:[s.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"12px",backgroundColor:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(Yx,{size:24,color:"#fff"})}),s.jsxs("div",{style:{flex:1,textAlign:"left"},children:[s.jsx("div",{style:{fontSize:"17px",fontWeight:"700",color:"#fff"},children:"Issue Tracker"}),s.jsx("div",{style:{fontSize:"13px",color:"rgba(255,255,255,0.75)",marginTop:"1px"},children:"Status dashboard & issue tracking"})]}),s.jsx(ll,{size:20,color:"rgba(255,255,255,0.6)"})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"12px"},children:[s.jsxs("a",{href:"https://ops-handbook-ai.vercel.app/",target:"_blank",rel:"noopener noreferrer",style:{backgroundColor:"rgba(255,255,255,0.12)",backdropFilter:"blur(10px)",borderRadius:"14px",padding:"16px",border:"1px solid rgba(255,255,255,0.15)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",textDecoration:"none"},children:[s.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"#2B57D0",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(rw,{size:26,color:"#fff"})}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#fff"},children:"Knowledge Hub"}),s.jsx("div",{style:{fontSize:"12px",color:"#C2ECFD",marginTop:"2px"},children:"How do we do X?"})]})]}),s.jsxs("a",{href:"https://www.wrike.com/frontend/requestforms/index.html?token=eyJhY2NvdW50SWQiOjY3NDg0NDYsInRhc2tGb3JtSWQiOjI1Nzk5MTJ9CTQ5MjM5MzE4NDU3NTIJNTNlZmY5OGU2MzA2OWIyYWI5OWQ5NWJjNmIxMzg0OWVkZjNmNGNlZGJkNmViMTc5YzQ0YWEzZWNlNmZiZmRmNg==",target:"_blank",rel:"noopener noreferrer",style:{backgroundColor:"rgba(255,255,255,0.12)",backdropFilter:"blur(10px)",borderRadius:"14px",padding:"16px",border:"1px solid rgba(255,255,255,0.15)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",textDecoration:"none"},children:[s.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"#14b8a6",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx($w,{size:26,color:"#fff"})}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#fff"},children:"Submit Request"}),s.jsx("div",{style:{fontSize:"12px",color:"#C2ECFD",marginTop:"2px"},children:"Campus requests"})]})]})]})]}),s.jsx("div",{style:{padding:"0 24px 20px"},children:s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[s.jsxs("button",{onClick:()=>n("/history"),style:{backgroundColor:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",padding:"16px",borderRadius:"14px",textAlign:"left",border:"none",cursor:"pointer"},children:[s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:"#fff"},children:g?"...":r.length}),s.jsx("div",{style:{fontSize:"15px",color:"#C2ECFD",marginTop:"4px"},children:i("history.audits")})]}),s.jsxs("button",{onClick:()=>n("/reports"),style:{backgroundColor:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",padding:"16px",borderRadius:"14px",textAlign:"left",border:"none",cursor:"pointer"},children:[s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:"#fff"},children:g?"...":c.length}),s.jsx("div",{style:{fontSize:"15px",color:"#C2ECFD",marginTop:"4px"},children:i("history.reports")}),S>0&&s.jsxs("div",{style:{fontSize:"14px",color:"#47C4E6",marginTop:"4px"},children:[S," open"]})]})]})}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"24px 24px 0 0",padding:"24px",flex:1,marginTop:"8px"},children:[s.jsx("h2",{style:{fontWeight:"700",fontSize:"20px",marginBottom:"20px",color:"#092849"},children:i("history.title")}),g?s.jsx("div",{style:{textAlign:"center",padding:"32px 0",color:"#666"},children:i("common.loading")}):_()]})]})},an=[{name:"Alpha School Austin",state:"Texas",city:"Austin",cc:"Shannon Peifer",ccEmail:"shannon.peifer@alpha.school",ccPhone:"(813) 389-0593",owner:"Aaron Crute",ownerEmail:"aaron.crute@trilogy.com",ownerPhone:"(404) 449-5043"},{name:"Alpha High School",state:"Texas",city:"Austin",cc:"Ian Huggins",ccEmail:"ian.huggins@alpha.school",ccPhone:"(971) 222-9736",owner:"Aaron Crute",ownerEmail:"aaron.crute@trilogy.com",ownerPhone:"(404) 449-5043"},{name:"Alpha School Miami",state:"Florida",city:"Miami",cc:"Maria Mejia",ccEmail:"maria.mejia@alpha.school",ccPhone:"(305) 775-3375",owner:"Tara Stephenson",ownerEmail:"tara.stephenson@trilogy.com",ownerPhone:"(704) 974-1413"},{name:"Alpha School Brownsville",state:"Texas",city:"Brownsville",cc:"Kathrine Ledesma",ccEmail:"kathrine.ledesma@alpha.school",ccPhone:"(956) 230-6648",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Texas Sports Academy - Lake Travis",state:"Texas",city:"Austin",cc:"Cyndie Jensen",ccEmail:"cyndie.jensen@sportsacademy.school",ccPhone:"",owner:"Aaron Crute",ownerEmail:"aaron.crute@trilogy.com",ownerPhone:"(404) 449-5043"},{name:"GT School",state:"Texas",city:"Georgetown",cc:"Keith Wong",ccEmail:"keith.wong@2hourlearning.com",ccPhone:"",owner:"Tara Stephenson",ownerEmail:"tara.stephenson@trilogy.com",ownerPhone:"(704) 974-1413"},{name:"Nova Academy Austin",state:"Texas",city:"Austin",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Nova Academy Bastrop",state:"Texas",city:"Bastrop",cc:"Not Yet",ccEmail:"",ccPhone:"",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"NextGen Academy",state:"Texas",city:"Austin",cc:"Christopher Ahrens",ccEmail:"christopher.ahrens@esports.school",ccPhone:"(571) 645-9825",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Waypoint Academy",state:"Texas",city:"Dripping Springs",cc:"Natasha Lince",ccEmail:"natasha.lince@alpha.school",ccPhone:"(956) 292-5092",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Alpha School Scottsdale",state:"Arizona",city:"Scottsdale",cc:"Tetiana Vozniuk",ccEmail:"tetiana.pierson@alpha.school",ccPhone:"(503) 943-9317",owner:"Jake Petersen",ownerEmail:"jake.petersen@trilogy.com",ownerPhone:"(712) 309-1377"},{name:"Alpha School Fort Worth",state:"Texas",city:"Fort Worth",cc:"Michaela Bosco",ccEmail:"michaela.bosco@alpha.school",ccPhone:"(817) 330-9327",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Alpha School San Francisco",state:"California",city:"San Francisco",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Jake Petersen",ownerEmail:"jake.petersen@trilogy.com",ownerPhone:"(712) 309-1377"},{name:"Alpha School Palm Beach",state:"Florida",city:"Palm Beach",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Tara Stephenson",ownerEmail:"tara.stephenson@trilogy.com",ownerPhone:"(704) 974-1413"},{name:"Alpha School Plano",state:"Texas",city:"Plano",cc:"May Dobbs",ccEmail:"may.dobbs@alpha.school",ccPhone:"(972) 246-8783",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Alpha Anywhere Center",state:"New York",city:"New York",cc:"Julianne Braime",ccEmail:"julianne.braime@alpha.school",ccPhone:"(805) 559-0131",owner:"Kevin Kongslie",ownerEmail:"kevin.kongslie@trilogy.com",ownerPhone:"(609) 933-6838"},{name:"Alpha School Santa Barbara",state:"California",city:"Santa Barbara",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Jake Petersen",ownerEmail:"jake.petersen@trilogy.com",ownerPhone:"(712) 309-1377"},{name:"Alpha School Chantilly",state:"Virginia",city:"Chantilly",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Jake Petersen",ownerEmail:"jake.petersen@trilogy.com",ownerPhone:"(712) 309-1377"},{name:"Alpha School Charlotte",state:"North Carolina",city:"Charlotte",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Jake Petersen",ownerEmail:"jake.petersen@trilogy.com",ownerPhone:"(712) 309-1377"},{name:"Alpha School Lake Forest",state:"California",city:"Lake Forest",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Jake Petersen",ownerEmail:"jake.petersen@trilogy.com",ownerPhone:"(712) 309-1377"},{name:"Alpha School Raleigh",state:"North Carolina",city:"Raleigh",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Jake Petersen",ownerEmail:"jake.petersen@trilogy.com",ownerPhone:"(712) 309-1377"},{name:"Alpha School Houston",state:"Texas",city:"Houston",cc:"Not Yet",ccEmail:"",ccPhone:"",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Montessorium Cedar Park",state:"Texas",city:"Cedar Park",cc:"Hiring CC",ccEmail:"",ccPhone:"",owner:"Randall Grant",ownerEmail:"randall.grant@trilogy.com",ownerPhone:"(850) 212-6957"},{name:"Texas Sports Academy - Carrollton",state:"Texas",city:"Carrollton",cc:"Sara Leightman",ccEmail:"sara.leightman@sportsacademy.school",ccPhone:"(214) 392-8218",owner:"Kevin Kongslie",ownerEmail:"kevin.kongslie@trilogy.com",ownerPhone:"(609) 933-6838"},{name:"Cross-Campus",state:"",city:"",cc:"",ccEmail:"",ccPhone:"",owner:"",ownerEmail:"",ownerPhone:""},{name:"TESTING - Copy of Ops P2 Template",state:"",city:"",cc:"",ccEmail:"",ccPhone:"",owner:"",ownerEmail:"",ownerPhone:""}],Xw=()=>{const n={};return an.forEach(i=>{n[i.state]||(n[i.state]=[]),n[i.state].push(i)}),n},Xn=({value:n,onChange:i,id:r="campus"})=>{const a=Xw();return s.jsxs("select",{id:r,value:n||"",onChange:c=>i(c.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",backgroundColor:"#fff",boxSizing:"border-box",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center",backgroundSize:"20px",paddingRight:"44px"},children:[s.jsx("option",{value:"",children:"Select campus..."}),Object.keys(a).sort().map(c=>s.jsx("optgroup",{label:c,children:a[c].map(d=>s.jsxs("option",{value:d.name,children:[d.name,"  ",d.city]},d.name))},c))]})},qe=({title:n,subtitle:i,onBack:r,variant:a="default",rightContent:c})=>{const d={default:"linear-gradient(180deg, #092849 0%, #141685 100%)",red:"#dc2626",orange:"#f97316",green:"#22c55e"};return s.jsx("div",{style:{background:d[a],color:"#fff",padding:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r&&s.jsx("button",{onClick:r,style:{fontSize:"24px",marginRight:"14px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff"},children:""}),s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",margin:0},children:n}),i&&s.jsx("p",{style:{fontSize:"15px",opacity:.8,margin:"4px 0 0 0"},children:i})]})]}),c]})})},e_=({audit:n})=>{const i=xe(),{t:r,getZoneName:a}=Jn(),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(""),[x,k]=v.useState(1),[S,_]=v.useState([]),w=A=>{_(z=>z.includes(A)?z.filter(D=>D!==A):[...z,A])},j=()=>{if(!c||!h||!g){alert(r("audit.validation.selectCampus")+", "+r("audit.validation.enterName").toLowerCase()+", "+r("audit.validation.enterEmail").toLowerCase());return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)){alert(r("audit.validation.enterEmail"));return}const A=an.find(z=>z.name===c);n.beginAudit(A,h,g,S,x),n.setCurrentZoneIndex(0),window.scrollTo(0,0),i("/audit/zone")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:r("audit.setup.title"),subtitle:r("audit.setup.selectOptionalZones"),onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:[r("audit.setup.campus")," *"]}),s.jsx(Xn,{value:c,onChange:d,placeholder:r("audit.setup.campusPlaceholder")})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:[r("audit.setup.yourName")," *"]}),s.jsx("input",{type:"text",placeholder:r("audit.setup.namePlaceholder"),value:h,onChange:A=>p(A.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:[r("audit.setup.email")," *"]}),s.jsx("input",{type:"email",placeholder:r("audit.setup.emailPlaceholder"),value:g,onChange:A=>m(A.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:[r("audit.setup.restroomCount")," *"]}),s.jsx("select",{value:x,onChange:A=>k(parseInt(A.target.value)),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23666'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center",backgroundSize:"20px"},children:[1,2,3,4,5,6,7,8,9,10].map(A=>s.jsxs("option",{value:A,children:[A," ",a("restroom"),A>1?"s":""]},A))})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:["Tour Route Zones (",uo.length,")"]}),s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:uo.map((A,z)=>s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 0",borderBottom:z!==uo.length-1?"1px solid rgba(71, 196, 230, 0.3)":"none"},children:[s.jsx("span",{style:{color:"#2B57D0",marginRight:"12px",fontSize:"20px"},children:""}),s.jsx("span",{style:{fontSize:"17px",flex:1},children:a(A)}),!os[A].amberEligible&&s.jsx("span",{style:{fontSize:"13px",backgroundColor:"#fee2e2",color:"#b91c1c",padding:"4px 10px",borderRadius:"6px",fontWeight:"500"},children:" RED"})]},A))})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:[a("restroom"),"s (",x,")"]}),s.jsx("div",{style:{backgroundColor:"rgba(254, 226, 226, 0.4)",border:"1px solid #f87171",borderRadius:"12px",padding:"16px"},children:Array.from({length:x},(A,z)=>s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 0",borderBottom:z!==x-1?"1px solid rgba(248, 113, 113, 0.3)":"none"},children:[s.jsx("span",{style:{color:"#b91c1c",marginRight:"12px",fontSize:"20px"},children:""}),s.jsxs("span",{style:{fontSize:"17px",flex:1},children:[a("restroom")," ",z+1]}),s.jsxs("span",{style:{fontSize:"13px",backgroundColor:"#fee2e2",color:"#b91c1c",padding:"4px 10px",borderRadius:"6px",fontWeight:"500"},children:[" ",r("audit.status.red").split(" ")[0]]})]},z))})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:r("audit.setup.optionalZones")}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:a2.map(A=>s.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"16px",backgroundColor:"#fff",borderRadius:"12px",border:"1px solid #ddd",cursor:"pointer",minHeight:"56px"},children:[s.jsx("input",{type:"checkbox",checked:S.includes(A),onChange:()=>w(A),style:{width:"24px",height:"24px",marginRight:"14px",accentColor:"#2B57D0"}}),s.jsx("span",{style:{flex:1,fontSize:"17px"},children:a(A)}),!os[A].amberEligible&&s.jsx("span",{style:{fontSize:"13px",backgroundColor:"#fef3c7",color:"#92400e",padding:"4px 10px",borderRadius:"6px",fontWeight:"500"},children:""})]},A))})]}),s.jsx("button",{onClick:j,style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer",marginTop:"8px"},children:r("audit.setup.beginWalkthrough")})]})]})},Pm=({zoneId:n,index:i,defects:r,isComplete:a,onClick:c})=>{const d=os[n],h=()=>a?r===0?"rgba(194, 236, 253, 0.3)":"rgba(194, 236, 253, 0.5)":"#fff",p=()=>a?r===0?"#47C4E6":"#141685":"#e5e7eb";return s.jsxs("button",{onClick:c,style:{width:"100%",backgroundColor:h(),padding:"16px",borderRadius:"12px",border:"1px solid #e5e7eb",display:"flex",alignItems:"center",textAlign:"left",cursor:"pointer"},children:[s.jsx("span",{style:{width:"36px",height:"36px",borderRadius:"50%",backgroundColor:p(),color:a?"#fff":"#666",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"14px",fontWeight:"700",fontSize:"15px"},children:a?r===0?"":r:i+1}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"17px",color:"#092849"},children:d.name}),d.description&&s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"2px"},children:d.description})]}),!d.amberEligible&&s.jsx("span",{style:{fontSize:"13px",backgroundColor:"#C2ECFD",color:"#141685",padding:"4px 10px",borderRadius:"6px"},children:""})]})},t_=({audit:n})=>{const i=xe();v.useEffect(()=>{window.scrollTo(0,0)},[]);const{campus:r,allZones:a,selectedOptionalZones:c,zoneResults:d,countDefects:h,getCompletedZonesCount:p,getNextIncompleteZoneIndex:g,setCurrentZoneIndex:m}=n,x=p(),k=w=>{m(w),i("/audit/zone")},S=()=>{if(x===a.length)i("/audit/tour-ready");else{const w=g();w>=0&&(m(w),i("/audit/zone"))}},_=()=>{window.confirm("Exit? Progress will be lost.")&&(n.resetAudit(),i("/"))};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx(qe,{title:r?.name||"Audit",subtitle:`${r?.city||""}, ${r?.state||""}`,onBack:_}),s.jsxs("div",{style:{backgroundColor:"#fff",padding:"16px 20px",borderBottom:"1px solid #e5e7eb"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"15px",color:"#666",marginBottom:"10px"},children:[s.jsx("span",{children:"Progress"}),s.jsxs("span",{children:[x," of ",a.length," zones"]})]}),s.jsx("div",{style:{height:"8px",backgroundColor:"#e5e7eb",borderRadius:"4px",overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",backgroundColor:"#092849",width:`${x/a.length*100}%`,transition:"width 0.3s ease"}})})]}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsx("h2",{style:{fontWeight:"700",fontSize:"17px",color:"#374151",marginBottom:"14px"},children:"Mandatory Zones"}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"24px"},children:Fd.map((w,j)=>s.jsx(Pm,{zoneId:w,index:j,defects:h(w),isComplete:!!d[w],onClick:()=>k(j)},w))}),c.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("h2",{style:{fontWeight:"700",fontSize:"17px",color:"#374151",marginBottom:"14px"},children:"Optional Zones"}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:c.map((w,j)=>s.jsx(Pm,{zoneId:w,index:Fd.length+j,defects:h(w),isComplete:!!d[w],onClick:()=>k(Fd.length+j)},w))})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:S,style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer"},children:x===a.length?"Final Question ":x===0?"Start First Zone ":"Continue "})})]})},n_=({audit:n,camera:i})=>{const r=xe(),{t:a,getChecklist:c,getZoneName:d}=Jn(),[h,p]=v.useState(""),{currentZoneIndex:g,currentZone:m,currentZoneId:x,allZones:k,zoneResults:S,setResponse:_,isZoneComplete:w,setConditionAlert:j,getConditionAlert:A,setCurrentZoneIndex:z,addConditionAlertPhoto:D,removeConditionAlertPhoto:y}=n,C=S[x]||{},T=Object.keys(C).length,E=m?.type==="final",W=os[x],M=m?.type==="restroom"?"restroom":x,K=c(M),ee=K?.length||m?.cleanliness?.length||0,F=E?C[0]!==void 0&&C.alpha_improvement&&C.alpha_improvement.length>0:w(x),ne=A(x),se=ne?.hasIssue!==void 0,B=ne?.photos||[],$=ne?.hasIssue===!1||ne?.hasIssue===!0&&B.length>0&&ne?.note?.length>0,O=()=>{(E?F:F&&$)&&(g<k.length-1?(z(g+1),window.scrollTo(0,0),r("/audit/zone")):(window.scrollTo(0,0),r("/audit/tour-ready")))},q=I=>{const U=I.target.value;p(U),_(x,"alpha_improvement",U)},Z=I=>{const U=I.target.value.slice(0,100);n.updateConditionAlertNote(x,U)},re=()=>{const I=x;console.log("[AuditZone] Taking condition photo for zone:",I),i.openCamera(U=>{console.log("[AuditZone] Condition photo received, length:",U?.length),U&&D(I,U)})},ae=I=>{y(x,I)};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",color:"#fff",padding:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("button",{onClick:()=>r("/audit/overview"),style:{fontSize:"24px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff"},children:""}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",margin:0},children:m?.type==="restroom"?m?.name:d(x)}),s.jsxs("p",{style:{fontSize:"15px",opacity:.8,margin:"4px 0 0 0"},children:[a("audit.walkthrough.zone")," ",g+1," ",a("audit.walkthrough.of")," ",k.length]})]}),s.jsx("div",{style:{width:"40px"}})]})}),s.jsx("div",{style:{height:"6px",backgroundColor:"#e5e7eb"},children:s.jsx("div",{style:{height:"100%",backgroundColor:"#092849",width:`${(g+1)/k.length*100}%`,transition:"width 0.3s ease"}})}),!m?.amberEligible&&!E&&s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.5)",borderLeft:"4px solid #2B57D0",padding:"14px 16px",margin:"16px 20px",borderRadius:"8px"},children:s.jsxs("div",{style:{fontWeight:"600",color:"#141685",fontSize:"15px"},children:[" ",a("audit.bg.anyDefectRed")]})}),E?s.jsxs("div",{style:{padding:"20px"},children:[s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderTop:"4px solid #092849",marginBottom:"16px"},children:s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:""}),s.jsx("h2",{style:{fontSize:"20px",fontWeight:"700",color:"#092849",margin:"0 0 8px 0"},children:"Alpha Standard"}),s.jsx("p",{style:{fontSize:"15px",color:"#666",margin:0,lineHeight:"1.5"},children:"Take one final look at the entire campus."})]})}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",marginBottom:"16px"},children:[s.jsxs("div",{style:{fontSize:"16px",marginBottom:"14px",color:"#333",lineHeight:"1.4"},children:["Does this property meet the ",s.jsx("strong",{children:"Alpha Standard"}),"?"]}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("button",{onClick:()=>_(x,0,"yes"),style:{flex:1,padding:"14px",borderRadius:"10px",fontWeight:"600",fontSize:"16px",border:"none",cursor:"pointer",backgroundColor:C[0]==="yes"?"#10b981":"#f3f4f6",color:C[0]==="yes"?"#fff":"#333"},children:" Yes"}),s.jsx("button",{onClick:()=>_(x,0,"no"),style:{flex:1,padding:"14px",borderRadius:"10px",fontWeight:"600",fontSize:"16px",border:"none",cursor:"pointer",backgroundColor:C[0]==="no"?"#ef4444":"#f3f4f6",color:C[0]==="no"?"#fff":"#333"},children:" No"})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",borderLeft:"4px solid #092849"},children:[s.jsxs("div",{style:{fontSize:"15px",marginBottom:"12px",color:"#333",lineHeight:"1.5"},children:["Even if everything passes, note ",s.jsx("strong",{children:"one thing"})," you would recommend we upgrade to raise the bar."]}),s.jsx("textarea",{value:C.alpha_improvement||h,onChange:q,placeholder:W?.improvementQuestion?.placeholder||"What one improvement would you recommend?",style:{width:"100%",padding:"14px",borderRadius:"10px",border:"2px solid #e5e7eb",fontSize:"15px",resize:"none",minHeight:"100px",fontFamily:"inherit",boxSizing:"border-box",lineHeight:"1.5"}}),s.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",marginTop:"6px",textAlign:"right"},children:[(C.alpha_improvement||h||"").length>0?" ":"","Your recommendation helps us continuously improve"]})]})]}):s.jsx(s.Fragment,{children:s.jsxs("div",{style:{padding:"20px"},children:[s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"14px"},children:K?.map((I,U)=>s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsxs("div",{style:{fontSize:"16px",marginBottom:"14px",color:"#333",lineHeight:"1.4"},children:[U+1,". ",I]}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsxs("button",{onClick:()=>_(x,U,"yes"),style:{flex:1,padding:"14px",borderRadius:"10px",fontWeight:"600",fontSize:"16px",border:"none",cursor:"pointer",backgroundColor:C[U]==="yes"?"#47C4E6":"#f3f4f6",color:C[U]==="yes"?"#fff":"#333"},children:[" ",a("common.yes")]}),s.jsxs("button",{onClick:()=>_(x,U,"no"),style:{flex:1,padding:"14px",borderRadius:"10px",fontWeight:"600",fontSize:"16px",border:"none",cursor:"pointer",backgroundColor:C[U]==="no"?"#141685":"#f3f4f6",color:C[U]==="no"?"#fff":"#333"},children:[" ",a("common.no")]})]})]},U))}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",marginTop:"20px",borderLeft:"4px solid #2B57D0"},children:[s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#092849",marginBottom:"12px"},children:a("audit.bg.title")}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("button",{onClick:()=>j(x,!1),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"14px",border:"none",cursor:"pointer",backgroundColor:ne?.hasIssue===!1?"#47C4E6":"#f3f4f6",color:ne?.hasIssue===!1?"#fff":"#333"},children:" No"}),s.jsx("button",{onClick:()=>j(x,!0),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"14px",border:"none",cursor:"pointer",backgroundColor:ne?.hasIssue===!0?"#2B57D0":"#f3f4f6",color:ne?.hasIssue===!0?"#fff":"#333"},children:" Yes"})]}),ne?.hasIssue===!0&&s.jsxs("div",{style:{marginTop:"12px"},children:[s.jsxs("div",{style:{marginBottom:"12px"},children:[B.length>0&&s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px",marginBottom:"12px"},children:B.map((I,U)=>s.jsxs("div",{style:{position:"relative"},children:[s.jsx("img",{src:I,alt:`B&G Issue ${U+1}`,style:{width:"100%",height:"120px",borderRadius:"8px",objectFit:"cover"}}),s.jsx("button",{onClick:()=>ae(U),style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"#ef4444",color:"#fff",width:"24px",height:"24px",borderRadius:"50%",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center"},children:""}),s.jsxs("div",{style:{position:"absolute",bottom:"4px",left:"4px",backgroundColor:"rgba(0,0,0,0.6)",color:"#fff",padding:"2px 6px",borderRadius:"4px",fontSize:"11px"},children:["#",U+1]})]},U))}),s.jsxs("button",{onClick:re,style:{width:"100%",padding:B.length>0?"12px":"20px",border:"2px dashed #d1d5db",borderRadius:"8px",backgroundColor:"#f9fafb",cursor:"pointer",display:"flex",flexDirection:B.length>0?"row":"column",alignItems:"center",justifyContent:"center",gap:"8px"},children:[s.jsx("span",{style:{fontSize:B.length>0?"20px":"28px"},children:""}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#374151"},children:B.length>0?a("audit.bg.addAnotherPhoto"):a("audit.bg.takePhotoOfIssue")}),B.length===0&&s.jsx("span",{style:{fontSize:"12px",color:"#6b7280"},children:a("audit.bg.requiredForAlerts")})]})]}),s.jsx("textarea",{value:ne?.note||"",onChange:Z,placeholder:a("audit.bg.describeIssue"),maxLength:100,style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #d1d5db",fontSize:"14px",resize:"none",minHeight:"60px",fontFamily:"inherit",boxSizing:"border-box"}}),s.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",textAlign:"right",marginTop:"4px"},children:[ne?.note?.length||0,"/100"]})]})]})]})}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:E?s.jsx("button",{onClick:O,disabled:!F,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:F?"pointer":"not-allowed",backgroundColor:F?"#092849":"#d1d5db",color:F?"#fff":"#9ca3af"},children:C[0]===void 0?"Answer Alpha Standard Question":C.alpha_improvement&&C.alpha_improvement.length>0?"Complete Audit ":"Enter Your Recommendation"}):s.jsx("button",{onClick:O,disabled:!F||!$,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:F&&$?"pointer":"not-allowed",backgroundColor:F&&$?"#092849":"#d1d5db",color:F&&$?"#fff":"#9ca3af"},children:F?se?ne?.hasIssue&&B.length===0?a("audit.bg.addBGPhoto"):ne?.hasIssue&&!ne?.note?.length?a("audit.bg.describeBGIssue"):`${a("audit.bg.completeZone")} `:a("audit.bg.selectBGStatus"):`${a("audit.bg.answerAll")} (${T}/${ee})`})})]})},i_=({audit:n,camera:i})=>{const r=xe(),{currentZoneIndex:a,currentZone:c,currentZoneId:d,allZones:h,setConditionAlert:p,updateConditionAlertPhoto:g,updateConditionAlertNote:m,canCompleteCondition:x,getConditionAlert:k,setCurrentZoneIndex:S}=n,_=k(d),w=x(d),j=()=>{const z=d;console.log("[AuditCondition] handleTakePhoto called for zone:",z),i.openCamera(D=>{console.log("[AuditCondition] Photo callback received, data length:",D?.length),console.log("[AuditCondition] Updating photo for zone:",z),D?g(z,D):console.error("[AuditCondition] ERROR: No image data received!")})},A=()=>{w&&(a<h.length-1?(S(a+1),r("/audit/zone")):r("/audit/overview"))};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx("div",{style:{backgroundColor:"#2B57D0",color:"#fff",padding:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("button",{onClick:()=>r("/audit/zone"),style:{fontSize:"24px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",marginRight:"14px"},children:""}),s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",margin:0},children:"Building Check"}),s.jsx("p",{style:{fontSize:"15px",color:"#C2ECFD",margin:"4px 0 0 0"},children:c?.name})]})]})}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"16px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"#092849"},children:"Any building issues to flag for B&G?"}),s.jsx("p",{style:{fontSize:"15px",color:"#666",marginBottom:"20px"},children:"Examples: holes in walls, broken fixtures, damaged flooring, water damage"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsxs("button",{onClick:()=>p(d,!1),style:{width:"100%",padding:"16px",borderRadius:"12px",border:_?.hasIssue===!1?"2px solid #47C4E6":"2px solid #e5e7eb",backgroundColor:_?.hasIssue===!1?"rgba(194, 236, 253, 0.3)":"#fff",display:"flex",alignItems:"center",cursor:"pointer"},children:[s.jsx("span",{style:{fontSize:"24px",marginRight:"14px"},children:""}),s.jsx("div",{style:{fontWeight:"600",fontSize:"17px"},children:"No issues"})]}),s.jsxs("button",{onClick:()=>p(d,!0),style:{width:"100%",padding:"16px",borderRadius:"12px",border:_?.hasIssue===!0?"2px solid #2B57D0":"2px solid #e5e7eb",backgroundColor:_?.hasIssue===!0?"rgba(194, 236, 253, 0.3)":"#fff",display:"flex",alignItems:"center",cursor:"pointer",textAlign:"left"},children:[s.jsx("span",{style:{fontSize:"24px",marginRight:"14px"},children:""}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"17px"},children:"Yes  flag for B&G"}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"2px"},children:"Photo + description required"})]})]})]})]}),_?.hasIssue===!0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{marginBottom:"16px"},children:_.photo?s.jsxs("div",{style:{position:"relative"},children:[s.jsx("img",{src:_.photo,alt:"Issue",style:{width:"100%",borderRadius:"12px"}}),s.jsx("button",{onClick:j,style:{position:"absolute",bottom:"12px",right:"12px",backgroundColor:"#fff",padding:"8px 14px",borderRadius:"8px",fontSize:"14px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",border:"none",cursor:"pointer"},children:" Retake"})]}):s.jsxs("button",{onClick:j,style:{width:"100%",border:"2px dashed #ccc",borderRadius:"12px",padding:"32px",textAlign:"center",backgroundColor:"#fafafa",cursor:"pointer"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"8px"},children:""}),s.jsx("div",{style:{fontWeight:"600",fontSize:"17px"},children:"Tap to Take Photo"})]})}),s.jsx("label",{style:{display:"block",fontSize:"15px",fontWeight:"600",color:"#374151",marginBottom:"10px"},children:"Describe the issue *"}),s.jsx("input",{type:"text",maxLength:100,placeholder:"e.g., Hole in drywall near door",style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box"},value:_.note||"",onChange:z=>m(d,z.target.value)}),s.jsxs("div",{style:{fontSize:"13px",color:"#9ca3af",marginTop:"6px",textAlign:"right"},children:[(_.note||"").length,"/100"]})]}),s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.3)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"14px 16px"},children:s.jsx("div",{style:{fontSize:"15px",color:"#141685"},children:"B&G alerts are separate from cleanliness and do NOT affect your score."})})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:A,disabled:!w,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:w?"pointer":"not-allowed",backgroundColor:w?"#092849":"#d1d5db",color:w?"#fff":"#9ca3af"},children:a<h.length-1?"Next Zone ":"Finish Zones "})})]})},s_=({audit:n})=>{const i=xe(),{t:r}=Jn(),{tourReady:a,setTourReady:c}=n;return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx(qe,{title:r("audit.tourReady.title"),onBack:()=>i("/audit/overview")}),s.jsx("div",{style:{padding:"20px"},children:s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{fontSize:"20px",fontWeight:"600",marginBottom:"20px",color:"#092849"},children:r("audit.tourReady.question")}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsxs("button",{onClick:()=>c("yes"),style:{width:"100%",padding:"18px",borderRadius:"12px",border:a==="yes"?"2px solid #47C4E6":"2px solid #e5e7eb",backgroundColor:a==="yes"?"rgba(194, 236, 253, 0.3)":"#fff",display:"flex",alignItems:"center",cursor:"pointer"},children:[s.jsx("span",{style:{fontSize:"28px",marginRight:"16px"},children:""}),s.jsx("div",{style:{fontWeight:"600",fontSize:"18px"},children:r("audit.tourReady.yesTourReady")})]}),s.jsxs("button",{onClick:()=>c("no"),style:{width:"100%",padding:"18px",borderRadius:"12px",border:a==="no"?"2px solid #2B57D0":"2px solid #e5e7eb",backgroundColor:a==="no"?"rgba(194, 236, 253, 0.3)":"#fff",display:"flex",alignItems:"center",cursor:"pointer",textAlign:"left"},children:[s.jsx("span",{style:{fontSize:"28px",marginRight:"16px"},children:""}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"18px"},children:r("audit.tourReady.noNotTourReady")}),s.jsxs("div",{style:{fontSize:"15px",color:"#141685",marginTop:"4px"},children:[" ",r("audit.tourReady.automaticRed")]})]})]})]})]})}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsxs("button",{onClick:()=>i("/audit/summary"),disabled:a===null,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:a!==null?"pointer":"not-allowed",backgroundColor:a!==null?"#092849":"#d1d5db",color:a!==null?"#fff":"#9ca3af"},children:[r("audit.tourReady.reviewSummary")," "]})})]})},r_=({audit:n})=>{const i=xe(),{t:r,getZoneName:a}=Jn(),[c,d]=v.useState(!1),{campus:h,auditor:p,auditorEmail:g,allZones:m,conditionAlerts:x,zoneResults:k,calculateStatus:S,countDefects:_,getTotalDefects:w,getDuration:j,buildAuditData:A,getZoneConfig:z,getZonePhotos:D}=n,y=S(),C=w(),T=j(),E=x.filter(ee=>ee.hasIssue).length,W={GREEN:"#47C4E6",AMBER:"#2B57D0",RED:"#141685"},M={GREEN:"",AMBER:"",RED:""},K=async()=>{d(!0);try{const ee=A();await Qk(ee);const F=h?.name,ne=zi(F),se=[];for(const q of m){const Z=z(q),re=k[q]||{},ae=Z?.type==="restroom"?Z?.name:Z?.name||q,I=Z?.cleanliness||[],U=D?D(q):[];Object.entries(re).forEach(([Q,ie])=>{if(ie==="no"){const fe=I[parseInt(Q)]||`Question ${parseInt(Q)+1}`;se.push({checkText:fe,section:ae,explanation:"",photos:U,instantRed:!Z?.amberEligible})}})}const $=x.filter(q=>q.hasIssue).map(q=>{const Z=z(q.zoneId),re=Z?.type==="restroom"?Z?.name:Z?.name||q.zoneId;return{checkText:"B&G Condition Alert: "+(q.note||"Issue reported"),section:re,explanation:q.note||"",photos:q.photos||[],instantRed:!1}}),O=[...se,...$];if(console.log("[Wrike Debug] Campus:",F,"Enabled:",ne),console.log("[Wrike Debug] Defects:",se.length,"B&G Alerts:",$.length,"Total:",O.length),F&&ne)try{console.log("[AuditSummary] Creating consolidated Wrike task with",O.length,"issues...");const q=O.map(re=>({category:re.instantRed?" Critical":"Issue",section:re.section,check:re.checkText,description:re.explanation||"Issue found",photos:re.photos||[]})),Z=await ds({checklistType:"Ops Audit",campusName:F,auditorName:p,auditorEmail:g,issues:q,date:new Date().toLocaleDateString()});Z&&console.log("[AuditSummary] Wrike task created:",Z.id)}catch(q){console.error("[AuditSummary] Wrike submission failed:",q)}i("/audit/complete")}catch(ee){console.error("Error submitting audit:",ee),alert("Error submitting audit. Please try again.")}finally{d(!1)}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsxs("div",{style:{backgroundColor:W[y],color:"#fff",padding:"28px 20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"56px",marginBottom:"8px"},children:M[y]}),s.jsx("div",{style:{fontSize:"32px",fontWeight:"700"},children:r(`audit.status.${y}`)}),s.jsx("div",{style:{opacity:.9,fontSize:"17px",marginTop:"4px"},children:h?.name||""})]}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"16px"},children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",padding:"16px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#092849"},children:m.length}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"4px"},children:r("audit.summary.zones")})]}),s.jsxs("div",{style:{backgroundColor:"#fff",padding:"16px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:C>0?"#141685":"#47C4E6"},children:C}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"4px"},children:r("audit.summary.defects")})]}),s.jsxs("div",{style:{backgroundColor:"#fff",padding:"16px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",textAlign:"center"},children:[s.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#092849"},children:[T,"m"]}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"4px"},children:r("audit.summary.duration")})]})]}),s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden"},children:m.map((ee,F)=>{const ne=z(ee),se=_(ee);return s.jsxs("div",{style:{padding:"14px 16px",display:"flex",alignItems:"center",borderBottom:F!==m.length-1?"1px solid #e5e7eb":"none"},children:[s.jsx("span",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:se===0?"#C2ECFD":"rgba(194, 236, 253, 0.5)",color:se===0?"#2B57D0":"#141685",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"14px",fontWeight:"700",fontSize:"15px"},children:se===0?"":se}),s.jsx("span",{style:{flex:1,fontSize:"17px",color:"#374151"},children:ne?.type==="restroom"?ne?.name:a(ee)})]},ee)})}),E>0&&s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.3)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:[s.jsxs("div",{style:{fontWeight:"700",color:"#092849",marginBottom:"4px",fontSize:"17px"},children:[" ",E," ",r("audit.summary.bgIssuesFlagged")]}),s.jsx("div",{style:{fontSize:"15px",color:"#141685"},children:r("audit.summary.sentToBGTeam")})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:K,disabled:c,style:{width:"100%",backgroundColor:c?"#9ca3af":"#092849",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:c?"not-allowed":"pointer"},children:c?r("audit.summary.submitting"):` ${r("audit.summary.submitAudit")}`})})]})},o_=({audit:n})=>{const i=xe(),{t:r}=Jn(),{campus:a,calculateStatus:c,resetAudit:d}=n,h=c(),p={GREEN:"#47C4E6",AMBER:"#2B57D0",RED:"#141685"},g=()=>{d(),i("/")};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:p[h],display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"32px",color:"#fff",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"96px",marginBottom:"24px"},children:""}),s.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",marginBottom:"8px"},children:r("audit.complete.submitted")}),s.jsx("div",{style:{fontSize:"56px",fontWeight:"700",margin:"16px 0"},children:r(`audit.status.${h}`)}),s.jsx("p",{style:{opacity:.9,marginBottom:"32px",fontSize:"18px"},children:a?.name||""}),s.jsx("button",{onClick:g,style:{backgroundColor:"#fff",color:"#092849",padding:"16px 40px",borderRadius:"12px",fontWeight:"700",fontSize:"18px",border:"none",cursor:"pointer"},children:r("audit.complete.done")})]})},a_=()=>{const n=xe(),[i,r]=v.useState([]),[a,c]=v.useState([]),[d,h]=v.useState(!0),[p,g]=v.useState("all");v.useEffect(()=>{(async()=>{try{const[_,w]=await Promise.all([$x(50),Hu(null,50)]);r(_),c(w)}catch(_){console.error("Error loading data:",_)}finally{h(!1)}})()},[]);const m={GREEN:"#47C4E6",AMBER:"#2B57D0",RED:"#141685"},k=(()=>{let S=[];return(p==="all"||p==="audits")&&(S=[...S,...i.map(_=>({..._,type:"audit",sortDate:new Date(_.createdAt||_.date+" "+_.time)}))]),(p==="all"||p==="bg")&&(S=[...S,...a.map(_=>({..._,type:"bg",sortDate:new Date(_.createdAt||_.date+" "+_.time)}))]),S.sort((_,w)=>w.sortDate-_.sortDate)})();return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"History",onBack:()=>n("/")}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",backgroundColor:"#fff",padding:"6px",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("button",{onClick:()=>g("all"),style:{flex:1,padding:"12px",borderRadius:"8px",border:"none",fontSize:"15px",fontWeight:"600",cursor:"pointer",backgroundColor:p==="all"?"#092849":"transparent",color:p==="all"?"#fff":"#666"},children:"All"}),s.jsx("button",{onClick:()=>g("audits"),style:{flex:1,padding:"12px",borderRadius:"8px",border:"none",fontSize:"15px",fontWeight:"600",cursor:"pointer",backgroundColor:p==="audits"?"#092849":"transparent",color:p==="audits"?"#fff":"#666"},children:"Cleanliness"}),s.jsx("button",{onClick:()=>g("bg"),style:{flex:1,padding:"12px",borderRadius:"8px",border:"none",fontSize:"15px",fontWeight:"600",cursor:"pointer",backgroundColor:p==="bg"?"#092849":"transparent",color:p==="bg"?"#fff":"#666"},children:"B&G"})]}),d?s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af",fontSize:"17px"},children:"Loading..."}):k.length===0?s.jsxs("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:[s.jsx("div",{style:{fontSize:"56px",marginBottom:"16px"},children:""}),s.jsx("p",{style:{fontSize:"17px"},children:"No records yet"})]}):s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:k.map((S,_)=>S.type==="audit"?s.jsx("div",{onClick:()=>S.id&&n(`/audit/${S.id}`),style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",cursor:S.id?"pointer":"default"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:"28px",marginRight:"14px"},children:S.status==="GREEN"?"":S.status==="AMBER"?"":""}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"700",fontSize:"17px",color:"#092849"},children:S.campus}),s.jsxs("div",{style:{fontSize:"15px",color:"#666",marginTop:"2px"},children:[S.date,"  ",S.auditor]}),s.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",marginTop:"4px",display:"inline-block",backgroundColor:"#f3f4f6",padding:"2px 8px",borderRadius:"4px"},children:"Cleanliness"})]}),s.jsxs("div",{style:{textAlign:"right",marginRight:"8px"},children:[s.jsx("div",{style:{fontWeight:"700",fontSize:"17px",color:m[S.status]||"#092849"},children:S.status}),s.jsxs("div",{style:{fontSize:"15px",color:"#666",marginTop:"2px"},children:[S.defects," defect",S.defects!==1?"s":""]})]}),s.jsx("span",{style:{color:"#9ca3af",fontSize:"24px"},children:""})]})},`audit-${S.id||_}`):s.jsx("div",{onClick:()=>S.id&&n(`/bg/${S.id}`),style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",cursor:S.id?"pointer":"default"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:"28px",marginRight:"14px"},children:""}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"700",fontSize:"17px",color:"#092849"},children:S.campus}),s.jsxs("div",{style:{fontSize:"15px",color:"#666",marginTop:"2px"},children:[S.date,"  ",S.auditor]}),s.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",marginTop:"4px",display:"inline-block",backgroundColor:"#e0f2fe",padding:"2px 8px",borderRadius:"4px"},children:"B&G Walkthrough"})]}),s.jsxs("div",{style:{textAlign:"right",marginRight:"8px"},children:[s.jsx("div",{style:{fontWeight:"700",fontSize:"17px",color:S.campusRating==="PASS"?"#10b981":"#ef4444"},children:S.campusRating||"N/A"}),s.jsxs("div",{style:{fontSize:"15px",color:"#666",marginTop:"2px"},children:[S.totalIssues||0," issue",S.totalIssues!==1?"s":""]})]}),s.jsx("span",{style:{color:"#9ca3af",fontSize:"24px"},children:""})]})},`bg-${S.id||_}`))})]})]})},tu=n=>{if(os[n])return os[n];if(n.startsWith("restroom_")){const i=n.replace("restroom_","");return{...Px,name:`Restroom ${i}`}}return null},l_=()=>{const n=xe(),{id:i}=fl(),[r,a]=v.useState(null),[c,d]=v.useState([]),[h,p]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const{data:k,error:S}=await ct.from("audits").select("*").eq("id",i).single();if(S)throw S;console.log("Raw audit data:",{zone_results:k.zone_results,condition_alert_details:k.condition_alert_details}),k.condition_alert_details&&k.condition_alert_details.forEach((j,A)=>{console.log(`Condition Alert ${A}:`,{zoneId:j.zoneId,hasIssue:j.hasIssue,hasPhoto:!!j.photo,photoUrl:j.photo,note:j.note})}),a({id:k.id,date:k.date,time:k.time,campus:k.campus,auditor:k.auditor,auditorEmail:k.auditor_email,status:k.status,defects:k.defects,zones:k.zones,duration:k.duration,tourReady:k.tour_ready,conditionAlerts:k.condition_alerts_count,zoneResults:k.zone_results||{},conditionAlertDetails:k.condition_alert_details||[],campusData:k.campus_data,createdAt:k.created_at});const{data:_,error:w}=await ct.from("zone_photos").select("*").eq("audit_id",i).order("created_at",{ascending:!0});!w&&_&&d(_)}catch(k){console.error("Error loading audit:",k)}finally{p(!1)}})()},[i]);const g={GREEN:{bg:"#dcfce7",text:"#166534",emoji:""},AMBER:{bg:"#fef3c7",text:"#92400e",emoji:""},RED:{bg:"#fee2e2",text:"#b91c1c",emoji:""}};if(h)return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Audit Report",onBack:()=>n(-1)}),s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:"Loading..."})]});if(!r)return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Audit Report",onBack:()=>n(-1)}),s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:"Audit not found"})]});const m=g[r.status]||g.RED;return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Audit Report",onBack:()=>n(-1)}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:m.bg,borderRadius:"16px",padding:"24px",textAlign:"center",marginBottom:"20px"},children:[s.jsx("div",{style:{fontSize:"56px",marginBottom:"12px"},children:m.emoji}),s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:m.text},children:r.status}),s.jsxs("div",{style:{fontSize:"17px",color:m.text,marginTop:"8px"},children:[r.defects," defect",r.defects!==1?"s":""," found"]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:"Audit Details"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Campus"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.campus})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Auditor"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.auditor})]}),r.auditorEmail&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Email"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.auditorEmail})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Date"}),s.jsxs("span",{style:{fontWeight:"600",color:"#092849"},children:[r.date," at ",r.time]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Duration"}),s.jsxs("span",{style:{fontWeight:"600",color:"#092849"},children:[r.duration," min"]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Zones Checked"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.zones})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Tour Ready"}),s.jsx("span",{style:{fontWeight:"600",color:r.tourReady?"#166534":"#b91c1c"},children:r.tourReady?"Yes":"No"})]})]})]}),r.zoneResults&&Object.keys(r.zoneResults).length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:"Zone Results"}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:Object.entries(r.zoneResults).map(([x,k])=>{const S=tu(x),_=Object.values(k).filter(w=>w==="no").length;return Object.keys(k).length,s.jsxs("div",{style:{padding:"14px",backgroundColor:_>0?"#fee2e2":"#dcfce7",borderRadius:"10px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:S?.name||x}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:_>0?"#b91c1c":"#166534"},children:_>0?`${_} defect${_>1?"s":""}`:"Passed"})]}),_>0&&s.jsx("div",{style:{marginTop:"10px",fontSize:"14px",color:"#666"},children:Object.entries(k).filter(([,w])=>w==="no").map(([w])=>{const j=S?.cleanliness?.[parseInt(w)]||`Question ${parseInt(w)+1}`;return s.jsxs("div",{style:{marginTop:"4px",color:"#b91c1c"},children:[" ",j]},w)})})]},x)})})]}),r.conditionAlertDetails&&r.conditionAlertDetails.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsxs("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:["Condition Alerts (",r.conditionAlertDetails.length,")"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:r.conditionAlertDetails.map((x,k)=>{const S=tu(x.zoneId);return s.jsxs("div",{style:{padding:"14px",backgroundColor:"#fef3c7",borderRadius:"10px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:S?.name||x.zoneId}),x.note&&s.jsx("div",{style:{fontSize:"15px",color:"#666",marginBottom:"8px"},children:x.note}),x.photos?.length>0||x.photo?s.jsx("div",{style:{display:"grid",gridTemplateColumns:(x.photos?.length||1)>1?"repeat(2, 1fr)":"1fr",gap:"8px"},children:(x.photos||[x.photo]).filter(Boolean).map((_,w)=>s.jsx("img",{src:_,alt:`Condition alert ${w+1}`,style:{width:"100%",maxHeight:(x.photos?.length||1)>1?"150px":"300px",objectFit:"cover",borderRadius:"8px",backgroundColor:"#f3f4f6"},onError:j=>{console.error("Failed to load condition alert photo:",_),j.target.style.display="none"}},w))}):s.jsx("div",{style:{padding:"12px",backgroundColor:"#f3f4f6",borderRadius:"8px",fontSize:"14px",color:"#9ca3af",textAlign:"center"},children:"No photo attached"})]},k)})})]}),c.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsxs("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:["Zone Photos (",c.length,")"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:Object.entries(c.reduce((x,k)=>{const S=k.zone_id||"unknown";return x[S]||(x[S]=[]),x[S].push(k),x},{})).map(([x,k])=>{const S=tu(x);return s.jsxs("div",{style:{padding:"14px",backgroundColor:"#f0f9ff",borderRadius:"10px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#0369a1",marginBottom:"12px"},children:S?.name||k[0]?.zone_name||x}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},children:k.map((_,w)=>s.jsx("img",{src:_.photo_url,alt:`Zone photo ${w+1}`,style:{width:"100%",height:"120px",objectFit:"cover",borderRadius:"8px"}},_.id||w))})]},x)})})]}),s.jsx("button",{onClick:()=>n(-1),style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"16px",borderRadius:"12px",fontSize:"17px",fontWeight:"700",border:"none",cursor:"pointer",marginTop:"8px"},children:"Back to History"})]})]})},c_=({report:n,camera:i})=>{const r=xe(),{t:a}=Jn(),[c,d]=v.useState(""),h=()=>{if(!c){alert("Please select a campus first");return}const p=an.find(g=>g.name===c);n.setCampus(p),i.openCamera(g=>{n.addPhoto(g),r("/report/photo")},"Capture Issue")};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:a("nav.report"),subtitle:a("report.setup.subtitle","Report a facility issue"),variant:"red",onBack:()=>r("/")}),s.jsx("div",{style:{padding:"20px"},children:s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"28px 24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:""}),s.jsx("h2",{style:{fontSize:"22px",fontWeight:"700",marginBottom:"10px",color:"#092849"},children:a("report.snapPhoto")}),s.jsx("p",{style:{color:"#666",marginBottom:"28px",fontSize:"17px",lineHeight:"1.5"},children:a("report.snapPhotoDesc")}),s.jsxs("div",{style:{marginBottom:"24px",textAlign:"left"},children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:[a("report.setup.campus")," *"]}),s.jsx(Xn,{id:"reportCampus",value:c,onChange:d})]}),s.jsxs("button",{onClick:h,style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer"},children:[" ",a("audit.walkthrough.takePhoto")]})]})})]})},d_=({report:n,camera:i})=>{const r=xe(),{campus:a,photos:c,addPhoto:d}=n,h=()=>{i.openCamera(x=>{d(x)},"Add Another Photo")},p=x=>{n.removePhoto(x)},g=()=>{r("/report/description")},m=()=>{n.setPhotos([]),i.openCamera(x=>{n.addPhoto(x)},"Capture Issue")};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Photos",subtitle:a?.name||"",variant:"red",onBack:()=>r("/report")}),s.jsx("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"20px"},children:c.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{display:"grid",gridTemplateColumns:c.length===1?"1fr":"1fr 1fr",gap:"12px"},children:c.map((x,k)=>s.jsxs("div",{style:{position:"relative",borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("img",{src:x,alt:`Issue photo ${k+1}`,style:{width:"100%",aspectRatio:c.length===1?"auto":"1",objectFit:"cover",display:"block"}}),c.length>1&&s.jsx("button",{onClick:()=>p(k),style:{position:"absolute",top:"8px",right:"8px",width:"28px",height:"28px",borderRadius:"50%",backgroundColor:"rgba(0,0,0,0.6)",color:"#fff",border:"none",fontSize:"18px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]},k))}),s.jsxs("div",{style:{textAlign:"center",fontSize:"15px",color:"#666"},children:[c.length," photo",c.length!==1?"s":""," captured"]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"20px",fontWeight:"600",color:"#333",marginBottom:"24px"},children:"Do you need to add more photos?"}),s.jsxs("div",{style:{display:"flex",gap:"12px"},children:[s.jsxs("button",{onClick:h,style:{flex:1,backgroundColor:"#f3f4f6",color:"#374151",padding:"16px",borderRadius:"12px",fontWeight:"600",fontSize:"17px",border:"2px solid #e5e7eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[s.jsx("span",{style:{fontSize:"20px"},children:""}),"Yes"]}),s.jsx("button",{onClick:g,style:{flex:1,backgroundColor:"#092849",color:"#fff",padding:"16px",borderRadius:"12px",fontWeight:"600",fontSize:"17px",border:"none",cursor:"pointer"},children:"No, Continue "})]})]}),s.jsx("button",{onClick:m,style:{backgroundColor:"transparent",color:"#666",padding:"12px",borderRadius:"8px",border:"none",fontSize:"15px",cursor:"pointer",textDecoration:"underline"},children:"Start over with new photo"})]}):s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"48px 24px",textAlign:"center",color:"#9ca3af"},children:[s.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:""}),s.jsx("p",{style:{fontSize:"17px",marginBottom:"20px"},children:"No photo captured"}),s.jsx("button",{onClick:m,style:{backgroundColor:"#092849",color:"#fff",padding:"14px 28px",borderRadius:"12px",fontWeight:"600",fontSize:"17px",border:"none",cursor:"pointer"},children:"Take Photo"})]})})]})},u_=({report:n})=>{const i=xe(),{campus:r,photos:a,description:c,location:d,setDescription:h,setLocation:p}=n,g=c.trim()&&d.trim(),m=()=>{g&&i("/report/emergency")};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx(qe,{title:"Describe the Problem",subtitle:r?.name||"",variant:"red",onBack:()=>i("/report/photo")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"20px"},children:[a.length>0&&s.jsxs("div",{style:{display:"flex",gap:"8px",overflowX:"auto",paddingBottom:"4px"},children:[a.map((x,k)=>s.jsx("img",{src:x,alt:`Photo ${k+1}`,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"8px",flexShrink:0}},k)),s.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:"14px",color:"#666",paddingLeft:"8px"},children:[a.length," photo",a.length!==1?"s":""]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[s.jsx("label",{style:{display:"block",fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:"What's the problem?"}),s.jsx("textarea",{value:c,onChange:x=>h(x.target.value),placeholder:"Describe what you see or what needs attention...",rows:4,style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fafafa",resize:"vertical",fontFamily:"inherit"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[s.jsx("label",{style:{display:"block",fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:"Where is it located?"}),s.jsx("input",{type:"text",value:d,onChange:x=>p(x.target.value),placeholder:"e.g., 2nd floor restroom, Room 204, Main lobby",style:{width:"100%",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fafafa"}})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:m,disabled:!g,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:g?"pointer":"not-allowed",backgroundColor:g?"#092849":"#d1d5db",color:g?"#fff":"#9ca3af"},children:"Continue "})})]})},h_=({report:n})=>{const i=xe(),[r,a]=v.useState(!1),{campus:c,photos:d,description:h,location:p,setIsEmergency:g}=n,m=async x=>{g(x),a(!0);try{await Jk({timestamp:new Date().toLocaleString(),campus:c?.name||"",photo:d[0]||null,photos:d,category:"other",location:p,note:h,urgent:x,team:x?"Facilities Manager":"Facilities",status:"open",campusData:c,isEmergency:x}),i("/report/complete")}catch(k){console.error("Error submitting report:",k),alert("Error submitting report. Please try again."),a(!1)}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"One Last Question",subtitle:c?.name||"",variant:"red",onBack:()=>i("/report/description")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"20px"},children:[s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:s.jsxs("div",{style:{display:"flex",gap:"12px"},children:[d[0]&&s.jsx("img",{src:d[0],alt:"Issue",style:{width:"64px",height:"64px",objectFit:"cover",borderRadius:"8px",flexShrink:0}}),s.jsxs("div",{style:{flex:1,minWidth:0},children:[s.jsx("div",{style:{fontSize:"15px",color:"#333",fontWeight:"500",marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:h}),s.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:[" ",p]}),d.length>1&&s.jsxs("div",{style:{fontSize:"13px",color:"#999",marginTop:"4px"},children:["+",d.length-1," more photo",d.length>2?"s":""]})]})]})}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"28px 24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:""}),s.jsx("div",{style:{fontSize:"22px",fontWeight:"700",color:"#333",marginBottom:"8px"},children:"Is this an emergency?"}),s.jsx("div",{style:{fontSize:"15px",color:"#666",marginBottom:"28px"},children:"Emergencies include safety hazards, flooding, or anything requiring immediate attention"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsxs("button",{onClick:()=>m(!0),disabled:r,style:{width:"100%",backgroundColor:r?"#fca5a5":"#dc2626",color:"#fff",padding:"18px",borderRadius:"12px",fontWeight:"700",fontSize:"18px",border:"none",cursor:r?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[s.jsx("span",{style:{fontSize:"22px"},children:""}),r?"Submitting...":"Yes, Emergency"]}),s.jsx("button",{onClick:()=>m(!1),disabled:r,style:{width:"100%",backgroundColor:r?"#d1d5db":"#092849",color:"#fff",padding:"18px",borderRadius:"12px",fontWeight:"700",fontSize:"18px",border:"none",cursor:r?"not-allowed":"pointer"},children:r?"Submitting...":"No, Not an Emergency"})]})]})]})]})},f_=({report:n})=>{const i=xe(),[r,a]=v.useState(null),{campus:c,location:d,description:h,isEmergency:p,category:g,photo:m,resetReport:x}=n;v.useEffect(()=>{(async()=>{const w=c?.name;if(!w||!zi()){console.log("[Report] Wrike not enabled for campus:",w),a("skipped");return}a("sending");try{console.log("[Report] Creating Wrike task...");const j=await d2({category:g||"General Issue",location:d,description:h,urgent:p,photo:m,reporterName:"",reporterEmail:""},w);j?(console.log("[Report] Wrike task created:",j.id),a("sent")):a("error")}catch(j){console.error("[Report] Wrike error:",j),a("error")}})()},[]);const k=()=>{x(),i("/")},S=()=>{x(),i("/reports")};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:p?"#dc2626":"#2B57D0",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"32px",color:"#fff",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"96px",marginBottom:"24px"},children:p?"":""}),s.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",marginBottom:"10px"},children:p?"Emergency Reported!":"Report Submitted!"}),s.jsx("p",{style:{fontSize:"18px",opacity:.9,marginBottom:"8px"},children:p?"Facilities Manager has been alerted":"Your report has been received"}),s.jsx("p",{style:{fontSize:"16px",opacity:.8,marginBottom:"8px"},children:"Added to recent history"}),r&&s.jsxs("p",{style:{fontSize:"14px",opacity:.7,marginBottom:"24px"},children:[r==="sending"&&" Sending to Wrike...",r==="sent"&&" Sent to Wrike",r==="error"&&" Wrike sync failed",r==="skipped"&&""]}),s.jsxs("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:"12px",padding:"18px 20px",marginBottom:"32px",width:"100%",maxWidth:"320px",textAlign:"left"},children:[s.jsx("div",{style:{fontSize:"16px",fontWeight:"500",marginBottom:"8px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:h||"Issue reported"}),s.jsxs("div",{style:{fontSize:"15px",opacity:.9},children:[" ",c?.name||"Campus"]}),s.jsx("div",{style:{fontSize:"15px",opacity:.9,marginTop:"4px"},children:d})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",width:"100%",maxWidth:"320px"},children:[s.jsx("button",{onClick:k,style:{backgroundColor:"#fff",color:"#092849",padding:"16px 40px",borderRadius:"12px",fontWeight:"700",fontSize:"18px",border:"none",cursor:"pointer",width:"100%"},children:"Done"}),s.jsx("button",{onClick:S,style:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"#fff",padding:"14px 40px",borderRadius:"12px",fontWeight:"600",fontSize:"16px",border:"2px solid rgba(255, 255, 255, 0.3)",cursor:"pointer",width:"100%"},children:"View Recent Reports"})]})]})},p_=()=>{const n=xe(),[i,r]=v.useState([]),[a,c]=v.useState(!0);return v.useEffect(()=>{(async()=>{try{const h=await Hx(50);r(h)}catch(h){console.error("Error loading reports:",h)}finally{c(!1)}})()},[]),s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Reported Issues",variant:"red",onBack:()=>n("/")}),s.jsx("div",{style:{padding:"20px"},children:a?s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af",fontSize:"17px"},children:"Loading..."}):i.length===0?s.jsxs("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:[s.jsx("div",{style:{fontSize:"56px",marginBottom:"16px"},children:""}),s.jsx("p",{style:{fontSize:"17px"},children:"No issues reported"})]}):s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:i.map((d,h)=>{const p=Gu.find(g=>g.id===d.category)||{icon:"",name:"See It, Report It"};return s.jsx("div",{onClick:()=>d.id&&n(`/report/${d.id}`),style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",cursor:d.id?"pointer":"default"},children:s.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[d.photo&&s.jsx("img",{src:d.photo,alt:"Issue",style:{width:"64px",height:"64px",objectFit:"cover",borderRadius:"8px",marginRight:"14px"}}),s.jsxs("div",{style:{flex:1},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[s.jsxs("span",{style:{fontWeight:"700",fontSize:"17px",color:"#092849"},children:[p.icon," ",p.name]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{style:{fontSize:"14px",padding:"5px 10px",borderRadius:"6px",backgroundColor:d.status==="open"?"#C2ECFD":"rgba(194, 236, 253, 0.5)",color:d.status==="open"?"#141685":"#092849",fontWeight:"500"},children:d.status}),s.jsx("span",{style:{color:"#9ca3af",fontSize:"20px"},children:""})]})]}),s.jsx("div",{style:{fontSize:"15px",color:"#666"},children:d.campus}),s.jsx("div",{style:{fontSize:"15px",color:"#888",marginTop:"2px"},children:d.location}),s.jsx("div",{style:{fontSize:"13px",color:"#aaa",marginTop:"6px"},children:d.timestamp})]})]})},d.id||h)})})})]})},g_=()=>{const n=xe(),{id:i}=fl(),[r,a]=v.useState(null),[c,d]=v.useState(!0),[h,p]=v.useState(!1);v.useEffect(()=>{(async()=>{try{const{data:k,error:S}=await ct.from("reports").select("*").eq("id",i).single();if(S)throw S;a({id:k.id,timestamp:k.timestamp,campus:k.campus,photo:k.photo,category:k.category,location:k.location,note:k.note,urgent:k.urgent,team:k.team,status:k.status,campusData:k.campus_data,createdAt:k.created_at})}catch(k){console.error("Error loading report:",k)}finally{d(!1)}})()},[i]);const g=async x=>{if(!(!r||h)){p(!0);try{await Xk(r.id,x),a({...r,status:x})}catch(k){console.error("Error updating status:",k),alert("Failed to update status")}finally{p(!1)}}},m=r?Gu.find(x=>x.id===r.category)||{icon:"",name:"See It, Report It"}:null;return c?s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Report Details",onBack:()=>n(-1)}),s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:"Loading..."})]}):r?s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Report Details",onBack:()=>n(-1)}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:r.urgent?"#fee2e2":r.status==="open"?"#C2ECFD":"#dcfce7",borderRadius:"16px",padding:"24px",textAlign:"center",marginBottom:"20px"},children:[s.jsx("div",{style:{fontSize:"56px",marginBottom:"12px"},children:r.urgent?"":m?.icon}),s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:r.urgent?"#b91c1c":"#092849"},children:m?.name}),r.urgent&&s.jsx("div",{style:{fontSize:"15px",color:"#b91c1c",marginTop:"8px",fontWeight:"600"},children:"URGENT / SAFETY ISSUE"}),s.jsx("div",{style:{display:"inline-block",marginTop:"12px",padding:"6px 16px",borderRadius:"20px",backgroundColor:r.status==="open"?"#47C4E6":"#10b981",color:"#fff",fontSize:"14px",fontWeight:"600"},children:r.status})]}),r.photo&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"12px"},children:"Photo"}),s.jsx("img",{src:r.photo,alt:"Reported issue",style:{width:"100%",maxHeight:"400px",objectFit:"contain",borderRadius:"8px",backgroundColor:"#f3f4f6"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:"Report Details"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Campus"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.campus})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Location"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.location})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Category"}),s.jsxs("span",{style:{fontWeight:"600",color:"#092849"},children:[m?.icon," ",m?.name]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Assigned To"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.team||"Facilities"})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Reported"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.timestamp})]})]})]}),r.note&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"12px"},children:"Notes"}),s.jsx("p",{style:{fontSize:"15px",color:"#374151",lineHeight:"1.5",margin:0},children:r.note})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:"Update Status"}),s.jsxs("div",{style:{display:"flex",gap:"12px"},children:[s.jsx("button",{onClick:()=>g("open"),disabled:r.status==="open"||h,style:{flex:1,padding:"14px",borderRadius:"10px",border:r.status==="open"?"2px solid #47C4E6":"2px solid #e5e7eb",backgroundColor:r.status==="open"?"#C2ECFD":"#fff",color:"#092849",fontSize:"15px",fontWeight:"600",cursor:r.status==="open"||h?"not-allowed":"pointer",opacity:h?.6:1},children:"Open"}),s.jsx("button",{onClick:()=>g("resolved"),disabled:r.status==="resolved"||h,style:{flex:1,padding:"14px",borderRadius:"10px",border:r.status==="resolved"?"2px solid #10b981":"2px solid #e5e7eb",backgroundColor:r.status==="resolved"?"#dcfce7":"#fff",color:"#092849",fontSize:"15px",fontWeight:"600",cursor:r.status==="resolved"||h?"not-allowed":"pointer",opacity:h?.6:1},children:"Resolved"})]})]}),s.jsx("button",{onClick:()=>n(-1),style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"16px",borderRadius:"12px",fontSize:"17px",fontWeight:"700",border:"none",cursor:"pointer",marginTop:"8px"},children:"Back"})]})]}):s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"Report Details",onBack:()=>n(-1)}),s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:"Report not found"})]})},m_=()=>!0,x_=()=>{const n=xe(),{t:i}=Jn(),[r,a]=v.useState(!1);return v.useEffect(()=>{a(m_())},[]),s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:i("settings.title"),subtitle:"",variant:"red",onBack:()=>n("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"16px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px",gap:"10px"},children:[s.jsx("span",{style:{fontSize:"28px"},children:""}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#333"},children:i("settings.language")}),s.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:[i("common.english")," / ",i("common.spanish")]})]})]}),s.jsx(Kx,{style:"buttons"})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx("span",{style:{fontSize:"28px"},children:""}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#333"},children:"AI Photo Analysis"}),s.jsx("div",{style:{fontSize:"14px",color:"#666"},children:"Automatically identifies issue types from photos"})]}),s.jsx("span",{style:{backgroundColor:r?"#d1fae5":"#fef2f2",color:r?"#059669":"#dc2626",fontSize:"13px",fontWeight:"600",padding:"6px 12px",borderRadius:"12px"},children:r?" Enabled":" Not configured"})]}),!r&&s.jsx("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#fef3c7",borderRadius:"8px",fontSize:"14px",color:"#92400e"},children:"AI analysis is not available. Please contact your administrator."})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:"About This App"}),s.jsxs("div",{style:{fontSize:"15px",color:"#666",lineHeight:"1.5"},children:[s.jsxs("p",{style:{margin:"0 0 8px 0"},children:[s.jsx("strong",{children:"See It, Report It"})," allows you to quickly report facility issues by taking a photo."]}),s.jsx("p",{style:{margin:"0"},children:"AI-powered analysis automatically identifies the type of issue in your photo to speed up reporting."})]})]})]})]})},y_=({bgWalkthrough:n})=>{const i=xe(),[r,a]=v.useState(""),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(["","",""]),[x,k]=v.useState(["",""]),S=(z,D)=>{const y=[...g];y[z]=D,m(y)},_=(z,D)=>{const y=[...x];y[z]=D,k(y)},w=()=>{k([...x,""])},j=z=>{x.length>2&&k(x.filter((D,y)=>y!==z))},A=()=>{if(!r){alert("Please select a campus");return}if(!c.trim()){alert("Please enter your name");return}if(!h.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)){alert("Please enter a valid email address");return}const z=g.filter(C=>C.trim()),D=x.filter(C=>C.trim());if(z.length<3){alert("Please enter names/numbers for at least 3 classrooms");return}if(D.length<2){alert("Please enter names/numbers for at least 2 bathrooms");return}const y=an.find(C=>C.name===r);n.initWalkthrough(r,y,c.trim(),h.trim()),n.setSelectedRooms(z,D),window.scrollTo(0,0),i("/bg/zone")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Weekly B&G Walkthrough",subtitle:"Building & Grounds Quality Control",onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Campus *"}),s.jsx(Xn,{value:r,onChange:a,placeholder:"Select campus..."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Name *"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:c,onChange:z=>d(z.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Email *"}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:h,onChange:z=>p(z.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:["Inspection Zones (",Yt.length,")"]}),s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:Yt.map((z,D)=>{const y=Rn[z];return s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 0",borderBottom:D!==Yt.length-1?"1px solid rgba(71, 196, 230, 0.3)":"none"},children:[s.jsx("span",{style:{color:"#2B57D0",marginRight:"12px",fontSize:"20px"},children:D+1}),s.jsxs("div",{style:{flex:1},children:[s.jsx("span",{style:{fontSize:"17px",fontWeight:"500"},children:y.name}),s.jsx("div",{style:{fontSize:"13px",color:"#666",marginTop:"2px"},children:y.description})]})]},z)})})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Interior Rooms to Inspect *"}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:"Select 3 classrooms and at least 2 bathrooms to walk during the Interior Building Condition zone."}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"12px",padding:"16px",marginBottom:"12px"},children:[s.jsx("div",{style:{fontWeight:"600",marginBottom:"12px",color:"#092849"},children:"Classrooms (3 required)"}),g.map((z,D)=>s.jsx("div",{style:{marginBottom:"8px"},children:s.jsx("input",{type:"text",placeholder:`Classroom ${D+1} (e.g., Room 101, K-1, etc.)`,value:z,onChange:y=>S(D,y.target.value),style:{width:"100%",border:"1px solid #ddd",borderRadius:"8px",padding:"12px",fontSize:"15px",boxSizing:"border-box"}})},D))]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"12px",padding:"16px"},children:[s.jsxs("div",{style:{fontWeight:"600",marginBottom:"12px",color:"#092849",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("span",{children:"Bathrooms (2+ required)"}),s.jsx("button",{onClick:w,style:{backgroundColor:"#47C4E6",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",fontWeight:"600"},children:"+ Add"})]}),x.map((z,D)=>s.jsxs("div",{style:{marginBottom:"8px",display:"flex",gap:"8px"},children:[s.jsx("input",{type:"text",placeholder:`Bathroom ${D+1} (e.g., Main Hall, Boys K-2, etc.)`,value:z,onChange:y=>_(D,y.target.value),style:{flex:1,border:"1px solid #ddd",borderRadius:"8px",padding:"12px",fontSize:"15px",boxSizing:"border-box"}}),x.length>2&&s.jsx("button",{onClick:()=>j(D),style:{backgroundColor:"#fee2e2",color:"#b91c1c",border:"none",borderRadius:"8px",width:"44px",fontSize:"18px",cursor:"pointer"},children:""})]},D))]})]}),s.jsxs("div",{style:{backgroundColor:"rgba(254, 243, 199, 0.5)",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:"The Standard"}),s.jsx("div",{style:{fontSize:"15px",color:"#78350f",fontStyle:"italic"},children:`"If you wouldn't accept this at a Ritz-Carlton, report it."`}),s.jsx("div",{style:{fontSize:"13px",color:"#92400e",marginTop:"8px"},children:"Would this pass the 47-second arrival decision?"})]}),s.jsx("button",{onClick:A,style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer",marginTop:"8px"},children:"Begin B&G Walkthrough"})]})]})},b_=({bgWalkthrough:n,camera:i})=>{const r=xe(),[a,c]=v.useState({}),[d,h]=v.useState(0),[p,g]=v.useState({}),{currentZoneIndex:m,zoneResults:x,roomResults:k,selectedRooms:S,issues:_,recordZoneResults:w,addIssue:j,updateIssue:A,addPhotoToIssue:z,nextZone:D,goToZone:y,calculateAndSetZoneRating:C}=n,T=Yt[m],E=Rn[T],W=Yt.length,M=E?.isObservationZone,K=E?.isGovernanceZone,ee=E?.isRoomBased,F=ee?[...S.classrooms.map(oe=>({name:oe,type:"classroom"})),...S.bathrooms.map(oe=>({name:oe,type:"bathroom"}))]:[],ne=F[d],se=F.length,$=(()=>{if(ee&&ne){if(ne.type==="classroom"&&E.classroomSections)return E.classroomSections;if(ne.type==="bathroom"&&E.bathroomSections)return E.bathroomSections}return E?.sections||[]})(),q=ee&&ne?`${ne.type}_${ne.name}`:T,Z=`${T}-${d}`;v.useEffect(()=>{const oe=ee?k[q]||{}:x[T]||{};c(()=>oe);const le={};$?.forEach(Oe=>{le[Oe.name]=!0}),g(()=>le)},[Z]),v.useEffect(()=>{M?r("/bg/observations"):K&&r("/bg/governance")},[T,M,K,r]);const re=(oe,le)=>{c(Oe=>({...Oe,[oe]:le}))},ae=oe=>{g(le=>({...le,[oe]:!le[oe]}))},I=()=>$?.reduce((oe,le)=>oe+le.checks.length,0)||0,U=()=>Object.keys(a).filter(oe=>a[oe]!==void 0).length,Q=U()===I(),fe=(()=>{const oe=[];return $?.forEach(le=>{le.checks.forEach(Oe=>{a[Oe.id]===!1&&oe.push({...Oe,section:le.name})})}),oe})(),ce=_.filter(oe=>ee?oe.roomId===q:oe.zoneId===T),ge=fe.every(oe=>{const le=ce.find(Oe=>Oe.checkId===oe.id);return le&&le.photos&&le.photos.length>0}),Pe=fe.length===0&&Q,Ne=Q&&(Pe||ge),dt=oe=>{let le=ce.find(it=>it.checkId===oe.id),Oe=le?.id;if(!le){const it={zoneId:T,zoneName:E.name,checkId:oe.id,checkText:oe.text,section:oe.section,tier:oe.tier,amberEligible:oe.amberEligible||!1,amberIneligible:oe.amberIneligible||!1,roomId:ee?q:null,roomName:ee?ne?.name:null,photos:[],notes:""};Oe=j(it)}i.openCamera(it=>{it&&Oe&&z(Oe,it)})},Bt=(oe,le)=>{const Oe=_.find(it=>it.id===oe);if(Oe){const it=Oe.photos.filter((Rt,cn)=>cn!==le);A(oe,{photos:it})}},ue=(oe,le)=>{A(oe,{notes:le.slice(0,200)})},ye=()=>{ee?w(T,a,q):w(T,a),fe.forEach(oe=>{ce.find(Oe=>Oe.checkId===oe.id)||j({zoneId:T,zoneName:E.name,checkId:oe.id,checkText:oe.text,section:oe.section,tier:oe.tier,amberEligible:oe.amberEligible||!1,amberIneligible:oe.amberIneligible||!1,roomId:ee?q:null,roomName:ee?ne?.name:null,photos:[],notes:""})}),ee&&d<se-1?(h(d+1),c({}),window.scrollTo(0,0)):(C(T),m<W-1?(D(),h(0),c({}),window.scrollTo(0,0)):r("/bg/summary"))},we=()=>{if(ee&&d>0)h(d-1),c({});else if(m>0){y(m-1);const oe=Yt[m-1];if(Rn[oe].isRoomBased){const Oe=[...S.classrooms,...S.bathrooms];h(Oe.length-1)}else h(0)}else r("/bg/setup")};return!E||M||K?null:s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"120px"},children:[s.jsx("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",color:"#fff",padding:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("button",{onClick:we,style:{fontSize:"24px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff"},children:""}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",margin:0},children:ee&&ne?`${ne.type==="classroom"?"Classroom":"Restroom"} ${ne.name}`:E.name}),ee&&ne&&s.jsxs("p",{style:{fontSize:"16px",margin:"4px 0 0 0",color:"#C2ECFD"},children:[ne.type==="classroom"?"":""," ",E.name]}),s.jsxs("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:["Zone ",m+1," of ",W,ee&&`  Room ${d+1} of ${se}`]})]}),s.jsx("div",{style:{width:"40px"}})]})}),s.jsx("div",{style:{height:"6px",backgroundColor:"#e5e7eb"},children:s.jsx("div",{style:{height:"100%",backgroundColor:"#092849",width:`${(m+1)/W*100}%`,transition:"width 0.3s ease"}})}),s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.5)",borderLeft:"4px solid #2B57D0",padding:"14px 16px",margin:"16px 20px",borderRadius:"8px"},children:s.jsx("div",{style:{fontSize:"14px",color:"#141685"},children:ee&&ne?ne.type==="classroom"?"Walls, floors, ceilings, doors/windows, baseboards, lighting, furniture, whiteboard":"Walls, floors, ceilings, toilets, sinks, mirrors, dispensers, doors, partitions":E.description})}),s.jsxs("div",{style:{padding:"0 20px"},children:[$?.map(oe=>s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsxs("button",{onClick:()=>ae(oe.name),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",backgroundColor:"#092849",color:"#fff",borderRadius:p[oe.name]?"12px 12px 0 0":"12px",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:[s.jsx("span",{children:oe.name}),s.jsx("span",{style:{transform:p[oe.name]?"rotate(180deg)":"rotate(0)",transition:"transform 0.2s"},children:""})]}),p[oe.name]&&s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0 0 12px 12px",border:"1px solid #e5e7eb",borderTop:"none"},children:oe.checks.map((le,Oe)=>{const it=a[le.id],Rt=ce.find(cn=>cn.checkId===le.id);return s.jsxs("div",{style:{padding:"16px",borderBottom:Oe<oe.checks.length-1?"1px solid #e5e7eb":"none"},children:[s.jsx("div",{style:{fontSize:"15px",marginBottom:"12px",color:"#333",lineHeight:"1.4"},children:le.text}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("button",{onClick:()=>re(le.id,!0),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:it===!0?"#10b981":"#f3f4f6",color:it===!0?"#fff":"#333"},children:" Yes"}),s.jsx("button",{onClick:()=>re(le.id,!1),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:it===!1?"#ef4444":"#f3f4f6",color:it===!1?"#fff":"#333"},children:" No"})]}),it===!1&&s.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",border:"1px solid #fecaca"},children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:"#b91c1c",marginBottom:"8px"},children:" Photo Required"}),Rt?.photos?.length>0&&s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginBottom:"8px"},children:Rt.photos.map((cn,Di)=>s.jsxs("div",{style:{position:"relative"},children:[s.jsx("img",{src:cn,alt:`Issue ${Di+1}`,style:{width:"100%",height:"80px",borderRadius:"6px",objectFit:"cover"}}),s.jsx("button",{onClick:()=>Bt(Rt.id,Di),style:{position:"absolute",top:"2px",right:"2px",backgroundColor:"#ef4444",color:"#fff",width:"20px",height:"20px",borderRadius:"50%",border:"none",cursor:"pointer",fontSize:"12px",fontWeight:"700"},children:""})]},Di))}),s.jsxs("button",{onClick:()=>dt(le),style:{width:"100%",padding:"10px",border:"2px dashed #fca5a5",borderRadius:"6px",backgroundColor:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{children:""}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#b91c1c"},children:Rt?.photos?.length>0?"Add Another Photo":"Take Photo"})]}),s.jsx("textarea",{value:Rt?.notes||"",onChange:cn=>Rt&&ue(Rt.id,cn.target.value),placeholder:"Describe the issue (optional)...",maxLength:200,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #fca5a5",fontSize:"14px",resize:"none",minHeight:"50px",fontFamily:"inherit",boxSizing:"border-box"}})]})]},le.id)})})]},oe.name)),Q&&Pe&&s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginTop:"16px",border:"2px solid #10b981"},children:s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#059669"},children:" All checks passed - Zone is Green!"})})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:ye,disabled:!Ne,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:Ne?"pointer":"not-allowed",backgroundColor:Ne?"#092849":"#d1d5db",color:Ne?"#fff":"#9ca3af"},children:Q?!ge&&!Pe?"Add Photos for All Issues":ee&&d<se-1?"Next Room ":m<W-1?"Next Zone ":"View Summary ":`Answer All Questions (${U()}/${I()})`})})]})},v_=({bgWalkthrough:n})=>{const i=xe(),[r,a]=v.useState(null),[c,d]=v.useState(!0),[h,p]=v.useState({}),{currentZoneIndex:g,campus:m,zoneResults:x,recordZoneResults:k,goToZone:S,calculateAndSetZoneRating:_}=n,w=Yt[g],j=Rn[w],A=Yt.length;v.useEffect(()=>{(async()=>{if(!m){d(!1);return}try{const $=(await Hu(m,2)).find(O=>O.isComplete);$&&a($)}catch(B){console.error("Error loading prior week data:",B)}finally{d(!1)}})()},[m]),v.useEffect(()=>{const se=x[w]||{};p(se)},[w,x]);const z=(se,B)=>{p($=>({...$,[se]:B}))},D=j?.sections?.flatMap(se=>se.checks.map(B=>({...B,section:se.name})))||[],y=()=>D.length,C=()=>D.filter(se=>{const B=h[se.id];return se.isTextInput?typeof B=="string"&&B.trim().length>0:B!==void 0}).length,T=C()===y(),W=D.filter(se=>h[se.id]===!1).length===0&&T,M=T,K=()=>{k(w,h),_(w),i("/bg/summary")},ee=()=>{g>0&&(S(g-1),i("/bg/zone"))},F=r?.issues?.filter(se=>se.tier===2||se.tier===3||se.amberEligible).length||0,ne=r?.issues?.filter(se=>se.tier===1||se.amberIneligible).length||0;return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"120px"},children:[s.jsx("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",color:"#fff",padding:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("button",{onClick:ee,style:{fontSize:"24px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff"},children:""}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",margin:0},children:j?.name}),s.jsxs("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:["Zone ",g+1," of ",A]})]}),s.jsx("div",{style:{width:"40px"}})]})}),s.jsx("div",{style:{height:"6px",backgroundColor:"#e5e7eb"},children:s.jsx("div",{style:{height:"100%",backgroundColor:"#092849",width:`${(g+1)/A*100}%`,transition:"width 0.3s ease"}})}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:" Prior Week Summary"}),c?s.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#666"},children:"Loading prior week data..."}):r?s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"16px"},children:[s.jsxs("div",{style:{backgroundColor:"#f0fdf4",padding:"12px",borderRadius:"8px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:r.greenZones||0}),s.jsx("div",{style:{fontSize:"12px",color:"#065f46"},children:"Green Zones"})]}),s.jsxs("div",{style:{backgroundColor:"#fef3c7",padding:"12px",borderRadius:"8px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#d97706"},children:F}),s.jsx("div",{style:{fontSize:"12px",color:"#92400e"},children:"Amber Issues"})]}),s.jsxs("div",{style:{backgroundColor:"#fee2e2",padding:"12px",borderRadius:"8px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#dc2626"},children:ne}),s.jsx("div",{style:{fontSize:"12px",color:"#991b1b"},children:"Red Issues"})]})]}),s.jsxs("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:[s.jsx("strong",{children:"Date:"})," ",r.date]}),s.jsxs("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:[s.jsx("strong",{children:"Auditor:"})," ",r.auditor]}),s.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:[s.jsx("strong",{children:"Campus Rating:"})," ",s.jsx("span",{style:{fontWeight:"600",color:r.campusRating==="PASS"?"#059669":"#dc2626"},children:r.campusRating||"N/A"})]}),r.issues?.length>0&&s.jsxs("div",{style:{marginTop:"16px"},children:[s.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:"Open Issues from Prior Week:"}),s.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:r.issues.map((se,B)=>s.jsxs("div",{style:{padding:"10px",backgroundColor:"#f9fafb",borderRadius:"6px",marginBottom:"6px",fontSize:"13px"},children:[s.jsxs("div",{style:{fontWeight:"500",color:"#374151"},children:[se.zoneName," - ",se.section]}),s.jsx("div",{style:{color:"#6b7280",marginTop:"2px"},children:se.checkText}),s.jsxs("div",{style:{display:"inline-block",marginTop:"4px",fontSize:"11px",padding:"2px 6px",borderRadius:"4px",backgroundColor:se.tier===1?"#fee2e2":"#fef3c7",color:se.tier===1?"#b91c1c":"#92400e"},children:["Tier ",se.tier]})]},B))})]})]}):s.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#666",backgroundColor:"#f9fafb",borderRadius:"8px"},children:[s.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:""}),s.jsx("div",{children:"No prior week walkthrough found for this campus."}),s.jsx("div",{style:{fontSize:"13px",marginTop:"4px"},children:"This may be the first B&G walkthrough."})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:" Governance Checks"}),j?.sections?.map(se=>s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#374151",marginBottom:"12px",paddingBottom:"8px",borderBottom:"1px solid #e5e7eb"},children:se.name}),se.checks.map(B=>{const $=h[B.id];return B.isTextInput?s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",padding:"16px",marginBottom:"12px",borderLeft:"4px solid #092849"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{fontSize:"24px"},children:""}),s.jsx("span",{style:{fontSize:"16px",fontWeight:"600",color:"#092849"},children:"Continuous Improvement"})]}),s.jsx("div",{style:{fontSize:"15px",color:"#333",lineHeight:"1.5"},children:B.text})]}),s.jsx("textarea",{value:$||"",onChange:O=>z(B.id,O.target.value),placeholder:B.placeholder||"Enter your recommendation...",style:{width:"100%",padding:"14px",borderRadius:"10px",border:"2px solid #e5e7eb",fontSize:"15px",resize:"none",minHeight:"100px",fontFamily:"inherit",boxSizing:"border-box",lineHeight:"1.5"}}),s.jsx("div",{style:{fontSize:"12px",color:"#6b7280",marginTop:"6px",textAlign:"right"},children:($||"").length>0?" Recommendation entered":"Required"})]},B.id):s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsx("div",{style:{fontSize:"15px",marginBottom:"10px",color:"#333",lineHeight:"1.4"},children:B.text}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("button",{onClick:()=>z(B.id,!0),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:$===!0?"#10b981":"#f3f4f6",color:$===!0?"#fff":"#333"},children:" Yes"}),s.jsx("button",{onClick:()=>z(B.id,!1),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:$===!1?"#ef4444":"#f3f4f6",color:$===!1?"#fff":"#333"},children:" No"})]})]},B.id)})]},se.name))]}),T&&W&&s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginTop:"16px",border:"2px solid #10b981"},children:s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#059669"},children:" All governance checks passed!"})})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:K,disabled:!M,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:M?"pointer":"not-allowed",backgroundColor:M?"#092849":"#d1d5db",color:M?"#fff":"#9ca3af"},children:T?"View Summary ":`Answer All Questions (${C()}/${y()})`})})]})},S_=({bgWalkthrough:n})=>{const i=xe(),{campus:r,auditor:a,auditorEmail:c,startTime:d,zoneRatings:h,issues:p,observations:g,completeWalkthrough:m}=n,[x,k]=v.useState(!1),S=v.useMemo(()=>{if(!d)return null;const F=new Date(d),se=new Date-F,B=Math.round(se/6e4),$=Math.floor(B/60),O=B%60;return{total:B,hours:$,mins:O}},[d]),_=v.useMemo(()=>m(),[m]),w=_?.zoneRatings||h,j=_?.campusRating,A=Object.values(w).filter(F=>F==="GREEN").length,z=Object.values(w).filter(F=>F==="AMBER").length,D=Object.values(w).filter(F=>F==="RED").length,y=Math.round(A/Yt.length*100),C=p.filter(F=>F.tier===1),T=p.filter(F=>F.tier===2),E=p.filter(F=>F.tier===3),W=p.filter(F=>F.tier===4),M=F=>{switch(F){case"GREEN":return"#10b981";case"AMBER":return"#f59e0b";case"RED":return"#ef4444";default:return"#6b7280"}},K=F=>{switch(F){case"GREEN":return"#f0fdf4";case"AMBER":return"#fef3c7";case"RED":return"#fee2e2";default:return"#f3f4f6"}},ee=async()=>{k(!0);try{if(zi(r))try{console.log("[B&G Walkthrough] Creating consolidated Wrike task...");const F=p.map(ne=>({category:ne.tier===1?" Instant Red":"Issue",section:`Tier ${ne.tier} - ${ne.zone||"General"}`,check:ne.description||ne.category,description:ne.observation||"Issue found",photos:ne.photos||[]}));await ds({checklistType:"BG_WALKTHROUGH",campusName:r,auditorName:a,auditorEmail:c,issues:F,date:new Date().toLocaleDateString()}),console.log("[B&G Walkthrough] Wrike task created")}catch(F){console.error("[B&G Walkthrough] Wrike error:",F)}i("/bg/complete")}finally{k(!1)}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsxs("div",{style:{background:j==="PASS"?"linear-gradient(180deg, #059669 0%, #047857 100%)":"linear-gradient(180deg, #dc2626 0%, #b91c1c 100%)",color:"#fff",padding:"30px 20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:j==="PASS"?"":""}),s.jsxs("h1",{style:{fontSize:"28px",fontWeight:"700",margin:"0 0 8px 0"},children:["Campus ",j||"Calculating..."]}),s.jsxs("p",{style:{fontSize:"16px",opacity:.9,margin:0},children:[r," - Weekly B&G Walkthrough"]}),s.jsxs("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:["Completed by ",a]}),S&&s.jsxs("div",{style:{marginTop:"12px",backgroundColor:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"8px 16px",display:"inline-block"},children:[s.jsx("span",{style:{fontSize:"14px",opacity:.9},children:" Walkthrough Time: "}),s.jsx("span",{style:{fontSize:"16px",fontWeight:"700"},children:S.hours>0?`${S.hours}h ${S.mins}m`:`${S.mins} minutes`})]})]}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginBottom:"20px"},children:[s.jsxs("div",{style:{backgroundColor:"#f0fdf4",padding:"16px",borderRadius:"12px",textAlign:"center",border:"2px solid #10b981"},children:[s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#059669"},children:A}),s.jsx("div",{style:{fontSize:"13px",color:"#065f46",fontWeight:"600"},children:"GREEN"})]}),s.jsxs("div",{style:{backgroundColor:"#fef3c7",padding:"16px",borderRadius:"12px",textAlign:"center",border:"2px solid #f59e0b"},children:[s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#d97706"},children:z}),s.jsx("div",{style:{fontSize:"13px",color:"#92400e",fontWeight:"600"},children:"AMBER"})]}),s.jsxs("div",{style:{backgroundColor:"#fee2e2",padding:"16px",borderRadius:"12px",textAlign:"center",border:"2px solid #ef4444"},children:[s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#dc2626"},children:D}),s.jsx("div",{style:{fontSize:"13px",color:"#991b1b",fontWeight:"600"},children:"RED"})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"Campus Rating Criteria:"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:y>=85?"#10b981":"#e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:y>=85?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["85% zones GREEN (",y,"% achieved)"]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:C.length===0?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:C.length===0?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["Zero Tier 1 (Safety) issues (",C.length," found)"]})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:"Zone Ratings"}),Yt.map(F=>{const ne=Rn[F],se=w[F]||"N/A",B=p.filter($=>$.zoneId===F);return s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px",backgroundColor:K(se),borderRadius:"8px",marginBottom:"8px"},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"15px",color:"#333"},children:ne.name}),B.length>0&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"2px"},children:[B.length," issue",B.length>1?"s":""]})]}),s.jsx("div",{style:{padding:"6px 12px",borderRadius:"6px",backgroundColor:M(se),color:"#fff",fontWeight:"700",fontSize:"14px"},children:se})]},F)})]}),p.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:["Issues by SLA Tier (",p.length," total)"]}),C.length>0&&s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{backgroundColor:"#fee2e2",color:"#b91c1c",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"700"},children:"TIER 1 - CRITICAL"}),s.jsx("span",{style:{fontSize:"13px",color:"#666"},children:ho[1].resolution})]}),C.map((F,ne)=>s.jsxs("div",{style:{padding:"10px",backgroundColor:"#fef2f2",borderRadius:"6px",marginBottom:"6px",fontSize:"14px"},children:[s.jsx("div",{style:{fontWeight:"500"},children:F.zoneName}),s.jsx("div",{style:{color:"#666",fontSize:"13px"},children:F.checkText})]},ne))]}),T.length>0&&s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{backgroundColor:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"700"},children:"TIER 2 - HIGH-VISIBILITY"}),s.jsx("span",{style:{fontSize:"13px",color:"#666"},children:ho[2].resolution})]}),T.map((F,ne)=>s.jsxs("div",{style:{padding:"10px",backgroundColor:"#fffbeb",borderRadius:"6px",marginBottom:"6px",fontSize:"14px"},children:[s.jsx("div",{style:{fontWeight:"500"},children:F.zoneName}),s.jsx("div",{style:{color:"#666",fontSize:"13px"},children:F.checkText})]},ne))]}),(E.length>0||W.length>0)&&s.jsxs("div",{children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{backgroundColor:"#e5e7eb",color:"#374151",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"700"},children:"TIER 3/4 - ROUTINE"}),s.jsx("span",{style:{fontSize:"13px",color:"#666"},children:ho[3].resolution})]}),[...E,...W].map((F,ne)=>s.jsxs("div",{style:{padding:"10px",backgroundColor:"#f9fafb",borderRadius:"6px",marginBottom:"6px",fontSize:"14px"},children:[s.jsx("div",{style:{fontWeight:"500"},children:F.zoneName}),s.jsx("div",{style:{color:"#666",fontSize:"13px"},children:F.checkText})]},ne))]})]}),g.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:["Observations Routed to Other Pillars (",g.length,")"]}),g.map((F,ne)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#f0f9ff",borderRadius:"8px",marginBottom:"8px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#0369a1"},children:F.categoryName}),s.jsxs("span",{style:{fontSize:"12px",backgroundColor:"#e0f2fe",color:"#0369a1",padding:"2px 6px",borderRadius:"4px"},children:[" ",F.pillar]})]}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:F.description})]},ne))]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:ee,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer",backgroundColor:"#092849",color:"#fff"},children:"Submit & Send Report "})})]})},k_=({bgWalkthrough:n})=>{const i=xe(),[r,a]=v.useState(!0),[c,d]=v.useState(null),[h,p]=v.useState(!1),g=v.useRef(!1),{getWalkthroughData:m,resetWalkthrough:x}=n,k=m(),S=v.useCallback(w=>{const j=Object.values(w.zoneRatings||{}).filter(y=>y==="GREEN").length,A=Object.values(w.zoneRatings||{}).filter(y=>y==="AMBER").length,z=Object.values(w.zoneRatings||{}).filter(y=>y==="RED").length;let D=`
WEEKLY B&G WALKTHROUGH REPORT
=============================
Campus: ${w.campus}
Date: ${w.date}
Time: ${w.time}
Auditor: ${w.auditor}
Duration: ${w.duration||"N/A"} minutes

CAMPUS RATING: ${w.campusRating||"N/A"}
=============================

ZONE SUMMARY:
- GREEN: ${j}
- AMBER: ${A}
- RED: ${z}

`;if(w.issues?.length>0){D+=`
ISSUES FOUND (${w.issues.length}):
`,D+=`-----------------------------
`;const y=w.issues.filter(E=>E.tier===1),C=w.issues.filter(E=>E.tier===2),T=w.issues.filter(E=>E.tier>2);y.length>0&&(D+=`
TIER 1 - CRITICAL (${ho[1].resolution}):
`,y.forEach(E=>{D+=`  - ${E.zoneName}: ${E.checkText}
`,E.notes&&(D+=`    Notes: ${E.notes}
`)})),C.length>0&&(D+=`
TIER 2 - HIGH-VISIBILITY (${ho[2].resolution}):
`,C.forEach(E=>{D+=`  - ${E.zoneName}: ${E.checkText}
`,E.notes&&(D+=`    Notes: ${E.notes}
`)})),T.length>0&&(D+=`
TIER 3/4 - ROUTINE:
`,T.forEach(E=>{D+=`  - ${E.zoneName}: ${E.checkText}
`,E.notes&&(D+=`    Notes: ${E.notes}
`)}))}return w.observations?.length>0&&(D+=`
OBSERVATIONS ROUTED TO OTHER PILLARS (${w.observations.length}):
`,D+=`-----------------------------
`,w.observations.forEach(y=>{D+=`  - ${y.categoryName} -> ${y.pillar}
`,D+=`    ${y.description}
`})),D+=`
-----------------------------
`,D+=`Report generated by Alpha Facilities App
`,D},[]);v.useEffect(()=>{if(g.current)return;g.current=!0,(async()=>{try{a(!0),d(null);const j=m();await e2(j);try{console.log("[BGComplete] Sending email to:",j.auditorEmail),await n2(j),console.log("[BGComplete] Email sent successfully"),p(!0)}catch(A){console.error("[BGComplete] Email failed (non-blocking):",A),p(!1)}}catch(j){console.error("Error saving B&G walkthrough:",j),d(j.message||"Failed to save walkthrough")}finally{a(!1)}})()},[m,S]);const _=()=>{x(),i("/")};return s.jsxs("div",{style:{minHeight:"100vh",background:k.campusRating==="PASS"?"linear-gradient(180deg, #059669 0%, #047857 100%)":"linear-gradient(180deg, #dc2626 0%, #b91c1c 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px 20px"},children:[s.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px"},children:r?s.jsx("div",{style:{fontSize:"48px"},children:""}):c?s.jsx("div",{style:{fontSize:"48px"},children:""}):s.jsx("div",{style:{fontSize:"48px"},children:k.campusRating==="PASS"?"":""})}),s.jsx("h1",{style:{color:"#fff",fontSize:"28px",fontWeight:"700",marginBottom:"8px",textAlign:"center"},children:r?"Saving Walkthrough...":c?"Error Saving":"Walkthrough Complete!"}),s.jsx("p",{style:{color:"rgba(255,255,255,0.9)",fontSize:"18px",marginBottom:"32px",textAlign:"center"},children:r?"Please wait...":c||`Campus ${k.campusRating||"Rating"}`}),!r&&!c&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"24px",width:"100%",maxWidth:"320px",marginBottom:"32px"},children:[s.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"4px"},children:"Campus"}),s.jsx("div",{style:{fontSize:"20px",fontWeight:"700",color:"#092849"},children:k.campus})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"20px"},children:[s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#10b981"},children:k.greenZones||0}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Green"})]}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#f59e0b"},children:k.amberZones||0}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Amber"})]}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#ef4444"},children:k.redZones||0}),s.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Red"})]})]}),s.jsxs("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"16px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{color:"#666",fontSize:"14px"},children:"Issues Found"}),s.jsx("span",{style:{fontWeight:"600",fontSize:"14px"},children:k.totalIssues||0})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{color:"#666",fontSize:"14px"},children:"Observations"}),s.jsx("span",{style:{fontWeight:"600",fontSize:"14px"},children:k.totalObservations||0})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666",fontSize:"14px"},children:"Duration"}),s.jsx("span",{style:{fontWeight:"600",fontSize:"14px"},children:k.duration?`${k.duration} min`:"N/A"})]})]}),s.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:h?"#f0fdf4":h===!1?"#fef3c7":"#f3f4f6",borderRadius:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{style:{fontSize:"20px"},children:h?"":h===!1?"":""}),s.jsx("div",{style:{fontSize:"14px",color:h?"#059669":h===!1?"#92400e":"#666"},children:h?`Report sent to ${k.auditorEmail}`:h===!1?"Email could not be sent (data saved)":"Sending email report..."})]})]}),!r&&s.jsxs("div",{style:{width:"100%",maxWidth:"320px"},children:[s.jsx("button",{onClick:_,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer",backgroundColor:"#fff",color:"#092849",marginBottom:"12px"},children:"Done"}),c&&s.jsx("button",{onClick:()=>window.location.reload(),style:{width:"100%",padding:"16px",borderRadius:"12px",fontSize:"16px",fontWeight:"600",border:"2px solid rgba(255,255,255,0.3)",cursor:"pointer",backgroundColor:"transparent",color:"#fff"},children:"Retry"})]})]})},w_=()=>{const n=xe(),{id:i}=fl(),[r,a]=v.useState(null),[c,d]=v.useState(!0);if(v.useEffect(()=>{(async()=>{try{const g=await t2(i);a(g)}catch(g){console.error("Error loading B&G walkthrough:",g)}finally{d(!1)}})()},[i]),c)return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"B&G Walkthrough",onBack:()=>n(-1)}),s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:"Loading..."})]});if(!r)return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"B&G Walkthrough",onBack:()=>n(-1)}),s.jsx("div",{style:{textAlign:"center",padding:"48px 0",color:"#9ca3af"},children:"Walkthrough not found"})]});const h=r.campusRating==="PASS";return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6"},children:[s.jsx(qe,{title:"B&G Walkthrough",onBack:()=>n(-1)}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:h?"#dcfce7":"#fee2e2",borderRadius:"16px",padding:"24px",textAlign:"center",marginBottom:"20px"},children:[s.jsx("div",{style:{fontSize:"56px",marginBottom:"12px"},children:h?"":""}),s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:h?"#166534":"#b91c1c"},children:r.campusRating||"N/A"}),s.jsxs("div",{style:{fontSize:"17px",color:h?"#166534":"#b91c1c",marginTop:"8px"},children:[r.totalIssues||0," issue",r.totalIssues!==1?"s":""," found"]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:"Walkthrough Details"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Campus"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.campus})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Auditor"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.auditor})]}),r.auditorEmail&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Email"}),s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:r.auditorEmail})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Date"}),s.jsxs("span",{style:{fontWeight:"600",color:"#092849"},children:[r.date," at ",r.time]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:"#666"},children:"Duration"}),s.jsxs("span",{style:{fontWeight:"600",color:"#092849"},children:[r.duration||"N/A"," min"]})]})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:"Zone Summary"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginBottom:"16px"},children:[s.jsxs("div",{style:{textAlign:"center",padding:"16px",backgroundColor:"#dcfce7",borderRadius:"10px"},children:[s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:"#166534"},children:r.greenZones||0}),s.jsx("div",{style:{fontSize:"14px",color:"#166534"},children:"Green"})]}),s.jsxs("div",{style:{textAlign:"center",padding:"16px",backgroundColor:"#fef3c7",borderRadius:"10px"},children:[s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:"#92400e"},children:r.amberZones||0}),s.jsx("div",{style:{fontSize:"14px",color:"#92400e"},children:"Amber"})]}),s.jsxs("div",{style:{textAlign:"center",padding:"16px",backgroundColor:"#fee2e2",borderRadius:"10px"},children:[s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:"#b91c1c"},children:r.redZones||0}),s.jsx("div",{style:{fontSize:"14px",color:"#b91c1c"},children:"Red"})]})]}),r.zoneRatings&&Object.keys(r.zoneRatings).length>0&&s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Object.entries(r.zoneRatings).map(([p,g])=>s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:g==="GREEN"?"#dcfce7":g==="AMBER"?"#fef3c7":"#fee2e2",borderRadius:"8px"},children:[s.jsx("span",{style:{fontWeight:"500",color:"#092849"},children:p}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:g==="GREEN"?"#166534":g==="AMBER"?"#92400e":"#b91c1c"},children:g})]},p))})]}),r.issues&&r.issues.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsxs("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:["Issues (",r.issues.length,")"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:r.issues.map((p,g)=>s.jsxs("div",{style:{padding:"14px",backgroundColor:p.tier===1?"#fee2e2":p.tier===2?"#fef3c7":"#f3f4f6",borderRadius:"10px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:p.zoneName||p.zoneId}),s.jsxs("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",backgroundColor:p.tier===1?"#b91c1c":p.tier===2?"#92400e":"#666",color:"#fff",fontWeight:"600"},children:["Tier ",p.tier]})]}),s.jsx("div",{style:{fontSize:"15px",color:"#333",marginBottom:"8px"},children:p.checkText}),p.notes&&s.jsxs("div",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:["Note: ",p.notes]}),p.photos&&p.photos.length>0&&s.jsx("div",{style:{display:"grid",gridTemplateColumns:p.photos.length>1?"repeat(2, 1fr)":"1fr",gap:"8px",marginTop:"12px"},children:p.photos.filter(Boolean).map((m,x)=>s.jsx("img",{src:m,alt:`Issue photo ${x+1}`,style:{width:"100%",maxHeight:p.photos.length>1?"150px":"200px",objectFit:"cover",borderRadius:"8px"}},x))})]},g))})]}),r.observations&&r.observations.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsxs("h3",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"16px"},children:["Observations (",r.observations.length,")"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:r.observations.map((p,g)=>s.jsxs("div",{style:{padding:"14px",backgroundColor:"#f0f9ff",borderRadius:"10px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[s.jsx("span",{style:{fontWeight:"600",color:"#092849"},children:p.categoryName||"Observation"}),s.jsx("span",{style:{fontSize:"12px",padding:"4px 8px",borderRadius:"6px",backgroundColor:"#0369a1",color:"#fff"},children:p.pillar||"General"})]}),s.jsx("div",{style:{fontSize:"15px",color:"#333"},children:p.description}),p.photos&&p.photos.length>0&&s.jsx("div",{style:{display:"grid",gridTemplateColumns:p.photos.length>1?"repeat(2, 1fr)":"1fr",gap:"8px",marginTop:"12px"},children:p.photos.filter(Boolean).map((m,x)=>s.jsx("img",{src:m,alt:`Observation photo ${x+1}`,style:{width:"100%",maxHeight:p.photos.length>1?"150px":"200px",objectFit:"cover",borderRadius:"8px"}},x))})]},g))})]}),s.jsx("button",{onClick:()=>n(-1),style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"16px",borderRadius:"12px",fontSize:"17px",fontWeight:"700",border:"none",cursor:"pointer",marginTop:"8px"},children:"Back to History"})]})]})},Gm=[{id:"daily",name:"Daily Security Check",icon:"",color:"#2563eb"},{id:"weekly",name:"Weekly Security Check",icon:"",color:"#7c3aed"},{id:"monthly",name:"Monthly Security Check",icon:"",color:"#059669"},{id:"annual",name:"Annual Security Check",icon:"",color:"#dc2626"}],__=({securityChecklist:n})=>{const i=xe(),[r,a]=v.useState(null),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(""),x=r?Ri[r]:null,k=()=>{if(!r){alert("Please select a checklist type");return}if(!c){alert("Please select a campus");return}if(!h.trim()){alert("Please enter your name");return}if(!g.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)){alert("Please enter a valid email address");return}const S=an.find(_=>_.name===c);n.initChecklist(c,S,h.trim(),g.trim(),r),window.scrollTo(0,0),i("/security/checklist")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Security Compliance",subtitle:"2B/2C Sustain Checklist",onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"What are you checking today? *"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:Gm.map(S=>{const _=Ri[S.id],w=r===S.id;return s.jsxs("button",{onClick:()=>a(S.id),style:{padding:"16px",borderRadius:"12px",border:w?`3px solid ${S.color}`:"2px solid #e5e7eb",backgroundColor:w?`${S.color}10`:"#fff",cursor:"pointer",textAlign:"center",transition:"all 0.2s"},children:[s.jsx("div",{style:{fontSize:"28px",marginBottom:"8px"},children:S.icon}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:w?S.color:"#333"},children:S.name}),s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:_?.timeNeeded})]},S.id)})})]}),x&&s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:[s.jsxs("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:[x.name," - What You'll Check"]}),x.sections.map((S,_)=>s.jsxs("div",{style:{padding:"10px 0",borderBottom:_<x.sections.length-1?"1px solid rgba(71, 196, 230, 0.3)":"none"},children:[s.jsx("div",{style:{fontWeight:"500",fontSize:"15px",color:"#333"},children:S.name}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"2px"},children:[S.checks.length," check",S.checks.length>1?"s":""]})]},_))]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Campus *"}),s.jsx(Xn,{value:c,onChange:d,placeholder:"Select campus..."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Name *"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:h,onChange:S=>p(S.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Email *"}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:g,onChange:S=>m(S.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Rating System"}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10b981",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#059669"},children:xn.green.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"All checks pass"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#f59e0b",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#d97706"},children:xn.amber.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Some issues found, being addressed"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#ef4444",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#dc2626"},children:xn.red.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Critical issues need immediate attention"})]})]})]}),s.jsxs("div",{style:{backgroundColor:"rgba(254, 243, 199, 0.5)",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:"Important"}),s.jsxs("div",{style:{fontSize:"14px",color:"#78350f"},children:["Some items are marked as ",s.jsx("strong",{children:"INSTANT RED"}),". If any of these fail, the campus cannot pass until fixed."]}),s.jsx("div",{style:{fontSize:"14px",color:"#78350f",marginTop:"8px"},children:'Every "No" answer requires an explanation.'})]}),s.jsx("button",{onClick:k,disabled:!r,style:{width:"100%",backgroundColor:r?"#092849":"#9ca3af",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"pointer":"not-allowed",marginTop:"8px"},children:r?`Begin ${Gm.find(S=>S.id===r)?.name}`:"Select a Checklist Type"})]})]})},j_=({securityChecklist:n,camera:i})=>{const r=xe(),[a,c]=v.useState({}),[d,h]=v.useState({}),{checklistType:p,checkResults:g,issues:m,recordZoneResults:x,addIssue:k,updateIssue:S,addPhotoToIssue:_}=n,w=Ri[p];v.useEffect(()=>{if(g&&c(()=>g),w?.sections){const B={};w.sections.forEach($=>{B[$.name]=!0}),h(()=>B)}},[p]),v.useEffect(()=>{(!n.startTime||!p)&&r("/security")},[n.startTime,p,r]);const j=(B,$)=>{c(O=>({...O,[B]:$}))},A=B=>{h($=>({...$,[B]:!$[B]}))},z=()=>w?.sections?.reduce((B,$)=>B+$.checks.length,0)||0,D=()=>Object.keys(a).filter(B=>a[B]!==void 0).length,y=D()===z(),T=(()=>{const B=[];return w?.sections?.forEach($=>{$.checks.forEach(O=>{a[O.id]===!1&&B.push({...O,section:$.name})})}),B})(),E=T.every(B=>{const $=m.find(O=>O.checkId===B.id);return!(!$||!$.explanation||$.explanation.trim()===""||es(B.id)&&(!$.photos||$.photos.length===0))}),W=T.length===0&&y,M=y&&(W||E),K=B=>{let $=m.find(q=>q.checkId===B.id),O=$?.id;if(!$){const q={checklistType:p,checklistName:w.name,checkId:B.id,checkText:B.text,section:B.section,instantRed:oo(B.id),photoRequired:es(B.id),photos:[],explanation:""};O=k(q)}i.openCamera(q=>{q&&O&&_(O,q)})},ee=(B,$)=>{const O=m.find(q=>q.id===B);if(O){const q=O.photos.filter((Z,re)=>re!==$);S(B,{photos:q})}},F=(B,$)=>{let O=m.find(q=>q.checkId===B);if(O)S(O.id,{explanation:$.slice(0,500)});else{const q=T.find(Z=>Z.id===B);q&&k({checklistType:p,checklistName:w.name,checkId:q.id,checkText:q.text,section:q.section,instantRed:oo(q.id),photoRequired:es(q.id),photos:[],explanation:$.slice(0,500)})}},ne=()=>{x(p,a),T.forEach(B=>{m.find(O=>O.checkId===B.id)||k({checklistType:p,checklistName:w.name,checkId:B.id,checkText:B.text,section:B.section,instantRed:oo(B.id),photoRequired:es(B.id),photos:[],explanation:""})}),r("/security/summary")},se=()=>{r("/security")};return w?s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"120px"},children:[s.jsx("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",color:"#fff",padding:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("button",{onClick:se,style:{fontSize:"24px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff"},children:""}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",margin:0},children:w.name}),s.jsx("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:n.campus})]}),s.jsx("div",{style:{width:"40px"}})]})}),s.jsxs("div",{style:{backgroundColor:"#fff",padding:"12px 20px",borderBottom:"1px solid #e5e7eb"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"Progress"}),s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#092849"},children:[D()," / ",z()]})]}),s.jsx("div",{style:{height:"8px",backgroundColor:"#e5e7eb",borderRadius:"4px",overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",width:`${D()/z()*100}%`,backgroundColor:y?"#10b981":"#2563eb",borderRadius:"4px",transition:"width 0.3s"}})})]}),s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.5)",borderLeft:"4px solid #2B57D0",padding:"14px 16px",margin:"16px 20px",borderRadius:"8px"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#141685"},children:w.description}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"4px"},children:["Estimated time: ",w.timeNeeded]})]}),s.jsxs("div",{style:{padding:"0 20px"},children:[w.sections?.map(B=>s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsxs("button",{onClick:()=>A(B.name),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",backgroundColor:"#092849",color:"#fff",borderRadius:d[B.name]?"12px 12px 0 0":"12px",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:[s.jsx("span",{children:B.name}),s.jsx("span",{style:{transform:d[B.name]?"rotate(180deg)":"rotate(0)",transition:"transform 0.2s"},children:""})]}),d[B.name]&&B.description&&s.jsx("div",{style:{backgroundColor:"#f9fafb",padding:"12px 16px",borderLeft:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb",fontSize:"14px",color:"#666"},children:B.description}),d[B.name]&&s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0 0 12px 12px",border:"1px solid #e5e7eb",borderTop:B.description?"none":"1px solid #e5e7eb"},children:B.checks.map(($,O)=>{const q=a[$.id],Z=m.find(I=>I.checkId===$.id),re=oo($.id),ae=es($.id);return s.jsxs("div",{style:{padding:"16px",borderBottom:O<B.checks.length-1?"1px solid #e5e7eb":"none"},children:[re&&s.jsx("div",{style:{display:"inline-block",backgroundColor:"#fee2e2",color:"#dc2626",fontSize:"11px",fontWeight:"700",padding:"2px 8px",borderRadius:"4px",marginBottom:"8px"},children:"INSTANT RED IF NO"}),s.jsx("div",{style:{fontSize:"15px",marginBottom:"8px",color:"#333",lineHeight:"1.4"},children:$.text}),$.helpText&&s.jsx("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px",fontStyle:"italic"},children:$.helpText}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("button",{onClick:()=>j($.id,!0),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:q===!0?"#10b981":"#f3f4f6",color:q===!0?"#fff":"#333"},children:" Yes"}),s.jsx("button",{onClick:()=>j($.id,!1),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:q===!1?"#ef4444":"#f3f4f6",color:q===!1?"#fff":"#333"},children:" No"})]}),q===!1&&s.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",border:"1px solid #fecaca"},children:[s.jsxs("div",{style:{marginBottom:ae?"12px":"0"},children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:"#b91c1c",marginBottom:"6px"},children:"Explanation Required *"}),s.jsx("textarea",{value:Z?.explanation||"",onChange:I=>F($.id,I.target.value),placeholder:"Describe what was found and why it failed...",maxLength:500,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #fca5a5",fontSize:"14px",resize:"none",minHeight:"70px",fontFamily:"inherit",boxSizing:"border-box"}})]}),ae&&s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:"#b91c1c",marginBottom:"6px"},children:"Photo Required *"}),Z?.photos?.length>0&&s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginBottom:"8px"},children:Z.photos.map((I,U)=>s.jsxs("div",{style:{position:"relative"},children:[s.jsx("img",{src:I,alt:`Issue ${U+1}`,style:{width:"100%",height:"80px",borderRadius:"6px",objectFit:"cover"}}),s.jsx("button",{onClick:()=>ee(Z.id,U),style:{position:"absolute",top:"2px",right:"2px",backgroundColor:"#ef4444",color:"#fff",width:"20px",height:"20px",borderRadius:"50%",border:"none",cursor:"pointer",fontSize:"12px",fontWeight:"700"},children:""})]},U))}),s.jsxs("button",{onClick:()=>K({...$,section:B.name}),style:{width:"100%",padding:"10px",border:"2px dashed #fca5a5",borderRadius:"6px",backgroundColor:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[s.jsx("span",{children:""}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#b91c1c"},children:Z?.photos?.length>0?"Add Another Photo":"Take Photo"})]})]})]})]},$.id)})})]},B.name)),y&&W&&s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginTop:"16px",border:"2px solid #10b981"},children:s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#059669"},children:" All checks passed!"})}),y&&!W&&!E&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginTop:"16px",border:"2px solid #f59e0b"},children:[s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#d97706"},children:" Please complete all issue documentation"}),s.jsxs("div",{style:{fontSize:"13px",color:"#78350f",marginTop:"4px"},children:['Every "No" answer needs an explanation',T.some(B=>es(B.id))?" and photo where required":"","."]})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:ne,disabled:!M,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:M?"pointer":"not-allowed",backgroundColor:M?"#092849":"#d1d5db",color:M?"#fff":"#9ca3af"},children:y?!E&&!W?"Complete All Issue Documentation":"Submit Report ":`Answer All Questions (${D()}/${z()})`})})]}):null},C_=async n=>{const{date:i,time:r,campus:a,campusData:c,auditor:d,auditorEmail:h,duration:p,zoneResults:g,zoneRatings:m,overallRating:x,issues:k,totalIssues:S,openIssues:_,instantRedIssues:w,startTime:j,endTime:A}=n,{data:z,error:D}=await ct.from("security_audits").insert([{date:i,time:r,campus:a,campus_data:c,auditor:d,auditor_email:h,duration:p,zone_results:g,zone_ratings:m,overall_rating:x,issues:k,total_issues:S,open_issues:_,instant_red_issues:w,start_time:j,end_time:A}]).select();if(D)throw console.error("Error saving security audit:",D),D;return z[0]},R_=({securityChecklist:n})=>{const i=xe(),[r,a]=v.useState(!1),{campus:c,auditor:d,auditorEmail:h,startTime:p,checklistType:g,issues:m,completeChecklist:x}=n,k=Ri[g],S=v.useMemo(()=>{if(!p)return null;const y=new Date(p),T=new Date-y,E=Math.round(T/6e4),W=Math.floor(E/60),M=E%60;return{total:E,hours:W,mins:M}},[p]),w=v.useMemo(()=>x(),[x])?.rating,j=m.filter(y=>y.instantRed),A=m.filter(y=>!y.instantRed),z=y=>{switch(y){case"GREEN":return"#10b981";case"AMBER":return"#f59e0b";case"RED":return"#ef4444";default:return"#6b7280"}},D=async()=>{a(!0);try{const y=n.getChecklistData();if(await C_(y),zi(c))try{console.log("[SecuritySummary] Creating consolidated Wrike task...");const C=m.map(T=>({category:T.instantRed?" Instant Red":"Issue",section:T.section,check:T.checkText,description:T.explanation||"Issue found",photos:T.photos||[]}));await ds({checklistType:"Security Checklist",campusName:c,auditorName:d,auditorEmail:h,issues:C,date:new Date().toLocaleDateString()}),console.log("[SecuritySummary] Wrike task created")}catch(C){console.error("[SecuritySummary] Wrike error:",C)}i("/security/complete")}catch(y){console.error("Error saving security audit:",y),alert("Error saving audit. Please try again.")}finally{a(!1)}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsxs("div",{style:{background:w==="GREEN"?"linear-gradient(180deg, #059669 0%, #047857 100%)":w==="AMBER"?"linear-gradient(180deg, #d97706 0%, #b45309 100%)":"linear-gradient(180deg, #dc2626 0%, #b91c1c 100%)",color:"#fff",padding:"30px 20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:w==="GREEN"?"":w==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",margin:"0 0 8px 0"},children:w==="GREEN"?xn.green.description:w==="AMBER"?xn.amber.description:xn.red.description}),s.jsx("p",{style:{fontSize:"16px",opacity:.9,margin:0},children:k?.name||g}),s.jsxs("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:[c," - Completed by ",d]}),S&&s.jsxs("div",{style:{marginTop:"12px",backgroundColor:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"8px 16px",display:"inline-block"},children:[s.jsx("span",{style:{fontSize:"14px",opacity:.9},children:"Duration: "}),s.jsx("span",{style:{fontSize:"16px",fontWeight:"700"},children:S.hours>0?`${S.hours}h ${S.mins}m`:`${S.mins} minutes`})]})]}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:`2px solid ${z(w)}`,textAlign:"center"},children:[s.jsx("div",{style:{display:"inline-block",padding:"12px 32px",borderRadius:"8px",backgroundColor:z(w),color:"#fff",fontSize:"24px",fontWeight:"700"},children:w}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"12px"},children:m.length===0?"All checks passed!":`${m.length} issue${m.length>1?"s":""} found`})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:"Rating Breakdown:"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:j.length===0?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:j.length===0?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["No Instant RED items failed (",j.length," found)"]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:m.length<=xn.amber.maxOpenIssues?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:m.length<=xn.amber.maxOpenIssues?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["",xn.amber.maxOpenIssues," open issues (",m.length," total)"]})]})]}),j.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"2px solid #ef4444"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#dc2626"},children:[" Instant RED Issues (",j.length,")"]}),s.jsx("div",{style:{fontSize:"13px",color:"#b91c1c",marginBottom:"12px"},children:"These issues prevent passing until fixed."}),j.map((y,C)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#b91c1c"},children:y.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:y.checkText}),y.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",y.explanation]}),y.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:y.photos.map((T,E)=>s.jsx("img",{src:T,alt:`Issue ${E+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},E))})]},C))]}),A.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:["Other Issues (",A.length,")"]}),A.map((y,C)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef3c7",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e"},children:y.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:y.checkText}),y.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",y.explanation]}),y.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:y.photos.map((T,E)=>s.jsx("img",{src:T,alt:`Issue ${E+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},E))})]},C))]}),m.length===0&&s.jsxs("div",{style:{backgroundColor:"#f0fdf4",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #10b981",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:""}),s.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#059669"},children:"No Issues Found!"}),s.jsx("div",{style:{fontSize:"14px",color:"#065f46",marginTop:"4px"},children:"All security checks passed."})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:D,disabled:r,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"not-allowed":"pointer",backgroundColor:r?"#9ca3af":"#092849",color:"#fff"},children:r?"Submitting...":"Submit Report "})})]})},E_=({securityChecklist:n})=>{const i=xe(),{campus:r,overallRating:a,issues:c}=n,d=c.filter(g=>g.instantRed).length,h=()=>{n.resetChecklist(),i("/")},p=()=>{n.resetChecklist(),i("/security")};return s.jsx("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px"},children:s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"40px 30px",textAlign:"center",maxWidth:"400px",width:"100%",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:[s.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:a==="GREEN"?"":a==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"#092849",margin:"0 0 12px 0"},children:"Checklist Submitted!"}),s.jsxs("p",{style:{fontSize:"16px",color:"#666",margin:"0 0 24px 0"},children:[r," security checklist has been saved."]}),s.jsxs("div",{style:{display:"inline-block",padding:"12px 24px",borderRadius:"8px",marginBottom:"24px",backgroundColor:a==="GREEN"?"#f0fdf4":a==="AMBER"?"#fef3c7":"#fee2e2",border:`2px solid ${a==="GREEN"?"#10b981":a==="AMBER"?"#f59e0b":"#ef4444"}`},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"4px"},children:"Overall Rating"}),s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:a==="GREEN"?"#059669":a==="AMBER"?"#d97706":"#dc2626"},children:a})]}),c.length>0&&s.jsxs("div",{style:{backgroundColor:"#f9fafb",borderRadius:"8px",padding:"16px",marginBottom:"24px",textAlign:"left"},children:[s.jsxs("div",{style:{fontSize:"14px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:["Issues Reported: ",c.length]}),d>0&&s.jsxs("div",{style:{fontSize:"13px",color:"#dc2626"},children:[" ",d," Instant RED item",d>1?"s":""]}),c.length-d>0&&s.jsxs("div",{style:{fontSize:"13px",color:"#d97706"},children:[" ",c.length-d," other issue",c.length-d>1?"s":""]})]}),s.jsxs("div",{style:{backgroundColor:"#eff6ff",borderRadius:"8px",padding:"16px",marginBottom:"24px",textAlign:"left"},children:[s.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#1e40af",marginBottom:"8px"},children:"Next Steps"}),s.jsx("div",{style:{fontSize:"13px",color:"#1e3a8a"},children:c.length>0?"Assign owners and fix dates to all issues within 45 days to maintain Amber status or improve to Green.":"Continue completing daily checks to maintain World Class status."})]}),s.jsx("button",{onClick:h,style:{width:"100%",padding:"16px",backgroundColor:"#092849",color:"#fff",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"600",cursor:"pointer",marginBottom:"12px"},children:"Done"}),s.jsx("button",{onClick:p,style:{width:"100%",padding:"16px",backgroundColor:"#f3f4f6",color:"#333",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"Start Another Checklist"})]})})},yn={green:{description:"World Class"},amber:{description:"At Risk",maxOpenIssues:3,maxDaysToFix:45},red:{description:"Not Meeting Standard"}},T_=["weekly_safety_hazards","monthly_ergonomic_chairs_height","monthly_ergonomic_desks_height","monthly_safety_sharp_edges","weekly_biophilic_plants_healthy","weekly_handwritten_signs","weekly_furniture_misaligned","weekly_visible_garbage"],A_=["daily_vip_glass_clean","daily_vip_branding_lit","daily_vip_bathrooms","daily_capacity_overflow","weekly_condition_damage","weekly_condition_stains","weekly_safety_hazards","monthly_desks_condition","monthly_chairs_condition","monthly_safety_sharp_edges","monthly_brand_signage","monthly_brand_wall_damage","monthly_lighting_burnt_out","monthly_flooring_damage","quarterly_special_spaces_condition"],Ei={daily:{id:"daily",name:"Daily Pulse Checks",frequency:"daily",order:1,description:"Ensure the 3 C's are intact and check for immediate capacity friction",timeNeeded:"20-25 minutes",persona:"Guide or Facilities Staff",sections:[{name:"A. VIP Ready Pulse (Curb Appeal & Workspace Setup)",description:"Walk through main entrance and common areas to verify VIP readiness.",checks:[{id:"daily_vip_glass_clean",text:"Is exterior glass and handles smudge-free? Is there no litter at the doorstep or in parking stalls?",helpText:"Entrance Check",tier:"amber",photoRequired:!0},{id:"daily_vip_scent_active",text:"Is the signature scent active and detectable at the main entrance?",helpText:"The Scent",tier:"amber",photoRequired:!1},{id:"daily_vip_branding_lit",text:"Is branding signage illuminated and visible from the street?",helpText:"First Look",tier:"amber",photoRequired:!0},{id:"daily_vip_power_hubs",text:"Are all coworking power hubs accessible?",helpText:"Tech-Check",tier:"amber",photoRequired:!1},{id:"daily_vip_lighting_preset",text:"Is smart lighting set to the morning light preset?",helpText:"Tech-Check",tier:"amber",photoRequired:!1},{id:"daily_vip_furniture_tucked",text:"Are chairs tucked in and lounge furniture straightened from the previous evening's use?",helpText:"Furniture Alignment",tier:"amber",photoRequired:!1},{id:"daily_vip_no_clutter",text:'Is there no abandoned "temp" signage, loose cables, or left-behind items in common areas?',helpText:"Clutter Control",tier:"amber",photoRequired:!1},{id:"daily_vip_temperature",text:"Is the temperature set to the brand standard (not too cold/hot)?",helpText:"Climate",tier:"amber",photoRequired:!1},{id:"daily_vip_bathrooms",text:"Are mirrors spotless, surfaces dry, and high-end consumables stocked in the bathrooms?",helpText:"Bathrooms - VIP Standard",tier:"amber",photoRequired:!0},{id:"daily_vip_biophilic",text:"Are there no visible fallen leaves or stagnant water in interior garden features?",helpText:"Biophilic Check",tier:"amber",photoRequired:!1},{id:"daily_vip_bins_empty",text:"Are all garbage and sanitary bins empty and liners hidden?",helpText:"Refuse",tier:"amber",photoRequired:!1}]},{name:'B. Capacity Pulse (The "Friction" Check)',description:"Performed during peak hours to identify capacity issues.",checks:[{id:"daily_capacity_10_percent_open",text:"Is there at least 10% open seating in every zone?",helpText:'If 0%, the "Luxury" experience is failing.',tier:"amber",photoRequired:!1},{id:"daily_capacity_rooms_intended_use",text:'Are students using rooms as intended? (e.g., Is a "Quiet Study" room being used for loud "Rec" because the Rec area is full?)',helpText:"Check for cross-usage due to capacity issues",tier:"amber",photoRequired:!1},{id:"daily_capacity_outlet_crowding",text:"Are students huddled around specific outlets because others are broken or poorly placed?",helpText:"Outlet distribution check",tier:"amber",photoRequired:!1},{id:"daily_capacity_overflow",text:'Are students sitting on floors or "non-seat" surfaces (planters, stairs)?',helpText:'The "Overflow" Check',tier:"amber",photoRequired:!0}]}]},weekly:{id:"weekly",name:"Weekly Pulse Checks",frequency:"weekly",order:2,description:"Quick visual scan of furniture condition and strategic usage, plus a quality audit of the high-end experience",timeNeeded:"30-40 minutes",persona:"Guide or Facilities Staff",sections:[{name:"A. Furniture Condition, Usage, and Safety",description:"Walk through main areas and assess furniture condition and safety.",checks:[{id:"weekly_condition_damage",text:"Is furniture in good overall condition (no visible damage or excessive wear)?",helpText:"Examples: broken parts, cracks, peeling laminate, heavy fading, major scratches.",tier:"amber",photoRequired:!0},{id:"weekly_condition_stains",text:"Is upholstered/soft seating free of visible stains or odors?",helpText:"Includes sofas, cushions, fabric chairs, lounge seating.",tier:"amber",photoRequired:!0},{id:"weekly_condition_functional",text:"Is furniture functional as intended?",helpText:"Examples: drawers open/close, chairs roll/adjust, tables stable, shelves/cabinets open safely.",tier:"amber",photoRequired:!1},{id:"weekly_safety_hazards",text:"Are there any furniture safety hazards?",helpText:"Examples: wobbling chairs, unstable shelving, sharp edges, broken wheels, exposed nails/screws, tip risk.",tier:"red",instantRed:!0,photoRequired:!0},{id:"weekly_furniture_appropriate_use",text:"Is furniture appropriate and used as intended for the space?",helpText:'Examples: desks used for work, seating supports the activity, no "workarounds" (students sitting on floors because chairs unusable).',tier:"amber",photoRequired:!1},{id:"weekly_furniture_arrangement",text:"Is furniture arranged to support instruction and movement?",helpText:"Examples: collaboration areas exist, quiet/focus areas exist, pathways are clear.",tier:"amber",photoRequired:!1}]},{name:"B. Luxury-Tech Standards (Quality Audit)",description:"Quality audit of the high-end experience elements.",checks:[{id:"weekly_branding_signage_clean",text:"Is exterior branding signage clean, lit (if applicable), and unobstructed?",helpText:"Check all exterior brand elements",tier:"amber",photoRequired:!1},{id:"weekly_scent_functioning",text:"Is the signature scent present and functioning at entry (not missing, not overpowering)?",helpText:"Scent should be subtle but detectable",tier:"amber",photoRequired:!1},{id:"weekly_entry_lighting",text:'Is entry lighting set to the approved brightness/scene ("Welcome" scene)?',helpText:"Check lighting presets are correct",tier:"amber",photoRequired:!1},{id:"weekly_wayfinding_signs",text:"Are wayfinding/directional signs clean and clearly readable?",helpText:"All directional and informational signage",tier:"amber",photoRequired:!1},{id:"weekly_smart_lighting_scenes",text:"Are smart lighting scenes functioning correctly (no failed zones, correct scene active)?",helpText:"Test all lighting zones",tier:"amber",photoRequired:!1},{id:"weekly_forgotten_spots_clean",text:'Are "forgotten spots" clean and intact (ceilings, corners, acoustic panels - no dust or damage)?',helpText:"Check areas often overlooked in daily cleaning",tier:"amber",photoRequired:!1},{id:"weekly_furniture_reset",text:"Is furniture reset to the approved layout (no drift, clear pathways)?",helpText:"Compare to original layout design",tier:"amber",photoRequired:!1},{id:"weekly_biophilic_plants_healthy",text:"Are plants healthy and presentable (no dead leaves, not dusty)?",helpText:"Dead or dying plants are an INSTANT RED",tier:"red",instantRed:!0,photoRequired:!1},{id:"weekly_bins_bathrooms_clean",text:"Are bins emptied/discreet and bathrooms clean + fully stocked (soap/paper/scent items)?",helpText:"Full bathroom and refuse check",tier:"amber",photoRequired:!1}]},{name:'C. Capacity Deep-Dive (The "Strategy" Check)',description:"Please consult with your CC and Lead Guide on the below.",checks:[{id:"weekly_capacity_furniture_count_matches",text:"Does the furniture count in every room type (Learning, Rec, Social) match the original design blueprint?",helpText:"Inventory vs. Intent",tier:"amber",photoRequired:!1},{id:"weekly_capacity_dead_zones_identified",text:'Have "Dead Zones" (under-utilized rooms) vs. "Hot Zones" (over-crowded) been identified to inform furniture movement?',helpText:"Zone Balance",tier:"amber",photoRequired:!1},{id:"weekly_capacity_rec_surface_space",text:'Are "Rec" areas providing enough surface space for "Learning" if students are cross-using the space?',helpText:"Furniture Versatility",tier:"amber",photoRequired:!1},{id:"weekly_capacity_high_traffic_integrity",text:"Has high-traffic seating been checked for structural integrity (as over-capacity leads to faster degradation)?",helpText:"Wear & Tear per Capita",tier:"amber",photoRequired:!1},{id:"weekly_capacity_new_level_activity",text:"Do you have a new learning level starting soon? Or some form of new activity starting soon? (i.e., something that would drive the need for a new space)",helpText:"Planning for capacity changes",tier:"amber",photoRequired:!1}]}]},monthly:{id:"monthly",name:"Monthly Condition Scan",frequency:"monthly",order:3,description:"Detailed assessment of furniture condition and environment",timeNeeded:"45-60 minutes",persona:"Facilities Staff",sections:[{name:"A. Detailed Furniture Assessment",description:"Thoroughly check each furniture category.",checks:[{id:"monthly_desks_condition",text:"Are all desks/tables in good condition?",helpText:"Surfaces smooth, legs stable, no wobble",tier:"amber",photoRequired:!0},{id:"monthly_chairs_condition",text:"Are all chairs in good condition?",helpText:"Seats intact, backs secure, wheels working",tier:"amber",photoRequired:!0},{id:"monthly_storage_condition",text:"Are all storage units in good condition?",helpText:"Shelves secure, doors close properly, drawers slide",tier:"amber",photoRequired:!1},{id:"monthly_soft_seating_condition",text:"Is soft seating in good condition?",helpText:"Sofas, lounge chairs - cushions intact, no sagging",tier:"amber",photoRequired:!1}]},{name:"B. Ergonomic Standards",description:"Verify furniture meets ergonomic requirements.",checks:[{id:"monthly_ergonomic_chairs_height",text:"Do work chairs have appropriate height?",helpText:"Required for proper posture",tier:"red",instantRed:!0,photoRequired:!1},{id:"monthly_ergonomic_desks_height",text:"Are desks at appropriate working height?",helpText:"Standard 28-30 inches or adjustable",tier:"red",instantRed:!0,photoRequired:!1},{id:"monthly_ergonomic_monitor_space",text:"Is there appropriate space for monitor placement?",helpText:"Desk depth allows proper eye distance",tier:"amber",photoRequired:!1},{id:"monthly_ergonomic_keyboard_space",text:"Is there adequate space for keyboard/mouse?",helpText:"Comfortable arm position possible",tier:"amber",photoRequired:!1}]},{name:"C. Safety Detailed Check",description:"Thorough safety inspection of all furniture.",checks:[{id:"monthly_safety_sharp_edges",text:"Is all furniture free of sharp edges or exposed hardware?",helpText:"No protruding screws, sharp corners, rough edges",tier:"red",instantRed:!0,photoRequired:!0},{id:"monthly_safety_weight_limits",text:"Is furniture being used within weight limits?",helpText:"Shelving not overloaded, chairs appropriate for users",tier:"amber",photoRequired:!1},{id:"monthly_safety_tip_hazards",text:"Are tall items secured against tipping?",helpText:"Bookcases, tall shelving units anchored if needed",tier:"amber",photoRequired:!1}]},{name:"D. Decor & Brand Standards",description:"Check environmental and brand elements.",checks:[{id:"monthly_brand_signage",text:"Is all signage in good condition?",helpText:"Not faded, peeling, or damaged",tier:"amber",photoRequired:!0},{id:"monthly_brand_colors_consistent",text:"Are brand colors consistent throughout?",helpText:"Matches Alpha Schools brand guidelines",tier:"amber",photoRequired:!1},{id:"monthly_brand_wall_damage",text:"Are walls free of damage and marks?",helpText:"No holes, scuffs, or unauthorized postings",tier:"amber",photoRequired:!0}]},{name:"E. Lighting & Environment",description:"Check environmental comfort factors.",checks:[{id:"monthly_lighting_adequate",text:"Is lighting adequate for all work areas?",helpText:"No dark spots, appropriate brightness",tier:"amber",photoRequired:!1},{id:"monthly_lighting_burnt_out",text:"Are all lights working (no burnt out bulbs)?",helpText:"Check overhead and task lighting",tier:"amber",photoRequired:!0},{id:"monthly_flooring_condition",text:"Is flooring in good condition?",helpText:"No tears, stains, or trip hazards",tier:"amber",photoRequired:!1},{id:"monthly_flooring_damage",text:"Is flooring free of damage needing repair?",helpText:"No loose tiles, carpet edges, or cracks",tier:"amber",photoRequired:!0}]}]},quarterly:{id:"quarterly",name:"Quarterly Deep Review",frequency:"quarterly",order:4,description:"Comprehensive review including satisfaction and special spaces",timeNeeded:"60-90 minutes",persona:"Facilities Manager",sections:[{name:"A. Satisfaction Review",description:"Review feedback from guides and students.",checks:[{id:"quarterly_satisfaction_guide_reviewed",text:"Has guide satisfaction feedback been reviewed?",helpText:"Check survey results or gather informal feedback",tier:"amber",photoRequired:!1},{id:"quarterly_satisfaction_guide_positive",text:"Is guide satisfaction with furniture positive (4+ rating)?",helpText:"Based on recent surveys or feedback",tier:"amber",photoRequired:!1},{id:"quarterly_satisfaction_student_reviewed",text:"Has student satisfaction feedback been reviewed?",helpText:"Check survey results or gather informal feedback",tier:"amber",photoRequired:!1},{id:"quarterly_satisfaction_student_positive",text:"Is student satisfaction with furniture positive (4+ rating)?",helpText:"Based on recent surveys or feedback",tier:"amber",photoRequired:!1}]},{name:"B. Special Spaces",description:"Review specialized areas and their unique furniture needs.",checks:[{id:"quarterly_special_spaces_identified",text:"Are all special spaces identified and documented?",helpText:"Labs, maker spaces, quiet rooms, collaboration zones",tier:"amber",photoRequired:!1},{id:"quarterly_special_spaces_condition",text:"Is specialized furniture in these spaces in good condition?",helpText:"Lab tables, maker benches, lounge furniture",tier:"amber",photoRequired:!0},{id:"quarterly_special_spaces_appropriate",text:"Is furniture appropriate for each space type?",helpText:"Matches the intended use of the space",tier:"amber",photoRequired:!1}]},{name:"C. Biophilic & Comfort Elements",description:"Check elements that enhance wellbeing.",checks:[{id:"quarterly_biophilic_natural_light",text:"Is natural light being maximized?",helpText:"Blinds open when appropriate, windows unobstructed",tier:"amber",photoRequired:!1},{id:"quarterly_comfort_noise",text:"Are noise levels appropriate for each space?",helpText:"Quiet zones are quiet, collaboration spaces have acoustic management",tier:"amber",photoRequired:!1}]},{name:"D. Replacement Planning",description:"Identify items that may need replacement.",checks:[{id:"quarterly_replacement_identified",text:"Have items needing replacement been identified?",helpText:"Track items past useful life or beyond repair",tier:"amber",photoRequired:!1},{id:"quarterly_replacement_documented",text:"Are replacement needs documented and prioritized?",helpText:"List with estimated costs and urgency",tier:"amber",photoRequired:!1},{id:"quarterly_replacement_budget",text:"Is there a plan/budget for necessary replacements?",helpText:"Included in facilities planning",tier:"amber",photoRequired:!1}]}]},annual:{id:"annual",name:"Annual Comprehensive Review",frequency:"annual",order:5,description:"Full inventory and strategic planning review",timeNeeded:"2-3 hours",persona:"Facilities Manager + Leadership",sections:[{name:"A. Inventory Verification",description:"Verify furniture inventory is accurate and complete.",checks:[{id:"annual_inventory_exists",text:"Does a complete furniture inventory exist?",helpText:"List of all furniture items by location",tier:"amber",photoRequired:!1},{id:"annual_inventory_accurate",text:"Has the inventory been verified against actual items?",helpText:"Walk-through confirms inventory matches reality",tier:"amber",photoRequired:!1},{id:"annual_inventory_ages_tracked",text:"Are furniture ages/purchase dates tracked?",helpText:"Know when items were acquired for replacement planning",tier:"amber",photoRequired:!1}]},{name:"B. Vendor & Warranty Review",description:"Review vendor relationships and warranty coverage.",checks:[{id:"annual_warranty_tracked",text:"Are warranties tracked and documented?",helpText:"Know what is still under warranty",tier:"amber",photoRequired:!1},{id:"annual_vendor_performance",text:"Has vendor performance been reviewed?",helpText:"Quality, delivery, service satisfaction",tier:"amber",photoRequired:!1},{id:"annual_vendor_contracts_current",text:"Are vendor contracts current and competitive?",helpText:"Reviewed within last 12 months",tier:"amber",photoRequired:!1}]},{name:"C. Strategic Planning",description:"Long-term furniture and environment planning.",checks:[{id:"annual_strategy_refresh_plan",text:"Is there a furniture refresh/replacement plan?",helpText:"Multi-year plan for systematic updates",tier:"amber",photoRequired:!1},{id:"annual_strategy_budget_adequate",text:"Is annual furniture budget adequate?",helpText:"Covers maintenance, repairs, and planned replacements",tier:"amber",photoRequired:!1},{id:"annual_strategy_standards_documented",text:"Are furniture standards documented?",helpText:"Approved brands, specs, and requirements for new purchases",tier:"amber",photoRequired:!1}]},{name:"D. Compliance & Accessibility",description:"Ensure furniture meets compliance requirements.",checks:[{id:"annual_compliance_ada",text:"Does furniture meet ADA accessibility requirements?",helpText:"Accessible seating, appropriate heights, clearances",tier:"amber",photoRequired:!1},{id:"annual_compliance_fire_code",text:"Does furniture arrangement meet fire code?",helpText:"Clear pathways, proper egress, fire-rated materials",tier:"amber",photoRequired:!1},{id:"annual_compliance_certifications",text:"Is furniture from certified/approved manufacturers?",helpText:"BIFMA, GREENGUARD, or equivalent certifications",tier:"amber",photoRequired:!1}]}]}},z_=n=>{const i=Ei[n];return!i||!i.sections?[]:i.sections.flatMap(r=>r.checks.map(a=>({...a,section:r.name})))},Eu=n=>T_.includes(n),Qx=n=>A_.includes(n),D_=(n,i,r)=>{const c=z_(n).filter(x=>i[x.id]===!1);if(c.length===0)return"GREEN";if(c.some(x=>x.instantRed))return"RED";const h=r.filter(x=>x.status==="open");if(h.length>yn.amber.maxOpenIssues||h.some(x=>!x.owner||!x.fixDate))return"RED";const g=new Date;return h.some(x=>{const k=new Date(x.createdAt);return Math.floor((g-k)/(1e3*60*60*24))>yn.amber.maxDaysToFix})?"RED":"AMBER"},Vm=[{id:"daily",name:"Daily Pulse Checks",icon:"",color:"#f97316"},{id:"weekly",name:"Weekly Pulse Checks",icon:"",color:"#2563eb"},{id:"monthly",name:"Monthly Condition Scan",icon:"",color:"#7c3aed"},{id:"quarterly",name:"Quarterly Deep Review",icon:"",color:"#059669"},{id:"annual",name:"Annual Comprehensive",icon:"",color:"#dc2626"}],O_=({furnitureChecklist:n})=>{const i=xe(),[r,a]=v.useState(null),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(""),x=r?Ei[r]:null,k=()=>{if(!r){alert("Please select a checklist type");return}if(!c){alert("Please select a campus");return}if(!h.trim()){alert("Please enter your name");return}if(!g.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)){alert("Please enter a valid email address");return}const S=an.find(_=>_.name===c);n.initChecklist(c,S,h.trim(),g.trim(),r),window.scrollTo(0,0),i("/furniture/checklist")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Furniture & Decor",subtitle:"14.08 Quality Bar",onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"What are you checking today? *"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:Vm.map(S=>{const _=Ei[S.id],w=r===S.id;return s.jsxs("button",{onClick:()=>a(S.id),style:{padding:"16px",borderRadius:"12px",border:w?`3px solid ${S.color}`:"2px solid #e5e7eb",backgroundColor:w?`${S.color}10`:"#fff",cursor:"pointer",textAlign:"center",transition:"all 0.2s"},children:[s.jsx("div",{style:{fontSize:"28px",marginBottom:"8px"},children:S.icon}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:w?S.color:"#333"},children:S.name}),s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:_?.timeNeeded})]},S.id)})})]}),x&&s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:[s.jsxs("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"8px"},children:[x.name," - What You'll Check"]}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px"},children:["Best done by: ",x.persona]}),x.sections.map((S,_)=>s.jsxs("div",{style:{padding:"10px 0",borderBottom:_<x.sections.length-1?"1px solid rgba(71, 196, 230, 0.3)":"none"},children:[s.jsx("div",{style:{fontWeight:"500",fontSize:"15px",color:"#333"},children:S.name}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"2px"},children:[S.checks.length," check",S.checks.length>1?"s":""]})]},_))]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Campus *"}),s.jsx(Xn,{value:c,onChange:d,placeholder:"Select campus..."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Name *"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:h,onChange:S=>p(S.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Email *"}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:g,onChange:S=>m(S.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Rating System"}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10b981",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#059669"},children:yn.green.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"All checks pass, furniture in excellent condition"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#f59e0b",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#d97706"},children:yn.amber.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Some issues found, being addressed"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#ef4444",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#dc2626"},children:yn.red.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Critical issues need immediate attention"})]})]})]}),s.jsxs("div",{style:{backgroundColor:"rgba(254, 243, 199, 0.5)",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:"Important"}),s.jsxs("div",{style:{fontSize:"14px",color:"#78350f"},children:["Some items are marked as ",s.jsx("strong",{children:"INSTANT RED"})," (safety hazards, ergonomic requirements). If any of these fail, the campus cannot pass until fixed."]}),s.jsx("div",{style:{fontSize:"14px",color:"#78350f",marginTop:"8px"},children:'Every "No" answer requires an explanation.'})]}),s.jsx("button",{onClick:k,disabled:!r,style:{width:"100%",backgroundColor:r?"#092849":"#9ca3af",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"pointer":"not-allowed",marginTop:"8px"},children:r?`Begin ${Vm.find(S=>S.id===r)?.name}`:"Select a Checklist Type"})]})]})},Fu=({isOpen:n,onClose:i,onSave:r,zoneName:a,campusName:c,maxPhotos:d=5})=>{const[h,p]=v.useState([]),[g,m]=v.useState(!1),x=v.useRef(null),k=v.useCallback(A=>{Array.from(A.target.files).forEach(D=>{if(h.length>=d)return;const y=new FileReader;y.onload=C=>{p(T=>T.length>=d?T:[...T,C.target.result])},y.readAsDataURL(D)}),x.current&&(x.current.value="")},[h.length,d]),S=()=>{x.current&&x.current.click()},_=A=>{p(z=>z.filter((D,y)=>y!==A))},w=async()=>{if(h.length!==0){m(!0);try{await r(h),p([]),i()}catch(A){console.error("Error saving photos:",A),alert("Failed to save photos. Please try again.")}finally{m(!1)}}},j=()=>{p([]),i()};return n?s.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",zIndex:1e3,display:"flex",flexDirection:"column"},children:[s.jsx("input",{ref:x,type:"file",accept:"image/*",capture:"environment",onChange:k,style:{display:"none"}}),s.jsxs("div",{style:{padding:"16px 20px",backgroundColor:"#092849",color:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("button",{onClick:j,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",fontSize:"20px"},children:""}),s.jsxs("div",{style:{textAlign:"center",flex:1},children:[s.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:"Report with Photo"}),s.jsxs("div",{style:{fontSize:"13px",opacity:.8},children:[a,"  ",c]})]}),s.jsx("div",{style:{width:"40px"}})]}),s.jsxs("div",{style:{padding:"12px 20px",backgroundColor:"#141685",color:"#fff",textAlign:"center",fontSize:"14px"},children:[" ",h.length," of ",d," photos taken"]}),s.jsx("div",{style:{flex:1,padding:"20px",overflowY:"auto",backgroundColor:"#1a1a1a"},children:h.length===0?s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#999",textAlign:"center",padding:"40px"},children:[s.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:""}),s.jsx("div",{style:{fontSize:"18px",marginBottom:"8px"},children:"No photos yet"}),s.jsx("div",{style:{fontSize:"14px",opacity:.7},children:"Tap the button below to take photos of issues"})]}):s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:h.map((A,z)=>s.jsxs("div",{style:{position:"relative"},children:[s.jsx("img",{src:A,alt:`Photo ${z+1}`,style:{width:"100%",aspectRatio:"1",objectFit:"cover",borderRadius:"12px",border:"2px solid #333"}}),s.jsx("button",{onClick:()=>_(z),style:{position:"absolute",top:"8px",right:"8px",width:"28px",height:"28px",borderRadius:"50%",backgroundColor:"rgba(255, 0, 0, 0.8)",border:"none",color:"#fff",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:""}),s.jsxs("div",{style:{position:"absolute",bottom:"8px",left:"8px",backgroundColor:"rgba(0,0,0,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:["#",z+1]})]},z))})}),s.jsxs("div",{style:{padding:"16px 20px",backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",display:"flex",gap:"12px"},children:[h.length<d&&s.jsx("button",{onClick:S,style:{flex:1,padding:"16px",borderRadius:"12px",fontSize:"16px",fontWeight:"600",border:"2px solid #2B57D0",backgroundColor:"#fff",color:"#2B57D0",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:" Take Photo"}),s.jsx("button",{onClick:w,disabled:h.length===0||g,style:{flex:1,padding:"16px",borderRadius:"12px",fontSize:"16px",fontWeight:"600",border:"none",backgroundColor:h.length>0&&!g?"#092849":"#d1d5db",color:h.length>0&&!g?"#fff":"#9ca3af",cursor:h.length>0&&!g?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:g?"Saving...":`Save ${h.length} Photo${h.length!==1?"s":""}`})]})]}):null},I_=({furnitureChecklist:n,camera:i})=>{const r=xe(),{campus:a,checklistType:c,checkResults:d,issues:h,recordZoneResults:p,addIssue:g,updateIssue:m,addPhotoToIssue:x,removeIssue:k,getZoneCompletionStatus:S}=n,_=Ei[c],[w,j]=v.useState({}),[A,z]=v.useState(null),[D,y]=v.useState(!1),[C,T]=v.useState(null);if(v.useEffect(()=>{d&&j(d)},[d]),v.useEffect(()=>{c||r("/furniture")},[c,r]),!_)return null;const E=_.sections.flatMap(O=>O.checks.map(q=>({...q,sectionName:O.name}))),W=E.length,M=Object.keys(w).filter(O=>E.some(q=>q.id===O)).length,K=W>0?Math.round(M/W*100):0,ee=(O,q,Z,re)=>{if(j(ae=>({...ae,[O]:q})),q===!1){if(!h.find(I=>I.checkId===O)){const I=g({checkId:O,checkText:Z.text,section:re,instantRed:Eu(O),photoRequired:Qx(O)});z(I)}}else{const ae=h.find(I=>I.checkId===O);ae&&(k(ae.id),A===ae.id&&z(null))}},F=(O,q)=>{m(O,{explanation:q})},ne=O=>{T(O),y(!0)},se=async O=>{C&&O&&x(C,O),y(!1),T(null)},B=()=>{p(c,w);const O=h.filter(q=>!!(!q.explanation||q.explanation.trim()===""||q.photoRequired&&(!q.photos||q.photos.length===0)));if(O.length>0){alert("Please complete all issue explanations and required photos before submitting."),z(O[0].id);return}r("/furniture/summary")},$=M===W;return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx(qe,{title:_.name,subtitle:a,onBack:()=>{confirm("Are you sure you want to exit? Your progress will be saved.")&&r("/furniture")}}),s.jsxs("div",{style:{padding:"16px 20px",backgroundColor:"#fff",borderBottom:"1px solid #e5e7eb"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"Progress"}),s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#092849"},children:[M," / ",W," checks"]})]}),s.jsx("div",{style:{height:"8px",backgroundColor:"#e5e7eb",borderRadius:"4px",overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",width:`${K}%`,backgroundColor:K===100?"#10b981":"#2563eb",transition:"width 0.3s ease"}})})]}),s.jsx("div",{style:{padding:"20px"},children:_.sections.map((O,q)=>s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx("div",{style:{backgroundColor:"#092849",color:"#fff",padding:"12px 16px",borderRadius:"10px 10px 0 0",fontWeight:"600",fontSize:"16px"},children:O.name}),O.description&&s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",padding:"10px 16px",fontSize:"14px",color:"#092849"},children:O.description}),s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0 0 10px 10px",overflow:"hidden",border:"1px solid #e5e7eb",borderTop:"none"},children:O.checks.map((Z,re)=>{const ae=w[Z.id],I=h.find(ie=>ie.checkId===Z.id),U=A===I?.id,Q=Eu(Z.id);return s.jsx("div",{children:s.jsxs("div",{style:{padding:"16px",borderBottom:re<O.checks.length-1?"1px solid #e5e7eb":"none",backgroundColor:ae===!1?"#fef2f2":"#fff"},children:[Q&&s.jsx("div",{style:{display:"inline-block",backgroundColor:"#ef4444",color:"#fff",fontSize:"10px",fontWeight:"700",padding:"2px 6px",borderRadius:"4px",marginBottom:"8px"},children:"INSTANT RED"}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500",color:"#333",marginBottom:"4px"},children:Z.text}),Z.helpText&&s.jsx("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px"},children:Z.helpText}),s.jsxs("div",{style:{display:"flex",gap:"12px"},children:[s.jsx("button",{onClick:()=>ee(Z.id,!0,Z,O.name),style:{flex:1,padding:"12px",borderRadius:"8px",border:ae===!0?"2px solid #10b981":"2px solid #e5e7eb",backgroundColor:ae===!0?"#d1fae5":"#fff",color:ae===!0?"#065f46":"#333",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:"Yes"}),s.jsx("button",{onClick:()=>ee(Z.id,!1,Z,O.name),style:{flex:1,padding:"12px",borderRadius:"8px",border:ae===!1?"2px solid #ef4444":"2px solid #e5e7eb",backgroundColor:ae===!1?"#fee2e2":"#fff",color:ae===!1?"#991b1b":"#333",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:"No"})]}),I&&s.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#fff",borderRadius:"8px",border:"1px solid #fca5a5"},children:[s.jsxs("button",{onClick:()=>z(U?null:I.id),style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",background:"none",border:"none",padding:0,cursor:"pointer"},children:[s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#dc2626"},children:["Issue Details ",I.photoRequired&&!I.photos?.length?"(Photo Required)":""]}),s.jsx("span",{style:{fontSize:"18px",color:"#666"},children:U?"":"+"})]}),U&&s.jsxs("div",{style:{marginTop:"12px"},children:[s.jsxs("div",{style:{marginBottom:"12px"},children:[s.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#dc2626",marginBottom:"6px"},children:"Explanation Required *"}),s.jsx("textarea",{value:I.explanation||"",onChange:ie=>F(I.id,ie.target.value),placeholder:"Please describe the issue and what was observed...",style:{width:"100%",minHeight:"100px",padding:"12px",borderRadius:"6px",border:!I.explanation||I.explanation.trim()===""?"2px solid #ef4444":"1px solid #ccc",fontSize:"14px",resize:"vertical",boxSizing:"border-box",backgroundColor:!I.explanation||I.explanation.trim()===""?"#fef2f2":"#fff"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#333",marginBottom:"6px"},children:["Photos ",I.photoRequired?"*":"(Optional)"]}),I.photos&&I.photos.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"8px",flexWrap:"wrap"},children:I.photos.map((ie,fe)=>s.jsx("img",{src:ie,alt:`Issue photo ${fe+1}`,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"6px",border:"1px solid #ccc"}},fe))}),s.jsxs("button",{onClick:()=>ne(I.id),style:{padding:"8px 16px",backgroundColor:"#f3f4f6",border:"1px solid #ccc",borderRadius:"6px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[s.jsx("span",{children:""})," Add Photo"]})]})]})]})]})},Z.id)})})]},q))}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:B,disabled:!$,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:$?"pointer":"not-allowed",backgroundColor:$?"#092849":"#9ca3af",color:"#fff"},children:$?"Submit Report ":`Answer All Checks (${M}/${W})`})}),D&&s.jsx(Fu,{isOpen:D,onClose:()=>{y(!1),T(null)},onCapture:se,camera:i})]})},B_=async n=>{const{date:i,time:r,campus:a,campusData:c,auditor:d,auditorEmail:h,duration:p,checklistType:g,checklistName:m,checkResults:x,rating:k,issues:S,totalIssues:_,openIssues:w,instantRedIssues:j,startTime:A,endTime:z}=n,{data:D,error:y}=await ct.from("furniture_audits").insert([{date:i,time:r,campus:a,campus_data:c,auditor:d,auditor_email:h,duration:p,checklist_type:g,checklist_name:m,check_results:x,rating:k,issues:S,total_issues:_,open_issues:w,instant_red_issues:j,start_time:A,end_time:z}]).select();if(y)throw console.error("Error saving furniture audit:",y),y;return D[0]},N_=({furnitureChecklist:n})=>{const i=xe(),[r,a]=v.useState(!1),{campus:c,auditor:d,auditorEmail:h,startTime:p,checklistType:g,issues:m,completeChecklist:x}=n,k=Ei[g],S=v.useMemo(()=>{if(!p)return null;const y=new Date(p),T=new Date-y,E=Math.round(T/6e4),W=Math.floor(E/60),M=E%60;return{total:E,hours:W,mins:M}},[p]),w=v.useMemo(()=>x(),[x])?.rating,j=m.filter(y=>y.instantRed),A=m.filter(y=>!y.instantRed),z=y=>{switch(y){case"GREEN":return"#10b981";case"AMBER":return"#f59e0b";case"RED":return"#ef4444";default:return"#6b7280"}},D=async()=>{a(!0);try{const y=n.getChecklistData();if(await B_(y),zi(c))try{console.log("[Furniture Checklist] Creating consolidated Wrike task...");const C=m.map(T=>({category:T.instantRed?" Instant Red":"Issue",section:T.section,check:T.checkText,description:T.explanation||"Issue found",photos:T.photos||[]}));await ds({checklistType:"FURNITURE",campusName:c,auditorName:d,auditorEmail:h,issues:C,date:new Date().toLocaleDateString()}),console.log("[Furniture Checklist] Wrike task created")}catch(C){console.error("[Furniture Checklist] Wrike error:",C)}i("/furniture/complete")}catch(y){console.error("Error saving furniture audit:",y),alert("Error saving audit. Please try again.")}finally{a(!1)}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsxs("div",{style:{background:w==="GREEN"?"linear-gradient(180deg, #059669 0%, #047857 100%)":w==="AMBER"?"linear-gradient(180deg, #d97706 0%, #b45309 100%)":"linear-gradient(180deg, #dc2626 0%, #b91c1c 100%)",color:"#fff",padding:"30px 20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:w==="GREEN"?"":w==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",margin:"0 0 8px 0"},children:w==="GREEN"?yn.green.description:w==="AMBER"?yn.amber.description:yn.red.description}),s.jsx("p",{style:{fontSize:"16px",opacity:.9,margin:0},children:k?.name||g}),s.jsxs("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:[c," - Completed by ",d]}),S&&s.jsxs("div",{style:{marginTop:"12px",backgroundColor:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"8px 16px",display:"inline-block"},children:[s.jsx("span",{style:{fontSize:"14px",opacity:.9},children:"Duration: "}),s.jsx("span",{style:{fontSize:"16px",fontWeight:"700"},children:S.hours>0?`${S.hours}h ${S.mins}m`:`${S.mins} minutes`})]})]}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:`2px solid ${z(w)}`,textAlign:"center"},children:[s.jsx("div",{style:{display:"inline-block",padding:"12px 32px",borderRadius:"8px",backgroundColor:z(w),color:"#fff",fontSize:"24px",fontWeight:"700"},children:w}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"12px"},children:m.length===0?"All checks passed!":`${m.length} issue${m.length>1?"s":""} found`})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:"Rating Breakdown:"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:j.length===0?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:j.length===0?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["No Instant RED items failed (",j.length," found)"]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:m.length<=yn.amber.maxOpenIssues?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:m.length<=yn.amber.maxOpenIssues?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["",yn.amber.maxOpenIssues," open issues (",m.length," total)"]})]})]}),j.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"2px solid #ef4444"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#dc2626"},children:[" Instant RED Issues (",j.length,")"]}),s.jsx("div",{style:{fontSize:"13px",color:"#b91c1c",marginBottom:"12px"},children:"These issues prevent passing until fixed."}),j.map((y,C)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#b91c1c"},children:y.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:y.checkText}),y.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",y.explanation]}),y.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:y.photos.map((T,E)=>s.jsx("img",{src:T,alt:`Issue ${E+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},E))})]},C))]}),A.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:["Other Issues (",A.length,")"]}),A.map((y,C)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef3c7",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e"},children:y.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:y.checkText}),y.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",y.explanation]}),y.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:y.photos.map((T,E)=>s.jsx("img",{src:T,alt:`Issue ${E+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},E))})]},C))]}),m.length===0&&s.jsxs("div",{style:{backgroundColor:"#f0fdf4",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #10b981",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:""}),s.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#059669"},children:"No Issues Found!"}),s.jsx("div",{style:{fontSize:"14px",color:"#065f46",marginTop:"4px"},children:"All furniture and decor checks passed."})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:D,disabled:r,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"not-allowed":"pointer",backgroundColor:r?"#9ca3af":"#092849",color:"#fff"},children:r?"Submitting...":"Submit Report "})})]})},M_=({furnitureChecklist:n})=>{const i=xe(),{rating:r,campus:a,checklistType:c,resetChecklist:d}=n;v.useEffect(()=>{r||i("/furniture")},[r,i]);const h=()=>{d(),i("/furniture")},p=()=>{d(),i("/")},g=()=>{switch(c){case"weekly":return"Weekly Pulse Check";case"monthly":return"Monthly Condition Scan";case"quarterly":return"Quarterly Deep Review";case"annual":return"Annual Comprehensive Review";default:return c}};return s.jsx("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px",textAlign:"center"},children:s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"40px 24px",maxWidth:"400px",width:"100%",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:r==="GREEN"?"":r==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",color:"#092849",margin:"0 0 8px 0"},children:"Report Submitted!"}),s.jsxs("p",{style:{fontSize:"16px",color:"#666",margin:"0 0 24px 0"},children:["Your ",g()," for ",a," has been recorded."]}),s.jsx("div",{style:{display:"inline-block",padding:"12px 32px",borderRadius:"8px",backgroundColor:r==="GREEN"?"#10b981":r==="AMBER"?"#f59e0b":"#ef4444",color:"#fff",fontSize:"24px",fontWeight:"700",marginBottom:"32px"},children:r}),r!=="GREEN"&&s.jsxs("div",{style:{backgroundColor:"#fef3c7",borderRadius:"8px",padding:"12px 16px",marginBottom:"24px",fontSize:"14px",color:"#92400e",textAlign:"left"},children:[s.jsx("strong",{children:"Next Steps:"}),s.jsxs("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px"},children:[s.jsx("li",{children:"Review issues with your facilities team"}),s.jsx("li",{children:"Assign owners to each issue"}),s.jsx("li",{children:"Set fix dates within 45 days"}),r==="RED"&&s.jsx("li",{children:"Address Instant RED items immediately"})]})]}),s.jsxs("div",{style:{backgroundColor:"#f0f9ff",borderRadius:"8px",padding:"12px 16px",marginBottom:"24px",fontSize:"13px",color:"#0369a1"},children:[s.jsx("strong",{children:"Pillar Owners:"})," Taraya Voelker, Austin Ray"]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsx("button",{onClick:h,style:{width:"100%",padding:"16px",borderRadius:"10px",fontSize:"16px",fontWeight:"600",border:"none",cursor:"pointer",backgroundColor:"#092849",color:"#fff"},children:"Start Another Checklist"}),s.jsx("button",{onClick:p,style:{width:"100%",padding:"16px",borderRadius:"10px",fontSize:"16px",fontWeight:"600",border:"2px solid #092849",cursor:"pointer",backgroundColor:"#fff",color:"#092849"},children:"Return to Home"})]})]})})},nu="furniture_checklist_state",iu=()=>({campus:null,campusData:null,auditor:"",auditorEmail:"",startTime:null,checklistType:null,checkResults:{},issues:[],rating:null,isComplete:!1,endTime:null}),q_=()=>{const[n,i]=v.useState(()=>{try{const y=localStorage.getItem(nu);if(y){const C=JSON.parse(y);if(C.startTime&&!C.isComplete){const T=new Date(C.startTime).toDateString(),E=new Date().toDateString();if(T===E)return C}}}catch(y){console.error("Error restoring furniture checklist state:",y)}return iu()});v.useEffect(()=>{if(n.startTime&&!n.isComplete)try{localStorage.setItem(nu,JSON.stringify(n))}catch(y){console.error("[useFurnitureChecklist] Error saving to localStorage:",y)}},[n]);const r=v.useCallback(()=>{localStorage.removeItem(nu)},[]),a=v.useCallback((y,C,T,E,W)=>{i({...iu(),campus:y,campusData:C,auditor:T,auditorEmail:E,checklistType:W,startTime:new Date().toISOString()})},[]),c=v.useCallback(()=>{r(),i(iu())},[r]),d=v.useCallback(()=>n.checklistType?Ei[n.checklistType]:null,[n.checklistType]),h=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,[y]:C}}))},[]),p=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,...C}}))},[]),g=v.useCallback(y=>{const C=`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return i(T=>({...T,issues:[...T.issues,{id:C,timestamp:new Date().toISOString(),instantRed:Eu(y.checkId),photoRequired:Qx(y.checkId),photos:[],explanation:"",status:"open",...y}]})),C},[]),m=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,...C}:E)}))},[]),x=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,photos:[...E.photos||[],C]}:E)}))},[]),k=v.useCallback(y=>{i(C=>({...C,issues:C.issues.filter(T=>T.id!==y)}))},[]),S=v.useCallback(y=>{const C=Ei[y||n.checklistType];if(!C)return{complete:!1,answered:0,total:0};let T=0,E=0;return C.sections.forEach(W=>{W.checks.forEach(M=>{T++,n.checkResults[M.id]!==void 0&&E++})}),{complete:E===T,answered:E,total:T}},[n.checkResults,n.checklistType]),_=v.useCallback(()=>n.issues.every(y=>!(!y.explanation||y.explanation.trim()===""||y.photoRequired&&(!y.photos||y.photos.length===0))),[n.issues]),w=v.useCallback(()=>{const y=D_(n.checklistType,n.checkResults,n.issues);return i(C=>({...C,rating:y,isComplete:!0,endTime:new Date().toISOString()})),r(),{rating:y}},[n.checklistType,n.checkResults,n.issues,r]),j=v.useCallback(()=>{const y=n.startTime&&n.endTime?Math.round((new Date(n.endTime)-new Date(n.startTime))/6e4):null,C=Ei[n.checklistType];return{date:n.startTime?new Date(n.startTime).toLocaleDateString():null,time:n.startTime?new Date(n.startTime).toLocaleTimeString():null,campus:n.campus,campusData:n.campusData,auditor:n.auditor,auditorEmail:n.auditorEmail,duration:y,checklistType:n.checklistType,checklistName:C?.name||n.checklistType,checkResults:n.checkResults,rating:n.rating,issues:n.issues,totalIssues:n.issues.length,openIssues:n.issues.filter(T=>T.status==="open").length,instantRedIssues:n.issues.filter(T=>T.instantRed).length,startTime:n.startTime,endTime:n.endTime}},[n]),A=n.startTime&&!n.isComplete,z={[n.checklistType]:n.checkResults},D=n.rating?{[n.checklistType]:n.rating}:{};return{...n,isInProgress:A,currentZoneId:n.checklistType,zoneResults:z,zoneRatings:D,overallRating:n.rating,getCurrentZone:d,getZoneCompletionStatus:S,getChecklistData:j,allIssuesComplete:_,initChecklist:a,resetChecklist:c,recordCheckResult:h,recordZoneResults:p,addIssue:g,updateIssue:m,addPhotoToIssue:x,removeIssue:k,completeChecklist:w,clearSavedState:r,setCurrentZone:()=>{},calculateAndSetZoneRating:()=>{}}},Cn={green:{description:"World Class"},amber:{description:"At Risk",maxOpenIssues:3,maxDaysToFix:45},red:{description:"Not Meeting Standard"}},Zm=["temperature_compliance","sanitation_packaging"],Fm=["meal_match","special_diet_labels","food_quality_defects","temperature_compliance","sanitation_packaging"],Ti={monthly:{id:"monthly",name:"Monthly Food Service Quality Check",frequency:"monthly",order:1,description:"Complete monthly or when requested by management for a spot check",timeNeeded:"20-30 minutes",persona:"Site Owner / Campus Coordinator",sections:[{name:"Service Timeliness",description:"Check that food service started on time and as scheduled.",checks:[{id:"vendor_on_time",text:"Did the vendor arrive and start lunch service on time?",helpText:"If no, include how late the service started in comments",tier:"amber",photoRequired:!1}]},{name:"Meal Accuracy",description:"Verify the meal served matches what was planned/posted.",checks:[{id:"meal_match",text:"Did the meal match the one that was planned/posted?",helpText:"If no, describe inconsistencies and include photos of each entree, side, and menu if applicable",tier:"amber",photoRequired:!0},{id:"special_diet_labels",text:"Were special diet meals clearly labeled and correctly served?",helpText:"If no, describe inconsistencies and include photo of special diet meals and labels",tier:"amber",photoRequired:!0}]},{name:"Food Quality Assessment",description:"Check for food quality defects related to freshness, preparation, flavor, or presentation.",checks:[{id:"food_quality_defects",text:"Was the food free of quality defects?",helpText:"Check for: Proteins dry/overcooked (lacks moisture, hardened edges), Vegetables mushy/overcooked (loss of structural integrity), Visible browning/oxidation on fruits/vegetables, Inconsistent appearance across 3+ servings, Off-odors (sour, chemical, burnt smells)",tier:"amber",photoRequired:!0,defectChecklist:["Proteins dry/overcooked - Lacks visible moisture, edges hardened, or visible dryness when cut","Vegetables mushy/overcooked - Loss of structural integrity when picked up with utensils","Visible browning/oxidation - Fruit/vegetables show discoloration from extended holding","Inconsistent appearance - Meals vary significantly in portion size, plating, or ingredient distribution across 3+ servings","Off-odors detected - Sour, chemical, or burnt smells present"]}]},{name:"Temperature Compliance",description:"Verify food temperature meets safety standards.",checks:[{id:"temperature_compliance",text:"Hot food temperature during service >=135F? Cold food temperature during service <=41F?",helpText:"If no, list what foods did not meet temperature compliance, include temperature reading, and photos of temperature readings",tier:"red",instantRed:!0,photoRequired:!0}]},{name:"Sanitation & Packaging",description:"Check for sanitation and packaging compliance.",checks:[{id:"sanitation_packaging",text:"Was the service free of sanitation & packaging defects?",helpText:"Check for: glove use, clean/secure/undamaged packaging, covered foods, food stored off floor at all times, space left clean and usable after service",tier:"red",instantRed:!0,photoRequired:!0}]},{name:"Vendor Professionalism",description:"Assess vendor professionalism and service quality.",checks:[{id:"vendor_professionalism",text:"Was the service free of vendor professionalism issues?",helpText:"If no, provide description of issues observed",tier:"amber",photoRequired:!1}]},{name:"Participation & Consumption",description:"Track student participation and meal consumption.",checks:[{id:"student_participation_count",text:"Has student participation count been recorded?",helpText:"Ask server to count number of students who participated in school lunch",tier:"amber",photoRequired:!1,inputType:"number",inputLabel:"Number of students"},{id:"student_consumption_rate",text:"Did at least 70% of students consume >75% of the meal?",helpText:"Rough observation of meal consumption during service",tier:"amber",photoRequired:!1}]},{name:"Survey Completion",description:"Verify surveys have been completed for feedback collection.",checks:[{id:"student_survey_complete",text:"Have students completed the survey (at least 10)?",helpText:"Each school will have its own student survey link",tier:"amber",photoRequired:!1},{id:"staff_survey_complete",text:"Have staff completed the survey (at least 3)?",helpText:"Each school will have its own staff survey link",tier:"amber",photoRequired:!1}]},{name:"Additional Observations",description:"Any other observations or explanations.",checks:[{id:"additional_observations",text:"Are there any additional observations to note?",helpText:"Include any additional observations or explanations for any of the above checks",tier:"amber",photoRequired:!1,inputType:"text",optional:!0}]}]},spot_check:{id:"spot_check",name:"Management Spot Check",frequency:"as_needed",order:2,description:"Triggered spot check requested by management when quality declines",timeNeeded:"15-20 minutes",persona:"Site Owner / Campus Coordinator / Management",sections:[{name:"Service Timeliness",description:"Check that food service started on time and as scheduled.",checks:[{id:"spot_vendor_on_time",text:"Did the vendor arrive and start lunch service on time?",helpText:"If no, include how late the service started in comments",tier:"amber",photoRequired:!1}]},{name:"Meal Accuracy",description:"Verify the meal served matches what was planned/posted.",checks:[{id:"spot_meal_match",text:"Did the meal match the one that was planned/posted?",helpText:"If no, describe inconsistencies and include photos of each entree, side, and menu if applicable",tier:"amber",photoRequired:!0},{id:"spot_special_diet_labels",text:"Were special diet meals clearly labeled and correctly served?",helpText:"If no, describe inconsistencies and include photo of special diet meals and labels",tier:"amber",photoRequired:!0}]},{name:"Food Quality Assessment",description:"Check for food quality defects related to freshness, preparation, flavor, or presentation.",checks:[{id:"spot_food_quality_defects",text:"Was the food free of quality defects?",helpText:"Check for: Proteins dry/overcooked, Vegetables mushy/overcooked, Visible browning/oxidation, Inconsistent appearance, Off-odors",tier:"amber",photoRequired:!0,defectChecklist:["Proteins dry/overcooked - Lacks visible moisture, edges hardened, or visible dryness when cut","Vegetables mushy/overcooked - Loss of structural integrity when picked up with utensils","Visible browning/oxidation - Fruit/vegetables show discoloration from extended holding","Inconsistent appearance - Meals vary significantly in portion size, plating, or ingredient distribution across 3+ servings","Off-odors detected - Sour, chemical, or burnt smells present"]}]},{name:"Temperature Compliance",description:"Verify food temperature meets safety standards.",checks:[{id:"spot_temperature_compliance",text:"Hot food temperature during service >=135F? Cold food temperature during service <=41F?",helpText:"If no, list what foods did not meet temperature compliance, include temperature reading, and photos of temperature readings",tier:"red",instantRed:!0,photoRequired:!0}]},{name:"Sanitation & Packaging",description:"Check for sanitation and packaging compliance.",checks:[{id:"spot_sanitation_packaging",text:"Was the service free of sanitation & packaging defects?",helpText:"Check for: glove use, clean/secure/undamaged packaging, covered foods, food stored off floor, space left clean after service",tier:"red",instantRed:!0,photoRequired:!0}]},{name:"Vendor Professionalism",description:"Assess vendor professionalism and service quality.",checks:[{id:"spot_vendor_professionalism",text:"Was the service free of vendor professionalism issues?",helpText:"If no, provide description of issues observed",tier:"amber",photoRequired:!1}]},{name:"Additional Observations",description:"Any other observations specific to the spot check trigger.",checks:[{id:"spot_additional_observations",text:"Are there any additional observations related to the spot check trigger?",helpText:"Include observations or explanations for the issue that triggered this spot check",tier:"amber",photoRequired:!1,inputType:"text",optional:!0}]}]}},W_=n=>{const i=Ti[n];return!i||!i.sections?[]:i.sections.flatMap(r=>r.checks.map(a=>({...a,section:r.name})))},Tu=n=>{const i=n.replace("spot_","");return Zm.includes(n)||Zm.includes(i)},Jx=n=>{const i=n.replace("spot_","");return Fm.includes(n)||Fm.includes(i)},U_=(n,i,r)=>{const c=W_(n).filter(x=>!x.optional&&i[x.id]===!1);if(c.length===0)return"GREEN";if(c.some(x=>x.instantRed))return"RED";const h=r.filter(x=>x.status==="open");if(h.length>Cn.amber.maxOpenIssues||h.some(x=>!x.owner||!x.fixDate))return"RED";const g=new Date;return h.some(x=>{const k=new Date(x.createdAt);return Math.floor((g-k)/(1e3*60*60*24))>Cn.amber.maxDaysToFix})?"RED":"AMBER"},Ym=[{id:"monthly",name:"Monthly Quality Check",icon:"",color:"#059669"},{id:"spot_check",name:"Management Spot Check",icon:"",color:"#dc2626"}],L_=({foodSafetyChecklist:n})=>{const i=xe(),[r,a]=v.useState(null),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(""),[x,k]=v.useState(""),[S,_]=v.useState(""),w=r?Ti[r]:null,j=()=>{if(!r){alert("Please select a checklist type");return}if(!c){alert("Please select a campus");return}if(!h.trim()){alert("Please enter your name");return}if(!g.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)){alert("Please enter a valid email address");return}if(r==="spot_check"&&!S.trim()){alert("Please provide the reason for this spot check");return}const A=an.find(z=>z.name===c);n.initChecklist(c,A,h.trim(),g.trim(),r,x.trim(),S.trim()),window.scrollTo(0,0),i("/food-safety/checklist")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Food Service Quality",subtitle:"Ops Quality Check",onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"What type of check? *"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:Ym.map(A=>{const z=Ti[A.id],D=r===A.id;return s.jsxs("button",{onClick:()=>a(A.id),style:{padding:"16px",borderRadius:"12px",border:D?`3px solid ${A.color}`:"2px solid #e5e7eb",backgroundColor:D?`${A.color}10`:"#fff",cursor:"pointer",textAlign:"center",transition:"all 0.2s"},children:[s.jsx("div",{style:{fontSize:"28px",marginBottom:"8px"},children:A.icon}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:D?A.color:"#333"},children:A.name}),s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:z?.timeNeeded})]},A.id)})})]}),w&&s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:[s.jsxs("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"8px"},children:[w.name," - What You'll Check"]}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px"},children:["Best done by: ",w.persona]}),w.sections.map((A,z)=>s.jsxs("div",{style:{padding:"10px 0",borderBottom:z<w.sections.length-1?"1px solid rgba(71, 196, 230, 0.3)":"none"},children:[s.jsx("div",{style:{fontWeight:"500",fontSize:"15px",color:"#333"},children:A.name}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"2px"},children:[A.checks.length," check",A.checks.length>1?"s":""]})]},z))]}),r==="spot_check"&&s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Reason for Spot Check *"}),s.jsx("textarea",{placeholder:"What triggered this spot check? (e.g., quality complaint, management request, etc.)",value:S,onChange:A=>_(A.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"16px",boxSizing:"border-box",backgroundColor:"#fff",minHeight:"80px",resize:"vertical"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Campus *"}),s.jsx(Xn,{value:c,onChange:d,placeholder:"Select campus..."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Food Vendor (Optional)"}),s.jsx("input",{type:"text",placeholder:"Enter food vendor name",value:x,onChange:A=>k(A.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Name *"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:h,onChange:A=>p(A.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Email *"}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:g,onChange:A=>m(A.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Rating System"}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10b981",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#059669"},children:Cn.green.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"All checks pass, food quality excellent"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#f59e0b",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#d97706"},children:Cn.amber.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Some issues found, being addressed"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#ef4444",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#dc2626"},children:Cn.red.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Critical issues need immediate attention"})]})]})]}),s.jsxs("div",{style:{backgroundColor:"rgba(254, 243, 199, 0.5)",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:"Important"}),s.jsxs("div",{style:{fontSize:"14px",color:"#78350f"},children:["Some items are marked as ",s.jsx("strong",{children:"INSTANT RED"})," (temperature compliance, sanitation issues). If any of these fail, the campus cannot pass until fixed."]}),s.jsx("div",{style:{fontSize:"14px",color:"#78350f",marginTop:"8px"},children:'Every "No" answer requires an explanation and may require photos.'})]}),s.jsx("button",{onClick:j,disabled:!r,style:{width:"100%",backgroundColor:r?"#092849":"#9ca3af",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"pointer":"not-allowed",marginTop:"8px"},children:r?`Begin ${Ym.find(A=>A.id===r)?.name}`:"Select a Check Type"})]})]})},$_=({foodSafetyChecklist:n,camera:i})=>{const r=xe(),{campus:a,checklistType:c,checkResults:d,issues:h,recordZoneResults:p,addIssue:g,updateIssue:m,addPhotoToIssue:x,removeIssue:k,getZoneCompletionStatus:S,setStudentParticipationCount:_,studentParticipationCount:w}=n,j=Ti[c],[A,z]=v.useState({}),[D,y]=v.useState(null),[C,T]=v.useState(!1),[E,W]=v.useState(null),[M,K]=v.useState("");if(v.useEffect(()=>{d&&z(d),w&&K(w.toString())},[d,w]),v.useEffect(()=>{c||r("/food-safety")},[c,r]),!j)return null;const F=j.sections.flatMap(U=>U.checks.map(Q=>({...Q,sectionName:U.name}))).filter(U=>!U.optional),ne=F.length,se=Object.keys(A).filter(U=>F.some(Q=>Q.id===U)).length,B=ne>0?Math.round(se/ne*100):0,$=(U,Q,ie,fe)=>{if(z(ce=>({...ce,[U]:Q})),Q===!1){if(!h.find(ge=>ge.checkId===U)){const ge=g({checkId:U,checkText:ie.text,section:fe,instantRed:Tu(U),photoRequired:Jx(U)});y(ge)}}else{const ce=h.find(ge=>ge.checkId===U);ce&&(k(ce.id),D===ce.id&&y(null))}},O=(U,Q)=>{m(U,{explanation:Q})},q=U=>{W(U),T(!0)},Z=async U=>{E&&U&&x(E,U),T(!1),W(null)},re=U=>{K(U);const Q=parseInt(U,10);!isNaN(Q)&&Q>=0&&_(Q)},ae=()=>{p(c,A);const U=h.filter(Q=>!!(!Q.explanation||Q.explanation.trim()===""||Q.photoRequired&&(!Q.photos||Q.photos.length===0)));if(U.length>0){alert("Please complete all issue explanations and required photos before submitting."),y(U[0].id);return}r("/food-safety/summary")},I=se===ne;return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx(qe,{title:j.name,subtitle:a,onBack:()=>{confirm("Are you sure you want to exit? Your progress will be saved.")&&r("/food-safety")}}),s.jsxs("div",{style:{padding:"16px 20px",backgroundColor:"#fff",borderBottom:"1px solid #e5e7eb"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"Progress"}),s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#092849"},children:[se," / ",ne," checks"]})]}),s.jsx("div",{style:{height:"8px",backgroundColor:"#e5e7eb",borderRadius:"4px",overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",width:`${B}%`,backgroundColor:B===100?"#10b981":"#2563eb",transition:"width 0.3s ease"}})})]}),s.jsx("div",{style:{padding:"20px"},children:j.sections.map((U,Q)=>s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx("div",{style:{backgroundColor:"#092849",color:"#fff",padding:"12px 16px",borderRadius:"10px 10px 0 0",fontWeight:"600",fontSize:"16px"},children:U.name}),U.description&&s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",padding:"10px 16px",fontSize:"14px",color:"#092849"},children:U.description}),s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0 0 10px 10px",overflow:"hidden",border:"1px solid #e5e7eb",borderTop:"none"},children:U.checks.map((ie,fe)=>{const ce=A[ie.id],ge=h.find(dt=>dt.checkId===ie.id),Pe=D===ge?.id,Ne=Tu(ie.id);return s.jsx("div",{children:s.jsxs("div",{style:{padding:"16px",borderBottom:fe<U.checks.length-1?"1px solid #e5e7eb":"none",backgroundColor:ce===!1?"#fef2f2":"#fff"},children:[Ne&&s.jsx("div",{style:{display:"inline-block",backgroundColor:"#ef4444",color:"#fff",fontSize:"10px",fontWeight:"700",padding:"2px 6px",borderRadius:"4px",marginBottom:"8px"},children:"INSTANT RED"}),ie.optional&&s.jsx("div",{style:{display:"inline-block",backgroundColor:"#6b7280",color:"#fff",fontSize:"10px",fontWeight:"700",padding:"2px 6px",borderRadius:"4px",marginBottom:"8px",marginLeft:Ne?"8px":"0"},children:"OPTIONAL"}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500",color:"#333",marginBottom:"4px"},children:ie.text}),ie.helpText&&s.jsx("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px"},children:ie.helpText}),ie.defectChecklist&&s.jsxs("div",{style:{backgroundColor:"#fef3c7",borderRadius:"8px",padding:"12px",marginBottom:"12px",fontSize:"13px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:"Check for these defects:"}),s.jsx("ul",{style:{margin:0,paddingLeft:"20px",color:"#78350f"},children:ie.defectChecklist.map((dt,Bt)=>s.jsx("li",{style:{marginBottom:"4px"},children:dt},Bt))})]}),ie.inputType==="number"&&s.jsxs("div",{style:{marginBottom:"12px"},children:[s.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#333",marginBottom:"6px"},children:ie.inputLabel}),s.jsx("input",{type:"number",min:"0",value:M,onChange:dt=>re(dt.target.value),placeholder:"Enter number",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ccc",fontSize:"16px",boxSizing:"border-box"}})]}),s.jsxs("div",{style:{display:"flex",gap:"12px"},children:[s.jsx("button",{onClick:()=>$(ie.id,!0,ie,U.name),style:{flex:1,padding:"12px",borderRadius:"8px",border:ce===!0?"2px solid #10b981":"2px solid #e5e7eb",backgroundColor:ce===!0?"#d1fae5":"#fff",color:ce===!0?"#065f46":"#333",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:"Yes"}),s.jsx("button",{onClick:()=>$(ie.id,!1,ie,U.name),style:{flex:1,padding:"12px",borderRadius:"8px",border:ce===!1?"2px solid #ef4444":"2px solid #e5e7eb",backgroundColor:ce===!1?"#fee2e2":"#fff",color:ce===!1?"#991b1b":"#333",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:"No"}),ie.optional&&s.jsx("button",{onClick:()=>$(ie.id,"na",ie,U.name),style:{flex:1,padding:"12px",borderRadius:"8px",border:ce==="na"?"2px solid #6b7280":"2px solid #e5e7eb",backgroundColor:ce==="na"?"#f3f4f6":"#fff",color:ce==="na"?"#374151":"#333",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:"N/A"})]}),ge&&s.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#fff",borderRadius:"8px",border:"1px solid #fca5a5"},children:[s.jsxs("button",{onClick:()=>y(Pe?null:ge.id),style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",background:"none",border:"none",padding:0,cursor:"pointer"},children:[s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#dc2626"},children:["Issue Details ",ge.photoRequired&&!ge.photos?.length?"(Photo Required)":""]}),s.jsx("span",{style:{fontSize:"18px",color:"#666"},children:Pe?"-":"+"})]}),Pe&&s.jsxs("div",{style:{marginTop:"12px"},children:[s.jsxs("div",{style:{marginBottom:"12px"},children:[s.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#333",marginBottom:"6px"},children:"Explanation *"}),s.jsx("textarea",{value:ge.explanation||"",onChange:dt=>O(ge.id,dt.target.value),placeholder:"Describe the issue...",style:{width:"100%",minHeight:"80px",padding:"10px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px",resize:"vertical",boxSizing:"border-box"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#333",marginBottom:"6px"},children:["Photos ",ge.photoRequired?"*":"(Optional)"]}),ge.photos&&ge.photos.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"8px",flexWrap:"wrap"},children:ge.photos.map((dt,Bt)=>s.jsx("img",{src:dt,alt:`Issue photo ${Bt+1}`,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"6px",border:"1px solid #ccc"}},Bt))}),s.jsxs("button",{onClick:()=>q(ge.id),style:{padding:"8px 16px",backgroundColor:"#f3f4f6",border:"1px solid #ccc",borderRadius:"6px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[s.jsx("span",{children:""})," Add Photo"]})]})]})]})]})},ie.id)})})]},Q))}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:ae,disabled:!I,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:I?"pointer":"not-allowed",backgroundColor:I?"#092849":"#9ca3af",color:"#fff"},children:I?"Submit Report":`Answer All Checks (${se}/${ne})`})}),C&&s.jsx(Fu,{isOpen:C,onClose:()=>{T(!1),W(null)},onCapture:Z,camera:i})]})},H_=async n=>{const{date:i,time:r,campus:a,campusData:c,auditor:d,auditorEmail:h,duration:p,checklistType:g,checklistName:m,checkResults:x,rating:k,issues:S,totalIssues:_,openIssues:w,instantRedIssues:j,startTime:A,endTime:z,studentParticipationCount:D,spotCheckTrigger:y,foodVendor:C}=n,{data:T,error:E}=await ct.from("food_safety_audits").insert([{date:i,time:r,campus:a,campus_data:c,auditor:d,auditor_email:h,duration:p,checklist_type:g,checklist_name:m,check_results:x,rating:k,issues:S,total_issues:_,open_issues:w,instant_red_issues:j,start_time:A,end_time:z,student_participation_count:D,spot_check_trigger:y,food_vendor:C}]).select();if(E)throw console.error("Error saving food safety audit:",E),E;return T[0]},P_=({foodSafetyChecklist:n})=>{const i=xe(),[r,a]=v.useState(!1),{campus:c,auditor:d,auditorEmail:h,startTime:p,checklistType:g,issues:m,foodVendor:x,spotCheckTrigger:k,studentParticipationCount:S,completeChecklist:_}=n,w=Ti[g],j=v.useMemo(()=>{if(!p)return null;const E=new Date(p),M=new Date-E,K=Math.round(M/6e4),ee=Math.floor(K/60),F=K%60;return{total:K,hours:ee,mins:F}},[p]),z=v.useMemo(()=>_(),[_])?.rating,D=m.filter(E=>E.instantRed),y=m.filter(E=>!E.instantRed),C=E=>{switch(E){case"GREEN":return"#10b981";case"AMBER":return"#f59e0b";case"RED":return"#ef4444";default:return"#6b7280"}},T=async()=>{a(!0);try{const E=n.getChecklistData();if(await H_(E),zi(c))try{console.log("[Food Safety Checklist] Creating consolidated Wrike task...");const W=m.map(M=>({category:M.instantRed?" Instant Red":"Issue",section:M.section,check:M.checkText,description:M.explanation||"Issue found",photos:M.photos||[]}));await ds({checklistType:"FOOD_SAFETY",campusName:c,auditorName:d,auditorEmail:h,issues:W,date:new Date().toLocaleDateString()}),console.log("[Food Safety Checklist] Wrike task created")}catch(W){console.error("[Food Safety Checklist] Wrike error:",W)}i("/food-safety/complete")}catch(E){console.error("Error saving food safety audit:",E),alert("Error saving audit. Please try again.")}finally{a(!1)}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsxs("div",{style:{background:z==="GREEN"?"linear-gradient(180deg, #059669 0%, #047857 100%)":z==="AMBER"?"linear-gradient(180deg, #d97706 0%, #b45309 100%)":"linear-gradient(180deg, #dc2626 0%, #b91c1c 100%)",color:"#fff",padding:"30px 20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:z==="GREEN"?"":z==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",margin:"0 0 8px 0"},children:z==="GREEN"?Cn.green.description:z==="AMBER"?Cn.amber.description:Cn.red.description}),s.jsx("p",{style:{fontSize:"16px",opacity:.9,margin:0},children:w?.name||g}),s.jsxs("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:[c," - Completed by ",d]}),j&&s.jsxs("div",{style:{marginTop:"12px",backgroundColor:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"8px 16px",display:"inline-block"},children:[s.jsx("span",{style:{fontSize:"14px",opacity:.9},children:"Duration: "}),s.jsx("span",{style:{fontSize:"16px",fontWeight:"700"},children:j.hours>0?`${j.hours}h ${j.mins}m`:`${j.mins} minutes`})]})]}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:`2px solid ${C(z)}`,textAlign:"center"},children:[s.jsx("div",{style:{display:"inline-block",padding:"12px 32px",borderRadius:"8px",backgroundColor:C(z),color:"#fff",fontSize:"24px",fontWeight:"700"},children:z}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"12px"},children:m.length===0?"All checks passed!":`${m.length} issue${m.length>1?"s":""} found`})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Service Details"}),x&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{color:"#666"},children:"Food Vendor:"}),s.jsx("span",{style:{fontWeight:"500"},children:x})]}),S&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{color:"#666"},children:"Student Participation:"}),s.jsxs("span",{style:{fontWeight:"500"},children:[S," students"]})]}),k&&s.jsxs("div",{style:{marginTop:"12px",padding:"10px",backgroundColor:"#fef3c7",borderRadius:"6px"},children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:"#92400e",marginBottom:"4px"},children:"Spot Check Trigger:"}),s.jsx("div",{style:{fontSize:"14px",color:"#78350f"},children:k})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:"Rating Breakdown:"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:D.length===0?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:D.length===0?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["No Instant RED items failed (",D.length," found)"]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:m.length<=Cn.amber.maxOpenIssues?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:m.length<=Cn.amber.maxOpenIssues?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["3 open issues or fewer (",m.length," total)"]})]})]}),D.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"2px solid #ef4444"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#dc2626"},children:[" Instant RED Issues (",D.length,")"]}),s.jsx("div",{style:{fontSize:"13px",color:"#b91c1c",marginBottom:"12px"},children:"These food safety issues require immediate attention."}),D.map((E,W)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#b91c1c"},children:E.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:E.checkText}),E.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",E.explanation]}),E.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:E.photos.map((M,K)=>s.jsx("img",{src:M,alt:`Issue ${K+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},K))})]},W))]}),y.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:["Other Issues (",y.length,")"]}),y.map((E,W)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef3c7",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e"},children:E.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:E.checkText}),E.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",E.explanation]}),E.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:E.photos.map((M,K)=>s.jsx("img",{src:M,alt:`Issue ${K+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},K))})]},W))]}),m.length===0&&s.jsxs("div",{style:{backgroundColor:"#f0fdf4",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #10b981",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:""}),s.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#059669"},children:"No Issues Found!"}),s.jsx("div",{style:{fontSize:"14px",color:"#065f46",marginTop:"4px"},children:"All food service quality checks passed."})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:T,disabled:r,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"not-allowed":"pointer",backgroundColor:r?"#9ca3af":"#092849",color:"#fff"},children:r?"Submitting...":"Submit Report"})})]})},G_=({foodSafetyChecklist:n})=>{const i=xe(),{rating:r,campus:a,checklistType:c,foodVendor:d,resetChecklist:h}=n;v.useEffect(()=>{r||i("/food-safety")},[r,i]);const p=()=>{h(),i("/food-safety")},g=()=>{h(),i("/")},m=()=>{switch(c){case"monthly":return"Monthly Quality Check";case"spot_check":return"Management Spot Check";default:return c}};return s.jsx("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px",textAlign:"center"},children:s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"40px 24px",maxWidth:"400px",width:"100%",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:r==="GREEN"?"":r==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",color:"#092849",margin:"0 0 8px 0"},children:"Report Submitted!"}),s.jsxs("p",{style:{fontSize:"16px",color:"#666",margin:"0 0 24px 0"},children:["Your ",m()," for ",a," has been recorded."]}),d&&s.jsxs("p",{style:{fontSize:"14px",color:"#666",margin:"0 0 16px 0"},children:["Vendor: ",d]}),s.jsx("div",{style:{display:"inline-block",padding:"12px 32px",borderRadius:"8px",backgroundColor:r==="GREEN"?"#10b981":r==="AMBER"?"#f59e0b":"#ef4444",color:"#fff",fontSize:"24px",fontWeight:"700",marginBottom:"32px"},children:r}),r!=="GREEN"&&s.jsxs("div",{style:{backgroundColor:"#fef3c7",borderRadius:"8px",padding:"12px 16px",marginBottom:"24px",fontSize:"14px",color:"#92400e",textAlign:"left"},children:[s.jsx("strong",{children:"Next Steps:"}),s.jsxs("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px"},children:[s.jsx("li",{children:"Review issues with food service vendor"}),s.jsx("li",{children:"Document vendor response"}),s.jsx("li",{children:"Set corrective action plan within 45 days"}),r==="RED"&&s.jsx("li",{children:"Address temperature/sanitation issues immediately"})]})]}),s.jsxs("div",{style:{backgroundColor:"#f0f9ff",borderRadius:"8px",padding:"12px 16px",marginBottom:"24px",fontSize:"13px",color:"#0369a1",textAlign:"left"},children:[s.jsx("strong",{children:"Survey Reminder:"}),s.jsx("div",{style:{marginTop:"4px"},children:"Ensure student surveys (10+) and staff surveys (3+) are completed for comprehensive feedback."})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.jsx("button",{onClick:p,style:{width:"100%",padding:"16px",borderRadius:"10px",fontSize:"16px",fontWeight:"600",border:"none",cursor:"pointer",backgroundColor:"#092849",color:"#fff"},children:"Start Another Check"}),s.jsx("button",{onClick:g,style:{width:"100%",padding:"16px",borderRadius:"10px",fontSize:"16px",fontWeight:"600",border:"2px solid #092849",cursor:"pointer",backgroundColor:"#fff",color:"#092849"},children:"Return to Home"})]})]})})},su="food_safety_checklist_state",ru=()=>({campus:null,campusData:null,auditor:"",auditorEmail:"",startTime:null,checklistType:null,foodVendor:"",spotCheckTrigger:"",studentParticipationCount:null,checkResults:{},issues:[],rating:null,isComplete:!1,endTime:null}),V_=()=>{const[n,i]=v.useState(()=>{try{const E=localStorage.getItem(su);if(E){const W=JSON.parse(E);if(W.startTime&&!W.isComplete){const M=new Date(W.startTime).toDateString(),K=new Date().toDateString();if(M===K)return W}}}catch(E){console.error("Error restoring food safety checklist state:",E)}return ru()});v.useEffect(()=>{if(n.startTime&&!n.isComplete)try{localStorage.setItem(su,JSON.stringify(n))}catch(E){console.error("[useFoodSafetyChecklist] Error saving to localStorage:",E)}},[n]);const r=v.useCallback(()=>{localStorage.removeItem(su)},[]),a=v.useCallback((E,W,M,K,ee,F="",ne="")=>{i({...ru(),campus:E,campusData:W,auditor:M,auditorEmail:K,checklistType:ee,foodVendor:F,spotCheckTrigger:ne,startTime:new Date().toISOString()})},[]),c=v.useCallback(()=>{r(),i(ru())},[r]),d=v.useCallback(()=>n.checklistType?Ti[n.checklistType]:null,[n.checklistType]),h=v.useCallback((E,W)=>{i(M=>({...M,checkResults:{...M.checkResults,[E]:W}}))},[]),p=v.useCallback((E,W)=>{i(M=>({...M,checkResults:{...M.checkResults,...W}}))},[]),g=v.useCallback(E=>{i(W=>({...W,studentParticipationCount:E}))},[]),m=v.useCallback(E=>{i(W=>({...W,foodVendor:E}))},[]),x=v.useCallback(E=>{i(W=>({...W,spotCheckTrigger:E}))},[]),k=v.useCallback(E=>{const W=`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return i(M=>({...M,issues:[...M.issues,{id:W,timestamp:new Date().toISOString(),instantRed:Tu(E.checkId),photoRequired:Jx(E.checkId),photos:[],explanation:"",status:"open",...E}]})),W},[]),S=v.useCallback((E,W)=>{i(M=>({...M,issues:M.issues.map(K=>K.id===E?{...K,...W}:K)}))},[]),_=v.useCallback((E,W)=>{i(M=>({...M,issues:M.issues.map(K=>K.id===E?{...K,photos:[...K.photos||[],W]}:K)}))},[]),w=v.useCallback(E=>{i(W=>({...W,issues:W.issues.filter(M=>M.id!==E)}))},[]),j=v.useCallback(E=>{const W=Ti[E||n.checklistType];if(!W)return{complete:!1,answered:0,total:0};let M=0,K=0;return W.sections.forEach(ee=>{ee.checks.forEach(F=>{F.optional||(M++,n.checkResults[F.id]!==void 0&&K++)})}),{complete:K===M,answered:K,total:M}},[n.checkResults,n.checklistType]),A=v.useCallback(()=>n.issues.every(E=>!(!E.explanation||E.explanation.trim()===""||E.photoRequired&&(!E.photos||E.photos.length===0))),[n.issues]),z=v.useCallback(()=>{const E=U_(n.checklistType,n.checkResults,n.issues);return i(W=>({...W,rating:E,isComplete:!0,endTime:new Date().toISOString()})),r(),{rating:E}},[n.checklistType,n.checkResults,n.issues,r]),D=v.useCallback(()=>{const E=n.startTime&&n.endTime?Math.round((new Date(n.endTime)-new Date(n.startTime))/6e4):null,W=Ti[n.checklistType];return{date:n.startTime?new Date(n.startTime).toLocaleDateString():null,time:n.startTime?new Date(n.startTime).toLocaleTimeString():null,campus:n.campus,campusData:n.campusData,auditor:n.auditor,auditorEmail:n.auditorEmail,duration:E,checklistType:n.checklistType,checklistName:W?.name||n.checklistType,foodVendor:n.foodVendor,spotCheckTrigger:n.spotCheckTrigger,studentParticipationCount:n.studentParticipationCount,checkResults:n.checkResults,rating:n.rating,issues:n.issues,totalIssues:n.issues.length,openIssues:n.issues.filter(M=>M.status==="open").length,instantRedIssues:n.issues.filter(M=>M.instantRed).length,startTime:n.startTime,endTime:n.endTime}},[n]),y=n.startTime&&!n.isComplete,C={[n.checklistType]:n.checkResults},T=n.rating?{[n.checklistType]:n.rating}:{};return{...n,isInProgress:y,currentZoneId:n.checklistType,zoneResults:C,zoneRatings:T,overallRating:n.rating,getCurrentZone:d,getZoneCompletionStatus:j,getChecklistData:D,allIssuesComplete:A,initChecklist:a,resetChecklist:c,recordCheckResult:h,recordZoneResults:p,setStudentParticipationCount:g,setFoodVendor:m,setSpotCheckTrigger:x,addIssue:k,updateIssue:S,addPhotoToIssue:_,removeIssue:w,completeChecklist:z,clearSavedState:r,setCurrentZone:()=>{},calculateAndSetZoneRating:()=>{}}},bn={green:{description:"World Class"},amber:{description:"At Risk",maxOpenIssues:2,maxDaysToFix:30},red:{description:"Not Meeting Standard"}},Z_=["high_risk_ihcp_eap","aed_present_ready","aed_pads_batteries","rescue_meds_onsite","meds_unexpired","exits_unobstructed","exit_signage","emergency_lighting","evacuation_routes_clear","cpr_certified_onsite","radios_functional","pa_system_functional","emergency_contacts_accessible"],F_=["aed_present_ready","aed_pads_batteries","bleeding_control_kits","first_aid_kits","rescue_meds_onsite","exits_unobstructed","exit_signage","emergency_lighting","evacuation_routes_clear","health_center_accessible","isolation_space_available","medication_storage","fire_extinguishers","evacuation_maps"],Ai={weekly:{id:"weekly",name:"Weekly Health & Safety Check",frequency:"weekly",order:1,description:"Complete once per week to verify all health and safety systems are operational",timeNeeded:"20-30 minutes",sections:[{name:"1. Medical Documentation & Records",description:"Verify student health records and care plans are current and accessible.",checks:[{id:"high_risk_list_current",text:"Is the high-risk student list current and accessible?",helpText:"List should be updated within last 30 days",tier:"amber",photoRequired:!1},{id:"high_risk_ihcp_eap",text:"Do all high-risk students have current IHCPs/EAPs on file?",helpText:"Individual Healthcare Plans or Emergency Action Plans for each high-risk student",tier:"red",instantRed:!0,photoRequired:!1},{id:"allergy_database_distributed",text:"Has the allergy database been distributed to all required locations (kitchen, health center, classrooms)?",helpText:"Current allergy info must be available to all staff who need it",tier:"amber",photoRequired:!1},{id:"emergency_contacts_verified",text:"Are emergency contacts verified and accessible for all students?",helpText:"Contact info should be tested and current",tier:"amber",photoRequired:!1}]},{name:"2. Equipment & Supplies - AEDs [LC]",description:"Verify all AEDs and life-saving devices are ready for use.",checks:[{id:"aed_present_ready",text:"Are all AEDs present and showing a ready indicator?",helpText:"Green light or ready status on each device",tier:"red",instantRed:!0,photoRequired:!0},{id:"aed_pads_batteries",text:"Are all AED pads and batteries unexpired?",helpText:"Check expiration dates on pads and batteries",tier:"red",instantRed:!0,photoRequired:!0},{id:"aed_inspection_logged",text:"Has the monthly AED inspection been logged?",helpText:"Inspection log should be current within 31 days",tier:"amber",photoRequired:!1},{id:"bleeding_control_kits",text:"Are bleeding control kits co-located with AEDs and fully stocked?",helpText:"Tourniquets, gauze, and other bleeding control supplies",tier:"amber",photoRequired:!0}]},{name:"2. Equipment & Supplies - Emergency Kits & Medications [LC]",description:"Verify all emergency kits and medications are present and ready.",checks:[{id:"first_aid_kits",text:"Are first aid kits present and stocked in all required locations?",helpText:"Gloves, bandages, gauze, CPR barrier, etc.",tier:"amber",photoRequired:!0},{id:"go_bags_deployed",text:"Are emergency go-bags deployed in all required zones?",helpText:"Portable emergency supplies for evacuation",tier:"amber",photoRequired:!1},{id:"rescue_meds_onsite",text:"Are rescue medications on-site for all high-risk students (EpiPens, inhalers, glucagon, etc.)?",helpText:"Each high-risk student must have their required meds on campus",tier:"red",instantRed:!0,photoRequired:!0},{id:"meds_unexpired",text:"Are all medications within their expiration dates?",helpText:"Check all stored medications for expiration",tier:"red",instantRed:!0,photoRequired:!1},{id:"med_refrigeration",text:"Is medication refrigeration functional and at proper temperature?",helpText:"Temperature should be monitored and within range",tier:"amber",photoRequired:!1}]},{name:"3. Spaces & Infrastructure - Emergency Exits [LC]",description:"Verify all emergency exits and evacuation routes are clear and functional.",checks:[{id:"exits_unobstructed",text:"Are all emergency exits unobstructed and functional?",helpText:"Doors open easily, not blocked by furniture or equipment",tier:"red",instantRed:!0,photoRequired:!0},{id:"exit_signage",text:"Is all exit signage illuminated and visible?",helpText:"EXIT signs lit and clearly visible from hallways",tier:"red",instantRed:!0,photoRequired:!0},{id:"emergency_lighting",text:"Does emergency lighting activate when tested?",helpText:"Test battery backup lights in hallways and stairwells",tier:"red",instantRed:!0,photoRequired:!0},{id:"evacuation_routes_clear",text:"Are all evacuation routes clear of obstructions?",helpText:"Hallways and stairwells free of stored items",tier:"red",instantRed:!0,photoRequired:!0}]},{name:"3. Spaces & Infrastructure - Health & Isolation Spaces",description:"Verify health center and isolation spaces are ready for use.",checks:[{id:"health_center_accessible",text:"Is the health center accessible and not being used for another purpose?",helpText:"Space available for student care, not repurposed",tier:"amber",photoRequired:!0},{id:"isolation_space_available",text:"Is the isolation space available and stocked with PPE and basic supplies?",helpText:"Masks, gloves, first-aid supplies, communication method",tier:"amber",photoRequired:!0},{id:"medication_storage",text:"Is medication storage locked and climate-controlled?",helpText:"Secure cabinet with proper temperature",tier:"amber",photoRequired:!0}]},{name:"3. Spaces & Infrastructure - Safety Equipment",description:"Verify fire safety and wayfinding equipment is in place.",checks:[{id:"fire_extinguishers",text:"Are fire extinguishers present with current inspection tags?",helpText:"Check tags for recent inspection dates",tier:"amber",photoRequired:!0},{id:"evacuation_maps",text:"Are evacuation maps posted in all rooms?",helpText:"Maps showing exits and assembly points",tier:"amber",photoRequired:!0}]},{name:"4. Staff Training & Competency",description:"Verify staff are trained and know emergency procedures.",checks:[{id:"cpr_certified_onsite",text:"Is a CPR/AED-certified adult on-site during all operating hours?",helpText:"At least one certified person present at all times",tier:"red",instantRed:!0,photoRequired:!1},{id:"staff_aware_high_risk",text:"Are staff aware of high-risk students in their care and their specific plans?",helpText:"Teachers know which students have IHCPs/EAPs and what to do",tier:"amber",photoRequired:!1},{id:"emergency_roles_current",text:"Are emergency role assignments current and acknowledged by assigned staff?",helpText:"Fire wardens, first responders, etc. know their roles",tier:"amber",photoRequired:!1},{id:"staff_equipment_access",text:"Can staff locate and access emergency equipment within 30 seconds?",helpText:"Staff know where AEDs, first aid, and meds are located",tier:"amber",photoRequired:!1}]},{name:"5. Communication & Response Systems - Equipment [LC]",description:"Verify all communication systems are operational.",checks:[{id:"radios_functional",text:"Are two-way radios functional and fully charged?",helpText:"Test radios, ensure batteries are charged",tier:"red",instantRed:!0,photoRequired:!1},{id:"pa_system_functional",text:"Is the PA system functional for all occupied areas?",helpText:"Announcements can be heard throughout campus",tier:"red",instantRed:!0,photoRequired:!1},{id:"emergency_contacts_accessible",text:"Is the emergency contact list current and accessible (911, leadership, front office)?",helpText:"Posted at security desk and key locations",tier:"red",instantRed:!0,photoRequired:!1}]},{name:"5. Communication & Response Systems - Plans & Procedures",description:"Verify emergency plans are accessible and routes are clear.",checks:[{id:"crisis_plan_accessible",text:"Is the crisis response plan accessible on-site?",helpText:"Physical or digital copy readily available",tier:"amber",photoRequired:!1},{id:"fire_plan_accessible",text:"Is the fire response plan with routes and assembly areas accessible?",helpText:"Staff know where to find fire procedures",tier:"amber",photoRequired:!1},{id:"lockdown_procedures_accessible",text:"Are lockdown/intruder procedures accessible?",helpText:"Active threat response procedures available",tier:"amber",photoRequired:!1},{id:"ems_route_clear",text:"Is the EMS access route clear with entry point identified?",helpText:"Ambulance can reach campus quickly, entry point marked",tier:"amber",photoRequired:!1}]}]}},Y_=n=>{const i=Ai[n];return!i||!i.sections?[]:i.sections.flatMap(r=>r.checks.map(a=>({...a,section:r.name})))},ao=n=>Z_.includes(n),ts=n=>F_.includes(n),K_=(n,i,r)=>{const c=Y_(n).filter(x=>i[x.id]===!1);if(c.length===0)return"GREEN";if(c.some(x=>x.instantRed))return"RED";const h=r.filter(x=>x.status==="open");if(h.length>bn.amber.maxOpenIssues||h.some(x=>!x.owner||!x.fixDate))return"RED";const g=new Date;return h.some(x=>{const k=new Date(x.createdAt);return Math.floor((g-k)/(1e3*60*60*24))>bn.amber.maxDaysToFix})?"RED":"AMBER"},Q_=[{id:"weekly",name:"Weekly Health & Safety Check",icon:"",color:"#059669"}],J_=({healthSafetyChecklist:n})=>{const i=xe(),[r,a]=v.useState("weekly"),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(""),x=r?Ai[r]:null,k=()=>{if(!r){alert("Please select a checklist type");return}if(!c){alert("Please select a campus");return}if(!h.trim()){alert("Please enter your name");return}if(!g.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)){alert("Please enter a valid email address");return}const S=an.find(_=>_.name===c);n.initChecklist(c,S,h.trim(),g.trim(),r),window.scrollTo(0,0),i("/health-safety/checklist")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Health & Safety",subtitle:"14.03 Quality Bar Checklist",onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Checklist Type"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"12px"},children:Q_.map(S=>{const _=Ai[S.id],w=r===S.id;return s.jsxs("button",{onClick:()=>a(S.id),style:{padding:"16px",borderRadius:"12px",border:w?`3px solid ${S.color}`:"2px solid #e5e7eb",backgroundColor:w?`${S.color}10`:"#fff",cursor:"pointer",textAlign:"center",transition:"all 0.2s"},children:[s.jsx("div",{style:{fontSize:"28px",marginBottom:"8px"},children:S.icon}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:w?S.color:"#333"},children:S.name}),s.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:_?.timeNeeded})]},S.id)})})]}),x&&s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:[s.jsxs("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:[x.name," - What You'll Check"]}),x.sections.map((S,_)=>s.jsxs("div",{style:{padding:"10px 0",borderBottom:_<x.sections.length-1?"1px solid rgba(71, 196, 230, 0.3)":"none"},children:[s.jsx("div",{style:{fontWeight:"500",fontSize:"15px",color:"#333"},children:S.name}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"2px"},children:[S.checks.length," check",S.checks.length>1?"s":""]})]},_))]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Campus *"}),s.jsx(Xn,{value:c,onChange:d,placeholder:"Select campus..."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Name *"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:h,onChange:S=>p(S.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Email *"}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:g,onChange:S=>m(S.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Rating System"}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10b981",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#059669"},children:bn.green.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"All checks pass"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#f59e0b",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#d97706"},children:bn.amber.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Issues found with compensating controls in place"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#ef4444",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#dc2626"},children:bn.red.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Life-critical issues need immediate attention"})]})]})]}),s.jsxs("div",{style:{backgroundColor:"rgba(254, 243, 199, 0.5)",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:"Important - Life-Critical Items [LC]"}),s.jsxs("div",{style:{fontSize:"14px",color:"#78350f"},children:["Items marked ",s.jsx("strong",{children:"[LC]"})," are Life-Critical. If any of these fail, the campus rating is automatically RED until fixed."]}),s.jsx("div",{style:{fontSize:"14px",color:"#78350f",marginTop:"8px"},children:'Per Quality Bar 14.03: Any "No" response requires a named owner, compensating control, and remediation within 30 days.'})]}),s.jsx("button",{onClick:k,disabled:!r,style:{width:"100%",backgroundColor:r?"#092849":"#9ca3af",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"pointer":"not-allowed",marginTop:"8px"},children:"Begin Health & Safety Check"})]})]})},X_=({healthSafetyChecklist:n,camera:i})=>{const r=xe(),[a,c]=v.useState({}),[d,h]=v.useState({}),{checklistType:p,checkResults:g,issues:m,recordZoneResults:x,addIssue:k,updateIssue:S,addPhotoToIssue:_}=n,w=Ai[p];v.useEffect(()=>{if(g&&c(()=>g),w?.sections){const B={};w.sections.forEach($=>{B[$.name]=!0}),h(()=>B)}},[p]),v.useEffect(()=>{(!n.startTime||!p)&&r("/health-safety")},[n.startTime,p,r]);const j=(B,$)=>{c(O=>({...O,[B]:$}))},A=B=>{h($=>({...$,[B]:!$[B]}))},z=()=>w?.sections?.reduce((B,$)=>B+$.checks.length,0)||0,D=()=>Object.keys(a).filter(B=>a[B]!==void 0).length,y=D()===z(),T=(()=>{const B=[];return w?.sections?.forEach($=>{$.checks.forEach(O=>{a[O.id]===!1&&B.push({...O,section:$.name})})}),B})(),E=T.every(B=>{const $=m.find(O=>O.checkId===B.id);return!(!$||!$.explanation||$.explanation.trim()===""||ts(B.id)&&(!$.photos||$.photos.length===0))}),W=T.length===0&&y,M=y&&(W||E),K=B=>{let $=m.find(q=>q.checkId===B.id),O=$?.id;if(!$){const q={checklistType:p,checklistName:w.name,checkId:B.id,checkText:B.text,section:B.section,instantRed:ao(B.id),photoRequired:ts(B.id),photos:[],explanation:""};O=k(q)}i.openCamera(q=>{q&&O&&_(O,q)})},ee=(B,$)=>{const O=m.find(q=>q.id===B);if(O){const q=O.photos.filter((Z,re)=>re!==$);S(B,{photos:q})}},F=(B,$)=>{let O=m.find(q=>q.checkId===B);if(O)S(O.id,{explanation:$.slice(0,500)});else{const q=T.find(Z=>Z.id===B);q&&k({checklistType:p,checklistName:w.name,checkId:q.id,checkText:q.text,section:q.section,instantRed:ao(q.id),photoRequired:ts(q.id),photos:[],explanation:$.slice(0,500)})}},ne=()=>{x(p,a),T.forEach(B=>{m.find(O=>O.checkId===B.id)||k({checklistType:p,checklistName:w.name,checkId:B.id,checkText:B.text,section:B.section,instantRed:ao(B.id),photoRequired:ts(B.id),photos:[],explanation:""})}),r("/health-safety/summary")},se=()=>{r("/health-safety")};return w?s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"120px"},children:[s.jsx("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",color:"#fff",padding:"20px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("button",{onClick:se,style:{fontSize:"24px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff"},children:""}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("h1",{style:{fontSize:"20px",fontWeight:"700",margin:0},children:w.name}),s.jsx("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:n.campus})]}),s.jsx("div",{style:{width:"40px"}})]})}),s.jsxs("div",{style:{backgroundColor:"#fff",padding:"12px 20px",borderBottom:"1px solid #e5e7eb"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"Progress"}),s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#092849"},children:[D()," / ",z()]})]}),s.jsx("div",{style:{height:"8px",backgroundColor:"#e5e7eb",borderRadius:"4px",overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",width:`${D()/z()*100}%`,backgroundColor:y?"#10b981":"#2563eb",borderRadius:"4px",transition:"width 0.3s"}})})]}),s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.5)",borderLeft:"4px solid #2B57D0",padding:"14px 16px",margin:"16px 20px",borderRadius:"8px"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#141685"},children:w.description}),s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"4px"},children:["Estimated time: ",w.timeNeeded]})]}),s.jsxs("div",{style:{padding:"0 20px"},children:[w.sections?.map(B=>s.jsxs("div",{style:{marginBottom:"16px"},children:[s.jsxs("button",{onClick:()=>A(B.name),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",backgroundColor:"#092849",color:"#fff",borderRadius:d[B.name]?"12px 12px 0 0":"12px",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:[s.jsx("span",{children:B.name}),s.jsx("span",{style:{transform:d[B.name]?"rotate(180deg)":"rotate(0)",transition:"transform 0.2s"},children:""})]}),d[B.name]&&B.description&&s.jsx("div",{style:{backgroundColor:"#f9fafb",padding:"12px 16px",borderLeft:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb",fontSize:"14px",color:"#666"},children:B.description}),d[B.name]&&s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0 0 12px 12px",border:"1px solid #e5e7eb",borderTop:B.description?"none":"1px solid #e5e7eb"},children:B.checks.map(($,O)=>{const q=a[$.id],Z=m.find(I=>I.checkId===$.id),re=ao($.id),ae=ts($.id);return s.jsxs("div",{style:{padding:"16px",borderBottom:O<B.checks.length-1?"1px solid #e5e7eb":"none"},children:[re&&s.jsx("div",{style:{display:"inline-block",backgroundColor:"#fee2e2",color:"#dc2626",fontSize:"11px",fontWeight:"700",padding:"2px 8px",borderRadius:"4px",marginBottom:"8px"},children:"LIFE-CRITICAL [LC]"}),s.jsx("div",{style:{fontSize:"15px",marginBottom:"8px",color:"#333",lineHeight:"1.4"},children:$.text}),$.helpText&&s.jsx("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px",fontStyle:"italic"},children:$.helpText}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("button",{onClick:()=>j($.id,!0),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:q===!0?"#10b981":"#f3f4f6",color:q===!0?"#fff":"#333"},children:" Yes"}),s.jsx("button",{onClick:()=>j($.id,!1),style:{flex:1,padding:"12px",borderRadius:"10px",fontWeight:"600",fontSize:"15px",border:"none",cursor:"pointer",backgroundColor:q===!1?"#ef4444":"#f3f4f6",color:q===!1?"#fff":"#333"},children:" No"})]}),q===!1&&s.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",border:"1px solid #fecaca"},children:[s.jsxs("div",{style:{marginBottom:ae?"12px":"0"},children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:"#b91c1c",marginBottom:"6px"},children:"Explanation Required *"}),s.jsx("textarea",{value:Z?.explanation||"",onChange:I=>F($.id,I.target.value),placeholder:"Describe what was found and the compensating control in place...",maxLength:500,style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #fca5a5",fontSize:"14px",resize:"none",minHeight:"70px",fontFamily:"inherit",boxSizing:"border-box"}})]}),ae&&s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:"#b91c1c",marginBottom:"6px"},children:"Photo Required *"}),Z?.photos?.length>0&&s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginBottom:"8px"},children:Z.photos.map((I,U)=>s.jsxs("div",{style:{position:"relative"},children:[s.jsx("img",{src:I,alt:`Issue ${U+1}`,style:{width:"100%",height:"80px",borderRadius:"6px",objectFit:"cover"}}),s.jsx("button",{onClick:()=>ee(Z.id,U),style:{position:"absolute",top:"2px",right:"2px",backgroundColor:"#ef4444",color:"#fff",width:"20px",height:"20px",borderRadius:"50%",border:"none",cursor:"pointer",fontSize:"12px",fontWeight:"700"},children:""})]},U))}),s.jsxs("button",{onClick:()=>K({...$,section:B.name}),style:{width:"100%",padding:"10px",border:"2px dashed #fca5a5",borderRadius:"6px",backgroundColor:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[s.jsx("span",{children:""}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#b91c1c"},children:Z?.photos?.length>0?"Add Another Photo":"Take Photo"})]})]})]})]},$.id)})})]},B.name)),y&&W&&s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginTop:"16px",border:"2px solid #10b981"},children:s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#059669"},children:" All checks passed!"})}),y&&!W&&!E&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginTop:"16px",border:"2px solid #f59e0b"},children:[s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#d97706"},children:" Please complete all issue documentation"}),s.jsxs("div",{style:{fontSize:"13px",color:"#78350f",marginTop:"4px"},children:['Every "No" answer needs an explanation',T.some(B=>ts(B.id))?" and photo where required":"","."]})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:ne,disabled:!M,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:M?"pointer":"not-allowed",backgroundColor:M?"#092849":"#d1d5db",color:M?"#fff":"#9ca3af"},children:y?!E&&!W?"Complete All Issue Documentation":"Review Summary ":`Answer All Questions (${D()}/${z()})`})})]}):null},ej=async n=>{const{date:i,time:r,campus:a,campusData:c,auditor:d,auditorEmail:h,duration:p,checklistType:g,checklistName:m,checkResults:x,rating:k,issues:S,totalIssues:_,openIssues:w,instantRedIssues:j,startTime:A,endTime:z}=n,{data:D,error:y}=await ct.from("health_safety_audits").insert([{date:i,time:r,campus:a,campus_data:c,auditor:d,auditor_email:h,duration:p,checklist_type:g,checklist_name:m,check_results:x,overall_rating:k,issues:S,total_issues:_,open_issues:w,instant_red_issues:j,start_time:A,end_time:z}]).select();if(y)throw console.error("Error saving health & safety audit:",y),y;return D[0]},tj=({healthSafetyChecklist:n})=>{const i=xe(),[r,a]=v.useState(!1),{campus:c,auditor:d,auditorEmail:h,startTime:p,checklistType:g,issues:m,completeChecklist:x}=n,k=Ai[g],S=v.useMemo(()=>{if(!p)return null;const y=new Date(p),T=new Date-y,E=Math.round(T/6e4),W=Math.floor(E/60),M=E%60;return{total:E,hours:W,mins:M}},[p]),w=v.useMemo(()=>x(),[x])?.rating,j=m.filter(y=>y.instantRed),A=m.filter(y=>!y.instantRed),z=y=>{switch(y){case"GREEN":return"#10b981";case"AMBER":return"#f59e0b";case"RED":return"#ef4444";default:return"#6b7280"}},D=async()=>{a(!0);try{const y=n.getChecklistData();if(await ej(y),zi(c))try{console.log("[Health & Safety Checklist] Creating consolidated Wrike task...");const C=m.map(T=>({category:T.instantRed?" Instant Red":"Issue",section:T.section,check:T.checkText,description:T.explanation||"Issue found",photos:T.photos||[]}));await ds({checklistType:"HEALTH_SAFETY",campusName:c,auditorName:d,auditorEmail:h,issues:C,date:new Date().toLocaleDateString()}),console.log("[Health & Safety Checklist] Wrike task created")}catch(C){console.error("[Health & Safety Checklist] Wrike error:",C)}i("/health-safety/complete")}catch(y){console.error("Error saving health & safety audit:",y),alert("Error saving audit. Please try again.")}finally{a(!1)}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsxs("div",{style:{background:w==="GREEN"?"linear-gradient(180deg, #059669 0%, #047857 100%)":w==="AMBER"?"linear-gradient(180deg, #d97706 0%, #b45309 100%)":"linear-gradient(180deg, #dc2626 0%, #b91c1c 100%)",color:"#fff",padding:"30px 20px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"12px"},children:w==="GREEN"?"":w==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"28px",fontWeight:"700",margin:"0 0 8px 0"},children:w==="GREEN"?bn.green.description:w==="AMBER"?bn.amber.description:bn.red.description}),s.jsx("p",{style:{fontSize:"16px",opacity:.9,margin:0},children:k?.name||g}),s.jsxs("p",{style:{fontSize:"14px",opacity:.8,margin:"4px 0 0 0"},children:[c," - Completed by ",d]}),S&&s.jsxs("div",{style:{marginTop:"12px",backgroundColor:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"8px 16px",display:"inline-block"},children:[s.jsx("span",{style:{fontSize:"14px",opacity:.9},children:"Duration: "}),s.jsx("span",{style:{fontSize:"16px",fontWeight:"700"},children:S.hours>0?`${S.hours}h ${S.mins}m`:`${S.mins} minutes`})]})]}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:`2px solid ${z(w)}`,textAlign:"center"},children:[s.jsx("div",{style:{display:"inline-block",padding:"12px 32px",borderRadius:"8px",backgroundColor:z(w),color:"#fff",fontSize:"24px",fontWeight:"700"},children:w}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginTop:"12px"},children:m.length===0?"All checks passed!":`${m.length} issue${m.length>1?"s":""} found`})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:"Rating Breakdown:"}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:j.length===0?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:j.length===0?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["No Life-Critical [LC] items failed (",j.length," found)"]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[s.jsx("span",{style:{width:"20px",height:"20px",borderRadius:"50%",backgroundColor:m.length<=bn.amber.maxOpenIssues?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:"12px"},children:m.length<=bn.amber.maxOpenIssues?"":""}),s.jsxs("span",{style:{fontSize:"14px"},children:["",bn.amber.maxOpenIssues," open issues (",m.length," total)"]})]})]}),j.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"2px solid #ef4444"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#dc2626"},children:[" Life-Critical [LC] Issues (",j.length,")"]}),s.jsx("div",{style:{fontSize:"13px",color:"#b91c1c",marginBottom:"12px"},children:"These issues require immediate escalation and remediation within 30 days."}),j.map((y,C)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#b91c1c"},children:y.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:y.checkText}),y.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",y.explanation]}),y.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:y.photos.map((T,E)=>s.jsx("img",{src:T,alt:`Issue ${E+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},E))})]},C))]}),A.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px",border:"1px solid #e5e7eb"},children:[s.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",color:"#092849"},children:["Other Issues (",A.length,")"]}),A.map((y,C)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef3c7",borderRadius:"8px",marginBottom:"8px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e"},children:y.section}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginTop:"4px"},children:y.checkText}),y.explanation&&s.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#fff",borderRadius:"4px"},children:[s.jsx("strong",{children:"Explanation:"})," ",y.explanation]}),y.photos?.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:y.photos.map((T,E)=>s.jsx("img",{src:T,alt:`Issue ${E+1}`,style:{width:"60px",height:"60px",borderRadius:"6px",objectFit:"cover"}},E))})]},C))]}),m.length===0&&s.jsxs("div",{style:{backgroundColor:"#f0fdf4",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #10b981",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:""}),s.jsx("div",{style:{fontSize:"18px",fontWeight:"600",color:"#059669"},children:"No Issues Found!"}),s.jsx("div",{style:{fontSize:"14px",color:"#065f46",marginTop:"4px"},children:"All health & safety checks passed."})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:D,disabled:r,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:r?"not-allowed":"pointer",backgroundColor:r?"#9ca3af":"#092849",color:"#fff"},children:r?"Submitting...":"Submit Report "})})]})},nj=({healthSafetyChecklist:n})=>{const i=xe(),{campus:r,overallRating:a,issues:c}=n,d=c.filter(g=>g.instantRed).length,h=()=>{n.resetChecklist(),i("/")},p=()=>{n.resetChecklist(),i("/health-safety")};return s.jsx("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px"},children:s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"40px 30px",textAlign:"center",maxWidth:"400px",width:"100%",boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},children:[s.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:a==="GREEN"?"":a==="AMBER"?"":""}),s.jsx("h1",{style:{fontSize:"24px",fontWeight:"700",color:"#092849",margin:"0 0 12px 0"},children:"Checklist Submitted!"}),s.jsxs("p",{style:{fontSize:"16px",color:"#666",margin:"0 0 24px 0"},children:[r," health & safety checklist has been saved."]}),s.jsxs("div",{style:{display:"inline-block",padding:"12px 24px",borderRadius:"8px",marginBottom:"24px",backgroundColor:a==="GREEN"?"#f0fdf4":a==="AMBER"?"#fef3c7":"#fee2e2",border:`2px solid ${a==="GREEN"?"#10b981":a==="AMBER"?"#f59e0b":"#ef4444"}`},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"4px"},children:"Overall Rating"}),s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:a==="GREEN"?"#059669":a==="AMBER"?"#d97706":"#dc2626"},children:a})]}),c.length>0&&s.jsxs("div",{style:{backgroundColor:"#f9fafb",borderRadius:"8px",padding:"16px",marginBottom:"24px",textAlign:"left"},children:[s.jsxs("div",{style:{fontSize:"14px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:["Issues Reported: ",c.length]}),d>0&&s.jsxs("div",{style:{fontSize:"13px",color:"#dc2626"},children:[" ",d," Life-Critical [LC] item",d>1?"s":""]}),c.length-d>0&&s.jsxs("div",{style:{fontSize:"13px",color:"#d97706"},children:[" ",c.length-d," other issue",c.length-d>1?"s":""]})]}),s.jsxs("div",{style:{backgroundColor:"#eff6ff",borderRadius:"8px",padding:"16px",marginBottom:"24px",textAlign:"left"},children:[s.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#1e40af",marginBottom:"8px"},children:"Next Steps"}),s.jsx("div",{style:{fontSize:"13px",color:"#1e3a8a"},children:c.length>0?"Per Quality Bar 14.03: Assign owners and remediation dates to all issues within 30 days. Life-Critical [LC] items require immediate compensating controls.":"Continue completing weekly checks to maintain World Class status."})]}),s.jsx("button",{onClick:h,style:{width:"100%",padding:"16px",backgroundColor:"#092849",color:"#fff",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"600",cursor:"pointer",marginBottom:"12px"},children:"Done"}),s.jsx("button",{onClick:p,style:{width:"100%",padding:"16px",backgroundColor:"#f3f4f6",color:"#333",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:"Start Another Checklist"})]})})},ou="health_safety_checklist_state",au=()=>({campus:null,campusData:null,auditor:"",auditorEmail:"",startTime:null,checklistType:null,checkResults:{},issues:[],rating:null,isComplete:!1,endTime:null}),ij=()=>{const[n,i]=v.useState(()=>{try{const y=localStorage.getItem(ou);if(y){const C=JSON.parse(y);if(C.startTime&&!C.isComplete){const T=new Date(C.startTime).toDateString(),E=new Date().toDateString();if(T===E)return C}}}catch(y){console.error("Error restoring health & safety checklist state:",y)}return au()});v.useEffect(()=>{if(n.startTime&&!n.isComplete)try{localStorage.setItem(ou,JSON.stringify(n))}catch(y){console.error("[useHealthSafetyChecklist] Error saving to localStorage:",y)}},[n]);const r=v.useCallback(()=>{localStorage.removeItem(ou)},[]),a=v.useCallback((y,C,T,E,W)=>{i({...au(),campus:y,campusData:C,auditor:T,auditorEmail:E,checklistType:W,startTime:new Date().toISOString()})},[]),c=v.useCallback(()=>{r(),i(au())},[r]),d=v.useCallback(()=>n.checklistType?Ai[n.checklistType]:null,[n.checklistType]),h=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,[y]:C}}))},[]),p=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,...C}}))},[]),g=v.useCallback(y=>{const C=`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return i(T=>({...T,issues:[...T.issues,{id:C,timestamp:new Date().toISOString(),instantRed:ao(y.checkId),photoRequired:ts(y.checkId),photos:[],explanation:"",status:"open",...y}]})),C},[]),m=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,...C}:E)}))},[]),x=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,photos:[...E.photos||[],C]}:E)}))},[]),k=v.useCallback(y=>{i(C=>({...C,issues:C.issues.filter(T=>T.id!==y)}))},[]),S=v.useCallback(y=>{const C=Ai[y||n.checklistType];if(!C)return{complete:!1,answered:0,total:0};let T=0,E=0;return C.sections.forEach(W=>{W.checks.forEach(M=>{T++,n.checkResults[M.id]!==void 0&&E++})}),{complete:E===T,answered:E,total:T}},[n.checkResults,n.checklistType]),_=v.useCallback(()=>n.issues.every(y=>!(!y.explanation||y.explanation.trim()===""||y.photoRequired&&(!y.photos||y.photos.length===0))),[n.issues]),w=v.useCallback(()=>{const y=K_(n.checklistType,n.checkResults,n.issues);return i(C=>({...C,rating:y,isComplete:!0,endTime:new Date().toISOString()})),r(),{rating:y}},[n.checklistType,n.checkResults,n.issues,r]),j=v.useCallback(()=>{const y=n.startTime&&n.endTime?Math.round((new Date(n.endTime)-new Date(n.startTime))/6e4):null,C=Ai[n.checklistType];return{date:n.startTime?new Date(n.startTime).toLocaleDateString():null,time:n.startTime?new Date(n.startTime).toLocaleTimeString():null,campus:n.campus,campusData:n.campusData,auditor:n.auditor,auditorEmail:n.auditorEmail,duration:y,checklistType:n.checklistType,checklistName:C?.name||n.checklistType,checkResults:n.checkResults,rating:n.rating,issues:n.issues,totalIssues:n.issues.length,openIssues:n.issues.filter(T=>T.status==="open").length,instantRedIssues:n.issues.filter(T=>T.instantRed).length,startTime:n.startTime,endTime:n.endTime}},[n]),A=n.startTime&&!n.isComplete,z={[n.checklistType]:n.checkResults},D=n.rating?{[n.checklistType]:n.rating}:{};return{...n,isInProgress:A,currentZoneId:n.checklistType,zoneResults:z,zoneRatings:D,overallRating:n.rating,getCurrentZone:d,getZoneCompletionStatus:S,getChecklistData:j,allIssuesComplete:_,initChecklist:a,resetChecklist:c,recordCheckResult:h,recordZoneResults:p,addIssue:g,updateIssue:m,addPhotoToIssue:x,removeIssue:k,completeChecklist:w,clearSavedState:r,setCurrentZone:()=>{},calculateAndSetZoneRating:()=>{}}},il={green:{description:"World Class"},amber:{description:"At Risk",maxOpenIssues:3},red:{description:"Not Meeting Standard"}},sj=["hvac_no_stuffiness","hvac_no_mold","plumbing_no_leaks","plumbing_no_discolored_water","plumbing_no_sewage_odor","electrical_no_hazards","electrical_exit_signs_work","electrical_emergency_lights_work","specialty_cooler_temp_safe","specialty_freezer_temp_safe","specialty_elevator_safe"],rj=["hvac_no_mold","plumbing_no_leaks","electrical_no_hazards","specialty_cooler_temp_safe","specialty_freezer_temp_safe"],rs={weekly:{id:"weekly",name:"Weekly Mechanical Systems Check",frequency:"weekly",order:1,description:"Human-verified inspection of all mechanical systems",timeNeeded:"30-45 minutes",persona:"Campus Manager or Facilities Staff",sections:[{name:"A. HVAC - Thermal Comfort & Air Quality",description:"Check that rooms are comfortable and air is fresh.",checks:[{id:"hvac_temp_comfortable",text:"Are all occupied rooms at a comfortable temperature (not too hot, not too cold)?",helpText:"Walk through classrooms and common areas. Target: 70-74F in classrooms, 68-76F in common areas.",tier:"amber",photoRequired:!1},{id:"hvac_no_hot_cold_spots",text:"Are there NO hot or cold spots reported by staff or students?",helpText:"Check with staff if anyone has complained about specific areas being uncomfortable.",tier:"amber",photoRequired:!1},{id:"hvac_no_stuffiness",text:"Is the air fresh and NOT stuffy in all occupied spaces?",helpText:"Stuffy air = poor ventilation = cognitive impact. If air feels heavy or stale, this is RED.",tier:"red",instantRed:!0,photoRequired:!1},{id:"hvac_no_odors",text:"Are all spaces free of unusual odors?",helpText:"No musty, chemical, or stale smells. Odors may indicate mold, poor ventilation, or other issues.",tier:"amber",photoRequired:!1},{id:"hvac_no_mold",text:"Is there NO visible mold, condensation on vents, or moisture on windows/walls?",helpText:"Check vents, window frames, and walls. Any mold is an INSTANT RED.",tier:"red",instantRed:!0,photoRequired:!0},{id:"hvac_vents_working",text:"Is air flowing from vents? (Use tissue paper test)",helpText:"Hold tissue near vent - it should move. No airflow = system issue.",tier:"amber",photoRequired:!1},{id:"hvac_no_unusual_noise",text:"Are HVAC units running quietly (no rattling, buzzing, or squealing)?",helpText:"Unusual noises may indicate mechanical problems that need attention.",tier:"amber",photoRequired:!1},{id:"hvac_thermostats_working",text:"Are thermostats displaying correctly and responding to adjustments?",helpText:"Check that displays are on and setpoints can be changed.",tier:"amber",photoRequired:!1},{id:"hvac_filters_clean",text:"Have air filters been checked/replaced within the last 90 days?",helpText:"Check filter log or visually inspect if accessible. Dirty filters reduce air quality.",tier:"amber",photoRequired:!1},{id:"hvac_mechanical_room_clean",text:"Are mechanical rooms clean, accessible, and free of stored items?",helpText:"No clutter, clear pathways, no water on floor.",tier:"amber",photoRequired:!1}]},{name:"B. Plumbing - Water Safety & Leak Defense",description:"Verify water quality and check for leaks.",checks:[{id:"plumbing_hot_water_fast",text:"Does hot water arrive at taps within 10 seconds?",helpText:"Test at the farthest sink from the water heater. Slow = recirculation pump issue.",tier:"amber",photoRequired:!1},{id:"plumbing_water_temp_safe",text:"Is hot water warm but not scalding at sinks?",helpText:"Should feel comfortably warm, not dangerously hot.",tier:"amber",photoRequired:!1},{id:"plumbing_fountains_cold",text:"Is water from drinking fountains cold and refreshing (not warm or tepid)?",helpText:"Water should be noticeably cool, under 60F ideally.",tier:"amber",photoRequired:!1},{id:"plumbing_no_discolored_water",text:"Is all water clear (not discolored, rusty, or cloudy)?",helpText:"Run water briefly at multiple fixtures. Any discoloration is INSTANT RED.",tier:"red",instantRed:!0,photoRequired:!1},{id:"plumbing_no_bad_taste",text:"Is water from fountains free of metallic taste or unusual flavor?",helpText:"Bad taste may indicate pipe issues or filter problems.",tier:"amber",photoRequired:!1},{id:"plumbing_no_sewage_odor",text:"Are all areas free of sewage or drain odors?",helpText:"Sewage smell = dry P-trap or plumbing issue. INSTANT RED.",tier:"red",instantRed:!0,photoRequired:!1},{id:"plumbing_no_leaks",text:"Are there NO active leaks anywhere (under sinks, toilets, ceilings)?",helpText:"Check under sinks, around toilets, ceiling tiles. Any active leak is INSTANT RED.",tier:"red",instantRed:!0,photoRequired:!0},{id:"plumbing_no_running_toilets",text:"Are all toilets flushing properly and NOT running continuously?",helpText:"Listen for running water. Continuous running = wasted water and potential issue.",tier:"amber",photoRequired:!1},{id:"plumbing_drains_clear",text:"Are all drains flowing freely (no slow drains or backups)?",helpText:"Water should drain quickly without pooling.",tier:"amber",photoRequired:!1},{id:"plumbing_monday_flush_done",text:"Was the Monday Morning Flush completed before students arrived?",helpText:"Run all fixtures for 1-2 minutes every Monday to clear stagnant water.",tier:"amber",photoRequired:!1}]},{name:"C. Electrical & Lighting - Visual Quality & Safety",description:"Check that lighting is adequate and electrical systems are safe.",checks:[{id:"electrical_all_lights_work",text:"Are ALL lights working (no dead bulbs or dark areas)?",helpText:"Walk through all spaces. Every light should be on and functional.",tier:"amber",photoRequired:!1},{id:"electrical_no_flickering",text:"Are lights free of visible flickering?",helpText:"Flickering can cause eye strain and headaches. Replace affected bulbs/fixtures.",tier:"amber",photoRequired:!1},{id:"electrical_no_buzzing",text:"Are lights and fixtures free of buzzing or humming sounds?",helpText:"Buzzing may indicate ballast issues or loose connections.",tier:"amber",photoRequired:!1},{id:"electrical_adequate_brightness",text:"Is lighting bright enough for all activities (no dark corners)?",helpText:"Classrooms should have even, adequate light for reading and work.",tier:"amber",photoRequired:!1},{id:"electrical_color_consistent",text:"Are light colors consistent (no mismatched warm/cool bulbs)?",helpText:"All bulbs in a room should be the same color temperature.",tier:"amber",photoRequired:!1},{id:"electrical_exit_signs_work",text:"Are ALL exit signs illuminated and visible?",helpText:"Every exit sign must be lit. Dark exit signs are an INSTANT RED safety issue.",tier:"red",instantRed:!0,photoRequired:!1},{id:"electrical_emergency_lights_work",text:"Do emergency lights turn on when tested (push test button)?",helpText:"Test monthly. Press and hold test button - lights should illuminate.",tier:"red",instantRed:!0,photoRequired:!1},{id:"electrical_no_hazards",text:"Are there NO electrical hazards (exposed wires, broken outlets, daisy-chained power strips)?",helpText:"Check outlets, switches, and power cords. Any exposed wiring is INSTANT RED.",tier:"red",instantRed:!0,photoRequired:!0},{id:"electrical_panels_accessible",text:"Are electrical panels accessible with 3ft clearance and properly labeled?",helpText:"Nothing stored in front of panels. Labels should be legible.",tier:"amber",photoRequired:!1},{id:"electrical_no_hot_panels",text:"Are electrical panels cool to the touch (not warm or hot)?",helpText:"Carefully check panel door temperature. Hot panels need immediate attention.",tier:"amber",photoRequired:!1}]},{name:"D. Specialty Systems - Cold Chain & Elevators",description:"Verify kitchen refrigeration and elevator safety.",checks:[{id:"specialty_cooler_temp_safe",text:"Are refrigerators/coolers at safe temperature (35-38F)?",helpText:"Check thermometer in each unit. Above 41F for >2 hours = food safety risk = INSTANT RED.",tier:"red",instantRed:!0,photoRequired:!0},{id:"specialty_freezer_temp_safe",text:"Are freezers at safe temperature (0F or below)?",helpText:"Check thermometer. Signs of thaw/refreeze (ice crystals on food) = INSTANT RED.",tier:"red",instantRed:!0,photoRequired:!0},{id:"specialty_cooler_door_seals",text:"Do refrigerator/freezer door seals close tightly? (Dollar bill test)",helpText:"Close door on dollar bill - it should hold firm. Loose seal = energy waste and temp issues.",tier:"amber",photoRequired:!1},{id:"specialty_cooler_coils_clean",text:"Are refrigerator/freezer coils free of ice buildup and dust?",helpText:"Check visible coils for frost buildup or heavy dust accumulation.",tier:"amber",photoRequired:!1},{id:"specialty_temp_logs_current",text:"Are temperature logs being recorded twice daily (AM/PM)?",helpText:"Check log sheet. Missing entries indicate process failure.",tier:"amber",photoRequired:!1},{id:"specialty_elevator_smooth",text:"Does the elevator operate smoothly (no jerking, grinding, or unusual sounds)?",helpText:"Take a test ride. Should accelerate and stop smoothly.",tier:"amber",photoRequired:!1},{id:"specialty_elevator_levels",text:"Does the elevator stop level with the floor (within 1/4 inch)?",helpText:"Check gap between elevator floor and building floor. Large gaps are trip hazards.",tier:"amber",photoRequired:!1},{id:"specialty_elevator_safe",text:"Do elevator doors open/close properly and emergency phone/alarm work?",helpText:"Test emergency phone - should connect to monitoring. INSTANT RED if not working.",tier:"red",instantRed:!0,photoRequired:!1},{id:"specialty_elevator_certificate",text:"Is the elevator inspection certificate current and posted?",helpText:"Check certificate in elevator cab. Expired certificate = compliance issue.",tier:"amber",photoRequired:!1},{id:"specialty_elevator_clean",text:"Is the elevator cab clean, well-lit, and buttons working?",helpText:"All buttons should illuminate and function. Interior should be clean.",tier:"amber",photoRequired:!1}]},{name:"E. Preventive Maintenance Status",description:"Confirm PM schedules are current for all systems.",checks:[{id:"pm_hvac_scheduled",text:"Is preventive maintenance scheduled and current for HVAC systems?",helpText:"Check PM records - filters, belts, coils should be serviced on schedule.",tier:"amber",photoRequired:!1},{id:"pm_plumbing_scheduled",text:"Is preventive maintenance scheduled and current for plumbing systems?",helpText:"Water heater flush, backflow testing, etc. should be documented.",tier:"amber",photoRequired:!1},{id:"pm_electrical_scheduled",text:"Is preventive maintenance scheduled and current for electrical systems?",helpText:"Panel inspections, emergency light battery tests, etc.",tier:"amber",photoRequired:!1},{id:"pm_refrigeration_scheduled",text:"Is preventive maintenance scheduled and current for refrigeration equipment?",helpText:"Compressor service, coil cleaning, gasket replacement.",tier:"amber",photoRequired:!1},{id:"pm_elevator_scheduled",text:"Is preventive maintenance scheduled and current for elevators?",helpText:"Elevator service contract should include regular maintenance visits.",tier:"amber",photoRequired:!1}]}]}},oj=n=>{const i=rs[n];return!i||!i.sections?[]:i.sections.flatMap(r=>r.checks.map(a=>({...a,section:r.name})))},Au=n=>sj.includes(n),Xx=n=>rj.includes(n),ey=(n,i,r)=>{const c=oj(n).filter(p=>i[p.id]===!1);return c.length===0?"GREEN":c.some(p=>p.instantRed)||r.filter(p=>p.status==="open").length>il.amber.maxOpenIssues?"RED":"AMBER"},Yu=[{id:"hvac",name:"HVAC",icon:"",description:"Thermal Comfort & Air Quality"},{id:"plumbing",name:"Plumbing",icon:"",description:"Water Safety & Leak Defense"},{id:"electrical",name:"Electrical",icon:"",description:"Lighting Quality & Safety"},{id:"specialty",name:"Specialty",icon:"",description:"Cold Chain & Elevators"},{id:"pm",name:"PM Status",icon:"",description:"Preventive Maintenance"}],aj=({mechanicalChecklist:n})=>{const i=xe(),[r,a]=v.useState(""),[c,d]=v.useState(""),[h,p]=v.useState(""),g=rs.weekly,m=()=>{if(!r){alert("Please select a campus");return}if(!c.trim()){alert("Please enter your name");return}if(!h.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)){alert("Please enter a valid email address");return}const x=an.find(k=>k.name===r);n.initChecklist(r,x,c.trim(),h.trim()),window.scrollTo(0,0),i("/mechanical/checklist")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Mechanical Systems",subtitle:"14.11 Quality Bar",onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[s.jsx("span",{style:{fontSize:"32px"},children:""}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"700",color:"#092849",fontSize:"18px"},children:"Weekly Mechanical Systems Check"}),s.jsxs("div",{style:{fontSize:"13px",color:"#666"},children:[g?.timeNeeded," | Tier 3: Human-Verified"]})]})]}),s.jsx("div",{style:{fontSize:"14px",color:"#333",marginBottom:"12px"},children:"Simple walkthrough inspection of all mechanical systems without requiring BAS or IoT sensors."})]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"What You'll Check"}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:Yu.map(x=>s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px",backgroundColor:"#f9fafb",borderRadius:"8px"},children:[s.jsx("span",{style:{fontSize:"24px"},children:x.icon}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",fontSize:"15px",color:"#333"},children:x.name}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:x.description})]})]},x.id))})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Campus *"}),s.jsx(Xn,{value:r,onChange:a,placeholder:"Select campus..."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Name *"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:c,onChange:x=>d(x.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Email *"}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:h,onChange:x=>p(x.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Rating System"}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10b981",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#059669"},children:il.green.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"All systems operating properly, no issues"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#f59e0b",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#d97706"},children:il.amber.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Minor issues found, being addressed"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#ef4444",flexShrink:0,marginTop:"2px"}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#dc2626"},children:il.red.description}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Safety or comfort issues need immediate attention"})]})]})]}),s.jsxs("div",{style:{backgroundColor:"rgba(254, 243, 199, 0.5)",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"8px"},children:"Important"}),s.jsxs("div",{style:{fontSize:"14px",color:"#78350f"},children:["Some items are marked as ",s.jsx("strong",{children:"INSTANT RED"})," (safety hazards, food safety, air quality). If any of these fail, the campus cannot pass until fixed."]}),s.jsx("div",{style:{fontSize:"14px",color:"#78350f",marginTop:"8px"},children:'Every "No" answer requires an explanation.'})]}),s.jsx("button",{onClick:m,style:{width:"100%",backgroundColor:"#092849",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer",marginTop:"8px"},children:"Begin Mechanical Systems Check"})]})]})},lj=({mechanicalChecklist:n,camera:i})=>{const r=xe(),{campus:a,checklistType:c,checkResults:d,issues:h,recordZoneResults:p,addIssue:g,updateIssue:m,addPhotoToIssue:x,removeIssue:k,getZoneCompletionStatus:S}=n,_=rs[c],[w,j]=v.useState({}),[A,z]=v.useState(null),[D,y]=v.useState(!1),[C,T]=v.useState(null);if(v.useEffect(()=>{d&&j(d)},[d]),v.useEffect(()=>{c||r("/mechanical")},[c,r]),!_)return null;const E=_.sections.flatMap(Z=>Z.checks.map(re=>({...re,sectionName:Z.name}))),W=E.length,M=Object.keys(w).filter(Z=>E.some(re=>re.id===Z)).length,K=W>0?Math.round(M/W*100):0,ee=(Z,re,ae,I)=>{if(j(U=>({...U,[Z]:re})),re===!1){if(!h.find(Q=>Q.checkId===Z)){const Q=g({checkId:Z,checkText:ae.text,section:I,instantRed:Au(Z),photoRequired:Xx(Z)});z(Q)}}else{const U=h.find(Q=>Q.checkId===Z);U&&(k(U.id),A===U.id&&z(null))}},F=(Z,re)=>{m(Z,{explanation:re})},ne=Z=>{T(Z),y(!0)},se=async Z=>{C&&Z&&x(C,Z),y(!1),T(null)},B=()=>{p(c,w);const Z=h.filter(re=>!!(!re.explanation||re.explanation.trim()===""||re.photoRequired&&(!re.photos||re.photos.length===0)));if(Z.length>0){alert("Please complete all issue explanations and required photos before submitting."),z(Z[0].id);return}r("/mechanical/summary")},$=M===W,O={"A. HVAC":"","B. Plumbing":"","C. Electrical":"","D. Specialty":"","E. Preventive":""},q=Z=>{for(const[re,ae]of Object.entries(O))if(Z.includes(re.split(".")[1]?.trim()||re))return ae;return""};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx(qe,{title:"Mechanical Systems",subtitle:a,onBack:()=>{confirm("Are you sure you want to exit? Your progress will be saved.")&&r("/mechanical")}}),s.jsxs("div",{style:{padding:"16px 20px",backgroundColor:"#fff",borderBottom:"1px solid #e5e7eb"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("span",{style:{fontSize:"14px",color:"#666"},children:"Progress"}),s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#092849"},children:[M," / ",W," checks"]})]}),s.jsx("div",{style:{height:"8px",backgroundColor:"#e5e7eb",borderRadius:"4px",overflow:"hidden"},children:s.jsx("div",{style:{height:"100%",width:`${K}%`,backgroundColor:K===100?"#10b981":"#2563eb",transition:"width 0.3s ease"}})})]}),s.jsx("div",{style:{padding:"20px"},children:_.sections.map((Z,re)=>s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsxs("div",{style:{backgroundColor:"#092849",color:"#fff",padding:"12px 16px",borderRadius:"10px 10px 0 0",fontWeight:"600",fontSize:"16px",display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx("span",{style:{fontSize:"20px"},children:q(Z.name)}),Z.name]}),Z.description&&s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",padding:"10px 16px",fontSize:"14px",color:"#092849"},children:Z.description}),s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0 0 10px 10px",overflow:"hidden",border:"1px solid #e5e7eb",borderTop:"none"},children:Z.checks.map((ae,I)=>{const U=w[ae.id],Q=h.find(ce=>ce.checkId===ae.id),ie=A===Q?.id,fe=Au(ae.id);return s.jsx("div",{children:s.jsxs("div",{style:{padding:"16px",borderBottom:I<Z.checks.length-1?"1px solid #e5e7eb":"none",backgroundColor:U===!1?"#fef2f2":"#fff"},children:[fe&&s.jsx("div",{style:{display:"inline-block",backgroundColor:"#ef4444",color:"#fff",fontSize:"10px",fontWeight:"700",padding:"2px 6px",borderRadius:"4px",marginBottom:"8px"},children:"INSTANT RED"}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500",color:"#333",marginBottom:"4px"},children:ae.text}),ae.helpText&&s.jsx("div",{style:{fontSize:"13px",color:"#666",marginBottom:"12px"},children:ae.helpText}),s.jsxs("div",{style:{display:"flex",gap:"12px"},children:[s.jsx("button",{onClick:()=>ee(ae.id,!0,ae,Z.name),style:{flex:1,padding:"12px",borderRadius:"8px",border:U===!0?"2px solid #10b981":"2px solid #e5e7eb",backgroundColor:U===!0?"#d1fae5":"#fff",color:U===!0?"#065f46":"#333",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:"Yes"}),s.jsx("button",{onClick:()=>ee(ae.id,!1,ae,Z.name),style:{flex:1,padding:"12px",borderRadius:"8px",border:U===!1?"2px solid #ef4444":"2px solid #e5e7eb",backgroundColor:U===!1?"#fee2e2":"#fff",color:U===!1?"#991b1b":"#333",fontWeight:"600",fontSize:"16px",cursor:"pointer"},children:"No"})]}),Q&&s.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#fff",borderRadius:"8px",border:"1px solid #fca5a5"},children:[s.jsxs("button",{onClick:()=>z(ie?null:Q.id),style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",background:"none",border:"none",padding:0,cursor:"pointer"},children:[s.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:"#dc2626"},children:["Issue Details ",Q.photoRequired&&!Q.photos?.length?"(Photo Required)":""]}),s.jsx("span",{style:{fontSize:"18px",color:"#666"},children:ie?"":"+"})]}),ie&&s.jsxs("div",{style:{marginTop:"12px"},children:[s.jsxs("div",{style:{marginBottom:"12px"},children:[s.jsx("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#dc2626",marginBottom:"6px"},children:"Explanation Required *"}),s.jsx("textarea",{value:Q.explanation||"",onChange:ce=>F(Q.id,ce.target.value),placeholder:"Please describe the issue and what was observed...",style:{width:"100%",minHeight:"100px",padding:"12px",borderRadius:"6px",border:!Q.explanation||Q.explanation.trim()===""?"2px solid #ef4444":"1px solid #ccc",fontSize:"14px",resize:"vertical",boxSizing:"border-box",backgroundColor:!Q.explanation||Q.explanation.trim()===""?"#fef2f2":"#fff"}})]}),s.jsxs("div",{children:[s.jsxs("label",{style:{display:"block",fontSize:"13px",fontWeight:"600",color:"#333",marginBottom:"6px"},children:["Photos ",Q.photoRequired?"*":"(Optional)"]}),Q.photos&&Q.photos.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"8px",flexWrap:"wrap"},children:Q.photos.map((ce,ge)=>s.jsx("img",{src:ce,alt:`Issue photo ${ge+1}`,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"6px",border:"1px solid #ccc"}},ge))}),s.jsxs("button",{onClick:()=>ne(Q.id),style:{padding:"8px 16px",backgroundColor:"#f3f4f6",border:"1px solid #ccc",borderRadius:"6px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[s.jsx("span",{children:""})," Add Photo"]})]})]})]})]})},ae.id)})})]},re))}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:B,disabled:!$,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:$?"pointer":"not-allowed",backgroundColor:$?"#092849":"#9ca3af",color:"#fff"},children:$?"Submit Report ":`Answer All Checks (${M}/${W})`})}),D&&s.jsx(Fu,{isOpen:D,onClose:()=>{y(!1),T(null)},onCapture:se,camera:i})]})},cj=({mechanicalChecklist:n})=>{const i=xe(),{campus:r,auditor:a,auditorEmail:c,checklistType:d,checkResults:h,issues:p,completeChecklist:g}=n,[m,x]=v.useState(!1),k=rs[d];if(v.useEffect(()=>{(!d||!h||Object.keys(h).length===0)&&i("/mechanical")},[d,h,i]),!k)return null;const S=ey(d,h,p),_=C=>{const T=k.sections.find(M=>M.name===C);if(!T)return{passed:0,failed:0,total:0};let E=0,W=0;return T.checks.forEach(M=>{h[M.id]===!0&&E++,h[M.id]===!1&&W++}),{passed:E,failed:W,total:T.checks.length}},w=Object.values(h).filter(C=>C===!0).length,j=Object.values(h).filter(C=>C===!1).length,A=Object.keys(h).length,z=async()=>{x(!0);try{const{rating:C}=g();if(zi(r))try{console.log("[Mechanical Checklist] Creating consolidated Wrike task...");const T=p.map(E=>({category:E.instantRed?" Instant Red":"Issue",section:E.section,check:E.checkText,description:E.explanation||"Issue found",photos:E.photos||[]}));await ds({checklistType:"MECHANICAL",campusName:r,auditorName:a,auditorEmail:c,issues:T,date:new Date().toLocaleDateString()}),console.log("[Mechanical Checklist] Wrike task created")}catch(T){console.error("[Mechanical Checklist] Wrike error:",T)}i("/mechanical/complete")}catch(C){console.error("Error submitting mechanical checklist:",C),alert("Error submitting report. Please try again.")}finally{x(!1)}},D=C=>{switch(C){case"GREEN":return"#10b981";case"AMBER":return"#f59e0b";case"RED":return"#ef4444";default:return"#6b7280"}},y=C=>{switch(C){case"GREEN":return"#d1fae5";case"AMBER":return"#fef3c7";case"RED":return"#fee2e2";default:return"#f3f4f6"}};return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f3f4f6",paddingBottom:"100px"},children:[s.jsx(qe,{title:"Review & Submit",subtitle:r,onBack:()=>i("/mechanical/checklist")}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{backgroundColor:y(S),border:`2px solid ${D(S)}`,borderRadius:"16px",padding:"20px",textAlign:"center",marginBottom:"20px"},children:[s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:"Projected Rating"}),s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:D(S)},children:S}),s.jsxs("div",{style:{fontSize:"14px",color:"#666",marginTop:"8px"},children:[S==="GREEN"&&"All systems operating properly",S==="AMBER"&&"Minor issues identified - action required",S==="RED"&&"Critical issues need immediate attention"]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Summary"}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-around",textAlign:"center"},children:[s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#10b981"},children:w}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Passed"})]}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#ef4444"},children:j}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Issues"})]}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#092849"},children:A}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total"})]})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"By Section"}),k.sections.map((C,T)=>{const E=_(C.name),W=Yu.find(M=>C.name.toLowerCase().includes(M.name.toLowerCase()));return s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 0",borderBottom:T<k.sections.length-1?"1px solid #e5e7eb":"none"},children:[s.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:W?.icon||""}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"500",color:"#333"},children:W?.name||C.name.split(" - ")[0]}),s.jsxs("div",{style:{fontSize:"13px",color:"#666"},children:[E.passed," passed, ",E.failed," issues"]})]}),E.failed>0?s.jsxs("span",{style:{backgroundColor:"#fee2e2",color:"#dc2626",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:[E.failed," issue",E.failed>1?"s":""]}):s.jsx("span",{style:{backgroundColor:"#d1fae5",color:"#065f46",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",fontWeight:"600"},children:" Pass"})]},T)})]}),p.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px"},children:[s.jsxs("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:["Issues Found (",p.length,")"]}),p.map((C,T)=>s.jsxs("div",{style:{padding:"12px",backgroundColor:C.instantRed?"#fef2f2":"#f9fafb",borderRadius:"8px",marginBottom:T<p.length-1?"8px":0},children:[C.instantRed&&s.jsx("span",{style:{display:"inline-block",backgroundColor:"#ef4444",color:"#fff",fontSize:"10px",fontWeight:"700",padding:"2px 6px",borderRadius:"4px",marginBottom:"6px"},children:"INSTANT RED"}),s.jsx("div",{style:{fontSize:"14px",fontWeight:"500",color:"#333",marginBottom:"4px"},children:C.checkText}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:C.explanation}),C.photos&&C.photos.length>0&&s.jsx("div",{style:{display:"flex",gap:"6px",marginTop:"8px"},children:C.photos.map((E,W)=>s.jsx("img",{src:E,alt:`Issue photo ${W+1}`,style:{width:"40px",height:"40px",objectFit:"cover",borderRadius:"4px"}},W))})]},C.id))]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"20px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"8px"},children:"Audit Details"}),s.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:[s.jsxs("div",{children:["Campus: ",r]}),s.jsxs("div",{children:["Auditor: ",a]}),s.jsxs("div",{children:["Date: ",new Date().toLocaleDateString()]})]})]})]}),s.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #e5e7eb",padding:"16px 20px"},children:s.jsx("button",{onClick:z,disabled:m,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:m?"not-allowed":"pointer",backgroundColor:m?"#9ca3af":"#092849",color:"#fff"},children:m?"Submitting...":"Submit Report"})})]})},dj=({mechanicalChecklist:n})=>{const i=xe(),{getChecklistData:r,resetChecklist:a}=n,c=r();if(v.useEffect(()=>{c.rating||i("/mechanical")},[c.rating,i]),!c.rating)return null;const d=x=>{switch(x){case"GREEN":return"#10b981";case"AMBER":return"#f59e0b";case"RED":return"#ef4444";default:return"#6b7280"}},h=x=>{switch(x){case"GREEN":return"#d1fae5";case"AMBER":return"#fef3c7";case"RED":return"#fee2e2";default:return"#f3f4f6"}},p=x=>{switch(x){case"GREEN":return"";case"AMBER":return"";case"RED":return"";default:return""}},g=()=>{a(),i("/")},m=()=>{a(),i("/mechanical")};return s.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(180deg, #092849 0%, #141685 100%)",display:"flex",flexDirection:"column",alignItems:"center",padding:"40px 20px"},children:[s.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px"},children:s.jsx("span",{style:{fontSize:"40px"},children:""})}),s.jsx("h1",{style:{color:"#fff",fontSize:"28px",fontWeight:"700",marginBottom:"8px",textAlign:"center"},children:"Mechanical Check Complete!"}),s.jsxs("p",{style:{color:"#C2ECFD",fontSize:"16px",marginBottom:"32px",textAlign:"center"},children:[c.campus," - ",c.date]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"20px",padding:"24px",width:"100%",maxWidth:"360px",marginBottom:"24px"},children:[s.jsxs("div",{style:{backgroundColor:h(c.rating),borderRadius:"12px",padding:"20px",textAlign:"center",marginBottom:"20px"},children:[s.jsx("div",{style:{fontSize:"40px",marginBottom:"8px"},children:p(c.rating)}),s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",color:d(c.rating)},children:c.rating}),s.jsxs("div",{style:{fontSize:"14px",color:"#666",marginTop:"4px"},children:[c.rating==="GREEN"&&"All systems operating properly",c.rating==="AMBER"&&"Minor issues - follow up required",c.rating==="RED"&&"Critical issues - immediate action needed"]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-around",marginBottom:"20px"},children:[s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#092849"},children:Object.values(c.checkResults).filter(x=>x===!0).length}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Passed"})]}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#ef4444"},children:c.totalIssues}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Issues"})]}),s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#092849"},children:c.duration||"--"}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Minutes"})]})]}),s.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"16px",paddingTop:"16px",borderTop:"1px solid #e5e7eb"},children:Yu.slice(0,4).map(x=>s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"24px"},children:x.icon}),s.jsx("div",{style:{fontSize:"11px",color:"#666"},children:x.name})]},x.id))})]}),c.instantRedIssues>0&&s.jsxs("div",{style:{backgroundColor:"#fee2e2",border:"2px solid #ef4444",borderRadius:"12px",padding:"16px",width:"100%",maxWidth:"360px",marginBottom:"24px"},children:[s.jsxs("div",{style:{fontWeight:"700",color:"#dc2626",marginBottom:"8px"},children:[" ",c.instantRedIssues," Instant Red Issue",c.instantRedIssues>1?"s":""]}),s.jsx("div",{style:{fontSize:"14px",color:"#991b1b"},children:"These safety/compliance issues require immediate attention and resolution."})]}),s.jsx("div",{style:{backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"12px",padding:"16px",width:"100%",maxWidth:"360px",marginBottom:"32px"},children:s.jsxs("div",{style:{color:"#C2ECFD",fontSize:"14px"},children:[s.jsxs("div",{style:{marginBottom:"4px"},children:[s.jsx("strong",{children:"Auditor:"})," ",c.auditor]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Time:"})," ",c.time]})]})}),s.jsxs("div",{style:{width:"100%",maxWidth:"360px"},children:[s.jsx("button",{onClick:g,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",backgroundColor:"#fff",color:"#092849",cursor:"pointer",marginBottom:"12px"},children:"Done"}),s.jsx("button",{onClick:m,style:{width:"100%",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"2px solid rgba(255,255,255,0.3)",backgroundColor:"transparent",color:"#fff",cursor:"pointer"},children:"Start New Check"})]})]})},lu="mechanical_checklist_state",cu=()=>({campus:null,campusData:null,auditor:"",auditorEmail:"",startTime:null,checklistType:"weekly",checkResults:{},issues:[],rating:null,isComplete:!1,endTime:null}),uj=()=>{const[n,i]=v.useState(()=>{try{const y=localStorage.getItem(lu);if(y){const C=JSON.parse(y);if(C.startTime&&!C.isComplete){const T=new Date(C.startTime).toDateString(),E=new Date().toDateString();if(T===E)return C}}}catch(y){console.error("Error restoring mechanical checklist state:",y)}return cu()});v.useEffect(()=>{if(n.startTime&&!n.isComplete)try{localStorage.setItem(lu,JSON.stringify(n))}catch(y){console.error("[useMechanicalChecklist] Error saving to localStorage:",y)}},[n]);const r=v.useCallback(()=>{localStorage.removeItem(lu)},[]),a=v.useCallback((y,C,T,E)=>{i({...cu(),campus:y,campusData:C,auditor:T,auditorEmail:E,checklistType:"weekly",startTime:new Date().toISOString()})},[]),c=v.useCallback(()=>{r(),i(cu())},[r]),d=v.useCallback(()=>n.checklistType?rs[n.checklistType]:null,[n.checklistType]),h=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,[y]:C}}))},[]),p=v.useCallback((y,C)=>{i(T=>({...T,checkResults:{...T.checkResults,...C}}))},[]),g=v.useCallback(y=>{const C=`issue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return i(T=>({...T,issues:[...T.issues,{id:C,timestamp:new Date().toISOString(),instantRed:Au(y.checkId),photoRequired:Xx(y.checkId),photos:[],explanation:"",status:"open",...y}]})),C},[]),m=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,...C}:E)}))},[]),x=v.useCallback((y,C)=>{i(T=>({...T,issues:T.issues.map(E=>E.id===y?{...E,photos:[...E.photos||[],C]}:E)}))},[]),k=v.useCallback(y=>{i(C=>({...C,issues:C.issues.filter(T=>T.id!==y)}))},[]),S=v.useCallback(y=>{const C=rs[y||n.checklistType];if(!C)return{complete:!1,answered:0,total:0};let T=0,E=0;return C.sections.forEach(W=>{W.checks.forEach(M=>{T++,n.checkResults[M.id]!==void 0&&E++})}),{complete:E===T,answered:E,total:T}},[n.checkResults,n.checklistType]),_=v.useCallback(()=>n.issues.every(y=>!(!y.explanation||y.explanation.trim()===""||y.photoRequired&&(!y.photos||y.photos.length===0))),[n.issues]),w=v.useCallback(()=>{const y=ey(n.checklistType,n.checkResults,n.issues);return i(C=>({...C,rating:y,isComplete:!0,endTime:new Date().toISOString()})),r(),{rating:y}},[n.checklistType,n.checkResults,n.issues,r]),j=v.useCallback(()=>{const y=n.startTime&&n.endTime?Math.round((new Date(n.endTime)-new Date(n.startTime))/6e4):null,C=rs[n.checklistType];return{date:n.startTime?new Date(n.startTime).toLocaleDateString():null,time:n.startTime?new Date(n.startTime).toLocaleTimeString():null,campus:n.campus,campusData:n.campusData,auditor:n.auditor,auditorEmail:n.auditorEmail,duration:y,checklistType:n.checklistType,checklistName:C?.name||n.checklistType,checkResults:n.checkResults,rating:n.rating,issues:n.issues,totalIssues:n.issues.length,openIssues:n.issues.filter(T=>T.status==="open").length,instantRedIssues:n.issues.filter(T=>T.instantRed).length,startTime:n.startTime,endTime:n.endTime}},[n]),A=n.startTime&&!n.isComplete,z={[n.checklistType]:n.checkResults},D=n.rating?{[n.checklistType]:n.rating}:{};return{...n,isInProgress:A,currentZoneId:n.checklistType,zoneResults:z,zoneRatings:D,overallRating:n.rating,getCurrentZone:d,getZoneCompletionStatus:S,getChecklistData:j,allIssuesComplete:_,initChecklist:a,resetChecklist:c,recordCheckResult:h,recordZoneResults:p,addIssue:g,updateIssue:m,addPhotoToIssue:x,removeIssue:k,completeChecklist:w,clearSavedState:r,setCurrentZone:()=>{},calculateAndSetZoneRating:()=>{}}},hj=({greenStreakWalk:n})=>{const i=xe(),[r,a]=v.useState(""),[c,d]=v.useState(""),[h,p]=v.useState(""),[g,m]=v.useState(""),[x,k]=v.useState(""),[S,_]=v.useState(""),[w,j]=v.useState(""),A=_t.reduce((y,C)=>y+C.checks.length,0),z=_t.reduce((y,C)=>{const T=parseInt(C.timeEstimate)||0;return y+T},0),D=()=>{if(!r){alert("Please select a campus");return}if(!c.trim()){alert("Please enter your name");return}if(!h.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h)){alert("Please enter a valid email address");return}if(!g.trim()||!x.trim()){alert("Please enter both learning spaces you will check");return}if(!S.trim()||!w.trim()){alert("Please enter both restroom locations you will check");return}const y=an.find(T=>T.name===r),C={learning:[g.trim(),x.trim()],restroom:[S.trim(),w.trim()]};n.initWalk(r,y,c.trim(),h.trim(),C),window.scrollTo(0,0),i("/green-streak/walk")};return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Green Streak Walk",subtitle:"Daily CC Oversight Check",onBack:()=>i("/")}),s.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",gap:"24px"},children:[s.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:"16px",padding:"24px",color:"#fff"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[s.jsx(cl,{size:32}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"24px",fontWeight:"700"},children:"Daily Green Streak"}),s.jsx("div",{style:{fontSize:"14px",opacity:.9},children:"Oversight walk - verify all systems are GO"})]})]}),s.jsxs("div",{style:{display:"flex",gap:"24px",marginTop:"16px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(Zu,{size:18}),s.jsxs("span",{style:{fontSize:"15px"},children:["~",z," min"]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx(as,{size:18}),s.jsxs("span",{style:{fontSize:"15px"},children:[A," checks"]})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Campus *"}),s.jsx(Xn,{value:r,onChange:a,placeholder:"Select campus..."})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Name *"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:c,onChange:y=>d(y.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"17px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Your Email *"}),s.jsx("input",{type:"email",placeholder:"Enter your email",value:h,onChange:y=>p(y.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"14px 16px",fontSize:"17px",boxSizing:"border-box",backgroundColor:"#fff"}})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"20px",border:"1px solid #e5e7eb"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[s.jsx(Ru,{size:20,color:"#10b981"}),s.jsx("span",{style:{fontSize:"17px",fontWeight:"600",color:"#333"},children:"Spaces You'll Check Today"})]}),s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",borderRadius:"8px",padding:"12px",marginBottom:"16px",fontSize:"13px",color:"#0369a1"},children:[s.jsx("strong",{children:"Tip:"})," Rotate which rooms you check daily so you see all spaces over the course of a week."]}),s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("label",{style:{display:"block",fontSize:"15px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Learning Spaces (2 rooms) *"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[s.jsx("input",{type:"text",placeholder:"Room 1 (e.g., Room 101, Pod A)",value:g,onChange:y=>m(y.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"12px 14px",fontSize:"16px",boxSizing:"border-box",backgroundColor:"#fff"}}),s.jsx("input",{type:"text",placeholder:"Room 2 (e.g., Room 102, Pod B)",value:x,onChange:y=>k(y.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"12px 14px",fontSize:"16px",boxSizing:"border-box",backgroundColor:"#fff"}})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",fontSize:"15px",fontWeight:"600",color:"#333",marginBottom:"10px"},children:"Restrooms (2 locations) *"}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[s.jsx("input",{type:"text",placeholder:"Restroom 1 (e.g., Main hallway)",value:S,onChange:y=>_(y.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"12px 14px",fontSize:"16px",boxSizing:"border-box",backgroundColor:"#fff"}}),s.jsx("input",{type:"text",placeholder:"Restroom 2 (e.g., Near gym)",value:w,onChange:y=>j(y.target.value),style:{width:"100%",border:"1px solid #ccc",borderRadius:"10px",padding:"12px 14px",fontSize:"16px",boxSizing:"border-box",backgroundColor:"#fff"}})]})]})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",border:"1px solid #e5e7eb"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"Walk Route"}),s.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:_t.map((y,C)=>s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",backgroundColor:"#f3f4f6",padding:"6px 12px",borderRadius:"20px",fontSize:"13px"},children:[s.jsx("span",{style:{fontWeight:"700",color:"#10b981",fontSize:"12px"},children:C+1}),s.jsx("span",{style:{color:"#333"},children:y.name})]},y.id))})]}),s.jsxs("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"5 Green Streak Metrics"}),s.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:Object.values(jt).filter(y=>!y.isVendorQC).map(y=>s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",backgroundColor:"#fff",padding:"6px 12px",borderRadius:"20px",fontSize:"13px"},children:[s.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:y.color}}),s.jsx("span",{style:{fontWeight:"500"},children:y.name})]},y.id))}),s.jsx("div",{style:{fontSize:"13px",color:"#666",marginTop:"12px"},children:"+ Cleanliness spot-check (vendor QC)"})]}),s.jsxs("div",{style:{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"16px"},children:[s.jsx("div",{style:{fontWeight:"600",color:"#092849",marginBottom:"12px"},children:"How It Works"}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#10b981",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"700",fontSize:"12px",flexShrink:0},children:"Y"}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"500",color:"#059669"},children:"Yes = All Good"}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Move to next check"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[s.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#ef4444",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"700",fontSize:"12px",flexShrink:0},children:"N"}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"500",color:"#dc2626"},children:"No = Issue Found"}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Describe the issue (required), add photo (optional)"})]})]})]}),s.jsxs("div",{style:{backgroundColor:"rgba(254, 243, 199, 0.5)",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px",display:"flex",gap:"12px"},children:[s.jsx(wo,{size:24,color:"#92400e",style:{flexShrink:0}}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:"600",color:"#92400e",marginBottom:"4px"},children:"This is Oversight"}),s.jsx("div",{style:{fontSize:"14px",color:"#78350f"},children:"You're verifying systems are working, not fixing them. If something is wrong, log it and escalate."})]})]}),s.jsxs("button",{onClick:D,style:{width:"100%",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer",marginTop:"8px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[s.jsx(cl,{size:22}),"Continue"]})]})]})},fj=({greenStreakWalk:n,camera:i})=>{const r=xe(),[a,c]=v.useState(!1),[d,h]=v.useState(null),[p,g]=v.useState(""),[m,x]=v.useState([]),k=n.getCurrentStop(),S=n.getCurrentCheck(),_=n.getProgress(),w=S?jt[S.metric]:null,j=n.currentRoomIndex||0,A=k?.roomCount||1,z=ee=>k?.roomCount>1?`${ee}_room${j}`:ee;if(v.useEffect(()=>{n.isInProgress||r("/green-streak")},[n.isInProgress,r]),!k||!S)return null;const D=z(S.id),y=n.roomSelections[k.id]?.[j]||"",C=()=>{n.removeIssue(D),n.recordCheckResult(D,!0),n.isWalkComplete()?r("/green-streak/summary"):n.nextCheck()},T=()=>{h({checkId:D,question:S.question,metric:S.metric,metricName:w?.name,stopId:k.id,stopName:k.name,lookingFor:S.lookingFor,roomName:y,roomIndex:j}),g(""),x([]),c(!0)},E=()=>{if(!p.trim()){alert("Please describe the issue");return}n.recordCheckResult(D,!1),n.addIssue({...d,description:p.trim(),photos:m,roomSelection:y}),c(!1),h(null),n.isWalkComplete()?r("/green-streak/summary"):n.nextCheck()},W=()=>{i.openCamera(ee=>{ee?(console.log("[GreenStreakWalk] Photo captured:",ee),x(F=>[...F,ee])):console.log("[GreenStreakWalk] Photo capture cancelled or failed")},"Issue photo","green-streak-issues")},M=ee=>{x(F=>F.filter((ne,se)=>se!==ee))},K=()=>{n.nextCheck()};return s.jsxs("div",{className:"min-h-screen bg-gray-100",style:{display:"flex",flexDirection:"column"},children:[s.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",padding:"16px 20px"},children:[s.jsx("div",{style:{height:"4px",backgroundColor:"rgba(255,255,255,0.3)",borderRadius:"2px",marginBottom:"12px"},children:s.jsx("div",{style:{height:"100%",width:`${_.percentage}%`,backgroundColor:"#fff",borderRadius:"2px",transition:"width 0.3s ease"}})}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",color:"#fff"},children:[s.jsxs("div",{children:[s.jsxs("div",{style:{fontSize:"13px",opacity:.9},children:["Stop ",_.currentStop," of ",_.totalStops]}),s.jsx("div",{style:{fontSize:"18px",fontWeight:"700"},children:k.name})]}),s.jsxs("div",{style:{textAlign:"right"},children:[s.jsx("div",{style:{fontSize:"13px",opacity:.9},children:"Check"}),s.jsxs("div",{style:{fontSize:"18px",fontWeight:"700"},children:[_.currentCheckInStop,"/",_.totalChecksInStop]})]})]}),k.requiresRoomSelection&&y&&s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"8px",fontSize:"13px",color:"rgba(255,255,255,0.9)"},children:[s.jsx(Ru,{size:14}),A>1?s.jsxs("span",{children:[k.id==="learning"?"Room":"Restroom"," ",j+1,"/",A,": ",y]}):s.jsxs("span",{children:["Checking: ",y]})]})]}),s.jsxs("div",{style:{flex:1,padding:"20px",display:"flex",flexDirection:"column"},children:[k?.roomCount>1&&y&&s.jsxs("div",{style:{backgroundColor:"#10b981",borderRadius:"12px",padding:"14px 16px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(Ru,{size:22,color:"#fff"}),s.jsxs("div",{children:[s.jsxs("div",{style:{fontSize:"13px",color:"rgba(255,255,255,0.85)"},children:[k.id==="learning"?"Learning Space":"Restroom"," ",j+1," of ",A]}),s.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:"#fff"},children:y})]})]}),s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"8px",backgroundColor:"#fff",padding:"8px 14px",borderRadius:"20px",alignSelf:"flex-start",marginBottom:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[s.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:w?.color||"#666"}}),s.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#333"},children:w?.name||S.metric})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"16px",padding:"24px",marginBottom:"16px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[s.jsx("div",{style:{fontSize:"22px",fontWeight:"600",color:"#092849",lineHeight:1.4},children:S.question}),S.lookingFor&&s.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#f8fafc",borderRadius:"8px",fontSize:"14px",color:"#64748b"},children:[s.jsx("strong",{children:"Looking for:"})," ",S.lookingFor]}),S.optional&&s.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f59e0b",fontStyle:"italic"},children:["Optional: ",S.optionalNote]})]}),s.jsx("div",{style:{flex:1}}),s.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"16px"},children:[s.jsxs("button",{onClick:C,style:{flex:1,backgroundColor:"#10b981",color:"#fff",padding:"20px",borderRadius:"16px",fontSize:"20px",fontWeight:"700",border:"none",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[s.jsx("span",{style:{fontSize:"28px"},children:"Yes"}),s.jsx("span",{style:{fontSize:"13px",opacity:.9},children:"All good"})]}),s.jsxs("button",{onClick:T,style:{flex:1,backgroundColor:"#ef4444",color:"#fff",padding:"20px",borderRadius:"16px",fontSize:"20px",fontWeight:"700",border:"none",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"4px"},children:[s.jsx("span",{style:{fontSize:"28px"},children:"No"}),s.jsx("span",{style:{fontSize:"13px",opacity:.9},children:"Issue found"})]})]}),S.optional&&s.jsx("button",{onClick:K,style:{width:"100%",backgroundColor:"transparent",color:"#666",padding:"12px",borderRadius:"8px",fontSize:"15px",border:"1px solid #e5e7eb",cursor:"pointer",marginBottom:"8px"},children:"Skip (not applicable)"}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("button",{onClick:()=>n.prevCheck(),disabled:_.currentStop===1&&_.currentCheckInStop===1&&j===0,style:{display:"flex",alignItems:"center",gap:"4px",padding:"12px 16px",backgroundColor:"transparent",border:"none",color:_.currentStop===1&&_.currentCheckInStop===1&&j===0?"#ccc":"#666",cursor:_.currentStop===1&&_.currentCheckInStop===1&&j===0?"not-allowed":"pointer",fontSize:"15px"},children:[s.jsx(dw,{size:20}),"Back"]}),s.jsx("button",{onClick:()=>{confirm("Exit without saving? Your progress will be lost.")&&(n.resetWalk(),r("/"))},style:{padding:"12px 16px",backgroundColor:"transparent",border:"none",color:"#999",cursor:"pointer",fontSize:"14px"},children:"Exit Walk"})]})]}),a&&s.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"flex-end",zIndex:100},children:s.jsxs("div",{style:{width:"100%",backgroundColor:"#fff",borderRadius:"24px 24px 0 0",padding:"24px",maxHeight:"90vh",overflowY:"auto"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"20px"},children:[s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"20px",fontWeight:"700",color:"#dc2626"},children:"Issue Found"}),s.jsxs("div",{style:{fontSize:"14px",color:"#666",marginTop:"4px"},children:[d?.metricName," - ",d?.stopName,d?.roomName&&` - ${d.roomName}`]})]}),s.jsx("button",{onClick:()=>c(!1),style:{backgroundColor:"#f3f4f6",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:s.jsx(Hm,{size:20,color:"#666"})})]}),s.jsx("div",{style:{backgroundColor:"#fef2f2",borderRadius:"12px",padding:"14px",marginBottom:"20px"},children:s.jsx("div",{style:{fontSize:"14px",color:"#991b1b"},children:d?.question})}),s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("label",{style:{display:"block",fontSize:"16px",fontWeight:"600",marginBottom:"8px"},children:"What's the issue? *"}),s.jsx("textarea",{value:p,onChange:ee=>g(ee.target.value),placeholder:"Describe what you found...",rows:4,style:{width:"100%",padding:"14px",fontSize:"16px",border:"2px solid #e5e7eb",borderRadius:"12px",resize:"vertical",boxSizing:"border-box"},autoFocus:!0})]}),s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx("label",{style:{display:"block",fontSize:"16px",fontWeight:"600",marginBottom:"8px"},children:"Add Photo (optional)"}),m.length>0&&s.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginBottom:"12px"},children:m.map((ee,F)=>s.jsxs("div",{style:{position:"relative"},children:[s.jsx("img",{src:ee.url||ee,alt:`Issue photo ${F+1}`,style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"8px"}}),s.jsx("button",{onClick:()=>M(F),style:{position:"absolute",top:"-8px",right:"-8px",width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#ef4444",color:"#fff",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(Hm,{size:14})})]},F))}),s.jsxs("button",{onClick:W,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"14px",backgroundColor:"#f3f4f6",border:"2px dashed #d1d5db",borderRadius:"12px",cursor:"pointer",color:"#666",fontSize:"15px"},children:[s.jsx(Vu,{size:20}),m.length>0?"Add Another Photo":"Take Photo"]})]}),s.jsx("div",{style:{backgroundColor:"#fffbeb",borderRadius:"12px",padding:"14px",marginBottom:"20px"},children:s.jsxs("div",{style:{fontSize:"13px",color:"#92400e"},children:[s.jsx("strong",{children:"Escalate to:"})," ",w?.escalation||"VP of Ops"]})}),s.jsx("button",{onClick:E,style:{width:"100%",backgroundColor:"#ef4444",color:"#fff",padding:"16px",borderRadius:"12px",fontSize:"17px",fontWeight:"600",border:"none",cursor:"pointer"},children:"Log Issue & Continue"})]})})]})},pj=({greenStreakWalk:n})=>{const i=xe();v.useEffect(()=>{!n.isInProgress&&!n.isComplete&&i("/green-streak")},[n.isInProgress,n.isComplete,i]);const r=ju(n.checkResults),a=n.issues||[],c=()=>{n.completeWalk(),i("/green-streak/complete")},d=Object.values(jt).filter(p=>!p.isVendorQC),h=jt.CLEANLINESS;return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsxs("div",{style:{background:r.overall==="GREEN"?"linear-gradient(135deg, #10b981 0%, #059669 100%)":"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",padding:"24px",color:"#fff",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"48px",marginBottom:"8px"},children:r.overall==="GREEN"?"":""}),s.jsx("div",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"4px"},children:r.overall==="GREEN"?"All Green!":"Issues Found"}),s.jsx("div",{style:{fontSize:"16px",opacity:.9},children:r.overall==="GREEN"?"Green Streak intact":`${a.length} issue${a.length!==1?"s":""} need attention`})]}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"#092849"},children:"Green Streak Metrics"}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:d.map(p=>{const m=r.metricStatuses[p.id]==="GREEN",x=a.filter(k=>k.metric===Object.keys(jt).find(S=>jt[S].id===p.id));return s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"14px 16px",backgroundColor:"#fff",borderRadius:"12px",border:`2px solid ${m?"#10b981":"#ef4444"}`},children:[s.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",backgroundColor:m?"#10b981":"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"},children:m?s.jsx(as,{size:20,color:"#fff"}):s.jsx(wo,{size:20,color:"#fff"})}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"600",color:"#333"},children:p.name}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:p.principle})]}),s.jsx("div",{style:{padding:"4px 12px",borderRadius:"12px",backgroundColor:m?"#dcfce7":"#fee2e2",color:m?"#166534":"#991b1b",fontSize:"13px",fontWeight:"600"},children:m?"GREEN":`${x.length} issue${x.length!==1?"s":""}`})]},p.id)})})]}),s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"#092849"},children:"Cleanliness (Vendor QC)"}),(()=>{const g=r.metricStatuses[h.id]==="GREEN",m=a.filter(x=>x.metric==="CLEANLINESS");return s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"14px 16px",backgroundColor:"#fff",borderRadius:"12px",border:`2px solid ${g?"#10b981":"#f59e0b"}`},children:[s.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",backgroundColor:g?"#10b981":"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px"},children:g?s.jsx(as,{size:20,color:"#fff"}):s.jsx(wo,{size:20,color:"#fff"})}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontWeight:"600",color:"#333"},children:"Tour Ready"}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Vendor spot-check"})]}),s.jsx("div",{style:{padding:"4px 12px",borderRadius:"12px",backgroundColor:g?"#dcfce7":"#fef3c7",color:g?"#166534":"#92400e",fontSize:"13px",fontWeight:"600"},children:g?"GOOD":`${m.length} flag${m.length!==1?"s":""}`})]})})(),s.jsx("div",{style:{fontSize:"13px",color:"#666",marginTop:"8px",fontStyle:"italic"},children:"Cleanliness issues don't break the Green Streak but should be escalated to vendors."})]}),a.length>0&&s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsxs("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"#092849"},children:["Issues to Escalate (",a.length,")"]}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:a.map((p,g)=>{const m=jt[p.metric];return s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",borderLeft:`4px solid ${m?.color||"#666"}`},children:[s.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"8px"},children:[s.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:m?.color||"#666",textTransform:"uppercase"},children:m?.name||p.metric}),p.photos&&p.photos.length>0&&s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:"#666",fontSize:"12px"},children:[s.jsx(Vu,{size:14}),p.photos.length]})]}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500",color:"#333",marginBottom:"4px"},children:p.question}),s.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"8px"},children:p.description}),s.jsxs("div",{style:{fontSize:"12px",color:"#999"},children:[p.stopName,p.roomSelection&&` - ${p.roomSelection}`]}),s.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #f3f4f6",fontSize:"12px",color:"#dc2626"},children:[s.jsx("strong",{children:"Escalate to:"})," ",m?.escalation||"VP of Ops"]})]},p.id||g)})})]}),s.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",marginBottom:"24px"},children:s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Campus"}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500"},children:n.campus})]}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Coordinator"}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500"},children:n.coordinator})]}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Date"}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500"},children:new Date(n.startTime).toLocaleDateString()})]}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Time"}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500"},children:new Date(n.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})}),s.jsxs("button",{onClick:c,style:{width:"100%",background:r.overall==="GREEN"?"linear-gradient(135deg, #10b981 0%, #059669 100%)":"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",color:"#fff",padding:"18px",borderRadius:"12px",fontSize:"18px",fontWeight:"700",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:["Complete Walk",s.jsx(iw,{size:22})]})]})]})},gj=async n=>{const{date:i,campus:r,coordinator:a,coordinatorEmail:c,startTime:d,endTime:h,checkResults:p,metricStatuses:g,roomSelections:m,issues:x,totalIssues:k,overallStatus:S}=n,_=d&&h?Math.round((new Date(h)-new Date(d))/6e4):null,{data:w,error:j}=await ct.from("green_streak_walks").insert([{date:i,campus:r,coordinator:a,coordinator_email:c,start_time:d,end_time:h,duration_minutes:_,overall_status:S,check_results:p,metric_statuses:g,room_selections:m,issues:x,total_issues:k||0}]).select();if(j)throw console.error("Error saving Green Streak Walk:",j),j;return w[0]},mj=({greenStreakWalk:n})=>{const i=xe(),[r,a]=v.useState(!1),[c,d]=v.useState(!1),[h,p]=v.useState(null),[g,m]=v.useState(null),[x,k]=v.useState(null),S=n.getWalkData(),_=S.overallStatus==="GREEN",w=S.startTime&&S.endTime?Math.round((new Date(S.endTime)-new Date(S.startTime))/6e4):null;v.useEffect(()=>{(async()=>{if(c||r)return;a(!0),m(null);try{await gj(S),console.log("[GreenStreak] Walk saved to Supabase"),d(!0)}catch(y){console.error("[GreenStreak] Supabase save failed (continuing to Wrike):",y),m(y.message),d(!1)}const D=Pu(S.campus);if(console.log("[GreenStreak] Got folder ID:",D,"for campus:",S.campus),!D)console.log("[GreenStreak] Campus not configured for Wrike:",S.campus),p("skipped");else{p("sending");try{console.log("[GreenStreak] Creating consolidated Wrike task...");const y=await xj(S,D);console.log("[GreenStreak] Task created:",y?.id),p("sent")}catch(y){console.error("[GreenStreak] Wrike error:",y),p("error"),k(y.message||"Unknown Wrike error")}}a(!1)})()},[]);const j=()=>{n.resetWalk(),i("/green-streak")},A=()=>{n.resetWalk(),i("/")};return s.jsxs("div",{className:"min-h-screen",style:{background:_?"linear-gradient(180deg, #10b981 0%, #059669 100%)":"linear-gradient(180deg, #ef4444 0%, #dc2626 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"24px",textAlign:"center",color:"#fff"},children:[s.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px"},children:s.jsx(cl,{size:64,color:"#fff"})}),s.jsx("div",{style:{fontSize:"32px",fontWeight:"700",marginBottom:"8px"},children:_?"Green Streak Intact!":"Walk Complete"}),s.jsx("div",{style:{fontSize:"18px",opacity:.9,marginBottom:"32px"},children:_?"All systems are GO":`${S.totalIssues} issue${S.totalIssues!==1?"s":""} logged for escalation`}),s.jsxs("div",{style:{backgroundColor:"rgba(255,255,255,0.15)",borderRadius:"16px",padding:"20px",marginBottom:"32px",width:"100%",maxWidth:"300px"},children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"28px",fontWeight:"700"},children:w||"-"}),s.jsx("div",{style:{fontSize:"14px",opacity:.8},children:"minutes"})]}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"28px",fontWeight:"700"},children:Object.keys(S.checkResults).length}),s.jsx("div",{style:{fontSize:"14px",opacity:.8},children:"checks"})]})]}),s.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.2)",marginTop:"16px",paddingTop:"16px"},children:[s.jsx("div",{style:{fontSize:"14px",opacity:.8},children:"Campus"}),s.jsx("div",{style:{fontSize:"18px",fontWeight:"600"},children:S.campus})]})]}),s.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"8px",marginBottom:"32px"},children:Object.entries(S.metricStatuses||{}).map(([z,D])=>s.jsxs("div",{style:{padding:"6px 12px",borderRadius:"16px",backgroundColor:D==="GREEN"?"rgba(255,255,255,0.3)":"rgba(0,0,0,0.2)",fontSize:"13px",fontWeight:"500"},children:[D==="GREEN"?"":"!"," ",z.replace("_"," ")]},z))}),s.jsxs("div",{style:{backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"12px",padding:"12px 16px",marginBottom:"24px",width:"100%",maxWidth:"300px",fontSize:"14px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[r&&!c?s.jsx($m,{size:16,className:"animate-spin"}):c?s.jsx(as,{size:16,color:"#86efac"}):g?s.jsx(Lm,{size:16,color:"#fca5a5"}):null,s.jsx("span",{children:r&&!c?"Saving to database...":c?"Saved to database":g?"Error saving":""})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[h==="sending"?s.jsx($m,{size:16,className:"animate-spin"}):h==="sent"?s.jsx(as,{size:16,color:"#86efac"}):h==="skipped"?s.jsx("span",{style:{opacity:.6},children:"-"}):h==="error"?s.jsx(Lm,{size:16,color:"#fca5a5"}):null,s.jsx("span",{children:h==="sending"?"Sending to Wrike...":h==="sent"?"Sent to Wrike":h==="skipped"?"Wrike not configured for campus":h==="error"?`Wrike error: ${x}`:""})]})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",width:"100%",maxWidth:"300px"},children:[s.jsxs("button",{onClick:A,style:{width:"100%",backgroundColor:"#fff",color:_?"#059669":"#dc2626",padding:"16px",borderRadius:"12px",fontSize:"17px",fontWeight:"600",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[s.jsx(zw,{size:20}),"Back to Home"]}),s.jsxs("button",{onClick:j,style:{width:"100%",backgroundColor:"rgba(255,255,255,0.2)",color:"#fff",padding:"16px",borderRadius:"12px",fontSize:"17px",fontWeight:"600",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[s.jsx(Uw,{size:20}),"Start New Walk"]})]}),s.jsxs("div",{style:{marginTop:"32px",fontSize:"13px",opacity:.6},children:["Completed ",new Date(S.endTime||Date.now()).toLocaleString()]})]})};async function xj(n,i){const r=new Date(n.date||Date.now()).toLocaleDateString(),a=n.issues&&n.issues.length>0,c=a?`${n.issues.length} issue${n.issues.length!==1?"s":""}`:"All Clear",d=`[${n.campus}] Green Streak Walk - ${r} (${c})`;let h="";h+=`<b>Campus:</b> ${n.campus}<br>`,h+=`<b>Coordinator:</b> ${n.coordinator}<br>`,h+=`<b>Date:</b> ${r}<br>`,h+=`<b>Status:</b> ${n.overallStatus==="GREEN"?" GREEN - All Clear":" ISSUES FOUND"}<br>`,h+="<br><hr><br>",a?(h+="<h3>Issues Requiring Action</h3>",h+="<ol>",n.issues.forEach(m=>{const x=jt[m.metric];h+="<li>",h+=`<b>${x?.name||m.metric} - ${m.stopName}</b><br>`,h+=`<b>Check:</b> ${m.question}<br>`,h+=`<b>Issue:</b> ${m.description}<br>`,x?.escalation&&(h+=`<b>Escalate to:</b> ${x.escalation}<br>`),m.photos&&m.photos.length>0&&(h+="<b>Photos:</b><br>",m.photos.forEach((k,S)=>{const _=k.url||k;_&&!_.startsWith("data:")&&(h+=`&nbsp;&nbsp; <a href="${_}">Photo ${S+1}</a><br>`)})),h+="</li>"}),h+="</ol>"):h+="<h3> No issues found. Green Streak intact!</h3>",h+="<br><hr><br>",h+="<h3>Metric Summary</h3>",h+="<ul>",Object.entries(n.metricStatuses||{}).forEach(([m,x])=>{const k=jt[m];h+=`<li>${x==="GREEN"?"":""} <b>${k?.name||m}:</b> ${x}</li>`}),h+="</ul>";const p=n.overallStatus==="GREEN"?"Normal":"High";return await So(i,{title:d,description:h,priority:p})}const yj=[{title:"Daily Audits",description:"Quick checks to verify vendor and system performance",audits:[{path:"/audit/setup",Icon:Vw,label:"Cleanliness Audit",description:"Verify overnight cleaning vendor work",color:"#10b981",time:"15-20 min"}]},{title:"Weekly Audits",description:"Detailed inspections of building systems and grounds",audits:[{path:"/bg/setup",Icon:Fx,label:"Building & Grounds",description:"Landscaping, hardscapes, exterior",color:"#6366f1",time:"30-45 min"},{path:"/mechanical",Icon:vw,label:"Mechanical Systems",description:"HVAC, plumbing, electrical",color:"#71717a",time:"30-45 min"}]},{title:"Periodic Audits",description:"Comprehensive compliance and quality reviews",audits:[{path:"/security",Icon:Nw,label:"Security Compliance",description:"Access control, cameras, protocols",color:"#eab308",time:"Varies by type"},{path:"/health-safety",Icon:Tw,label:"Health & Safety",description:"Safety equipment, emergency readiness",color:"#ef4444",time:"45-60 min"},{path:"/furniture",Icon:ew,label:"Furniture & Decor",description:"Interior design standards",color:"#8b5cf6",time:"30-45 min"},{path:"/food-safety",Icon:Yw,label:"Food Service",description:"Kitchen, storage, dining areas",color:"#64748b",time:"20-30 min"}]},{title:"External Tools",description:"Dashboards and monitoring systems",audits:[{path:"https://internet-audit-dashboard.vercel.app/",Icon:Cu,label:"Internet Dashboard",description:"Connectivity monitoring",color:"#0ea5e9",external:!0}]}],bj=()=>{const n=xe();return s.jsxs("div",{className:"min-h-screen bg-gray-100",children:[s.jsx(qe,{title:"Ops Audits",subtitle:"Detailed facility assessments",onBack:()=>n("/")}),s.jsxs("div",{style:{padding:"20px"},children:[s.jsx("div",{style:{backgroundColor:"rgba(194, 236, 253, 0.4)",border:"1px solid #47C4E6",borderRadius:"12px",padding:"16px",marginBottom:"24px"},children:s.jsxs("div",{style:{fontSize:"14px",color:"#0369a1"},children:["These are detailed audit checklists for periodic assessment. For daily oversight, use the ",s.jsx("strong",{children:"Green Streak Walk"})," instead."]})}),yj.map((i,r)=>s.jsxs("div",{style:{marginBottom:"24px"},children:[s.jsx("h2",{style:{fontSize:"18px",fontWeight:"700",color:"#092849",marginBottom:"4px"},children:i.title}),s.jsx("p",{style:{fontSize:"14px",color:"#666",marginBottom:"12px"},children:i.description}),s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:i.audits.map(a=>{const c=a.Icon,d=s.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"16px",backgroundColor:"#fff",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",cursor:"pointer",transition:"transform 0.1s, box-shadow 0.1s"},children:[s.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:a.color,display:"flex",alignItems:"center",justifyContent:"center",marginRight:"14px",flexShrink:0},children:s.jsx(c,{size:24,color:"#fff"})}),s.jsxs("div",{style:{flex:1},children:[s.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#092849",marginBottom:"2px"},children:a.label}),s.jsx("div",{style:{fontSize:"13px",color:"#666"},children:a.description}),a.time&&s.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"4px",marginTop:"6px",fontSize:"12px",color:"#999"},children:[s.jsx(Zu,{size:12}),a.time]})]}),s.jsx(ll,{size:20,color:"#ccc"})]});return a.external?s.jsx("a",{href:a.path,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:d},a.path):s.jsx("div",{onClick:()=>n(a.path),children:d},a.path)})})]},r))]})]})},mn={SUBMITTED:"Submitted",TRIAGED:"Triaged",IN_PROGRESS:"In Progress",VENDOR_ASSIGNED:"Vendor Assigned",RESOLVED:"Resolved"},vj={New:mn.SUBMITTED,Active:mn.IN_PROGRESS,"In Progress":mn.IN_PROGRESS,Completed:mn.RESOLVED,Done:mn.RESOLVED,Deferred:mn.TRIAGED,Cancelled:mn.RESOLVED},Ct={EMERGENCY:"Emergency",HIGH:"High",STANDARD:"Standard",LOW:"Low"},Sj={High:Ct.HIGH,Normal:Ct.STANDARD,Low:Ct.LOW},Ku={[Ct.EMERGENCY]:{targetHours:4,atRiskHoursRemaining:2},[Ct.HIGH]:{targetHours:24,atRiskHoursRemaining:6},[Ct.STANDARD]:{targetHours:48,atRiskHoursRemaining:12},[Ct.LOW]:{targetHours:168,atRiskHoursRemaining:48}},fo={ON_TRACK:"on-track",AT_RISK:"at-risk",OVERDUE:"overdue"},_o={Cleanliness:{pillar:"14.12",label:"Cleanliness",color:"#3b82f6"},"Buildings & Grounds":{pillar:"14.13",label:"Buildings & Grounds",color:"#8b5cf6"},"Mechanical Systems":{pillar:"14.14",label:"Mechanical Systems",color:"#f59e0b"},Security:{pillar:"--",label:"Security",color:"#ef4444"},Other:{pillar:"--",label:"Other",color:"#6b7280"}},kj={Cleanliness:["clean","dirty","smudge","trash","restroom","stocked","mop","sweep","spill","odor","dust","glass","floor"],"Buildings & Grounds":["paint","pothole","signage","landscap","door","window","wall","ceiling","roof","parking","fence","exterior"],"Mechanical Systems":["hvac","plumb","leak","lighting","electrical","temperature","humidity","air condition","heat","cool","sensor"],Security:["camera","lock","alarm","fire ext","badge","access","security","intrusion","safety"]},jn={EXECUTIVE:"Executive",SITE_OWNER:"Site Owner",CAMPUS_COORDINATOR:"Campus Coordinator"},wj=()=>{const n=[];n.push({name:"Sean Hubbard",email:"sean.hubbard@trilogy.com",role:jn.EXECUTIVE,campuses:"All"},{name:"Sam Anderson",email:"samuel.anderson@trilogy.com",role:jn.EXECUTIVE,campuses:"All"});const i=new Map;an.forEach(a=>{a.owner&&a.ownerEmail&&!i.has(a.ownerEmail)&&i.set(a.ownerEmail,{name:a.owner,email:a.ownerEmail,role:jn.SITE_OWNER,campuses:[]}),a.owner&&a.ownerEmail&&i.has(a.ownerEmail)&&i.get(a.ownerEmail).campuses.push(a.name)}),i.forEach(a=>n.push(a));const r=new Map;return an.forEach(a=>{a.cc&&a.ccEmail&&a.cc!=="Hiring CC"&&a.cc!=="Not Yet"&&!r.has(a.ccEmail)&&r.set(a.ccEmail,{name:a.cc,email:a.ccEmail,role:jn.CAMPUS_COORDINATOR,campuses:[a.name]})}),r.forEach(a=>n.push(a)),n},ty="MQAAAAED7kv2",zu="TESTING - Copy of Ops P2 Template",Qu=async(n,i={})=>{const{method:r="GET",body:a}=i;console.log(`[IssueTracker] Wrike: ${r} ${n}`);const{data:c,error:d}=await ct.functions.invoke("wrike-proxy",{body:{endpoint:n,method:r,body:a}});if(d)throw console.error("[IssueTracker] Edge Function error:",d),new Error(d.message||"Wrike API request failed");if(c?.error)throw console.error("[IssueTracker] API error:",c.error),new Error(c.error);return c},_j=async(n=ty)=>{const i=JSON.stringify(["description","briefDescription","responsibleIds","status","importance","createdDate","updatedDate","dates","customFields","parentIds","permalink"]);return(await Qu(`/folders/${n}/tasks?fields=${i}&sortField=CreatedDate&sortOrder=Desc&limit=100`))?.data||[]},jj=async n=>{const i=JSON.stringify(["description","briefDescription","responsibleIds","status","importance","createdDate","updatedDate","dates","customFields","parentIds","permalink","authorIds","hasAttachments"]);return(await Qu(`/tasks/${n}?fields=${i}`))?.data?.[0]||null},Cj=async n=>(await Qu(`/tasks/${n}/comments`))?.data||[],Rj=n=>{const i=n?.match(/^\[([^\]]+)\]/);return i?i[1]:"Unknown Campus"},Ej=n=>{const i=n?.match(/<b>(?:Auditor|Submitted by|Coordinator|Reporter)[^<]*:<\/b>\s*([^<\n]+)/i),r=n?.match(/<b>(?:Auditor Email|Email)[^<]*:<\/b>\s*([^<\n\s]+)/i);return{name:i?i[1].trim():"Unknown",email:r?r[1].trim():""}},Tj=n=>{if(!n)return[];const i=[],r=/href="([^"]*supabase[^"]*photos[^"]*)"/gi;let a;for(;(a=r.exec(n))!==null;)i.push(a[1]);const c=/src="([^"]*supabase[^"]*photos[^"]*)"/gi;for(;(a=c.exec(n))!==null;)i.push(a[1]);return i},Aj=(n,i)=>{const r=`${n} ${i}`.toLowerCase();for(const[a,c]of Object.entries(kj))if(c.some(d=>r.includes(d)))return a;return"Other"},zj=(n,i)=>{const r=`${n} ${i}`.toLowerCase();return["emergency","urgent","","fire","flood","safety hazard","water leak","hvac fail"].some(c=>r.includes(c))},ny=n=>{const i=Rj(n.title),r=Ej(n.description),a=Tj(n.description),c=Aj(n.title,n.description),d=zj(n.title,n.description),h=n.status,p=vj[h]||mn.SUBMITTED,g=n.importance;let m=Sj[g]||Ct.STANDARD;d&&(m=Ct.EMERGENCY);const x=n.createdDate,k=n.updatedDate,S=Ku[m],_=new Date(new Date(x).getTime()+S.targetHours*60*60*1e3).toISOString(),w=n.title?.replace(/^\[[^\]]+\]\s*/,"")||n.title;return{id:n.id,title:w,rawTitle:n.title,status:p,wrikeStatus:h,priority:m,category:c,campus:i,submittedBy:r.name,submittedByEmail:r.email,assignedTo:n.responsibleIds?.length?"Assigned":"Unassigned",createdDate:x,updatedDate:k,slaDeadline:_,description:n.description,briefDescription:n.briefDescription,photos:a,permalink:n.permalink,isResolved:p===mn.RESOLVED,isEmergency:d}},dl=n=>{if(n.isResolved)return{status:"resolved",label:"Resolved",hoursRemaining:0};const i=Date.now(),a=(new Date(n.slaDeadline).getTime()-i)/(1e3*60*60),c=Ku[n.priority];return a<=0?{status:fo.OVERDUE,label:"Overdue",hoursRemaining:a,display:Dj(Math.abs(a))}:a<=c.atRiskHoursRemaining?{status:fo.AT_RISK,label:"At Risk",hoursRemaining:a,display:Km(a)}:{status:fo.ON_TRACK,label:"On Track",hoursRemaining:a,display:Km(a)}},Km=n=>{if(n>=48)return`${Math.floor(n/24)}d remaining`;if(n>=1){const i=Math.floor(n),r=Math.round((n-i)*60);return r>0?`${i}h ${r}m remaining`:`${i}h remaining`}return`${Math.round(n*60)}m remaining`},Dj=n=>n>=48?`${Math.floor(n/24)}d overdue`:n>=1?`${Math.floor(n)}h overdue`:`${Math.round(n*60)}m overdue`,Oj=n=>{const i=n.filter(p=>!p.isResolved),r=i.filter(p=>p.isEmergency),a=i.filter(p=>dl(p).status===fo.OVERDUE),c=i.filter(p=>dl(p).status===fo.AT_RISK);let d="green",h="All clear";return r.length>0||a.length>0?(d="red",h=r.length>0?`${r.length} open emergency issue${r.length>1?"s":""}`:`${a.length} SLA violation${a.length>1?"s":""}`):(i.length>2||c.length>0)&&(d="amber",h=c.length>0?`${c.length} issue${c.length>1?"s":""} approaching SLA`:`${i.length} open issues`),{status:d,reason:h,openCount:i.length,resolvedCount:n.length-i.length,emergencyCount:r.length,slaViolationCount:a.length,atRiskCount:c.length,totalCount:n.length}},Ij=(n,i=[])=>{const r=[];return r.push({status:"Submitted",timestamp:n.createdDate,note:"Issue created",who:n.submittedBy||"Unknown"}),i.forEach(a=>{const c=a.text?.replace(/<[^>]*>/g,"")||"";r.push({status:"Update",timestamp:a.createdDate,note:c.substring(0,200),who:a.authorId||"Ops Team"})}),(n.isResolved||n.status===mn.RESOLVED)&&r.push({status:"Resolved",timestamp:n.updatedDate,note:"Issue resolved",who:"Ops Team"}),r.sort((a,c)=>new Date(a.timestamp)-new Date(c.timestamp)),r},Ju=(n=null)=>{const[i,r]=v.useState([]),[a,c]=v.useState(!0),[d,h]=v.useState(null),[p,g]=v.useState("all"),[m,x]=v.useState("all"),[k,S]=v.useState("all"),_=v.useCallback(async()=>{c(!0),h(null);try{const C=(await _j(ty)).map(ny);r(C),console.log(`[IssueTracker] Loaded ${C.length} issues`)}catch(y){console.error("[IssueTracker] Failed to load issues:",y),h(y.message)}finally{c(!1)}},[]);v.useEffect(()=>{_()},[_]);const w=v.useMemo(()=>i.map(y=>({...y,sla:dl(y)})),[i]),j=v.useMemo(()=>{let y=[...w];return p!=="all"&&(y=y.filter(C=>C.category===p)),m==="open"?y=y.filter(C=>!C.isResolved):m==="resolved"?y=y.filter(C=>C.isResolved):m!=="all"&&(y=y.filter(C=>C.status===m)),k!=="all"&&(y=y.filter(C=>C.priority===k)),y},[w,p,m,k]),A=v.useMemo(()=>n?w.filter(y=>y.submittedByEmail?.toLowerCase()===n.toLowerCase()).sort((y,C)=>y.isResolved!==C.isResolved?y.isResolved?1:-1:new Date(C.createdDate)-new Date(y.createdDate)):[],[w,n]),z=v.useMemo(()=>{const y=w.filter(C=>!C.isResolved);return{total:w.length,open:y.length,resolved:w.length-y.length,slaViolations:y.filter(C=>C.sla.status==="overdue").length,atRisk:y.filter(C=>C.sla.status==="at-risk").length,emergencies:y.filter(C=>C.isEmergency).length}},[w]),D=v.useMemo(()=>Oj(w),[w]);return{issues:w,filteredIssues:j,mySubmissions:A,loading:a,error:d,stats:z,campusHealth:D,categoryFilter:p,setCategoryFilter:g,statusFilter:m,setStatusFilter:x,priorityFilter:k,setPriorityFilter:S,refresh:_}},Qm="issueTracker_selectedUser",iy=()=>{const n=wj(),[i,r]=v.useState(()=>{const d=sessionStorage.getItem(Qm);return d&&n.some(h=>h.email===d)?d:n[0]?.email||""}),a=v.useCallback(d=>{r(d),sessionStorage.setItem(Qm,d)},[]);return{selectedUser:n.find(d=>d.email===i)||n[0],selectedUserEmail:i,setSelectedUser:a,availableUsers:n}},sy=({selectedEmail:n,onChange:i,users:r})=>{const a={[jn.EXECUTIVE]:r.filter(c=>c.role===jn.EXECUTIVE),[jn.SITE_OWNER]:r.filter(c=>c.role===jn.SITE_OWNER),[jn.CAMPUS_COORDINATOR]:r.filter(c=>c.role===jn.CAMPUS_COORDINATOR)};return s.jsx("select",{value:n,onChange:c=>i(c.target.value),style:{padding:"8px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",backgroundColor:"#fff",fontSize:"14px",fontWeight:"500",color:"#092849",cursor:"pointer",maxWidth:"220px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:Object.entries(a).map(([c,d])=>d.length>0&&s.jsx("optgroup",{label:c,children:d.map(h=>s.jsx("option",{value:h.email,children:h.name},h.email))},c))})},Jm={green:{bg:"linear-gradient(135deg, #ecfdf5, #d1fae5)",border:"#a7f3d0",icon:as,iconColor:"#059669",label:"Healthy",textColor:"#065f46"},amber:{bg:"linear-gradient(135deg, #fffbeb, #fef3c7)",border:"#fde68a",icon:wo,iconColor:"#d97706",label:"Needs Attention",textColor:"#92400e"},red:{bg:"linear-gradient(135deg, #fef2f2, #fee2e2)",border:"#fecaca",icon:Pw,iconColor:"#dc2626",label:"Critical",textColor:"#991b1b"}},ry=({health:n,campusName:i,onClick:r})=>{const a=Jm[n.status]||Jm.green,c=a.icon;return s.jsxs("div",{onClick:r,style:{background:a.bg,border:`1px solid ${a.border}`,borderRadius:"16px",padding:"20px",cursor:r?"pointer":"default",transition:"transform 0.15s"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[s.jsx(c,{size:28,color:a.iconColor}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"18px",fontWeight:"700",color:a.textColor},children:a.label}),s.jsx("div",{style:{fontSize:"13px",color:a.textColor,opacity:.8},children:i||"Test Campus"})]})]}),s.jsx("div",{style:{fontSize:"13px",color:a.textColor,marginBottom:"12px"},children:n.reason}),s.jsxs("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap"},children:[s.jsx(Xa,{label:"Open",value:n.openCount}),s.jsx(Xa,{label:"Resolved",value:n.resolvedCount}),n.slaViolationCount>0&&s.jsx(Xa,{label:"SLA Violations",value:n.slaViolationCount,highlight:!0}),n.emergencyCount>0&&s.jsx(Xa,{label:"Emergency",value:n.emergencyCount,highlight:!0})]})]})},Xa=({label:n,value:i,highlight:r})=>s.jsxs("div",{style:{textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"20px",fontWeight:"700",color:r?"#dc2626":"#1e293b"},children:i}),s.jsx("div",{style:{fontSize:"11px",color:"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:n})]}),Xm={"on-track":{bg:"#ecfdf5",color:"#059669",border:"#a7f3d0",icon:Zu,label:"On Track"},"at-risk":{bg:"#fffbeb",color:"#d97706",border:"#fde68a",icon:wo,label:"At Risk"},overdue:{bg:"#fef2f2",color:"#dc2626",border:"#fecaca",icon:gw,label:"Overdue"},resolved:{bg:"#f0f9ff",color:"#64748b",border:"#e2e8f0",icon:as,label:"Resolved"}},oy=({sla:n,compact:i=!1})=>{if(!n)return null;const r=Xm[n.status]||Xm["on-track"],a=r.icon;return i?s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",fontSize:"11px",fontWeight:"600",color:r.color,backgroundColor:r.bg,border:`1px solid ${r.border}`,borderRadius:"12px",padding:"2px 8px"},children:[s.jsx(a,{size:12}),n.display||r.label]}):s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",backgroundColor:r.bg,border:`1px solid ${r.border}`,borderRadius:"10px",padding:"8px 12px"},children:[s.jsx(a,{size:16,color:r.color}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"13px",fontWeight:"600",color:r.color},children:r.label}),n.display&&s.jsx("div",{style:{fontSize:"11px",color:r.color,opacity:.8},children:n.display})]})]})},ex={Submitted:{bg:"#dbeafe",color:"#1d4ed8"},Triaged:{bg:"#e0e7ff",color:"#4338ca"},"In Progress":{bg:"#fef3c7",color:"#b45309"},"Vendor Assigned":{bg:"#fce7f3",color:"#be185d"},Resolved:{bg:"#ecfdf5",color:"#059669"}},tx={[Ct.EMERGENCY]:{bg:"#fef2f2",color:"#dc2626",label:"EMERGENCY"},[Ct.HIGH]:{bg:"#fff7ed",color:"#ea580c",label:"HIGH"},[Ct.STANDARD]:{bg:"#f0f9ff",color:"#0284c7",label:"STANDARD"},[Ct.LOW]:{bg:"#f8fafc",color:"#64748b",label:"LOW"}},ul=({issue:n})=>{const i=xe(),r=ex[n.status]||ex.Submitted,a=tx[n.priority]||tx[Ct.STANDARD],c=_o[n.category]||_o.Other,d=Bj(n.updatedDate||n.createdDate);return s.jsxs("div",{onClick:()=>i(`/issues/${n.id}`),style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",border:"1px solid #e2e8f0",cursor:"pointer",transition:"box-shadow 0.15s",marginBottom:"8px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"8px"},children:[s.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#1e293b",flex:1,lineHeight:"1.3"},children:n.title}),s.jsx(ll,{size:18,color:"#94a3b8",style:{flexShrink:0,marginTop:"2px"}})]}),s.jsxs("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap",marginTop:"10px",alignItems:"center"},children:[s.jsx("span",{style:{fontSize:"11px",fontWeight:"600",backgroundColor:r.bg,color:r.color,borderRadius:"6px",padding:"2px 8px"},children:n.status}),s.jsx("span",{style:{fontSize:"10px",fontWeight:"700",backgroundColor:a.bg,color:a.color,borderRadius:"6px",padding:"2px 8px",letterSpacing:"0.5px"},children:a.label}),s.jsx("span",{style:{fontSize:"11px",fontWeight:"500",color:c.color,borderRadius:"6px",padding:"2px 8px",border:`1px solid ${c.color}33`},children:c.label}),s.jsx(oy,{sla:n.sla,compact:!0})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"10px",fontSize:"12px",color:"#94a3b8"},children:[s.jsx("span",{children:n.submittedBy}),s.jsx("span",{children:d})]})]})};function Bj(n){if(!n)return"";const i=Date.now()-new Date(n).getTime(),r=Math.floor(i/6e4);if(r<60)return`${r}m ago`;const a=Math.floor(r/60);return a<24?`${a}h ago`:`${Math.floor(a/24)}d ago`}const Nj=()=>{const n=xe(),{selectedUser:i,selectedUserEmail:r,setSelectedUser:a,availableUsers:c}=iy(),{issues:d,stats:h,campusHealth:p,loading:g,error:m,refresh:x}=Ju(r),k=d.filter(S=>!S.isResolved).sort((S,_)=>new Date(_.createdDate)-new Date(S.createdDate)).slice(0,5);return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f8fafc"},children:[s.jsxs("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",padding:"16px 20px 20px",color:"#fff"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[s.jsxs("button",{onClick:()=>n("/"),style:{background:"none",border:"none",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"14px"},children:[s.jsx(ko,{size:18})," Home"]}),s.jsxs("button",{onClick:x,disabled:g,style:{background:"rgba(255,255,255,0.15)",border:"none",color:"#fff",cursor:"pointer",borderRadius:"8px",padding:"6px 12px",display:"flex",alignItems:"center",gap:"4px",fontSize:"13px"},children:[s.jsx(ls,{size:14,className:g?"animate-spin":""})," Refresh"]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",margin:0},children:"Issue Tracker"}),s.jsx("p",{style:{fontSize:"13px",opacity:.7,margin:"2px 0 0"},children:"Test Campus Dashboard"})]}),s.jsx(sy,{selectedEmail:r,onChange:a,users:c})]})]}),s.jsxs("div",{style:{padding:"16px 20px",maxWidth:"800px",margin:"0 auto"},children:[s.jsx(ry,{health:p,campusName:zu,onClick:()=>n("/issues/campus")}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginTop:"16px"},children:[s.jsx(nx,{icon:s.jsx(_w,{size:20,color:"#2B57D0"}),title:"My Submissions",subtitle:i?.name||"Select user",onClick:()=>n("/issues/mine")}),s.jsx(nx,{icon:s.jsx(Fx,{size:20,color:"#2B57D0"}),title:"Campus Issues",subtitle:`${h.open} open`,onClick:()=>n("/issues/campus")})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px",marginTop:"16px"},children:[s.jsx(el,{label:"Total",value:h.total}),s.jsx(el,{label:"Open",value:h.open,color:"#2B57D0"}),s.jsx(el,{label:"At Risk",value:h.atRisk,color:"#d97706"}),s.jsx(el,{label:"Overdue",value:h.slaViolations,color:"#dc2626"})]}),m&&s.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"16px",marginTop:"16px",color:"#991b1b",fontSize:"14px"},children:["Failed to load issues: ",m]}),g&&s.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8"},children:[s.jsx(ls,{size:24,className:"animate-spin",style:{margin:"0 auto 8px"}}),"Loading issues from Wrike..."]}),!g&&k.length>0&&s.jsxs("div",{style:{marginTop:"20px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[s.jsx("h2",{style:{fontSize:"16px",fontWeight:"600",color:"#1e293b",margin:0},children:"Recent Open Issues"}),s.jsx("button",{onClick:()=>n("/issues/campus"),style:{background:"none",border:"none",color:"#2B57D0",cursor:"pointer",fontSize:"13px",fontWeight:"500"},children:"View all"})]}),k.map(S=>s.jsx(ul,{issue:S},S.id))]}),!g&&!m&&d.length===0&&s.jsxs("div",{style:{textAlign:"center",padding:"48px 20px",color:"#94a3b8",marginTop:"20px"},children:[s.jsx(Yx,{size:40,style:{margin:"0 auto 12px",opacity:.5}}),s.jsx("div",{style:{fontSize:"16px",fontWeight:"500",marginBottom:"4px"},children:"No issues found"}),s.jsx("div",{style:{fontSize:"13px"},children:"Issues from checklists and reports will appear here"})]})]})]})},nx=({icon:n,title:i,subtitle:r,onClick:a})=>s.jsxs("div",{onClick:a,style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",border:"1px solid #e2e8f0",cursor:"pointer",transition:"box-shadow 0.15s"},children:[s.jsx("div",{style:{marginBottom:"8px"},children:n}),s.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:i}),s.jsx("div",{style:{fontSize:"12px",color:"#94a3b8",marginTop:"2px"},children:r})]}),el=({label:n,value:i,color:r="#1e293b"})=>s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"10px",padding:"12px 8px",textAlign:"center",border:"1px solid #e2e8f0"},children:[s.jsx("div",{style:{fontSize:"22px",fontWeight:"700",color:r},children:i}),s.jsx("div",{style:{fontSize:"11px",color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.3px"},children:n})]}),Mj=()=>{const n=xe(),{selectedUser:i,selectedUserEmail:r,setSelectedUser:a,availableUsers:c}=iy(),{mySubmissions:d,loading:h,error:p,refresh:g}=Ju(r),m=d.filter(k=>!k.isResolved).length,x=d.filter(k=>k.isResolved).length;return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f8fafc"},children:[s.jsxs("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",padding:"16px 20px 20px",color:"#fff"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[s.jsxs("button",{onClick:()=>n("/issues"),style:{background:"none",border:"none",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"14px"},children:[s.jsx(ko,{size:18})," Dashboard"]}),s.jsx("button",{onClick:g,disabled:h,style:{background:"rgba(255,255,255,0.15)",border:"none",color:"#fff",cursor:"pointer",borderRadius:"8px",padding:"6px 12px",display:"flex",alignItems:"center",gap:"4px",fontSize:"13px"},children:s.jsx(ls,{size:14,className:h?"animate-spin":""})})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",margin:0},children:"My Submissions"}),s.jsxs("p",{style:{fontSize:"13px",opacity:.7,margin:"2px 0 0"},children:["Viewing as: ",i?.name]})]}),s.jsx(sy,{selectedEmail:r,onChange:a,users:c})]}),s.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"12px"},children:[s.jsxs("span",{style:{backgroundColor:"rgba(255,255,255,0.15)",borderRadius:"20px",padding:"4px 12px",fontSize:"13px"},children:[m," Open"]}),s.jsxs("span",{style:{backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"20px",padding:"4px 12px",fontSize:"13px"},children:[x," Resolved"]})]})]}),s.jsxs("div",{style:{padding:"16px 20px",maxWidth:"800px",margin:"0 auto"},children:[h&&s.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8"},children:[s.jsx(ls,{size:24,className:"animate-spin",style:{margin:"0 auto 8px"}}),"Loading your submissions..."]}),p&&s.jsx("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"16px",color:"#991b1b",fontSize:"14px"},children:p}),!h&&d.length>0&&s.jsxs(s.Fragment,{children:[m>0&&s.jsxs("div",{style:{marginBottom:"20px"},children:[s.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Open"}),d.filter(k=>!k.isResolved).map(k=>s.jsx(ul,{issue:k},k.id))]}),x>0&&s.jsxs("div",{children:[s.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Resolved"}),d.filter(k=>k.isResolved).map(k=>s.jsx(ul,{issue:k},k.id))]})]}),!h&&!p&&d.length===0&&s.jsxs("div",{style:{textAlign:"center",padding:"48px 20px",color:"#94a3b8"},children:[s.jsx(Ow,{size:40,style:{margin:"0 auto 12px",opacity:.5}}),s.jsx("div",{style:{fontSize:"16px",fontWeight:"500",marginBottom:"4px"},children:"No submissions found"}),s.jsx("div",{style:{fontSize:"13px"},children:i?.name?`No issues submitted by ${i.name} in this campus`:"Select a user to view their submissions"})]})]})]})},qj=()=>{const n=xe(),{filteredIssues:i,campusHealth:r,loading:a,error:c,refresh:d,categoryFilter:h,setCategoryFilter:p,statusFilter:g,setStatusFilter:m,priorityFilter:x,setPriorityFilter:k}=Ju(),S=[...i].sort((_,w)=>_.isResolved!==w.isResolved?_.isResolved?1:-1:new Date(w.createdDate)-new Date(_.createdDate));return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f8fafc"},children:[s.jsxs("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",padding:"16px 20px 20px",color:"#fff"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[s.jsxs("button",{onClick:()=>n("/issues"),style:{background:"none",border:"none",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"14px"},children:[s.jsx(ko,{size:18})," Dashboard"]}),s.jsx("button",{onClick:d,disabled:a,style:{background:"rgba(255,255,255,0.15)",border:"none",color:"#fff",cursor:"pointer",borderRadius:"8px",padding:"6px 12px",display:"flex",alignItems:"center",gap:"4px",fontSize:"13px"},children:s.jsx(ls,{size:14,className:a?"animate-spin":""})})]}),s.jsx("h1",{style:{fontSize:"22px",fontWeight:"700",margin:0},children:"Campus Issues"}),s.jsx("p",{style:{fontSize:"13px",opacity:.7,margin:"2px 0 0"},children:zu})]}),s.jsxs("div",{style:{padding:"16px 20px",maxWidth:"800px",margin:"0 auto"},children:[s.jsx(ry,{health:r,campusName:zu}),s.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"16px",overflowX:"auto",paddingBottom:"4px"},children:[s.jsx(du,{value:g,onChange:m,options:[{value:"all",label:"All Status"},{value:"open",label:"Open Only"},{value:"resolved",label:"Resolved"},...Object.values(mn).map(_=>({value:_,label:_}))]}),s.jsx(du,{value:h,onChange:p,options:[{value:"all",label:"All Categories"},...Object.keys(_o).map(_=>({value:_,label:_}))]}),s.jsx(du,{value:x,onChange:k,options:[{value:"all",label:"All Priority"},...Object.values(Ct).map(_=>({value:_,label:_}))]})]}),s.jsxs("div",{style:{fontSize:"13px",color:"#64748b",marginTop:"12px",marginBottom:"8px"},children:[i.length," issue",i.length!==1?"s":"",(h!=="all"||g!=="all"||x!=="all")&&" (filtered)"]}),a&&s.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8"},children:[s.jsx(ls,{size:24,className:"animate-spin",style:{margin:"0 auto 8px"}}),"Loading campus issues..."]}),c&&s.jsx("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"16px",color:"#991b1b",fontSize:"14px"},children:c}),!a&&S.map(_=>s.jsx(ul,{issue:_},_.id)),!a&&!c&&S.length===0&&s.jsxs("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8"},children:[s.jsx(Cw,{size:32,style:{margin:"0 auto 8px",opacity:.5}}),s.jsx("div",{style:{fontSize:"15px",fontWeight:"500"},children:"No issues match filters"})]})]})]})},du=({value:n,onChange:i,options:r})=>s.jsx("select",{value:n,onChange:a=>i(a.target.value),style:{padding:"6px 10px",borderRadius:"8px",border:"1px solid #e2e8f0",backgroundColor:n!=="all"?"#eff6ff":"#fff",fontSize:"13px",color:"#1e293b",cursor:"pointer",flexShrink:0},children:r.map(a=>s.jsx("option",{value:a.value,children:a.label},a.value))}),Wj={Submitted:"#3b82f6",Triaged:"#6366f1","In Progress":"#f59e0b","Vendor Assigned":"#ec4899",Resolved:"#10b981",Update:"#94a3b8"},Uj=({events:n})=>!n||n.length===0?null:s.jsx("div",{style:{padding:"4px 0"},children:n.map((i,r)=>{const a=Wj[i.status]||"#94a3b8",c=r===n.length-1,d=new Date(i.timestamp),h=d.toLocaleDateString("en-US",{month:"short",day:"numeric"})+" "+d.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return s.jsxs("div",{style:{display:"flex",gap:"12px",minHeight:c?"auto":"52px"},children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"20px"},children:[s.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:a,flexShrink:0,border:"2px solid #fff",boxShadow:`0 0 0 2px ${a}40`}}),!c&&s.jsx("div",{style:{width:"2px",flex:1,backgroundColor:"#e2e8f0",marginTop:"2px"}})]}),s.jsxs("div",{style:{paddingBottom:c?0:"16px",flex:1},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{style:{fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:i.status}),s.jsx("span",{style:{fontSize:"12px",color:"#94a3b8"},children:h})]}),i.note&&s.jsx("div",{style:{fontSize:"13px",color:"#64748b",marginTop:"2px",lineHeight:"1.4"},children:i.note}),i.who&&i.who!=="Unknown"&&s.jsxs("div",{style:{fontSize:"12px",color:"#94a3b8",marginTop:"2px"},children:["by ",i.who]})]})]},r)})}),Lj=()=>{const n=xe(),{taskId:i}=fl(),[r,a]=v.useState(null),[c,d]=v.useState([]),[h,p]=v.useState(!0),[g,m]=v.useState(null);if(v.useEffect(()=>{i&&(async()=>{p(!0);try{const[A,z]=await Promise.all([jj(i),Cj(i).catch(()=>[])]);if(!A)throw new Error("Task not found");const D=ny(A),y=dl(D);a({...D,sla:y}),d(Ij(D,z))}catch(A){console.error("[IssueDetail] Error:",A),m(A.message)}finally{p(!1)}})()},[i]),h)return s.jsx("div",{style:{minHeight:"100vh",backgroundColor:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{style:{textAlign:"center",color:"#94a3b8"},children:[s.jsx(ls,{size:24,className:"animate-spin",style:{margin:"0 auto 8px"}}),"Loading issue..."]})});if(g)return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f8fafc",padding:"20px"},children:[s.jsxs("button",{onClick:()=>n(-1),style:{background:"none",border:"none",color:"#2B57D0",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"14px",marginBottom:"20px"},children:[s.jsx(ko,{size:18})," Back"]}),s.jsx("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"16px",color:"#991b1b"},children:g})]});if(!r)return null;const x=_o[r.category]||_o.Other,k=Ku[r.priority],S=new Date(r.createdDate),_=new Date(r.updatedDate),w=r.description?.replace(/<br\s*\/?>/gi,`
`)?.replace(/<[^>]*>/g,"")?.trim()||"";return s.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"#f8fafc"},children:[s.jsxs("div",{style:{background:"linear-gradient(180deg, #092849 0%, #141685 100%)",padding:"16px 20px 20px",color:"#fff"},children:[s.jsxs("button",{onClick:()=>n(-1),style:{background:"none",border:"none",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"14px",marginBottom:"12px"},children:[s.jsx(ko,{size:18})," Back"]}),s.jsx("h1",{style:{fontSize:"18px",fontWeight:"700",margin:0,lineHeight:"1.3"},children:r.title}),s.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"10px",flexWrap:"wrap"},children:[s.jsx(uu,{bg:"rgba(255,255,255,0.15)",color:"#fff",children:r.status}),s.jsx(uu,{bg:"rgba(255,255,255,0.1)",color:"#fff",children:r.priority}),s.jsx(uu,{bg:`${x.color}33`,color:"#fff",children:x.label})]})]}),s.jsxs("div",{style:{padding:"16px 20px",maxWidth:"800px",margin:"0 auto"},children:[s.jsx(oy,{sla:r.sla}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",border:"1px solid #e2e8f0",marginTop:"12px"},children:[s.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",margin:"0 0 12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Details"}),s.jsx(Zn,{label:"Submitted By",value:r.submittedBy}),r.submittedByEmail&&s.jsx(Zn,{label:"Email",value:r.submittedByEmail}),s.jsx(Zn,{label:"Campus",value:r.campus}),s.jsx(Zn,{label:"Category",value:`${x.label} ${x.pillar!=="--"?`(${x.pillar})`:""}`}),s.jsx(Zn,{label:"Priority",value:r.priority}),s.jsx(Zn,{label:"Assigned To",value:r.assignedTo}),s.jsx(Zn,{label:"Created",value:ix(S)}),s.jsx(Zn,{label:"Last Updated",value:ix(_)}),s.jsx(Zn,{label:"SLA Target",value:`${k.targetHours}h from submission`}),r.permalink&&s.jsxs("a",{href:r.permalink,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-flex",alignItems:"center",gap:"4px",color:"#2B57D0",fontSize:"13px",marginTop:"8px",textDecoration:"none"},children:["Open in Wrike ",s.jsx(kw,{size:12})]})]}),r.photos.length>0&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",border:"1px solid #e2e8f0",marginTop:"12px"},children:[s.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",margin:"0 0 12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Photos"}),s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"8px"},children:r.photos.map((j,A)=>s.jsx("a",{href:j,target:"_blank",rel:"noopener noreferrer",children:s.jsx("img",{src:j,alt:`Photo ${A+1}`,style:{width:"100%",height:"100px",objectFit:"cover",borderRadius:"8px",border:"1px solid #e2e8f0"}})},A))})]}),s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",border:"1px solid #e2e8f0",marginTop:"12px"},children:[s.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",margin:"0 0 12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Status Timeline"}),c.length>0?s.jsx(Uj,{events:c}):s.jsx("div",{style:{fontSize:"13px",color:"#94a3b8",textAlign:"center",padding:"16px"},children:"No timeline events available"})]}),w&&s.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"12px",padding:"16px",border:"1px solid #e2e8f0",marginTop:"12px",marginBottom:"20px"},children:[s.jsx("h3",{style:{fontSize:"14px",fontWeight:"600",color:"#64748b",margin:"0 0 8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Description"}),s.jsxs("div",{style:{fontSize:"14px",color:"#475569",lineHeight:"1.5",whiteSpace:"pre-wrap",maxHeight:"200px",overflow:"auto"},children:[w.substring(0,1e3),w.length>1e3?"...":""]})]})]})]})},uu=({bg:n,color:i,children:r})=>s.jsx("span",{style:{backgroundColor:n,color:i,borderRadius:"8px",padding:"3px 10px",fontSize:"12px",fontWeight:"600"},children:r}),Zn=({label:n,value:i})=>s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #f1f5f9"},children:[s.jsx("span",{style:{fontSize:"13px",color:"#64748b"},children:n}),s.jsx("span",{style:{fontSize:"13px",color:"#1e293b",fontWeight:"500",textAlign:"right",maxWidth:"60%"},children:i})]});function ix(n){return n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})+" "+n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}function $j(){const n=s2(),i=l2(),r=p2(),a=y2(),c=w2(),d=q_(),h=V_(),p=ij(),g=uj(),m=R2();return s.jsxs(r1,{children:[s.jsx("input",{type:"file",ref:n.fileInputRef,accept:"image/*",capture:"environment",className:"hidden",onChange:n.handleFileSelect}),s.jsx(E2,{isOpen:n.isOpen,label:n.label,isVideoReady:n.isVideoReady,videoRef:n.videoRef,canvasRef:n.canvasRef,onCapture:n.capturePhoto,onClose:n.closeCamera}),n.isUploading&&s.jsx("div",{className:"fixed inset-0 z-[100] bg-black/70 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 flex flex-col items-center gap-4 shadow-2xl",children:[s.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-gray-700 font-medium",children:"Uploading photo..."})]})}),s.jsxs(Bv,{children:[s.jsx(be,{path:"/",element:s.jsx(Jw,{})}),s.jsx(be,{path:"/audit/setup",element:s.jsx(e_,{audit:i})}),s.jsx(be,{path:"/audit/overview",element:s.jsx(t_,{audit:i})}),s.jsx(be,{path:"/audit/zone",element:s.jsx(n_,{audit:i,camera:n})}),s.jsx(be,{path:"/audit/condition",element:s.jsx(i_,{audit:i,camera:n})}),s.jsx(be,{path:"/audit/tour-ready",element:s.jsx(s_,{audit:i})}),s.jsx(be,{path:"/audit/summary",element:s.jsx(r_,{audit:i})}),s.jsx(be,{path:"/audit/complete",element:s.jsx(o_,{audit:i})}),s.jsx(be,{path:"/bg/setup",element:s.jsx(y_,{bgWalkthrough:a})}),s.jsx(be,{path:"/bg/zone",element:s.jsx(b_,{bgWalkthrough:a,camera:n})}),s.jsx(be,{path:"/bg/governance",element:s.jsx(v_,{bgWalkthrough:a,camera:n})}),s.jsx(be,{path:"/bg/summary",element:s.jsx(S_,{bgWalkthrough:a})}),s.jsx(be,{path:"/bg/complete",element:s.jsx(k_,{bgWalkthrough:a})}),s.jsx(be,{path:"/history",element:s.jsx(a_,{})}),s.jsx(be,{path:"/audit/:id",element:s.jsx(l_,{})}),s.jsx(be,{path:"/bg/:id",element:s.jsx(w_,{})}),s.jsx(be,{path:"/report",element:s.jsx(c_,{report:r,camera:n})}),s.jsx(be,{path:"/report/photo",element:s.jsx(d_,{report:r,camera:n})}),s.jsx(be,{path:"/report/description",element:s.jsx(u_,{report:r})}),s.jsx(be,{path:"/report/emergency",element:s.jsx(h_,{report:r})}),s.jsx(be,{path:"/report/complete",element:s.jsx(f_,{report:r})}),s.jsx(be,{path:"/reports",element:s.jsx(p_,{})}),s.jsx(be,{path:"/report/:id",element:s.jsx(g_,{})}),s.jsx(be,{path:"/settings",element:s.jsx(x_,{})}),s.jsx(be,{path:"/security",element:s.jsx(__,{securityChecklist:c})}),s.jsx(be,{path:"/security/checklist",element:s.jsx(j_,{securityChecklist:c,camera:n})}),s.jsx(be,{path:"/security/summary",element:s.jsx(R_,{securityChecklist:c})}),s.jsx(be,{path:"/security/complete",element:s.jsx(E_,{securityChecklist:c})}),s.jsx(be,{path:"/furniture",element:s.jsx(O_,{furnitureChecklist:d})}),s.jsx(be,{path:"/furniture/checklist",element:s.jsx(I_,{furnitureChecklist:d,camera:n})}),s.jsx(be,{path:"/furniture/summary",element:s.jsx(N_,{furnitureChecklist:d})}),s.jsx(be,{path:"/furniture/complete",element:s.jsx(M_,{furnitureChecklist:d})}),s.jsx(be,{path:"/food-safety",element:s.jsx(L_,{foodSafetyChecklist:h})}),s.jsx(be,{path:"/food-safety/checklist",element:s.jsx($_,{foodSafetyChecklist:h,camera:n})}),s.jsx(be,{path:"/food-safety/summary",element:s.jsx(P_,{foodSafetyChecklist:h})}),s.jsx(be,{path:"/food-safety/complete",element:s.jsx(G_,{foodSafetyChecklist:h})}),s.jsx(be,{path:"/health-safety",element:s.jsx(J_,{healthSafetyChecklist:p})}),s.jsx(be,{path:"/health-safety/checklist",element:s.jsx(X_,{healthSafetyChecklist:p,camera:n})}),s.jsx(be,{path:"/health-safety/summary",element:s.jsx(tj,{healthSafetyChecklist:p})}),s.jsx(be,{path:"/health-safety/complete",element:s.jsx(nj,{healthSafetyChecklist:p})}),s.jsx(be,{path:"/mechanical",element:s.jsx(aj,{mechanicalChecklist:g})}),s.jsx(be,{path:"/mechanical/checklist",element:s.jsx(lj,{mechanicalChecklist:g,camera:n})}),s.jsx(be,{path:"/mechanical/summary",element:s.jsx(cj,{mechanicalChecklist:g})}),s.jsx(be,{path:"/mechanical/complete",element:s.jsx(dj,{mechanicalChecklist:g})}),s.jsx(be,{path:"/green-streak",element:s.jsx(hj,{greenStreakWalk:m})}),s.jsx(be,{path:"/green-streak/walk",element:s.jsx(fj,{greenStreakWalk:m,camera:n})}),s.jsx(be,{path:"/green-streak/summary",element:s.jsx(pj,{greenStreakWalk:m})}),s.jsx(be,{path:"/green-streak/complete",element:s.jsx(mj,{greenStreakWalk:m})}),s.jsx(be,{path:"/ops-audits",element:s.jsx(bj,{})}),s.jsx(be,{path:"/issues",element:s.jsx(Nj,{})}),s.jsx(be,{path:"/issues/mine",element:s.jsx(Mj,{})}),s.jsx(be,{path:"/issues/campus",element:s.jsx(qj,{})}),s.jsx(be,{path:"/issues/:taskId",element:s.jsx(Lj,{})})]})]})}qb.createRoot(document.getElementById("root")).render(s.jsx(v.StrictMode,{children:s.jsx(Z2,{children:s.jsx($j,{})})}));
